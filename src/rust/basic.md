---
order: 1
title: Rustè¯»ä¹¦ç¬”è®°-åŸºç¡€ç¯‡
category:
  - rust
---
# Rustè¯»ä¹¦ç¬”è®°-åŸºç¡€ç¯‡
![rest](https://hub.yzuu.cf/sunface/rust-course/blob/main/assets/banner.jpg?raw=true)

æ„Ÿè°¢[Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/about-book.html)ï¼Œæ­£å¦‚ä¹¦ä¸­æ‰€è¯´åœ¨å­¦ä¹  Rust çš„åŒæ—¶ä½ ä¼šæ”¶è·å¾ˆå¤šè¯­è¨€ä¹‹å¤–çš„çŸ¥è¯†ï¼Œå› æ­¤ Rust åœ¨å…¥é—¨é˜¶æ®µæ¯”å¾ˆå¤šç¼–ç¨‹è¯­è¨€è¦æ›´éš¾ï¼Œä½†æ˜¯ä¸€æ—¦å…¥é—¨ï¼Œä½ å°†æ”¶è·ä¸€ä¸ªå…¨æ–°çš„è‡ªå·±ï¼Œæˆä¸ºä¸€ä¸ªæ›´åŠ ä¼˜ç§€çš„ç¨‹åºå‘˜ã€‚
> è¦å­¦å¥½ Rustï¼Œä½ éœ€è¦æ·±å…¥ç†è§£å†…å­˜ã€å †æ ˆã€å¼•ç”¨ã€å˜é‡ä½œç”¨åŸŸç­‰è¿™äº›å…¶å®ƒé«˜çº§è¯­è¨€å¾€å¾€ä¸ä¼šæ·±å…¥æ¥è§¦çš„å†…å®¹ã€‚å¦å¤–ï¼ŒRust ä¼šé€šè¿‡è¯­æ³•ã€ç¼–è¯‘å™¨å’Œ clippy è¿™äº›é™æ€æ£€æŸ¥å·¥å…·åŠå¸®åŠ©åŠå¼ºè¿«çš„è®©ä½ æˆä¸ºæ›´ä¼˜ç§€çš„ç¨‹åºå‘˜ï¼Œå†™å‡ºæ›´å¥½çš„ä»£ç ã€‚åŒæ—¶ï¼Œå½“ä½ æŒæ¡ Rust åï¼Œå°±ä¼šè‡ªå‘æ€§çš„æƒ³è¦å»åšä¸€äº›æ›´ååº•å±‚çš„å¼€å‘ï¼Œè¿™äº›éƒ½å¯ä»¥å¸®åŠ©ä½ æ›´åŠ äº†è§£æ“ä½œç³»ç»Ÿã€ç½‘ç»œã€æ€§èƒ½ä¼˜åŒ–ç­‰åº•å±‚çŸ¥è¯†ï¼Œä¹Ÿä¼šé—´æ¥æˆ–è€…ç›´æ¥çš„æ¥è§¦åˆ°å„ç§ç®—æ³•å’Œæ•°æ®ç»“æ„çš„å®ç°ã€‚

ğŸ”¥å…¶ä»–æ¨èï¼š
- [é€šè¿‡ä¾‹å­å­¦ Rust](https://rustwiki.org/zh-CN/rust-by-example/)
- [Rust ç¨‹åºè®¾è®¡è¯­è¨€](https://www.rustwiki.org.cn/zh-CN/book/)
- [Rust å®˜æ–¹æ–‡æ¡£ä¸­æ–‡æ•™ç¨‹](https://www.rustwiki.org.cn/)
- [APIæŸ¥è¯¢](https://www.rustwiki.org.cn/zh-CN/std/)
- [Rustè¯­è¨€ä¸­æ–‡ç¤¾åŒº](https://rustcc.cn/)


##  ğŸ¥³ å®‰è£…rust
å®‰è£…æ—¥æœŸï¼š2023-05-03
* [å­—èŠ‚ä»£ç†](https://rsproxy.cn/)


### Mac
```sh
brew install rust

cargo -V
```

### Win
è¿‡ç¨‹æœ‰ç‚¹éº»çƒ¦è¿˜è¦è£…VSï¼Œå°±ç›´æ¥åœ¨Macä¸Šæ•²äº†

> https://rustup.rs/

### ğŸ˜æ¨è åœ¨çº¿ç»ƒä¹ 
[ç‚¹å‡»è¿›å…¥PlayGround](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021)
[Windowsçš„å¤‡ç”¨æ–¹æ¡ˆ](https://lightly.teamcode.com/rust/) æ— éœ€ä¸‹è½½Rustå¼€å‘ç¯å¢ƒï¼Œå¯ç›´æ¥åœ¨çº¿ç¼–å†™ä»£ç ï¼Œä¸æ˜¯æ‰“å¹¿å‘Šï¼Œæ„Ÿè§‰è¿˜æŒºæ–¹ä¾¿çš„

##  1.1 ğŸ¤ª Hello Rust
1. è¿™æ˜¯æœ€ç®€å•çš„å†™æ³•ï¼š
```rust
fn main() {
    println!("Hello, world!");
}
```

2. ç¨å¾®è¿›é˜¶ä¸€ç‚¹éœ€è¦äº†è§£ä¸€ç‚¹çŸ¥è¯†ï¼š
- `.iter()`  Rust çš„é›†åˆç±»å‹ä¸èƒ½ç›´æ¥è¿›è¡Œå¾ªç¯ï¼Œéœ€è¦å˜æˆè¿­ä»£å™¨ï¼ˆè¿™é‡Œæ˜¯é€šè¿‡ .iter() æ–¹æ³•ï¼‰ï¼Œæ‰èƒ½ç”¨äºè¿­ä»£å¾ªç¯
- `"{}"` è¾“å‡ºå ä½ç¬¦ï¼Œç±»ä¼¼äºå…¶å®ƒè¯­è¨€æƒ¯ç”¨çš„ %sã€%d 
- `&`  println! å®éœ€è¦ä¸€ä¸ªå¼•ç”¨ä½œä¸ºå‚æ•°ï¼Œå› ä¸º Rust çš„å­—ç¬¦ä¸²ç±»å‹æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå­—èŠ‚çš„ UTF-8 ç¼–ç çš„å‘é‡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦æ•°ç»„ã€‚å› æ­¤ï¼Œæ‰“å°ä¸€ä¸ªå­—ç¬¦ä¸²éœ€è¦å°†å®ƒçš„å¼•ç”¨ä¼ é€’ç»™ println! å®ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†é¿å…å°†æ•´ä¸ªå­—ç¬¦ä¸²å¤åˆ¶åˆ°å †æ ˆä¸Šï¼Œè€Œæ˜¯ä½¿ç”¨æŒ‡å‘åŸå§‹æ•°æ®çš„å¼•ç”¨æ¥è¿›è¡Œå¤„ç†ã€‚è¿™ç§æ–¹å¼å¯ä»¥é¿å…æ€§èƒ½ä¸Šçš„é—®é¢˜ï¼Œå¹¶ä¸”ä¸ Java ä¸­çš„å­—ç¬¦ä¸²å¤„ç†æ–¹å¼æœ‰æ‰€ä¸åŒã€‚
- `println!` åœ¨ Rust ä¸­ï¼Œè¿™æ˜¯ å® æ“ä½œç¬¦ï¼Œä½ ç›®å‰å¯ä»¥è®¤ä¸ºå®æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹å‡½æ•°
	- `println!` æ˜¯ä¸€ä¸ª Rust æ ‡å‡†åº“æä¾›çš„å®ï¼Œç”¨äºåœ¨æ§åˆ¶å°è¾“å‡ºæ–‡æœ¬ã€‚åœ¨è¿™é‡Œ "!" è¡¨ç¤ºå®å®šä¹‰çš„å¼€å§‹ï¼Œç„¶ååé¢çš„å†…å®¹æ˜¯å®å‚æ•°ã€‚
```rust
fn greet_world() {
    let southern_germany = "GrÃ¼ÃŸ Gott!";
    let chinese = "ä¸–ç•Œï¼Œä½ å¥½";
    let english = "World, hello";
    let regions = [southern_germany, chinese, english];
    for region in regions.iter() {
        println!("{}", &region);
    }
}
fn main() {
	
}
```

3. å†ç¨å¾®è¿›é˜¶ä¸€ç‚¹ï¼ˆè¿™ä¸ªä¾‹å­ä¹Ÿæ¥è‡ªRuståœ£ç»ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰è¿™ä¸ªä¾‹å­æœ‰ç‚¹åŠé€€ï¼‰ï¼Œéœ€è¦äº†è§£ä¸‹é¢çš„çŸ¥è¯†æ‰èƒ½ç†è§£ï¼š
* `let` åœ¨ Rust ä¸­ï¼Œå¸¸é‡å’Œå˜é‡çš„å®šä¹‰æ˜¯é€šè¿‡ let å…³é”®å­—æ¥è¿›è¡Œçš„ï¼Œåé¢ä¼šè¯´å˜é‡å¦‚ä½•å®šä¹‰
* `lines`ã€`enumerate`ç­‰éƒ½å¯ä»¥é€šè¿‡å…¶ä»–è¯­è¨€ç›´è§‚ç†è§£
* å¯èƒ½é‡åˆ°é—®é¢˜çš„æ˜¯è¿™ä¸ª`if let Ok(length) = fields[1].parse::<f32>()`
	* `parse` æ–¹æ³•çš„ä½œç”¨ç±»ä¼¼äº Java ä¸­çš„ parseInt æ–¹æ³•ï¼Œéƒ½æ˜¯å°†ä¸€ä¸ªå­—ç¬¦ä¸²è§£æä¸ºæ•°å­—
	* `fields[1].parse::<f32>()` å°†ç¬¬äºŒä¸ªå…ƒç´ è§£æä¸ºä¸€ä¸ª f32 ç±»å‹çš„æµ®ç‚¹æ•°ï¼Œå¦‚æœè§£ææˆåŠŸï¼Œè¿”å›ä¸€ä¸ª `Result<f32, ParseFloatError>` ç±»å‹çš„ Ok æšä¸¾å€¼ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ª Err(ParseFloatError) ç±»å‹çš„é”™è¯¯å€¼ã€‚

**parse**
å…¶ä¸­ï¼Œself æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å¼•ç”¨ï¼ŒF æ˜¯è¦è§£ææˆçš„æ•°æ®ç±»å‹ã€‚parse æ–¹æ³•è¿”å›ä¸€ä¸ª Result<F, ParseError> ç±»å‹çš„æšä¸¾å€¼ï¼Œå¦‚æœè§£ææˆåŠŸï¼Œè¿”å›ä¸€ä¸ª Ok(F) æšä¸¾å€¼ï¼Œå…¶ä¸­åŒ…å«è§£æå¾—åˆ°çš„æ•°æ®ï¼›å¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›ä¸€ä¸ª Err(ParseError) æšä¸¾å€¼ï¼Œå…¶ä¸­åŒ…å«è§£æå¤±è´¥çš„åŸå› ã€‚
```rust
pub fn parse<F>(&self) -> Result<F, ParseError>
    where F: FromStr
```

ç¤ºä¾‹ä»£ç ï¼š
```rust
fn main() {
   let penguin_data = "\
   common name,length (cm)
   Little penguin,33
   Yellow-eyed penguin,65
   Fiordland penguin,60
   Invalid,data
   ";

   let records = penguin_data.lines();

   for (i, record) in records.enumerate() {
     if i == 0 || record.trim().len() == 0 {
       continue;
     }

     // å£°æ˜ä¸€ä¸ª fields å˜é‡ï¼Œç±»å‹æ˜¯ Vec
     // Vec æ˜¯ vector çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¯ä¼¸ç¼©çš„é›†åˆç±»å‹ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„
     // <_>è¡¨ç¤º Vec ä¸­çš„å…ƒç´ ç±»å‹ç”±ç¼–è¯‘å™¨è‡ªè¡Œæ¨æ–­ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œéƒ½ä¼šå¸®æˆ‘ä»¬çœå´ä¸å°‘åŠŸå¤«
     let fields: Vec<_> = record
       .split(',')
       .map(|field| field.trim())
       .collect();
     if cfg!(debug_assertions) {
         // è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯è¾“å‡º
       eprintln!("debug: {:?} -> {:?}",
              record, fields);
     }

     let name = fields[0];
     // 1. å°è¯•æŠŠ fields[1] çš„å€¼è½¬æ¢ä¸º f32 ç±»å‹çš„æµ®ç‚¹æ•°ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™æŠŠ f32 å€¼èµ‹ç»™ length å˜é‡
     //
     // 2. if let æ˜¯ä¸€ä¸ªåŒ¹é…è¡¨è¾¾å¼ï¼Œç”¨æ¥ä»=å³è¾¹çš„ç»“æœä¸­ï¼ŒåŒ¹é…å‡º length çš„å€¼ï¼š
     //   1ï¼‰å½“=å³è¾¹çš„è¡¨è¾¾å¼æ‰§è¡ŒæˆåŠŸï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ª Ok(f32) çš„ç±»å‹ï¼Œè‹¥å¤±è´¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ª Err(e) ç±»å‹ï¼Œif let çš„ä½œç”¨å°±æ˜¯ä»…åŒ¹é… Ok ä¹Ÿå°±æ˜¯æˆåŠŸçš„æƒ…å†µï¼Œå¦‚æœæ˜¯é”™è¯¯ï¼Œå°±ç›´æ¥å¿½ç•¥
     //   2ï¼‰åŒæ—¶ if let è¿˜ä¼šåšä¸€æ¬¡è§£æ„åŒ¹é…ï¼Œé€šè¿‡ Ok(length) å»åŒ¹é…å³è¾¹çš„ Ok(f32)ï¼Œæœ€ç»ˆæŠŠç›¸åº”çš„ f32 å€¼èµ‹ç»™ length
     //
     // 3. å½“ç„¶ä½ ä¹Ÿå¯ä»¥å¿½ç•¥æˆåŠŸçš„æƒ…å†µï¼Œç”¨ if let Err(e) = fields[1].parse::<f32>() {...}åŒ¹é…å‡ºé”™è¯¯ï¼Œç„¶åæ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯æ²¡å•¥åµç”¨
     if let Ok(length) = fields[1].parse::<f32>() {
         // è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º
         println!("{}, {}cm", name, length);
     }
   }
 }
```

## 1.2 ğŸ‘€ å˜é‡

### ğŸ˜‰å¸¸è§„å®šä¹‰
å†™ä¸€ä¸ªå˜é‡ï¼Œåªæ˜¯ç”¨letå®šä¹‰
```rust
fn main() {
    let x = 6;
    println!("The value of x is: {}", x);
    x = 1008611; // è¿™é‡Œæ˜¯é”™è¯¯çš„
    println!("The value of x is: {}", x);
}
// é”™è¯¯ï¼šcannot assign twice to immutable variable `x`
```
å¦‚æœè¦è®©å®ƒæˆä¸ºå˜é‡ï¼Œéœ€è¦åŠ å…¥`mut`
```rust
fn main() {
    let mut x = 6;
    println!("The value of x is: {}", x);
    x = 1008611; // è¿™é‡Œæ˜¯é”™è¯¯çš„
    println!("The value of x is: {}", x);
}
```
åœ¨rustä¸­å¸¸é‡ä½¿ç”¨`const`æ¥å®šä¹‰ï¼š
> const MAX_POINTS: u32 = 100_000;

å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œrustä¸ºä»€ä¹ˆæ—¢ç„¶å¸¸é‡ç”¨constå®šä¹‰ï¼Œå˜é‡è¦ç”¨letå®šä¹‰ä¸ºä»€ä¹ˆè¦åŠ å…¥mutï¼Ÿ
> 1. ä½¿ç”¨ let å£°æ˜çš„å˜é‡æ˜¯å¯å˜çš„ï¼Œè€Œä½¿ç”¨ const å£°æ˜çš„å¸¸é‡æ˜¯ä¸å¯å˜çš„ã€‚è¿™æ„å‘³ç€ï¼Œä½¿ç”¨ let å£°æ˜çš„å˜é‡å¯ä»¥åœ¨ç¨‹åºä¸­ä¿®æ”¹å®ƒä»¬çš„å€¼ï¼Œè€Œä½¿ç”¨ const å£°æ˜çš„å¸¸é‡ä¸€æ—¦è¢«å®šä¹‰ï¼Œå°±ä¸èƒ½å†ä¿®æ”¹å®ƒä»¬çš„å€¼ã€‚åœ¨ Rust ä¸­ï¼Œä¸ºäº†æé«˜ä»£ç çš„å¯é æ€§å’Œå®‰å…¨æ€§ï¼Œæ¨èå°½å¯èƒ½ä½¿ç”¨å¸¸é‡è€Œä¸æ˜¯å˜é‡
> 2. ç±»å‹æ³¨è§£ï¼šä½¿ç”¨ let å£°æ˜å˜é‡æ—¶ï¼Œé€šå¸¸ä¸éœ€è¦æ˜¾å¼æŒ‡å®šå˜é‡çš„ç±»å‹ï¼Œå› ä¸º Rust ç¼–è¯‘å™¨å¯ä»¥æ ¹æ®å˜é‡çš„å€¼æ¨æ–­å‡ºå˜é‡çš„ç±»å‹ã€‚è€Œä½¿ç”¨ const å£°æ˜å¸¸é‡æ—¶ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šå¸¸é‡çš„ç±»å‹ï¼Œå› ä¸º Rust ç¼–è¯‘å™¨ä¸èƒ½æ ¹æ®å¸¸é‡çš„å€¼æ¨æ–­å‡ºå¸¸é‡çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼šlet x = 10;    const Y: i32 = 20;
> 3. å£°æ˜ä½ç½®ï¼šä½¿ç”¨ let å£°æ˜å˜é‡æ—¶ï¼Œå¯ä»¥åœ¨ä»»ä½•ä½œç”¨åŸŸå†…è¿›è¡Œå£°æ˜ï¼ŒåŒ…æ‹¬å‡½æ•°å†…éƒ¨å’Œå…¨å±€ä½œç”¨åŸŸã€‚è€Œä½¿ç”¨ const å£°æ˜å¸¸é‡æ—¶ï¼Œåªèƒ½åœ¨å…¨å±€ä½œç”¨åŸŸä¸­è¿›è¡Œå£°æ˜ã€‚è¿™æ˜¯å› ä¸ºåœ¨ Rust ä¸­ï¼Œå¸¸é‡çš„å€¼å¿…é¡»åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šä¸‹æ¥ï¼Œè€Œå˜é‡çš„å€¼å¯ä»¥åœ¨è¿è¡Œæ—¶ç¡®å®šã€‚

### â›”ä¸è¦è­¦å‘Šæˆ‘
å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªå˜é‡å´ä¸åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨å®ƒï¼ŒRust é€šå¸¸ä¼šç»™ä½ ä¸€ä¸ªè­¦å‘Šã€‚æ‰€ä»¥å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿`_`è¡¨ç¤º`Rust ä¸è¦è­¦å‘Šæœªä½¿ç”¨çš„å˜é‡`
```rust
fn main() {
    let mut x = 6;
}
// warning: unused variable: `x`
```
âœ”ï¸æ­£ç¡®å†™æ³•ï¼Œæˆ‘ä¸ç¦æ„Ÿå¹ï¼Œè¿™ä¹ŸTTMDå®‰å…¨äº†ï¼š
```rust
fn main() {
    let mut _x = 6;
}
```
åœ¨ä¸€æ¬¡å®éªŒä¸­æˆ‘æœªä½¿ç”¨`mut`ï¼Œéƒ½å¯ä»¥æç¤ºäº†`warning: variable does not need to be mutable`
```rust
fn main() {
    let (a, mut b): (bool, bool) = (true, false);
    println!("a = {:?}, b = {:?}", a, b);
}
```

### å˜é‡çš„è§£æ„
è¿™é‡Œå¯èƒ½æœ‰ç–‘é—®çš„ç‚¹æ˜¯`{:?}`ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨`{}`
> {:?} å ä½ç¬¦ä¼šä½¿ç”¨ Debug trait æ¥æ ¼å¼åŒ–è¾“å‡ºå˜é‡çš„å€¼ã€‚Debug trait æ˜¯ Rust ä¸­çš„ä¸€ä¸ªç‰¹æ®Š traitï¼Œç”¨äºå®šä¹‰æ ¼å¼åŒ–è¾“å‡ºè°ƒè¯•ä¿¡æ¯çš„æ–¹æ³•ã€‚è®¸å¤šå†…ç½®ç±»å‹å’Œæ ‡å‡†åº“ä¸­çš„ç±»å‹éƒ½å®ç°äº† Debug traitï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ä½¿ç”¨ {:?} å ä½ç¬¦æ—¶ç›´æ¥è¾“å‡ºè¿™äº›ç±»å‹çš„å€¼ã€‚{:?} å ä½ç¬¦è¾“å‡ºçš„å€¼é€šå¸¸åŒ…å«äº†æ›´å¤šçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ç±»å‹ä¿¡æ¯ã€ç»“æ„ä½“å­—æ®µåç­‰ï¼Œè¿™äº›ä¿¡æ¯å¯¹äºè°ƒè¯•ä»£ç éå¸¸æœ‰ç”¨ã€‚ä½†æ˜¯ï¼Œç”±äºè¾“å‡ºçš„ä¿¡æ¯å¯èƒ½æ¯”è¾ƒå†—é•¿ï¼Œå› æ­¤åœ¨æ­£å¼çš„è¾“å‡ºä¸­å¯èƒ½éœ€è¦ä½¿ç”¨å…¶ä»–çš„å ä½ç¬¦ã€‚

è¿˜æœ‰ä¸€ä¸ªå‡½æ•°`assert_eq`ï¼šæ–­è¨€ä¸¤ä¸ªè¡¨è¾¾å¼å½¼æ­¤ç›¸ç­‰ã€‚å¦‚æœæ¯”è¾ƒç»“æœä¸ç›¸ç­‰ï¼Œassert_eq! å®ä¼šè§¦å‘ä¸€ä¸ª panicï¼Œå¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚
> assert_eq! å®æ˜¯ Rust ä¸­çš„ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®šä½ä»£ç ä¸­çš„é”™è¯¯ï¼Œå¹¶æé«˜ä»£ç çš„å¯é æ€§ã€‚

```rust
macro_rules! assert_eq {
    ($left : expr, $right : expr $(,) ?) => { ... };
    ($left : expr, $right : expr, $($arg : tt) +) => { ... };
}
```
ä¾‹å­ï¼š
```rust
let a = 3;
let b = 1 + 2;
assert_eq!(a, b);

assert_eq!(a, b, "we are testing addition with {} and {}", a, b);
```

æœ‰äº†ä¸Šé¢çš„çŸ¥è¯†å°±å¯ä»¥å­¦ä¹ è¿™æ®µç¤ºä¾‹äº†ï¼Œéå¸¸ç±»ä¼¼JavaScriptçš„è¯­æ³•ï¼š
```rust
fn main() {
    let (a, mut b): (bool, bool) = (true, false);
    println!("a = {:?}, b = {:?}", a, b);
    b = true;
    assert_eq!(a, b);
}
```

### è§£æ„å¼èµ‹å€¼
åœ¨ Rust 1.59 ç‰ˆæœ¬åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨èµ‹å€¼è¯­å¥çš„å·¦å¼ä¸­ä½¿ç”¨å…ƒç»„ã€åˆ‡ç‰‡å’Œç»“æ„ä½“æ¨¡å¼äº†ã€‚
* è¿™é‡Œçš„ `..` è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œå³åŒ¹é…æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´  cï¼Œå’Œæœ€åä¸€ä¸ªå…ƒç´ ä¹‹å‰çš„æ‰€æœ‰å…ƒç´  d
* å°†` Struct { e: 5 }` è§£æ„ä¸ºå˜é‡ eã€‚è¿™é‡Œä½¿ç”¨äº†ç»“æ„ä½“è§£æ„è¯­æ³•ï¼Œ`{ e, .. }` è¡¨ç¤ºåªè§£æ„ç»“æ„ä½“ä¸­çš„å­—æ®µ eï¼Œè€Œå…¶ä»–å­—æ®µéƒ½ä¸å…³å¿ƒã€‚
```rust
fn main() {
    let (a, b, c, d);
    (a, b) = (1, 2);
    // println!("a {:?}, b {:?}, c {:?}, d {:?}, e {:?}", a, b, c, d, e);
    println!("a {:?}, b {:?}", a, b);
    [c, .., d, _] = [1, 2, 3, 4, 5];
    println!("a {:?}, b {:?}, c {:?}, d {:?}", a, b, c, d);
    // æœ€åè¾“å…¥ï¼ša 1, b 2
	// a 1, b 2, c 1, d 4
}
```

### å˜é‡é®è”½
Rust å…è®¸å£°æ˜ç›¸åŒçš„å˜é‡åï¼Œåœ¨åé¢å£°æ˜çš„å˜é‡ä¼šé®è”½æ‰å‰é¢å£°æ˜çš„
> è¿™å’Œ mut å˜é‡çš„ä½¿ç”¨æ˜¯ä¸åŒçš„ï¼Œç¬¬äºŒä¸ª let ç”Ÿæˆäº†å®Œå…¨ä¸åŒçš„æ–°å˜é‡ï¼Œä¸¤ä¸ªå˜é‡åªæ˜¯æ°å¥½æ‹¥æœ‰åŒæ ·çš„åç§°ï¼Œæ¶‰åŠä¸€æ¬¡å†…å­˜å¯¹è±¡çš„å†åˆ†é… ï¼Œè€Œ mut å£°æ˜çš„å˜é‡ï¼Œå¯ä»¥ä¿®æ”¹åŒä¸€ä¸ªå†…å­˜åœ°å€ä¸Šçš„å€¼ï¼Œå¹¶ä¸ä¼šå‘ç”Ÿå†…å­˜å¯¹è±¡çš„å†åˆ†é…ï¼Œæ€§èƒ½è¦æ›´å¥½ã€‚å˜é‡é®è”½çš„ç”¨å¤„åœ¨äºï¼Œå¦‚æœä½ åœ¨æŸä¸ªä½œç”¨åŸŸå†…æ— éœ€å†ä½¿ç”¨ä¹‹å‰çš„å˜é‡ï¼ˆåœ¨è¢«é®è”½åï¼Œæ— æ³•å†è®¿é—®åˆ°ä¹‹å‰çš„åŒåå˜é‡ï¼‰ï¼Œå°±å¯ä»¥é‡å¤çš„ä½¿ç”¨å˜é‡åå­—ï¼Œè€Œä¸ç”¨ç»å°½è„‘æ±å»æƒ³æ›´å¤šçš„åå­—ã€‚

è¿™ä¸ªå°±æœ‰ç‚¹åƒPythonäº†ï¼Œåœ¨æ·±åº¦å­¦ä¹ æˆ–è€…å…¶ä»–é¢†åŸŸï¼Œå˜é‡åˆå¤šåˆæ‡’å¾—èµ·åå­—ï¼Œç›´æ¥å°±ä½¿ç”¨ä¸Šä¸€ä¸ªè¦†ç›–ï¼š
```rust
fn main() {
    let spaces = "   ";
    // usizeæ•°å€¼ç±»å‹
    let spaces = spaces.len();
    println!("{}", spaces);
    // 3
}
```

ä½†æ˜¯å¦‚æœä¸ä½¿ç”¨å˜é‡é®è”½ï¼Œä¸‹é¢çš„æƒ…å†µå°±æ˜¯é”™è¯¯çš„ï¼š
```rust
// error[E0308]: mismatched types
let mut spaces = "   ";
spaces = spaces.len();
```


## 1.3 ğŸš— æ‰€æœ‰æƒ & ğŸšŒ å€Ÿç”¨
è¿™éƒ¨åˆ†æˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œå’Œä¹‹å‰å­¦è¿‡çš„Javaè™šæ‹Ÿæœºå®Œå…¨ä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¿™ç« æ ¸å¿ƒçš„å†…å®¹è¦æ˜¯æˆ‘å†æ·»æ²¹åŠ é†‹é‚£ä¹ˆå¯èƒ½ä¼šå¸¦åã€‚æœ¬ç« å†…å®¹ååˆ†é‡è¦ï¼Œå€Ÿç”¨ä½œè€…çš„ä¸€å¥è¯æ˜¯`ç”±äºæ‰€æœ‰æƒæ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œå› æ­¤è¯»è€…éœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´æ¥æŒæ¡å®ƒï¼Œä¸€æ—¦æŒæ¡ï¼Œæµ·é˜”å¤©ç©ºä»»ä½ é£è·ƒ`ã€‚æ‰€ä»¥æˆ‘[æ¬è¿](https://course.rs/basic/ownership/ownership.html)è€Œæ¥è¿™å—çš„å†…å®¹ï¼Œæ–¹ä¾¿åé¢ç›´æ¥çœ‹ã€‚

æœ¬ç« çš„æ‰€æœ‰å†…å®¹éƒ½æ¥è‡ªï¼š[Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs/basic/ownership/ownership.html)ã€‚è¿™ç« ä½œè€…å†™çš„é¬¼æ–§ç¥å·¥ï¼Œå‡ºç¥å…¥åŒ–ï¼Œæˆ‘åªèƒ½è¿™æ ·è¯´äº†ã€‚

### 1.3.1ğŸš— æ‰€æœ‰æƒ
æ‰€æœ‰çš„ç¨‹åºéƒ½å¿…é¡»å’Œè®¡ç®—æœºå†…å­˜æ‰“äº¤é“ï¼Œå¦‚ä½•ä»å†…å­˜ä¸­ç”³è¯·ç©ºé—´æ¥å­˜æ”¾ç¨‹åºçš„è¿è¡Œå†…å®¹ï¼Œå¦‚ä½•åœ¨ä¸éœ€è¦çš„æ—¶å€™é‡Šæ”¾è¿™äº›ç©ºé—´ï¼Œæˆäº†é‡ä¸­ä¹‹é‡ï¼Œä¹Ÿæ˜¯æ‰€æœ‰ç¼–ç¨‹è¯­è¨€è®¾è®¡çš„éš¾ç‚¹ä¹‹ä¸€ã€‚åœ¨è®¡ç®—æœºè¯­è¨€ä¸æ–­æ¼”å˜è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†ä¸‰ç§æµæ´¾ï¼š

åƒåœ¾å›æ”¶æœºåˆ¶(GC)ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶ä¸æ–­å¯»æ‰¾ä¸å†ä½¿ç”¨çš„å†…å­˜ï¼Œå…¸å‹ä»£è¡¨ï¼šJavaã€Go
æ‰‹åŠ¨ç®¡ç†å†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾, åœ¨ç¨‹åºä¸­ï¼Œé€šè¿‡å‡½æ•°è°ƒç”¨çš„æ–¹å¼æ¥ç”³è¯·å’Œé‡Šæ”¾å†…å­˜ï¼Œå…¸å‹ä»£è¡¨ï¼šC++
é€šè¿‡æ‰€æœ‰æƒæ¥ç®¡ç†å†…å­˜ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¼šæ ¹æ®ä¸€ç³»åˆ—è§„åˆ™è¿›è¡Œæ£€æŸ¥
å…¶ä¸­ Rust é€‰æ‹©äº†ç¬¬ä¸‰ç§ï¼Œæœ€å¦™çš„æ˜¯ï¼Œè¿™ç§æ£€æŸ¥åªå‘ç”Ÿåœ¨ç¼–è¯‘æœŸï¼Œå› æ­¤å¯¹äºç¨‹åºè¿è¡ŒæœŸï¼Œä¸ä¼šæœ‰ä»»ä½•æ€§èƒ½ä¸Šçš„æŸå¤±ã€‚

#### ä¸€æ®µä¸å®‰å…¨çš„ä»£ç 
å…ˆæ¥çœ‹çœ‹ä¸€æ®µæ¥è‡ª C è¯­è¨€çš„ç³Ÿç³•ä»£ç ï¼š

```c
int* foo() {
    int a;          // å˜é‡açš„ä½œç”¨åŸŸå¼€å§‹
    a = 100;
    char *c = "xyz";   // å˜é‡cçš„ä½œç”¨åŸŸå¼€å§‹
    return &a;
}                   // å˜é‡aå’Œcçš„ä½œç”¨åŸŸç»“æŸ
```
è¿™æ®µä»£ç è™½ç„¶å¯ä»¥ç¼–è¯‘é€šè¿‡ï¼Œä½†æ˜¯å…¶å®éå¸¸ç³Ÿç³•ï¼Œå˜é‡ a å’Œ c éƒ½æ˜¯å±€éƒ¨å˜é‡ï¼Œå‡½æ•°ç»“æŸåå°†å±€éƒ¨å˜é‡ a çš„åœ°å€è¿”å›ï¼Œä½†å±€éƒ¨å˜é‡ a å­˜åœ¨æ ˆä¸­ï¼Œåœ¨ç¦»å¼€ä½œç”¨åŸŸåï¼Œa æ‰€ç”³è¯·çš„æ ˆä¸Šå†…å­˜éƒ½ä¼šè¢«ç³»ç»Ÿå›æ”¶ï¼Œä»è€Œé€ æˆäº† æ‚¬ç©ºæŒ‡é’ˆ(Dangling Pointer) çš„é—®é¢˜ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å…¸å‹çš„å†…å­˜å®‰å…¨é—®é¢˜ï¼Œè™½ç„¶ç¼–è¯‘å¯ä»¥é€šè¿‡ï¼Œä½†æ˜¯è¿è¡Œçš„æ—¶å€™ä¼šå‡ºç°é”™è¯¯, å¾ˆå¤šç¼–ç¨‹è¯­è¨€éƒ½å­˜åœ¨ã€‚

å†æ¥çœ‹å˜é‡ cï¼Œc çš„å€¼æ˜¯å¸¸é‡å­—ç¬¦ä¸²ï¼Œå­˜å‚¨äºå¸¸é‡åŒºï¼Œå¯èƒ½è¿™ä¸ªå‡½æ•°æˆ‘ä»¬åªè°ƒç”¨äº†ä¸€æ¬¡ï¼Œä¹Ÿå¯èƒ½æˆ‘ä»¬ä¸å†ä¼šä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œä½† "xyz" åªæœ‰å½“æ•´ä¸ªç¨‹åºç»“æŸåç³»ç»Ÿæ‰èƒ½å›æ”¶è¿™ç‰‡å†…å­˜ã€‚

æ‰€ä»¥å†…å­˜å®‰å…¨é—®é¢˜ï¼Œä¸€ç›´éƒ½æ˜¯ç¨‹åºå‘˜éå¸¸å¤´ç–¼çš„é—®é¢˜ï¼Œå¥½åœ¨, åœ¨ Rust ä¸­è¿™äº›é—®é¢˜å³å°†æˆä¸ºå†å²ï¼Œå› ä¸º Rust åœ¨ç¼–è¯‘çš„æ—¶å€™å°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘ç°å†…å­˜ä¸å®‰å…¨çš„é—®é¢˜ï¼Œé‚£ Rust å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ

#### é¢„çƒ­çŸ¥è¯†: æ ˆ(Stack)ä¸å †(Heap)
æ ˆå’Œå †æ˜¯ç¼–ç¨‹è¯­è¨€æœ€æ ¸å¿ƒçš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯åœ¨å¾ˆå¤šè¯­è¨€ä¸­ï¼Œä½ å¹¶ä¸éœ€è¦æ·±å…¥äº†è§£æ ˆä¸å †ã€‚ ä½†å¯¹äº Rust è¿™æ ·çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œå€¼æ˜¯ä½äºæ ˆä¸Šè¿˜æ˜¯å †ä¸Šéå¸¸é‡è¦, å› ä¸ºè¿™ä¼šå½±å“ç¨‹åºçš„è¡Œä¸ºå’Œæ€§èƒ½ã€‚

æ ˆå’Œå †çš„æ ¸å¿ƒç›®æ ‡å°±æ˜¯ä¸ºç¨‹åºåœ¨è¿è¡Œæ—¶æä¾›å¯ä¾›ä½¿ç”¨çš„å†…å­˜ç©ºé—´ã€‚

**æ ˆ**
æ ˆæŒ‰ç…§é¡ºåºå­˜å‚¨å€¼å¹¶ä»¥ç›¸åé¡ºåºå–å‡ºå€¼ï¼Œè¿™ä¹Ÿè¢«ç§°ä½œåè¿›å…ˆå‡ºã€‚æƒ³è±¡ä¸€ä¸‹ä¸€å ç›˜å­ï¼šå½“å¢åŠ æ›´å¤šç›˜å­æ—¶ï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨ç›˜å­å †çš„é¡¶éƒ¨ï¼Œå½“éœ€è¦ç›˜å­æ—¶ï¼Œå†ä»é¡¶éƒ¨æ‹¿èµ°ã€‚ä¸èƒ½ä»ä¸­é—´ä¹Ÿä¸èƒ½ä»åº•éƒ¨å¢åŠ æˆ–æ‹¿èµ°ç›˜å­ï¼

å¢åŠ æ•°æ®å«åšè¿›æ ˆï¼Œç§»å‡ºæ•°æ®åˆ™å«åšå‡ºæ ˆã€‚

å› ä¸ºä¸Šè¿°çš„å®ç°æ–¹å¼ï¼Œæ ˆä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»å ç”¨å·²çŸ¥ä¸”å›ºå®šå¤§å°çš„å†…å­˜ç©ºé—´ï¼Œå‡è®¾æ•°æ®å¤§å°æ˜¯æœªçŸ¥çš„ï¼Œé‚£ä¹ˆåœ¨å–å‡ºæ•°æ®æ—¶ï¼Œä½ å°†æ— æ³•å–åˆ°ä½ æƒ³è¦çš„æ•°æ®ã€‚

**å †**
ä¸æ ˆä¸åŒï¼Œå¯¹äºå¤§å°æœªçŸ¥æˆ–è€…å¯èƒ½å˜åŒ–çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒå­˜å‚¨åœ¨å †ä¸Šã€‚

å½“å‘å †ä¸Šæ”¾å…¥æ•°æ®æ—¶ï¼Œéœ€è¦è¯·æ±‚ä¸€å®šå¤§å°çš„å†…å­˜ç©ºé—´ã€‚æ“ä½œç³»ç»Ÿåœ¨å †çš„æŸå¤„æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºä½ï¼ŒæŠŠå®ƒæ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥ä½ç½®åœ°å€çš„æŒ‡é’ˆ, è¯¥è¿‡ç¨‹è¢«ç§°ä¸ºåœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œæœ‰æ—¶ç®€ç§°ä¸º â€œåˆ†é…â€(allocating)ã€‚

æ¥ç€ï¼Œè¯¥æŒ‡é’ˆä¼šè¢«æ¨å…¥æ ˆä¸­ï¼Œå› ä¸ºæŒ‡é’ˆçš„å¤§å°æ˜¯å·²çŸ¥ä¸”å›ºå®šçš„ï¼Œåœ¨åç»­ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä½ å°†é€šè¿‡æ ˆä¸­çš„æŒ‡é’ˆï¼Œæ¥è·å–æ•°æ®åœ¨å †ä¸Šçš„å®é™…å†…å­˜ä½ç½®ï¼Œè¿›è€Œè®¿é—®è¯¥æ•°æ®ã€‚

ç”±ä¸Šå¯çŸ¥ï¼Œå †æ˜¯ä¸€ç§ç¼ºä¹ç»„ç»‡çš„æ•°æ®ç»“æ„ã€‚æƒ³è±¡ä¸€ä¸‹å»é¤é¦†å°±åº§åƒé¥­: è¿›å…¥é¤é¦†ï¼Œå‘ŠçŸ¥æœåŠ¡å‘˜æœ‰å‡ ä¸ªäººï¼Œç„¶åæœåŠ¡å‘˜æ‰¾åˆ°ä¸€ä¸ªå¤Ÿå¤§çš„ç©ºæ¡Œå­ï¼ˆå †ä¸Šåˆ†é…çš„å†…å­˜ç©ºé—´ï¼‰å¹¶é¢†ä½ ä»¬è¿‡å»ã€‚å¦‚æœæœ‰äººæ¥è¿Ÿäº†ï¼Œä»–ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ¡Œå·ï¼ˆæ ˆä¸Šçš„æŒ‡é’ˆï¼‰æ¥æ‰¾åˆ°ä½ ä»¬ååœ¨å“ªã€‚

**æ€§èƒ½åŒºåˆ«**
å†™å…¥æ–¹é¢ï¼šå…¥æ ˆæ¯”åœ¨å †ä¸Šåˆ†é…å†…å­˜è¦å¿«ï¼Œå› ä¸ºå…¥æ ˆæ—¶æ“ä½œç³»ç»Ÿæ— éœ€åˆ†é…æ–°çš„ç©ºé—´ï¼Œåªéœ€è¦å°†æ–°æ•°æ®æ”¾å…¥æ ˆé¡¶å³å¯ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨å †ä¸Šåˆ†é…å†…å­˜åˆ™éœ€è¦æ›´å¤šçš„å·¥ä½œï¼Œè¿™æ˜¯å› ä¸ºæ“ä½œç³»ç»Ÿå¿…é¡»é¦–å…ˆæ‰¾åˆ°ä¸€å—è¶³å¤Ÿå­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´ï¼Œæ¥ç€åšä¸€äº›è®°å½•ä¸ºä¸‹ä¸€æ¬¡åˆ†é…åšå‡†å¤‡ã€‚

è¯»å–æ–¹é¢ï¼šå¾—ç›Šäº CPU é«˜é€Ÿç¼“å­˜ï¼Œä½¿å¾—å¤„ç†å™¨å¯ä»¥å‡å°‘å¯¹å†…å­˜çš„è®¿é—®ï¼Œé«˜é€Ÿç¼“å­˜å’Œå†…å­˜çš„è®¿é—®é€Ÿåº¦å·®å¼‚åœ¨ 10 å€ä»¥ä¸Šï¼æ ˆæ•°æ®å¾€å¾€å¯ä»¥ç›´æ¥å­˜å‚¨åœ¨ CPU é«˜é€Ÿç¼“å­˜ä¸­ï¼Œè€Œå †æ•°æ®åªèƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚è®¿é—®å †ä¸Šçš„æ•°æ®æ¯”è®¿é—®æ ˆä¸Šçš„æ•°æ®æ…¢ï¼Œå› ä¸ºå¿…é¡»å…ˆè®¿é—®æ ˆå†é€šè¿‡æ ˆä¸Šçš„æŒ‡é’ˆæ¥è®¿é—®å†…å­˜ã€‚

å› æ­¤ï¼Œå¤„ç†å™¨å¤„ç†åˆ†é…åœ¨æ ˆä¸Šæ•°æ®ä¼šæ¯”åœ¨å †ä¸Šçš„æ•°æ®æ›´åŠ é«˜æ•ˆã€‚

**æ‰€æœ‰æƒä¸å †æ ˆ**
å½“ä½ çš„ä»£ç è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ï¼ˆåŒ…æ‹¬å¯èƒ½æŒ‡å‘å †ä¸Šæ•°æ®çš„æŒ‡é’ˆå’Œå‡½æ•°çš„å±€éƒ¨å˜é‡ï¼‰ä¾æ¬¡è¢«å‹å…¥æ ˆä¸­ï¼Œå½“å‡½æ•°è°ƒç”¨ç»“æŸæ—¶ï¼Œè¿™äº›å€¼å°†è¢«ä»æ ˆä¸­æŒ‰ç…§ç›¸åçš„é¡ºåºä¾æ¬¡ç§»é™¤ã€‚

å› ä¸ºå †ä¸Šçš„æ•°æ®ç¼ºä¹ç»„ç»‡ï¼Œå› æ­¤è·Ÿè¸ªè¿™äº›æ•°æ®ä½•æ—¶åˆ†é…å’Œé‡Šæ”¾æ˜¯éå¸¸é‡è¦çš„ï¼Œå¦åˆ™å †ä¸Šçš„æ•°æ®å°†äº§ç”Ÿå†…å­˜æ³„æ¼ â€”â€” è¿™äº›æ•°æ®å°†æ°¸è¿œæ— æ³•è¢«å›æ”¶ã€‚è¿™å°±æ˜¯ Rust æ‰€æœ‰æƒç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„å¼ºå¤§ä¿éšœã€‚

å¯¹äºå…¶ä»–å¾ˆå¤šç¼–ç¨‹è¯­è¨€ï¼Œä½ ç¡®å®æ— éœ€ç†è§£å †æ ˆçš„åŸç†ï¼Œä½†æ˜¯åœ¨ Rust ä¸­ï¼Œæ˜ç™½å †æ ˆçš„åŸç†ï¼Œå¯¹äºæˆ‘ä»¬ç†è§£æ‰€æœ‰æƒçš„å·¥ä½œåŸç†ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚

#### æ‰€æœ‰æƒåŸåˆ™
ç†è§£äº†å †æ ˆï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹å…³äºæ‰€æœ‰æƒçš„è§„åˆ™ï¼Œé¦–å…ˆè¯·è°¨è®°ä»¥ä¸‹è§„åˆ™ï¼š
> 1. Rust ä¸­æ¯ä¸€ä¸ªå€¼éƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œè¯¥å˜é‡è¢«ç§°ä¸ºå€¼çš„æ‰€æœ‰è€…
> 2. ä¸€ä¸ªå€¼åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œæˆ–è€…è¯´ä¸€ä¸ªå€¼åªèƒ½æ‹¥æœ‰ä¸€ä¸ªæ‰€æœ‰è€…
> 3. å½“æ‰€æœ‰è€…(å˜é‡)ç¦»å¼€ä½œç”¨åŸŸèŒƒå›´æ—¶ï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒ(drop)

##### å˜é‡ä½œç”¨åŸŸ
ä½œç”¨åŸŸæ˜¯ä¸€ä¸ªå˜é‡åœ¨ç¨‹åºä¸­æœ‰æ•ˆçš„èŒƒå›´, å‡å¦‚æœ‰è¿™æ ·ä¸€ä¸ªå˜é‡ï¼š

```rust
let s = "hello";
```
å˜é‡ s ç»‘å®šåˆ°äº†ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢å€¼ï¼Œè¯¥å­—ç¬¦ä¸²å­—é¢å€¼æ˜¯ç¡¬ç¼–ç åˆ°ç¨‹åºä»£ç ä¸­çš„ã€‚s å˜é‡ä»å£°æ˜çš„ç‚¹å¼€å§‹ç›´åˆ°å½“å‰ä½œç”¨åŸŸçš„ç»“æŸéƒ½æ˜¯æœ‰æ•ˆçš„ï¼š
```rust
{                      // s åœ¨è¿™é‡Œæ— æ•ˆï¼Œå®ƒå°šæœªå£°æ˜
    let s = "hello";   // ä»æ­¤å¤„èµ·ï¼Œs æ˜¯æœ‰æ•ˆçš„

    // ä½¿ç”¨ s
}                      // æ­¤ä½œç”¨åŸŸå·²ç»“æŸï¼Œsä¸å†æœ‰æ•ˆ
```
ç®€è€Œè¨€ä¹‹ï¼Œs ä»åˆ›å»ºä¼Šå§‹å°±å¼€å§‹æœ‰æ•ˆï¼Œç„¶åæœ‰æ•ˆæœŸæŒç»­åˆ°å®ƒç¦»å¼€ä½œç”¨åŸŸä¸ºæ­¢ï¼Œå¯ä»¥çœ‹å‡ºï¼Œ**å°±ä½œç”¨åŸŸæ¥è¯´ï¼ŒRust è¯­è¨€è·Ÿå…¶ä»–ç¼–ç¨‹è¯­è¨€æ²¡æœ‰åŒºåˆ«**ã€‚

##### ç®€å•ä»‹ç» String ç±»å‹
> è¿™é‡Œæˆ‘å¤§è‡´ä»‹ç»ä¸‹å¤§çº²ï¼š
> - äº†è§£å­—ç¬¦ä¸²çš„ç¡¬ç¼–ç 
> - äº†è§£åŠ¨æ€å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ç”¨æˆ·è¾“å…¥è¿›å»çš„æƒ…å†µåº”è¯¥å¦‚ä½•åˆ›å»ºï¼Ÿ

ä¹‹å‰æåˆ°è¿‡ï¼Œæœ¬ç« ä¼šç”¨ String ä½œä¸ºä¾‹å­ï¼Œå› æ­¤è¿™é‡Œä¼šè¿›è¡Œä¸€ä¸‹ç®€å•çš„ä»‹ç»ï¼Œå…·ä½“çš„ String å­¦ä¹ è¯·å‚è§ String ç±»å‹ã€‚

æˆ‘ä»¬å·²ç»è§è¿‡å­—ç¬¦ä¸²å­—é¢å€¼ `let s ="hello"`ï¼Œs æ˜¯è¢«ç¡¬ç¼–ç è¿›ç¨‹åºé‡Œçš„å­—ç¬¦ä¸²å€¼ï¼ˆç±»å‹ä¸º &str ï¼‰ã€‚å­—ç¬¦ä¸²å­—é¢å€¼æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œä½†æ˜¯å®ƒå¹¶ä¸é€‚ç”¨äºæ‰€æœ‰åœºæ™¯ã€‚åŸå› æœ‰äºŒï¼š

å­—ç¬¦ä¸²å­—é¢å€¼æ˜¯ä¸å¯å˜çš„ï¼Œå› ä¸ºè¢«ç¡¬ç¼–ç åˆ°ç¨‹åºä»£ç ä¸­
å¹¶éæ‰€æœ‰å­—ç¬¦ä¸²çš„å€¼éƒ½èƒ½åœ¨ç¼–å†™ä»£ç æ—¶å¾—çŸ¥
ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²æ˜¯éœ€è¦ç¨‹åºè¿è¡Œæ—¶ï¼Œé€šè¿‡ç”¨æˆ·åŠ¨æ€è¾“å…¥ç„¶åå­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œè¿™ç§æƒ…å†µï¼Œå­—ç¬¦ä¸²å­—é¢å€¼å°±å®Œå…¨æ— ç”¨æ­¦ä¹‹åœ°ã€‚ ä¸ºæ­¤ï¼ŒRust ä¸ºæˆ‘ä»¬æä¾›åŠ¨æ€å­—ç¬¦ä¸²ç±»å‹: String, è¯¥ç±»å‹è¢«åˆ†é…åˆ°å †ä¸Šï¼Œå› æ­¤å¯ä»¥åŠ¨æ€ä¼¸ç¼©ï¼Œä¹Ÿå°±èƒ½å­˜å‚¨åœ¨ç¼–è¯‘æ—¶å¤§å°æœªçŸ¥çš„æ–‡æœ¬ã€‚

å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•åŸºäºå­—ç¬¦ä¸²å­—é¢é‡æ¥åˆ›å»º String ç±»å‹ï¼š

```rust
let s = String::from("hello");
```
`::` æ˜¯ä¸€ç§è°ƒç”¨æ“ä½œç¬¦ï¼Œè¿™é‡Œè¡¨ç¤ºè°ƒç”¨ String ä¸­çš„ from æ–¹æ³•ï¼Œå› ä¸º String å­˜å‚¨åœ¨å †ä¸Šæ˜¯åŠ¨æ€çš„ï¼Œä½ å¯ä»¥è¿™æ ·ä¿®æ”¹å®ƒï¼š
```rust
let mut s = String::from("hello");

s.push_str(", world!"); // push_str() åœ¨å­—ç¬¦ä¸²åè¿½åŠ å­—é¢å€¼

println!("{}", s); // å°†æ‰“å° `hello, world!`
```
è¨€å½’æ­£ä¼ ï¼Œäº†è§£ String å†…å®¹åï¼Œä¸€èµ·æ¥çœ‹çœ‹å…³äºæ‰€æœ‰æƒçš„äº¤äº’ã€‚

#### å˜é‡ç»‘å®šèƒŒåçš„æ•°æ®äº¤äº’

##### è½¬ç§»æ‰€æœ‰æƒ
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

```rust
let x = 5;
let y = x;
```
ä»£ç èƒŒåçš„é€»è¾‘å¾ˆç®€å•, å°† 5 ç»‘å®šåˆ°å˜é‡ xï¼›æ¥ç€æ‹·è´ x çš„å€¼èµ‹ç»™ yï¼Œæœ€ç»ˆ x å’Œ y éƒ½ç­‰äº 5ï¼Œå› ä¸ºæ•´æ•°æ˜¯ Rust åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ˜¯å›ºå®šå¤§å°çš„ç®€å•å€¼ï¼Œå› æ­¤è¿™ä¸¤ä¸ªå€¼éƒ½æ˜¯é€šè¿‡è‡ªåŠ¨æ‹·è´çš„æ–¹å¼æ¥èµ‹å€¼çš„ï¼Œéƒ½è¢«å­˜åœ¨æ ˆä¸­ï¼Œå®Œå…¨æ— éœ€åœ¨å †ä¸Šåˆ†é…å†…å­˜ã€‚

å¯èƒ½æœ‰åŒå­¦ä¼šæœ‰ç–‘é—®ï¼šè¿™ç§æ‹·è´ä¸æ¶ˆè€—æ€§èƒ½å—ï¼Ÿå®é™…ä¸Šï¼Œè¿™ç§æ ˆä¸Šçš„æ•°æ®è¶³å¤Ÿç®€å•ï¼Œè€Œä¸”æ‹·è´éå¸¸éå¸¸å¿«ï¼Œåªéœ€è¦å¤åˆ¶ä¸€ä¸ªæ•´æ•°å¤§å°ï¼ˆi32ï¼Œ4 ä¸ªå­—èŠ‚ï¼‰çš„å†…å­˜å³å¯ï¼Œå› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‹·è´çš„é€Ÿåº¦è¿œæ¯”åœ¨å †ä¸Šåˆ›å»ºå†…å­˜æ¥å¾—å¿«çš„å¤šã€‚å®é™…ä¸Šï¼Œä¸Šä¸€ç« æˆ‘ä»¬è®²åˆ°çš„ Rust åŸºæœ¬ç±»å‹éƒ½æ˜¯é€šè¿‡è‡ªåŠ¨æ‹·è´çš„æ–¹å¼æ¥èµ‹å€¼çš„ï¼Œå°±åƒä¸Šé¢ä»£ç ä¸€æ ·ã€‚

ç„¶åå†æ¥çœ‹ä¸€æ®µä»£ç ï¼š

```rust
let s1 = String::from("hello");
let s2 = s1;
```
æ­¤æ—¶ï¼Œå¯èƒ½æŸä¸ªå¤§èªæ˜(å–„æ„æ˜µç§°)å·²ç»æƒ³åˆ°äº†ï¼šå—¯ï¼ŒæŠŠ s1 çš„å†…å®¹æ‹·è´ä¸€ä»½èµ‹å€¼ç»™ s2ï¼Œå®é™…ä¸Šï¼Œå¹¶ä¸æ˜¯è¿™æ ·ã€‚ä¹‹å‰ä¹Ÿæåˆ°äº†ï¼Œå¯¹äºåŸºæœ¬ç±»å‹ï¼ˆå­˜å‚¨åœ¨æ ˆä¸Šï¼‰ï¼ŒRust ä¼šè‡ªåŠ¨æ‹·è´ï¼Œä½†æ˜¯ String ä¸æ˜¯åŸºæœ¬ç±»å‹ï¼Œè€Œä¸”æ˜¯å­˜å‚¨åœ¨å †ä¸Šçš„ï¼Œå› æ­¤ä¸èƒ½è‡ªåŠ¨æ‹·è´ã€‚

å®é™…ä¸Šï¼Œ String ç±»å‹æ˜¯ä¸€ä¸ªå¤æ‚ç±»å‹ï¼Œç”±å­˜å‚¨åœ¨æ ˆä¸­çš„å †æŒ‡é’ˆã€å­—ç¬¦ä¸²é•¿åº¦ã€å­—ç¬¦ä¸²å®¹é‡å…±åŒç»„æˆï¼Œå…¶ä¸­å †æŒ‡é’ˆæ˜¯æœ€é‡è¦çš„ï¼Œå®ƒæŒ‡å‘äº†çœŸå®å­˜å‚¨å­—ç¬¦ä¸²å†…å®¹çš„å †å†…å­˜ï¼Œè‡³äºé•¿åº¦å’Œå®¹é‡ï¼Œå¦‚æœä½ æœ‰ Go è¯­è¨€çš„ç»éªŒï¼Œè¿™é‡Œå°±å¾ˆå¥½ç†è§£ï¼šå®¹é‡æ˜¯å †å†…å­˜åˆ†é…ç©ºé—´çš„å¤§å°ï¼Œé•¿åº¦æ˜¯ç›®å‰å·²ç»ä½¿ç”¨çš„å¤§å°ã€‚

æ€»ä¹‹ String ç±»å‹æŒ‡å‘äº†ä¸€ä¸ªå †ä¸Šçš„ç©ºé—´ï¼Œè¿™é‡Œå­˜å‚¨ç€å®ƒçš„çœŸå®æ•°æ®, ä¸‹é¢å¯¹ä¸Šé¢ä»£ç ä¸­çš„ let s2 = s1 åˆ†æˆä¸¤ç§æƒ…å†µè®¨è®ºï¼š
1. æ‹·è´ String å’Œå­˜å‚¨åœ¨å †ä¸Šçš„å­—èŠ‚æ•°ç»„ å¦‚æœè¯¥è¯­å¥æ˜¯æ‹·è´æ‰€æœ‰æ•°æ®(æ·±æ‹·è´)ï¼Œé‚£ä¹ˆæ— è®ºæ˜¯ String æœ¬èº«è¿˜æ˜¯åº•å±‚çš„å †ä¸Šæ•°æ®ï¼Œéƒ½ä¼šè¢«å…¨éƒ¨æ‹·è´ï¼Œè¿™å¯¹äºæ€§èƒ½è€Œè¨€ä¼šé€ æˆéå¸¸å¤§çš„å½±å“
2. åªæ‹·è´ String æœ¬èº« è¿™æ ·çš„æ‹·è´éå¸¸å¿«ï¼Œå› ä¸ºåœ¨ 64 ä½æœºå™¨ä¸Šå°±æ‹·è´äº† 8å­—èŠ‚çš„æŒ‡é’ˆã€8å­—èŠ‚çš„é•¿åº¦ã€8å­—èŠ‚çš„å®¹é‡ï¼Œæ€»è®¡ 24 å­—èŠ‚ï¼Œä½†æ˜¯å¸¦æ¥äº†æ–°çš„é—®é¢˜ï¼Œè¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰æåˆ°çš„æ‰€æœ‰æƒè§„åˆ™å§ï¼Ÿå…¶ä¸­æœ‰ä¸€æ¡å°±æ˜¯ï¼šä¸€ä¸ªå€¼åªå…è®¸æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ï¼Œè€Œç°åœ¨è¿™ä¸ªå€¼ï¼ˆå †ä¸Šçš„çœŸå®å­—ç¬¦ä¸²æ•°æ®ï¼‰æœ‰äº†ä¸¤ä¸ªæ‰€æœ‰è€…ï¼šs1 å’Œ s2ã€‚

å¥½å§ï¼Œå°±å‡å®šä¸€ä¸ªå€¼å¯ä»¥æ‹¥æœ‰ä¸¤ä¸ªæ‰€æœ‰è€…ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ

å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸåï¼ŒRust ä¼šè‡ªåŠ¨è°ƒç”¨ drop å‡½æ•°å¹¶æ¸…ç†å˜é‡çš„å †å†…å­˜ã€‚ä¸è¿‡ç”±äºä¸¤ä¸ª String å˜é‡æŒ‡å‘äº†åŒä¸€ä½ç½®ã€‚è¿™å°±æœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼šå½“ s1 å’Œ s2 ç¦»å¼€ä½œç”¨åŸŸï¼Œå®ƒä»¬éƒ½ä¼šå°è¯•é‡Šæ”¾ç›¸åŒçš„å†…å­˜ã€‚è¿™æ˜¯ä¸€ä¸ªå«åš äºŒæ¬¡é‡Šæ”¾ï¼ˆdouble freeï¼‰ çš„é”™è¯¯ï¼Œä¹Ÿæ˜¯ä¹‹å‰æåˆ°è¿‡çš„å†…å­˜å®‰å…¨æ€§ BUG ä¹‹ä¸€ã€‚ä¸¤æ¬¡é‡Šæ”¾ï¼ˆç›¸åŒï¼‰å†…å­˜ä¼šå¯¼è‡´å†…å­˜æ±¡æŸ“ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚

å› æ­¤ï¼ŒRust è¿™æ ·è§£å†³é—®é¢˜ï¼šå½“ s1 èµ‹äºˆ s2 åï¼ŒRust è®¤ä¸º s1 ä¸å†æœ‰æ•ˆï¼Œå› æ­¤ä¹Ÿæ— éœ€åœ¨ s1 ç¦»å¼€ä½œç”¨åŸŸå drop ä»»ä½•ä¸œè¥¿ï¼Œè¿™å°±æ˜¯æŠŠæ‰€æœ‰æƒä» s1 è½¬ç§»ç»™äº† s2ï¼Œs1 åœ¨è¢«èµ‹äºˆ s2 åå°±é©¬ä¸Šå¤±æ•ˆäº†ã€‚

å†æ¥çœ‹çœ‹ï¼Œåœ¨æ‰€æœ‰æƒè½¬ç§»åå†æ¥ä½¿ç”¨æ—§çš„æ‰€æœ‰è€…ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼š

```rust
let s1 = String::from("hello");
let s2 = s1;

println!("{}, world!", s1);
```
ç”±äº Rust ç¦æ­¢ä½ ä½¿ç”¨æ— æ•ˆçš„å¼•ç”¨ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸‹çš„é”™è¯¯ï¼š
```
error[E0382]: borrow of moved value: `s1`
 --> src/main.rs:5:28
  |
2 |     let s1 = String::from("hello");
  |         -- move occurs because `s1` has type `String`, which does not implement the `Copy` trait
3 |     let s2 = s1;
  |              -- value moved here
4 | 
5 |     println!("{}, world!", s1);
  |                            ^^ value borrowed here after move
  |
  = note: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)
```

> è¿™é‡Œæˆ‘å†è¿›ä¸€æ­¥è§£é‡Šä¸€ä¸‹ï¼šä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºåœ¨ Rust ä¸­ï¼Œå˜é‡ç»‘å®šå…·æœ‰æ‰€æœ‰æƒ (ownership)ã€‚å½“ä½ å°† s1 ç»‘å®šåˆ°æ–°çš„å˜é‡ s2 æ—¶ï¼Œæ‰€æœ‰æƒä¼šè½¬ç§»ï¼Œè€Œ s1 ä¸å†æœ‰æ•ˆã€‚è¿™æ˜¯ Rust çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§ï¼Œå®ƒæœ‰åŠ©äºé¿å…å†…å­˜ä¸å®‰å…¨ã€‚é”™è¯¯å‘ç”Ÿåœ¨ println! è¡Œï¼Œå› ä¸ºä½ è¯•å›¾ä½¿ç”¨å·²ç»å¤±æ•ˆçš„å˜é‡ s1ã€‚

ğŸŒ…å¦å¤–è¿™æ®µä»£ç å¯ä»¥è§£å†³ï¼š`1. å…‹éš† 2. å¼•ç”¨`
1. å…‹éš†(clone)ï¼š
```rust
let s1 = String::from("hello");
let s2 = s1.clone();

println!("{}, world!", s1);
// è¿™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ `String` å®ä¾‹ï¼Œå…¶å†…å®¹ä¸ `s1` ç›¸åŒï¼Œå¹¶å°†å…¶ç»‘å®šåˆ° `s2`ã€‚è¿™æ ·ï¼Œ`s1` å’Œ `s2` éƒ½å¯ä»¥åœ¨åç»­ä»£ç ä¸­ä½¿ç”¨ã€‚
```
2. å¼•ç”¨ (references)ï¼š
```rust
let s1 = String::from("hello");
let s2 = &s1;

println!("{}, world!", s1);
// åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå¯¹ `s1` çš„å¼•ç”¨å¹¶å°†å…¶èµ‹å€¼ç»™ `s2`ã€‚è¿™æ · `s1` ä»ç„¶æ‹¥æœ‰æ‰€æœ‰æƒï¼Œè€Œ `s2` åªæ˜¯å€Ÿç”¨ (borrow)ã€‚æ³¨æ„ï¼Œå½“ä½¿ç”¨å¼•ç”¨æ—¶ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘ç”Ÿå‘½å‘¨æœŸ (lifetimes) å’Œå¯å˜æ€§ (mutability)ã€‚
```

ç°åœ¨å†å›å¤´çœ‹çœ‹ä¹‹å‰çš„è§„åˆ™ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»æœ‰äº†æ›´æ·±åˆ»çš„ç†è§£ï¼š
> 1. Rust ä¸­æ¯ä¸€ä¸ªå€¼éƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œè¯¥å˜é‡è¢«ç§°ä¸ºå€¼çš„æ‰€æœ‰è€…
> 2. ä¸€ä¸ªå€¼åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œæˆ–è€…è¯´ä¸€ä¸ªå€¼åªèƒ½æ‹¥æœ‰ä¸€ä¸ªæ‰€æœ‰è€…
> 3. å½“æ‰€æœ‰è€…(å˜é‡)ç¦»å¼€ä½œç”¨åŸŸèŒƒå›´æ—¶ï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒ(drop)

å¦‚æœä½ åœ¨å…¶ä»–è¯­è¨€ä¸­å¬è¯´è¿‡æœ¯è¯­ æµ…æ‹·è´(shallow copy) å’Œ æ·±æ‹·è´(deep copy)ï¼Œé‚£ä¹ˆæ‹·è´æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡è€Œä¸æ‹·è´æ•°æ®å¬èµ·æ¥å°±åƒæµ…æ‹·è´ï¼Œä½†æ˜¯åˆå› ä¸º Rust åŒæ—¶ä½¿ç¬¬ä¸€ä¸ªå˜é‡ s1 æ— æ•ˆäº†ï¼Œå› æ­¤è¿™ä¸ªæ“ä½œè¢«ç§°ä¸º ç§»åŠ¨(move)ï¼Œè€Œä¸æ˜¯æµ…æ‹·è´ã€‚ä¸Šé¢çš„ä¾‹å­å¯ä»¥è§£è¯»ä¸º s1 è¢«ç§»åŠ¨åˆ°äº† s2 ä¸­ã€‚é‚£ä¹ˆå…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œç”¨ä¸€å¼ å›¾ç®€å•è¯´æ˜ï¼š
![](https://pic1.zhimg.com/80/v2-3ec77951de6a17584b5eb4a3838b4b61_1440w.jpg)
è¿™æ ·å°±è§£å†³äº†æˆ‘ä»¬ä¹‹å‰çš„é—®é¢˜ï¼Œs1 ä¸å†æŒ‡å‘ä»»ä½•æ•°æ®ï¼Œåªæœ‰ s2 æ˜¯æœ‰æ•ˆçš„ï¼Œå½“ s2 ç¦»å¼€ä½œç”¨åŸŸï¼Œå®ƒå°±ä¼šé‡Šæ”¾å†…å­˜ã€‚ ç›¸ä¿¡æ­¤åˆ»ï¼Œä½ åº”è¯¥æ˜ç™½äº†ï¼Œä¸ºä»€ä¹ˆ Rust ç§°å‘¼ let a = b ä¸ºå˜é‡ç»‘å®šäº†å§ï¼Ÿ

å†æ¥çœ‹ä¸€æ®µä»£ç :
```rust
fn main() {
    let x: &str = "hello, world";
    let y = x;
    println!("{},{}",x,y);
}
```
è¿™æ®µä»£ç ï¼Œå¤§å®¶è§‰å¾—ä¼šå¦æŠ¥é”™ï¼Ÿå¦‚æœå‚è€ƒä¹‹å‰çš„ String æ‰€æœ‰æƒè½¬ç§»çš„ä¾‹å­ï¼Œé‚£è¿™æ®µä»£ç ä¹Ÿåº”è¯¥æŠ¥é”™æ‰æ˜¯ï¼Œä½†æ˜¯å®é™…ä¸Šå‘¢ï¼Ÿ

è¿™æ®µä»£ç å’Œä¹‹å‰çš„ String æœ‰ä¸€ä¸ªæœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼šåœ¨ String çš„ä¾‹å­ä¸­ s1 æŒæœ‰äº†é€šè¿‡String::from("hello") åˆ›å»ºçš„å€¼çš„æ‰€æœ‰æƒï¼Œè€Œè¿™ä¸ªä¾‹å­ä¸­ï¼Œx åªæ˜¯å¼•ç”¨äº†å­˜å‚¨åœ¨äºŒè¿›åˆ¶ä¸­çš„å­—ç¬¦ä¸² "hello, world"ï¼Œå¹¶æ²¡æœ‰æŒæœ‰æ‰€æœ‰æƒã€‚

å› æ­¤ let y = x ä¸­ï¼Œä»…ä»…æ˜¯å¯¹è¯¥å¼•ç”¨è¿›è¡Œäº†æ‹·è´ï¼Œæ­¤æ—¶ y å’Œ x éƒ½å¼•ç”¨äº†åŒä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœè¿˜ä¸ç†è§£ä¹Ÿæ²¡å…³ç³»ï¼Œå½“å­¦ä¹ äº†ä¸‹ä¸€ç« èŠ‚ "å¼•ç”¨ä¸å€Ÿç”¨" åï¼Œå¤§å®¶è‡ªç„¶è€Œè¨€å°±ä¼šç†è§£ã€‚

##### å…‹éš†(æ·±æ‹·è´)
é¦–å…ˆï¼ŒRust æ°¸è¿œä¹Ÿä¸ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®çš„ â€œæ·±æ‹·è´â€ã€‚å› æ­¤ï¼Œä»»ä½•è‡ªåŠ¨çš„å¤åˆ¶éƒ½ä¸æ˜¯æ·±æ‹·è´ï¼Œå¯ä»¥è¢«è®¤ä¸ºå¯¹è¿è¡Œæ—¶æ€§èƒ½å½±å“è¾ƒå°ã€‚

å¦‚æœæˆ‘ä»¬ç¡®å®éœ€è¦æ·±åº¦å¤åˆ¶ String ä¸­å †ä¸Šçš„æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯æ ˆä¸Šçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå«åš clone çš„æ–¹æ³•ã€‚
```rust
let s1 = String::from("hello");
let s2 = s1.clone();

println!("s1 = {}, s2 = {}", s1, s2);
```

è¿™æ®µä»£ç èƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œå› æ­¤è¯´æ˜ s2 ç¡®å®å®Œæ•´çš„å¤åˆ¶äº† s1 çš„æ•°æ®ã€‚

å¦‚æœä»£ç æ€§èƒ½æ— å…³ç´§è¦ï¼Œä¾‹å¦‚åˆå§‹åŒ–ç¨‹åºæ—¶ï¼Œæˆ–è€…åœ¨æŸæ®µæ—¶é—´åªä¼šæ‰§è¡Œä¸€æ¬¡æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ clone æ¥ç®€åŒ–ç¼–ç¨‹ã€‚ä½†æ˜¯å¯¹äºæ‰§è¡Œè¾ƒä¸ºé¢‘ç¹çš„ä»£ç (çƒ­ç‚¹è·¯å¾„)ï¼Œä½¿ç”¨ clone ä¼šæå¤§çš„é™ä½ç¨‹åºæ€§èƒ½ï¼Œéœ€è¦å°å¿ƒä½¿ç”¨ï¼

##### æ‹·è´(æµ…æ‹·è´)
æµ…æ‹·è´åªå‘ç”Ÿåœ¨æ ˆä¸Šï¼Œå› æ­¤æ€§èƒ½å¾ˆé«˜ï¼Œåœ¨æ—¥å¸¸ç¼–ç¨‹ä¸­ï¼Œæµ…æ‹·è´æ— å¤„ä¸åœ¨ã€‚

å†å›åˆ°ä¹‹å‰çœ‹è¿‡çš„ä¾‹å­:
```rust
let x = 5;
let y = x;

println!("x = {}, y = {}", x, y);
```

ä½†è¿™æ®µä»£ç ä¼¼ä¹ä¸æˆ‘ä»¬åˆšåˆšå­¦åˆ°çš„å†…å®¹ç›¸çŸ›ç›¾ï¼šæ²¡æœ‰è°ƒç”¨ cloneï¼Œä¸è¿‡ä¾ç„¶å®ç°äº†ç±»ä¼¼æ·±æ‹·è´çš„æ•ˆæœ â€”â€” æ²¡æœ‰æŠ¥æ‰€æœ‰æƒçš„é”™è¯¯ã€‚

åŸå› æ˜¯åƒæ•´å‹è¿™æ ·çš„åŸºæœ¬ç±»å‹åœ¨ç¼–è¯‘æ—¶æ˜¯å·²çŸ¥å¤§å°çš„ï¼Œä¼šè¢«å­˜å‚¨åœ¨æ ˆä¸Šï¼Œæ‰€ä»¥æ‹·è´å…¶å®é™…çš„å€¼æ˜¯å¿«é€Ÿçš„ã€‚è¿™æ„å‘³ç€æ²¡æœ‰ç†ç”±åœ¨åˆ›å»ºå˜é‡ y åä½¿ x æ— æ•ˆï¼ˆxã€y éƒ½ä»ç„¶æœ‰æ•ˆï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œè¿™é‡Œæ²¡æœ‰æ·±æµ…æ‹·è´çš„åŒºåˆ«ï¼Œå› æ­¤è¿™é‡Œè°ƒç”¨ clone å¹¶ä¸ä¼šä¸é€šå¸¸çš„æµ…æ‹·è´æœ‰ä»€ä¹ˆä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®¡å®ƒï¼ˆå¯ä»¥ç†è§£æˆåœ¨æ ˆä¸Šåšäº†æ·±æ‹·è´ï¼‰ã€‚

Rust æœ‰ä¸€ä¸ªå«åš Copy çš„ç‰¹å¾ï¼Œå¯ä»¥ç”¨åœ¨ç±»ä¼¼æ•´å‹è¿™æ ·åœ¨æ ˆä¸­å­˜å‚¨çš„ç±»å‹ã€‚å¦‚æœä¸€ä¸ªç±»å‹æ‹¥æœ‰ Copy ç‰¹å¾ï¼Œä¸€ä¸ªæ—§çš„å˜é‡åœ¨è¢«èµ‹å€¼ç»™å…¶ä»–å˜é‡åä»ç„¶å¯ç”¨ã€‚

é‚£ä¹ˆä»€ä¹ˆç±»å‹æ˜¯å¯ Copy çš„å‘¢ï¼Ÿå¯ä»¥æŸ¥çœ‹ç»™å®šç±»å‹çš„æ–‡æ¡£æ¥ç¡®è®¤ï¼Œä¸è¿‡ä½œä¸ºä¸€ä¸ªé€šç”¨çš„è§„åˆ™ï¼š ä»»ä½•åŸºæœ¬ç±»å‹çš„ç»„åˆå¯ä»¥ Copy ï¼Œä¸éœ€è¦åˆ†é…å†…å­˜æˆ–æŸç§å½¢å¼èµ„æºçš„ç±»å‹æ˜¯å¯ä»¥ Copy çš„ã€‚å¦‚ä¸‹æ˜¯ä¸€äº› Copy çš„ç±»å‹ï¼š

- æ‰€æœ‰æ•´æ•°ç±»å‹ï¼Œæ¯”å¦‚ u32
- å¸ƒå°”ç±»å‹ï¼Œboolï¼Œå®ƒçš„å€¼æ˜¯ true å’Œ false
- æ‰€æœ‰æµ®ç‚¹æ•°ç±»å‹ï¼Œæ¯”å¦‚ f64
- å­—ç¬¦ç±»å‹ï¼Œchar
- å…ƒç»„ï¼Œå½“ä¸”ä»…å½“å…¶åŒ…å«çš„ç±»å‹ä¹Ÿéƒ½æ˜¯ Copy çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼Œ(i32, i32) æ˜¯ Copy çš„ï¼Œä½† (i32, String) å°±ä¸æ˜¯
- ä¸å¯å˜å¼•ç”¨ &T ï¼Œä¾‹å¦‚è½¬ç§»æ‰€æœ‰æƒä¸­çš„æœ€åä¸€ä¸ªä¾‹å­ï¼Œä½†æ˜¯æ³¨æ„: å¯å˜å¼•ç”¨ &mut T æ˜¯ä¸å¯ä»¥ Copyçš„

#### å‡½æ•°ä¼ å€¼ä¸è¿”å›
å°†å€¼ä¼ é€’ç»™å‡½æ•°ï¼Œä¸€æ ·ä¼šå‘ç”Ÿ ç§»åŠ¨ æˆ–è€… å¤åˆ¶ï¼Œå°±è·Ÿ let è¯­å¥ä¸€æ ·ï¼Œä¸‹é¢çš„ä»£ç å±•ç¤ºäº†æ‰€æœ‰æƒã€ä½œç”¨åŸŸçš„è§„åˆ™ï¼š
```rust
fn main() {
    let s = String::from("hello");  // s è¿›å…¥ä½œç”¨åŸŸ

    takes_ownership(s);             // s çš„å€¼ç§»åŠ¨åˆ°å‡½æ•°é‡Œ ...
                                    // ... æ‰€ä»¥åˆ°è¿™é‡Œä¸å†æœ‰æ•ˆ

    let x = 5;                      // x è¿›å…¥ä½œç”¨åŸŸ

    makes_copy(x);                  // x åº”è¯¥ç§»åŠ¨å‡½æ•°é‡Œï¼Œ
                                    // ä½† i32 æ˜¯ Copy çš„ï¼Œæ‰€ä»¥åœ¨åé¢å¯ç»§ç»­ä½¿ç”¨ x

} // è¿™é‡Œ, x å…ˆç§»å‡ºäº†ä½œç”¨åŸŸï¼Œç„¶åæ˜¯ sã€‚ä½†å› ä¸º s çš„å€¼å·²è¢«ç§»èµ°ï¼Œ
  // æ‰€ä»¥ä¸ä¼šæœ‰ç‰¹æ®Šæ“ä½œ

fn takes_ownership(some_string: String) { // some_string è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_string);
} // è¿™é‡Œï¼Œsome_string ç§»å‡ºä½œç”¨åŸŸå¹¶è°ƒç”¨ `drop` æ–¹æ³•ã€‚å ç”¨çš„å†…å­˜è¢«é‡Šæ”¾

fn makes_copy(some_integer: i32) { // some_integer è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_integer);
} // è¿™é‡Œï¼Œsome_integer ç§»å‡ºä½œç”¨åŸŸã€‚ä¸ä¼šæœ‰ç‰¹æ®Šæ“ä½œ
```
ä½ å¯ä»¥å°è¯•åœ¨ takes_ownership ä¹‹åï¼Œå†ä½¿ç”¨ sï¼Œçœ‹çœ‹å¦‚ä½•æŠ¥é”™ï¼Ÿä¾‹å¦‚æ·»åŠ ä¸€è¡Œ println!("åœ¨moveè¿›å‡½æ•°åç»§ç»­ä½¿ç”¨s: {}",s);ã€‚
```rust
fn main() {
    let s = String::from("hello");  // s è¿›å…¥ä½œç”¨åŸŸ

    takes_ownership(s);             // s çš„å€¼ç§»åŠ¨åˆ°å‡½æ•°é‡Œ ...
                                    // ... æ‰€ä»¥åˆ°è¿™é‡Œä¸å†æœ‰æ•ˆ
    let y = s;
    println!(y); // è¿™é‡Œè¿›è¡Œå®éªŒ
// ====================================
%%error: format argument must be a string literal
 --> src/main.rs:7:14
  |
7 |     println!(y);
  |              ^
  |
help: you might be missing a string literal to format with
  |
7 |     println!("{}", y);
  |              +++++

error: could not compile `Demo` due to previous erro%%r
```

åŒæ ·çš„ï¼Œå‡½æ•°è¿”å›å€¼ä¹Ÿæœ‰æ‰€æœ‰æƒï¼Œä¾‹å¦‚:

```rust
fn main() {
    let s1 = gives_ownership();         // gives_ownership å°†è¿”å›å€¼
                                        // ç§»ç»™ s1

    let s2 = String::from("hello");     // s2 è¿›å…¥ä½œç”¨åŸŸ

    let s3 = takes_and_gives_back(s2);  // s2 è¢«ç§»åŠ¨åˆ°
                                        // takes_and_gives_back ä¸­,
                                        // å®ƒä¹Ÿå°†è¿”å›å€¼ç§»ç»™ s3
} // è¿™é‡Œ, s3 ç§»å‡ºä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒã€‚s2 ä¹Ÿç§»å‡ºä½œç”¨åŸŸï¼Œä½†å·²è¢«ç§»èµ°ï¼Œ
  // æ‰€ä»¥ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿã€‚s1 ç§»å‡ºä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒ

fn gives_ownership() -> String {             // gives_ownership å°†è¿”å›å€¼ç§»åŠ¨ç»™
                                             // è°ƒç”¨å®ƒçš„å‡½æ•°

    let some_string = String::from("hello"); // some_string è¿›å…¥ä½œç”¨åŸŸ.

    some_string                              // è¿”å› some_string å¹¶ç§»å‡ºç»™è°ƒç”¨çš„å‡½æ•°
}

// takes_and_gives_back å°†ä¼ å…¥å­—ç¬¦ä¸²å¹¶è¿”å›è¯¥å€¼
fn takes_and_gives_back(a_string: String) -> String { // a_string è¿›å…¥ä½œç”¨åŸŸ

    a_string  // è¿”å› a_string å¹¶ç§»å‡ºç»™è°ƒç”¨çš„å‡½æ•°
}
```
æ‰€æœ‰æƒå¾ˆå¼ºå¤§ï¼Œé¿å…äº†å†…å­˜çš„ä¸å®‰å…¨æ€§ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªæ–°éº»çƒ¦ï¼š æ€»æ˜¯æŠŠä¸€ä¸ªå€¼ä¼ æ¥ä¼ å»æ¥ä½¿ç”¨å®ƒã€‚ ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå¾ˆå¯èƒ½è¿˜è¦ä»è¯¥å‡½æ•°ä¼ å‡ºå»ï¼Œç»“æœå°±æ˜¯è¯­è¨€è¡¨è¾¾å˜å¾—éå¸¸å•°å—¦ï¼Œå¹¸è¿çš„æ˜¯ï¼ŒRust æä¾›äº†æ–°åŠŸèƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

### 1.3.2 ğŸšŒ å€Ÿç”¨
ä¸ŠèŠ‚ä¸­æåˆ°ï¼Œå¦‚æœä»…ä»…æ”¯æŒé€šè¿‡è½¬ç§»æ‰€æœ‰æƒçš„æ–¹å¼è·å–ä¸€ä¸ªå€¼ï¼Œé‚£ä¼šè®©ç¨‹åºå˜å¾—å¤æ‚ã€‚ Rust èƒ½å¦åƒå…¶å®ƒç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œä½¿ç”¨æŸä¸ªå˜é‡çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥ã€‚

**Rust é€šè¿‡ å€Ÿç”¨(Borrowing) è¿™ä¸ªæ¦‚å¿µæ¥è¾¾æˆä¸Šè¿°çš„ç›®çš„ï¼Œè·å–å˜é‡çš„å¼•ç”¨ï¼Œç§°ä¹‹ä¸ºå€Ÿç”¨(borrowing)**ã€‚æ­£å¦‚ç°å®ç”Ÿæ´»ä¸­ï¼Œå¦‚æœä¸€ä¸ªäººæ‹¥æœ‰æŸæ ·ä¸œè¥¿ï¼Œä½ å¯ä»¥ä»ä»–é‚£é‡Œå€Ÿæ¥ï¼Œå½“ä½¿ç”¨å®Œæ¯•åï¼Œä¹Ÿå¿…é¡»è¦ç‰©å½’åŸä¸»ã€‚

#### å¼•ç”¨ä¸è§£å¼•ç”¨
å¸¸è§„å¼•ç”¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼ŒæŒ‡å‘äº†å¯¹è±¡å­˜å‚¨çš„å†…å­˜åœ°å€ã€‚åœ¨ä¸‹é¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª i32 å€¼çš„å¼•ç”¨ yï¼Œç„¶åä½¿ç”¨è§£å¼•ç”¨è¿ç®—ç¬¦æ¥è§£å‡º y æ‰€ä½¿ç”¨çš„å€¼:
```rust
fn main() {
    let x = 5;
    let y = &x;

    assert_eq!(5, x);
    assert_eq!(5, *y);
}
```
å˜é‡ x å­˜æ”¾äº†ä¸€ä¸ª i32 å€¼ 5ã€‚y æ˜¯ x çš„ä¸€ä¸ªå¼•ç”¨ã€‚å¯ä»¥æ–­è¨€ x ç­‰äº 5ã€‚ç„¶è€Œï¼Œå¦‚æœå¸Œæœ›å¯¹ y çš„å€¼åšå‡ºæ–­è¨€ï¼Œå¿…é¡»ä½¿ç”¨ *y æ¥è§£å‡ºå¼•ç”¨æ‰€æŒ‡å‘çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯è§£å¼•ç”¨ï¼‰ã€‚ä¸€æ—¦è§£å¼•ç”¨äº† yï¼Œå°±å¯ä»¥è®¿é—® y æ‰€æŒ‡å‘çš„æ•´å‹å€¼å¹¶å¯ä»¥ä¸ 5 åšæ¯”è¾ƒã€‚

ç›¸åå¦‚æœå°è¯•ç¼–å†™ assert_eq!(5, y);ï¼Œåˆ™ä¼šå¾—åˆ°å¦‚ä¸‹ç¼–è¯‘é”™è¯¯ï¼š
```
error[E0277]: can't compare `{integer}` with `&{integer}`
 --> src/main.rs:6:5
  |
6 |     assert_eq!(5, y);
  |     ^^^^^^^^^^^^^^^^ no implementation for `{integer} == &{integer}` // æ— æ³•æ¯”è¾ƒæ•´æ•°ç±»å‹å’Œå¼•ç”¨ç±»å‹
  |
  = help: the trait `PartialEq<&{integer}>` is not implemented for `{integer}`
  = help: the following other types implement trait `PartialEq<Rhs>`:
```

#### ä¸å¯å˜å¼•ç”¨
ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬ç”¨ s1 çš„å¼•ç”¨ä½œä¸ºå‚æ•°ä¼ é€’ç»™ calculate_length å‡½æ•°ï¼Œè€Œä¸æ˜¯æŠŠ s1 çš„æ‰€æœ‰æƒè½¬ç§»ç»™è¯¥å‡½æ•°ï¼š

```rust
fn main() {
    let s1 = String::from("hello");

    let len = calculate_length(&s1);

    println!("The length of '{}' is {}.", s1, len);
}

fn calculate_length(s: &String) -> usize {
    s.len()
}
```
èƒ½æ³¨æ„åˆ°ä¸¤ç‚¹ï¼š

1. æ— éœ€åƒä¸Šç« ä¸€æ ·ï¼šå…ˆé€šè¿‡å‡½æ•°å‚æ•°ä¼ å…¥æ‰€æœ‰æƒï¼Œç„¶åå†é€šè¿‡å‡½æ•°è¿”å›æ¥ä¼ å‡ºæ‰€æœ‰æƒï¼Œä»£ç æ›´åŠ ç®€æ´
2. calculate_length çš„å‚æ•° s ç±»å‹ä» String å˜ä¸º &String
è¿™é‡Œï¼Œ& ç¬¦å·å³æ˜¯å¼•ç”¨ï¼Œå®ƒä»¬å…è®¸ä½ ä½¿ç”¨å€¼ï¼Œä½†æ˜¯ä¸è·å–æ‰€æœ‰æƒï¼Œå¦‚å›¾æ‰€ç¤ºï¼š 
![](https://pic1.zhimg.com/80/v2-fc68ea4a1fe2e3fe4c5bb523a0a8247c_1440w.jpg)
é€šè¿‡ &s1 è¯­æ³•ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘ s1 çš„å¼•ç”¨ï¼Œä½†æ˜¯å¹¶ä¸æ‹¥æœ‰å®ƒã€‚å› ä¸ºå¹¶ä¸æ‹¥æœ‰è¿™ä¸ªå€¼ï¼Œå½“å¼•ç”¨ç¦»å¼€ä½œç”¨åŸŸåï¼Œå…¶æŒ‡å‘çš„å€¼ä¹Ÿä¸ä¼šè¢«ä¸¢å¼ƒã€‚

åŒç†ï¼Œå‡½æ•° calculate_length ä½¿ç”¨ & æ¥è¡¨æ˜å‚æ•° s çš„ç±»å‹æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼š

```rust
fn calculate_length(s: &String) -> usize { // s æ˜¯å¯¹ String çš„å¼•ç”¨
    s.len()
} // è¿™é‡Œï¼Œs ç¦»å¼€äº†ä½œç”¨åŸŸã€‚ä½†å› ä¸ºå®ƒå¹¶ä¸æ‹¥æœ‰å¼•ç”¨å€¼çš„æ‰€æœ‰æƒï¼Œ
  // æ‰€ä»¥ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿ
```
å¾ˆä¸å¹¸ï¼Œå¦¹å­ä½ æ²¡æŠ±åˆ°ï¼Œå“¦å£è¯¯ï¼Œä½ ä¿®æ”¹é”™äº†ï¼š

```
error[E0596]: cannot borrow `*some_string` as mutable, as it is behind a `&` reference
 --> src/main.rs:8:5
  |
7 | fn change(some_string: &String) {
  |                        ------- help: consider changing this to be a mutable reference: `&mut String`
						   ------- å¸®åŠ©ï¼šè€ƒè™‘å°†è¯¥å‚æ•°ç±»å‹ä¿®æ”¹ä¸ºå¯å˜çš„å¼•ç”¨: `&mut String`
8 |     some_string.push_str(", world");
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `some_string` is a `&` reference, so the data it refers to cannot be borrowed as mutable\
										`some_string`æ˜¯ä¸€ä¸ª`&`ç±»å‹çš„å¼•ç”¨ï¼Œå› æ­¤å®ƒæŒ‡å‘çš„æ•°æ®æ— æ³•è¿›è¡Œä¿®æ”¹

For more information about this error, try `rustc --explain E0596`.
error: could not compile `Demo` due to previous error
```

æ­£å¦‚å˜é‡é»˜è®¤ä¸å¯å˜ä¸€æ ·ï¼Œå¼•ç”¨æŒ‡å‘çš„å€¼é»˜è®¤ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œæ²¡äº‹ï¼Œæ¥ä¸€èµ·çœ‹çœ‹å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

#### å¯å˜å¼•ç”¨
åªéœ€è¦ä¸€ä¸ªå°è°ƒæ•´ï¼Œå³å¯ä¿®å¤ä¸Šé¢ä»£ç çš„é”™è¯¯ï¼š
```rust
fn main() {
    let mut s = String::from("hello");

    change(&mut s);
}

fn change(some_string: &mut String) {
    some_string.push_str(", world");
}
```

é¦–å…ˆï¼Œå£°æ˜ s æ˜¯å¯å˜ç±»å‹ï¼Œå…¶æ¬¡åˆ›å»ºä¸€ä¸ªå¯å˜çš„å¼•ç”¨ &mut s å’Œæ¥å—å¯å˜å¼•ç”¨å‚æ•° some_string: &mut String çš„å‡½æ•°ã€‚

##### å¯å˜å¼•ç”¨åŒæ—¶åªèƒ½å­˜åœ¨ä¸€ä¸ª
ä¸è¿‡å¯å˜å¼•ç”¨å¹¶ä¸æ˜¯éšå¿ƒæ‰€æ¬²ã€æƒ³ç”¨å°±ç”¨çš„ï¼Œå®ƒæœ‰ä¸€ä¸ªå¾ˆå¤§çš„é™åˆ¶ï¼š åŒä¸€ä½œç”¨åŸŸï¼Œç‰¹å®šæ•°æ®åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼š
```rust
let mut s = String::from("hello");

let r1 = &mut s;
let r2 = &mut s;

println!("{}, {}", r1, r2);
```
ä»¥ä¸Šä»£ç ä¼šæŠ¥é”™ï¼š
```
	error[E0499]: cannot borrow `s` as mutable more than once at a time åŒä¸€æ—¶é—´æ— æ³•å¯¹ `s` è¿›è¡Œä¸¤æ¬¡å¯å˜å€Ÿç”¨
 --> src/main.rs:5:10
  |
4 | let r1 = &mut s;
  |          ------ first mutable borrow occurs here é¦–ä¸ªå¯å˜å¼•ç”¨åœ¨è¿™é‡Œå€Ÿç”¨
5 | let r2 = &mut s;
  |          ^^^^^^ second mutable borrow occurs here ç¬¬äºŒä¸ªå¯å˜å¼•ç”¨åœ¨è¿™é‡Œå€Ÿç”¨
6 | 
7 | println!("{}, {}", r1, r2);
  |                    -- first borrow later used here ç¬¬ä¸€ä¸ªå€Ÿç”¨åœ¨è¿™é‡Œä½¿ç”¨

For more information about this error, try `rustc --explain E0499`.
error: could not compile `Demo` due to previous error
```
è¿™æ®µä»£ç å‡ºé”™çš„åŸå› åœ¨äºï¼Œç¬¬ä¸€ä¸ªå¯å˜å€Ÿç”¨ r1 å¿…é¡»è¦æŒç»­åˆ°æœ€åä¸€æ¬¡ä½¿ç”¨çš„ä½ç½® println!ï¼Œåœ¨ r1 åˆ›å»ºå’Œæœ€åä¸€æ¬¡ä½¿ç”¨ä¹‹é—´ï¼Œæˆ‘ä»¬åˆå°è¯•åˆ›å»ºç¬¬äºŒä¸ªå¯å˜å€Ÿç”¨ r2ã€‚

å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œè¿™ä¸ªç‰¹æ€§ç»å¯¹æ˜¯ä¸€å¤§æ‹¦è·¯è™ï¼Œä¹Ÿæ˜¯æ–°äººä»¬è°ˆä¹‹è‰²å˜çš„ç¼–è¯‘å™¨ borrow checker ç‰¹æ€§ä¹‹ä¸€ï¼Œä¸è¿‡å„è¡Œå„ä¸šéƒ½ä¸€æ ·ï¼Œé™åˆ¶å¾€å¾€æ˜¯å‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼ŒRust ä¹Ÿä¸€æ ·ã€‚

è¿™ç§é™åˆ¶çš„å¥½å¤„å°±æ˜¯ä½¿ Rust åœ¨ç¼–è¯‘æœŸå°±é¿å…æ•°æ®ç«äº‰ï¼Œæ•°æ®ç«äº‰å¯ç”±ä»¥ä¸‹è¡Œä¸ºé€ æˆï¼š
- ä¸¤ä¸ªæˆ–æ›´å¤šçš„æŒ‡é’ˆåŒæ—¶è®¿é—®åŒä¸€æ•°æ®
- è‡³å°‘æœ‰ä¸€ä¸ªæŒ‡é’ˆè¢«ç”¨æ¥å†™å…¥æ•°æ®
- æ²¡æœ‰åŒæ­¥æ•°æ®è®¿é—®çš„æœºåˆ¶

æ•°æ®ç«äº‰ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºå¾ˆå¯èƒ½è¶…å‡ºæˆ‘ä»¬çš„é¢„æœŸï¼Œéš¾ä»¥åœ¨è¿è¡Œæ—¶è¿½è¸ªï¼Œå¹¶ä¸”éš¾ä»¥è¯Šæ–­å’Œä¿®å¤ã€‚è€Œ Rust é¿å…äº†è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œå› ä¸ºå®ƒç”šè‡³ä¸ä¼šç¼–è¯‘å­˜åœ¨æ•°æ®ç«äº‰çš„ä»£ç ï¼

å¾ˆå¤šæ—¶å€™ï¼Œå¤§æ‹¬å·å¯ä»¥å¸®æˆ‘ä»¬è§£å†³ä¸€äº›ç¼–è¯‘ä¸é€šè¿‡çš„é—®é¢˜ï¼Œé€šè¿‡æ‰‹åŠ¨é™åˆ¶å˜é‡çš„ä½œç”¨åŸŸï¼š

```rust
let mut s = String::from("hello");

{
    let r1 = &mut s;

} // r1 åœ¨è¿™é‡Œç¦»å¼€äº†ä½œç”¨åŸŸï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å¼•ç”¨

let r2 = &mut s;
```

##### å¯å˜å¼•ç”¨ä¸ä¸å¯å˜å¼•ç”¨ä¸èƒ½åŒæ—¶å­˜åœ¨
ä¸‹é¢çš„ä»£ç ä¼šå¯¼è‡´ä¸€ä¸ªé”™è¯¯ï¼š

```rust
fn main() {
    let mut s = String::from("hello");

    let r1 = &s; // æ²¡é—®é¢˜
    let r2 = &s; // æ²¡é—®é¢˜
    let r3 = &mut s; // å¤§é—®é¢˜

    println!("{}, {}, and {}", r1, r2, r3);
}
```

é”™è¯¯å¦‚ä¸‹ï¼š
```
error[E0502]: cannot borrow `s` as mutable because it is also borrowed as immutable
 --> src/main.rs:6:14
  |
4 |     let r1 = &s; // æ²¡é—®é¢˜
  |              -- immutable borrow occurs here
5 |     let r2 = &s; // æ²¡é—®é¢˜
6 |     let r3 = &mut s; // å¤§é—®é¢˜
  |              ^^^^^^ mutable borrow occurs here
7 | 
8 |     println!("{}, {}, and {}", r1, r2, r3);
  |                                -- immutable borrow later used here

For more information about this error, try `rustc --explain E0502`.
error: could not compile `Demo` due to previous error
```
å…¶å®è¿™ä¸ªä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæ­£åœ¨å€Ÿç”¨ä¸å¯å˜å¼•ç”¨çš„ç”¨æˆ·ï¼Œè‚¯å®šä¸å¸Œæœ›ä»–å€Ÿç”¨çš„ä¸œè¥¿ï¼Œè¢«å¦å¤–ä¸€ä¸ªäººè«åå…¶å¦™æ”¹å˜äº†ã€‚å¤šä¸ªä¸å¯å˜å€Ÿç”¨è¢«å…è®¸æ˜¯å› ä¸ºæ²¡æœ‰äººä¼šå»è¯•å›¾ä¿®æ”¹æ•°æ®ï¼Œæ¯ä¸ªäººéƒ½åªè¯»è¿™ä¸€ä»½æ•°æ®è€Œä¸åšä¿®æ”¹ï¼Œå› æ­¤ä¸ç”¨æ‹…å¿ƒæ•°æ®è¢«æ±¡æŸ“ã€‚
> æ³¨æ„ï¼Œå¼•ç”¨çš„ä½œç”¨åŸŸ s ä»åˆ›å»ºå¼€å§‹ï¼Œä¸€ç›´æŒç»­åˆ°å®ƒæœ€åä¸€æ¬¡ä½¿ç”¨çš„åœ°æ–¹ï¼Œè¿™ä¸ªè·Ÿå˜é‡çš„ä½œç”¨åŸŸæœ‰æ‰€ä¸åŒï¼Œå˜é‡çš„ä½œç”¨åŸŸä»åˆ›å»ºæŒç»­åˆ°æŸä¸€ä¸ªèŠ±æ‹¬å· }

Rust çš„ç¼–è¯‘å™¨ä¸€ç›´åœ¨ä¼˜åŒ–ï¼Œæ—©æœŸçš„æ—¶å€™ï¼Œå¼•ç”¨çš„ä½œç”¨åŸŸè·Ÿå˜é‡ä½œç”¨åŸŸæ˜¯ä¸€è‡´çš„ï¼Œè¿™å¯¹æ—¥å¸¸ä½¿ç”¨å¸¦æ¥äº†å¾ˆå¤§çš„å›°æ‰°ï¼Œä½ å¿…é¡»éå¸¸å°å¿ƒçš„å»å®‰æ’å¯å˜ã€ä¸å¯å˜å˜é‡çš„å€Ÿç”¨ï¼Œå…å¾—æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š

```rust
fn main() {
   let mut s = String::from("hello");

    let r1 = &s;
    let r2 = &s;
    println!("{} and {}", r1, r2);
    // æ–°ç¼–è¯‘å™¨ä¸­ï¼Œr1,r2ä½œç”¨åŸŸåœ¨è¿™é‡Œç»“æŸ

    let r3 = &mut s;
    println!("{}", r3);
} // è€ç¼–è¯‘å™¨ä¸­ï¼Œr1ã€r2ã€r3ä½œç”¨åŸŸåœ¨è¿™é‡Œç»“æŸ
  // æ–°ç¼–è¯‘å™¨ä¸­ï¼Œr3ä½œç”¨åŸŸåœ¨è¿™é‡Œç»“æŸ
```
åœ¨è€ç‰ˆæœ¬çš„ç¼–è¯‘å™¨ä¸­ï¼ˆRust 1.31 å‰ï¼‰ï¼Œå°†ä¼šæŠ¥é”™ï¼Œå› ä¸º r1 å’Œ r2 çš„ä½œç”¨åŸŸåœ¨èŠ±æ‹¬å· } å¤„ç»“æŸï¼Œé‚£ä¹ˆ r3 çš„å€Ÿç”¨å°±ä¼šè§¦å‘ æ— æ³•åŒæ—¶å€Ÿç”¨å¯å˜å’Œä¸å¯å˜çš„è§„åˆ™ã€‚

ä½†æ˜¯åœ¨æ–°çš„ç¼–è¯‘å™¨ä¸­ï¼Œè¯¥ä»£ç å°†é¡ºåˆ©é€šè¿‡ï¼Œå› ä¸º å¼•ç”¨ä½œç”¨åŸŸçš„ç»“æŸä½ç½®ä»èŠ±æ‹¬å·å˜æˆæœ€åä¸€æ¬¡ä½¿ç”¨çš„ä½ç½®ï¼Œå› æ­¤ r1 å€Ÿç”¨å’Œ r2 å€Ÿç”¨åœ¨ println! åï¼Œå°±ç»“æŸäº†ï¼Œæ­¤æ—¶ r3 å¯ä»¥é¡ºåˆ©å€Ÿç”¨åˆ°å¯å˜å¼•ç”¨ã€‚

##### NLL
å¯¹äºè¿™ç§ç¼–è¯‘å™¨ä¼˜åŒ–è¡Œä¸ºï¼ŒRust ä¸“é—¨èµ·äº†ä¸€ä¸ªåå­— â€”â€” Non-Lexical Lifetimes(NLL)ï¼Œä¸“é—¨ç”¨äºæ‰¾åˆ°æŸä¸ªå¼•ç”¨åœ¨ä½œç”¨åŸŸ(})ç»“æŸå‰å°±ä¸å†è¢«ä½¿ç”¨çš„ä»£ç ä½ç½®ã€‚

è™½ç„¶è¿™ç§å€Ÿç”¨é”™è¯¯æœ‰çš„æ—¶å€™ä¼šè®©æˆ‘ä»¬å¾ˆéƒé—·ï¼Œä½†æ˜¯ä½ åªè¦æƒ³æƒ³è¿™æ˜¯ Rust æå‰å¸®ä½ å‘ç°äº†æ½œåœ¨çš„ BUGï¼Œå…¶å®å°±å¼€å¿ƒäº†ï¼Œè™½ç„¶å‡æ…¢äº†å¼€å‘é€Ÿåº¦ï¼Œä½†æ˜¯ä»é•¿æœŸæ¥çœ‹ï¼Œå¤§å¹…å‡å°‘äº†åç»­å¼€å‘å’Œè¿ç»´æˆæœ¬ã€‚

##### æ‚¬å‚å¼•ç”¨(Dangling References)
æ‚¬å‚å¼•ç”¨ä¹Ÿå«åšæ‚¬å‚æŒ‡é’ˆï¼Œæ„æ€ä¸ºæŒ‡é’ˆæŒ‡å‘æŸä¸ªå€¼åï¼Œè¿™ä¸ªå€¼è¢«é‡Šæ”¾æ‰äº†ï¼Œè€ŒæŒ‡é’ˆä»ç„¶å­˜åœ¨ï¼Œå…¶æŒ‡å‘çš„å†…å­˜å¯èƒ½ä¸å­˜åœ¨ä»»ä½•å€¼æˆ–å·²è¢«å…¶å®ƒå˜é‡é‡æ–°ä½¿ç”¨ã€‚åœ¨ Rust ä¸­ç¼–è¯‘å™¨å¯ä»¥ç¡®ä¿å¼•ç”¨æ°¸è¿œä¹Ÿä¸ä¼šå˜æˆæ‚¬å‚çŠ¶æ€ï¼šå½“ä½ è·å–æ•°æ®çš„å¼•ç”¨åï¼Œç¼–è¯‘å™¨å¯ä»¥ç¡®ä¿æ•°æ®ä¸ä¼šåœ¨å¼•ç”¨ç»“æŸå‰è¢«é‡Šæ”¾ï¼Œè¦æƒ³é‡Šæ”¾æ•°æ®ï¼Œå¿…é¡»å…ˆåœæ­¢å…¶å¼•ç”¨çš„ä½¿ç”¨ã€‚

è®©æˆ‘ä»¬å°è¯•åˆ›å»ºä¸€ä¸ªæ‚¬å‚å¼•ç”¨ï¼ŒRust ä¼šæŠ›å‡ºä¸€ä¸ªç¼–è¯‘æ—¶é”™è¯¯ï¼š
```rust
fn main() {
    let reference_to_nothing = dangle();
}

fn dangle() -> &String {
    let s = String::from("hello");

    &s
}
```
è¿™é‡Œæ˜¯é”™è¯¯ï¼š
```
error[E0106]: missing lifetime specifier
 --> src/main.rs:5:16
  |
5 | fn dangle() -> &String {
  |                ^ expected named lifetime parameter
  |
  = help: this function's return type contains a borrowed value, but there is no value for it to be borrowed from
help: consider using the `'static` lifetime
  |
5 | fn dangle() -> &'static String {
  |                ~~~~~~~~
```
é”™è¯¯ä¿¡æ¯å¼•ç”¨äº†ä¸€ä¸ªæˆ‘ä»¬è¿˜æœªä»‹ç»çš„åŠŸèƒ½ï¼šç”Ÿå‘½å‘¨æœŸ(lifetimes)ã€‚ä¸è¿‡ï¼Œå³ä½¿ä½ ä¸ç†è§£ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿå¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯çŸ¥é“è¿™æ®µä»£ç é”™è¯¯çš„å…³é”®ä¿¡æ¯ï¼š


this function's return type contains a borrowed value, but there is no value for it to be borrowed from.
è¯¥å‡½æ•°è¿”å›äº†ä¸€ä¸ªå€Ÿç”¨çš„å€¼ï¼Œä½†æ˜¯å·²ç»æ‰¾ä¸åˆ°å®ƒæ‰€å€Ÿç”¨å€¼çš„æ¥æº

ä»”ç»†çœ‹çœ‹ dangle ä»£ç çš„æ¯ä¸€æ­¥åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼š

```rust
fn dangle() -> &String { // dangle è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼•ç”¨

    let s = String::from("hello"); // s æ˜¯ä¸€ä¸ªæ–°å­—ç¬¦ä¸²

    &s // è¿”å›å­—ç¬¦ä¸² s çš„å¼•ç”¨
} // è¿™é‡Œ s ç¦»å¼€ä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒã€‚å…¶å†…å­˜è¢«é‡Šæ”¾ã€‚
  // å±é™©ï¼
```
å› ä¸º s æ˜¯åœ¨ dangle å‡½æ•°å†…åˆ›å»ºçš„ï¼Œå½“ dangle çš„ä»£ç æ‰§è¡Œå®Œæ¯•åï¼Œs å°†è¢«é‡Šæ”¾ï¼Œä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬åˆå°è¯•å»è¿”å›å®ƒçš„å¼•ç”¨ã€‚è¿™æ„å‘³ç€è¿™ä¸ªå¼•ç”¨ä¼šæŒ‡å‘ä¸€ä¸ªæ— æ•ˆçš„ Stringï¼Œè¿™å¯ä¸å¯¹ï¼

å…¶ä¸­ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ³•æ˜¯ç›´æ¥è¿”å› Stringï¼š
```rust
fn no_dangle() -> String {
    let s = String::from("hello");

    s
}
```
è¿™æ ·å°±æ²¡æœ‰ä»»ä½•é”™è¯¯äº†ï¼Œæœ€ç»ˆ String çš„ æ‰€æœ‰æƒè¢«è½¬ç§»ç»™å¤–é¢çš„è°ƒç”¨è€…ã€‚

#### å€Ÿç”¨è§„åˆ™æ€»ç»“
æ€»çš„æ¥è¯´ï¼Œå€Ÿç”¨è§„åˆ™å¦‚ä¸‹ï¼š
- åŒä¸€æ—¶åˆ»ï¼Œä½ åªèƒ½æ‹¥æœ‰è¦ä¹ˆä¸€ä¸ªå¯å˜å¼•ç”¨, è¦ä¹ˆä»»æ„å¤šä¸ªä¸å¯å˜å¼•ç”¨
- å¼•ç”¨å¿…é¡»æ€»æ˜¯æœ‰æ•ˆçš„

è‡³æ­¤ï¼Œæˆ‘ç»ˆäºæ¬å®Œäº†ï¼Œç´¯æ­»äº†ï¼

## 1.4 ğŸ—› å­—ç¬¦ä¸²

å…ˆè¯•è¯•è¿™æ®µä»£ç çš„ç»“æœæ˜¯æ€æ ·çš„ï¼Ÿ
```rust
fn main() {
  let my_name = "Pascal";
  greet(my_name);
}

fn greet(name: String) {
  println!("Hello, {}!", name);
}
```



è¿™æ®µä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºåœ¨è°ƒç”¨ greet å‡½æ•°æ—¶ï¼Œmy_name åªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼ˆ&strï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª String ç±»å‹ã€‚åœ¨ Rust ä¸­ï¼Œ&str å’Œ String æ˜¯ä¸¤ç§ä¸åŒçš„å­—ç¬¦ä¸²ç±»å‹ï¼ŒString æ˜¯å¯å˜çš„ï¼Œè€Œ &str æ˜¯ä¸å¯å˜çš„ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ‚¨å¯ä»¥å°† greet å‡½æ•°çš„å‚æ•°ç±»å‹æ›´æ”¹ä¸º &strï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```
error[E0308]: mismatched types
 --> src/main.rs:3:9
  |
3 |   greet(my_name);
  |         ^^^^^^^- help: try using a conversion method: `.to_string()` // å°è¯•ä½¿ç”¨è½¬æ¢æ–¹æ³•ï¼š'.to_stringï¼ˆï¼‰'
  |         |
  |         expected struct `String`, found `&str` // å½“å‰ç»“æ„'String'ï¼Œé¢„æœŸæ‰¾åˆ°'&str'

For more information about this error, try `rustc --explain E0308`.
error: could not compile `Demo` due to previous error
```

è§£å†³æ–¹æ¡ˆï¼š

```rust
fn main() {
  let my_name = "Pascal";
  greet(my_name);
}

fn greet(name: &str) {
  println!("Hello, {}!", name);
}
```

### åˆ‡ç‰‡(slice)
ä¸‹é¢å…ˆå†™ä¸€ä¸ªGoè¯­è¨€å’ŒPythonè¯­è¨€çš„åˆ‡ç‰‡ï¼Œæ–¹ä¾¿æ¸å…¥ä½³å¢ƒ

Goè¯­è¨€
```go
package main

import "fmt"

func main() {
    // åˆ›å»ºåˆ‡ç‰‡
    numbers := []int{1, 2, 3, 4, 5}

    // è¾“å‡ºåˆ‡ç‰‡
    fmt.Println("åˆ‡ç‰‡ numbersï¼š", numbers)

    // åˆ‡ç‰‡ä»ç´¢å¼• 1 åˆ°ç´¢å¼• 4
    fmt.Println("numbers[1:4]ï¼š", numbers[1:4])

    // é»˜è®¤ä¸‹é™ä¸º0
    fmt.Println("numbers[:3]ï¼š", numbers[:3])

    // é»˜è®¤ä¸Šé™ä¸º len(s)
    fmt.Println("numbers[2:]ï¼š", numbers[2:])

    // åˆ›å»ºä¸€ä¸ªåˆ‡ç‰‡ï¼Œlen=0ï¼Œcap=2
    slice1 := make([]int, 0, 2)
    fmt.Println("slice1ï¼š", slice1)

    // è¿½åŠ å…ƒç´ 
    slice1 = append(slice1, 1)
    fmt.Println("slice1ï¼š", slice1)

    // è¿½åŠ å¤šä¸ªå…ƒç´ 
    slice1 = append(slice1, 2, 3, 4)
    fmt.Println("slice1ï¼š", slice1)
}
```

Pythonï¼š
```python
# åˆ›å»ºåˆ—è¡¨
numbers = [1, 2, 3, 4, 5]

# è¾“å‡ºåˆ—è¡¨
print("åˆ—è¡¨ numbersï¼š", numbers)

# åˆ‡ç‰‡ä»ç´¢å¼• 1 åˆ°ç´¢å¼• 4
print("numbers[1:4]ï¼š", numbers[1:4])

# é»˜è®¤ä¸‹é™ä¸º0
print("numbers[:3]ï¼š", numbers[:3])

# é»˜è®¤ä¸Šé™ä¸º len(s)
print("numbers[2:]ï¼š", numbers[2:])

# åˆ›å»ºä¸€ä¸ªåˆ—è¡¨
list1 = []

# è¿½åŠ å…ƒç´ 
list1.append(1)
print("list1ï¼š", list1)

# è¿½åŠ å¤šä¸ªå…ƒç´ 
list1.extend([2, 3, 4])
print("list1ï¼š", list1)
```

rustï¼š
![](https://pic1.zhimg.com/80/v2-69da917741b2c610732d8526a9cc86f5_1440w.jpg)

```rust 
fn main() {
  let s = String::from("hello world");

  let hello = &s[0..5];
  let world = &s[6..11];
  println!("{}, {}", hello, world);
  // hello, world
}
```
å½“ç„¶ï¼Œä½ å¯ä»¥æ¨ªåˆ‡ç«–åˆ‡ï¼Œæƒ³æ€ä¹ˆåˆ‡æ€ä¹ˆåˆ‡ï¼š
1. ä»0å¼€å§‹åˆ‡
```rust
fn main() {
  let s = String::from("hello world");

  let tmp = &s[..2];
  println!("{:?}", tmp); // he
}
```
2. ä»æŸä¸ªä½ç½®åˆ‡åˆ°å°¾å·´
```rust
fn main() {
  let s = String::from("hello world");

  let tmp = &s[2..s.len()];
  println!("{:?}", tmp); // llo world
}
```
3. å®Œæ•´åˆ‡
```rust
fn main() {
  let s = String::from("hello world");

  let tmp = &s[..];
  println!("{:?}", tmp); // hello world
}
```

âš ï¸ warningï¼šåœ¨å¯¹å­—ç¬¦ä¸²ä½¿ç”¨åˆ‡ç‰‡è¯­æ³•æ—¶éœ€è¦æ ¼å¤–å°å¿ƒï¼Œåˆ‡ç‰‡çš„ç´¢å¼•å¿…é¡»è½åœ¨å­—ç¬¦ä¹‹é—´çš„è¾¹ç•Œä½ç½®ï¼Œä¹Ÿå°±æ˜¯ UTF-8 å­—ç¬¦çš„è¾¹ç•Œï¼Œä¾‹å¦‚ä¸­æ–‡åœ¨ UTF-8 ä¸­å ç”¨ä¸‰ä¸ªå­—èŠ‚ï¼Œä¸‹é¢çš„ä»£ç å°±ä¼šå´©æºƒï¼š

```rust
fn main() {
  let s = "ä¸­å›½äºº";
  let a = &s[0..2];
  println!("{}",a);
}
```

```
thread 'main' panicked at 'byte index 2 is not a char boundary; it is inside 'ä¸­' (bytes 0..3) of `ä¸­å›½äºº`', library/core/src/str/mod.rs:127:5
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

ä¸»çº¿ç¨‹åœ¨å­—èŠ‚ç´¢å¼•2å¤„ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªcharè¾¹ç•Œï¼›å®ƒåœ¨'ä¸­å›½äºº"ï¼Œ Library/core/src/str/mod.rs:127ï¼š5çš„'ä¸­'ï¼ˆå­—èŠ‚0â€¦3ï¼‰ä¸­
æ³¨æ„ï¼šä½¿ç”¨'RUST_BACKTRACE=1'ç¯å¢ƒå˜é‡è¿è¡Œä»¥æ˜¾ç¤ºå›æº¯
```

å› ä¸ºæˆ‘ä»¬åªå– s å­—ç¬¦ä¸²çš„å‰ä¸¤ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯æœ¬ä¾‹ä¸­æ¯ä¸ªæ±‰å­—å ç”¨ä¸‰ä¸ªå­—èŠ‚ï¼Œå› æ­¤æ²¡æœ‰è½åœ¨è¾¹ç•Œå¤„ï¼Œä¹Ÿå°±æ˜¯è¿ ä¸­ å­—éƒ½å–ä¸å®Œæ•´ï¼Œæ­¤æ—¶ç¨‹åºä¼šç›´æ¥å´©æºƒé€€å‡ºï¼Œå¦‚æœæ”¹æˆ &s[0..3]ï¼Œåˆ™å¯ä»¥æ­£å¸¸é€šè¿‡ç¼–è¯‘ã€‚ 

```
fn main() {
  let s = "ä¸­å›½äºº";
  let a = &s[0..3];
  println!("{}",a);
}
```

å­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç±»å‹æ ‡è¯†æ˜¯ `&str`
åœ¨è¿™é‡Œå…¶å®æœ‰ç‚¹æ··ä¹±ï¼Œ`String`å’Œ`&str`æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ
> - Stringæ˜¯ä¸€ä¸ªæ‹¥æœ‰æ‰€æœ‰æƒçš„å¯å˜å­—ç¬¦ä¸²ç±»å‹ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥åŠ¨æ€åœ°å¢åŠ æˆ–ç¼©å°å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå› ä¸ºå®ƒåœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨åœ°è°ƒæ•´å¤§å°ä»¥é€‚åº”æ›´æ”¹ã€‚
> - &stræ˜¯ä¸€ä¸ªä¸å¯å˜çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²æ•°æ®çš„å¼•ç”¨ã€‚è¿™æ„å‘³ç€å®ƒä¸èƒ½åŠ¨æ€åœ°æ”¹å˜å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå› ä¸ºå®ƒåªæ˜¯å­—ç¬¦ä¸²æ•°æ®çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯å®é™…çš„å­—ç¬¦ä¸²ã€‚å› æ­¤ï¼Œ&stré€šå¸¸ç”¨äºä¸éœ€è¦ä¿®æ”¹å­—ç¬¦ä¸²çš„æƒ…å†µï¼Œä¾‹å¦‚å‡½æ•°å‚æ•°ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²æ•°æ®ä¸éœ€è¦æ‹¥æœ‰æ‰€æœ‰æƒæ—¶ä½¿ç”¨ã€‚

```rust
fn main() {
    // åˆ›å»ºä¸€ä¸ªStringç±»å‹çš„å­—ç¬¦ä¸²
    let mut s = String::from("hello");

    // åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ä¸€ä¸ªå­—ç¬¦
    s.push(' ');

    // æ·»åŠ ä¸€ä¸ª&strç±»å‹çš„å­—ç¬¦ä¸²
    s.push_str("world");

    // ä½¿ç”¨&æ“ä½œç¬¦å°†Stringç±»å‹çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º&strç±»å‹çš„å­—ç¬¦ä¸²åˆ‡ç‰‡
    let slice = &s[..];

    println!("{}", slice);
}
```
åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Stringç±»å‹çš„så˜é‡åˆ›å»ºä¸€ä¸ªå¯å˜å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨å…¶æœ«å°¾æ·»åŠ å­—ç¬¦å’Œå­—ç¬¦ä¸²ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨&æ“ä½œç¬¦å°†Stringç±»å‹çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º&strç±»å‹çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™sliceå˜é‡ã€‚æœ€åï¼Œæˆ‘ä»¬æ‰“å°sliceå˜é‡ï¼Œå®ƒåŒ…å«å®Œæ•´çš„"hello world"å­—ç¬¦ä¸²ã€‚

æœ‰äº†è¿™ä¸ªç†è§£å°±å¯ä»¥æ¥çœ‹æ¯”è¾ƒå¦™çš„ä»£ç äº†ï¼š

```rust
fn main() {
    let mut s = String::from("hello world");

    let word = first_word(&s);

    s.clear(); // error!

    println!("the first word is: {}", word);
}
fn first_word(s: &String) -> &str {
    &s[..1]
}
```

æˆ‘çš„ç†è§£æ˜¯ï¼š
- `let mut s = String::from("hello world");` è¿™é‡Œæ˜¯Stringï¼Œæ‹¥æœ‰æ‰€æœ‰æƒçš„å¯å˜å­—ç¬¦ä¸²ç±»å‹
- `let word = first_word(&s);` è¿”å›ä¸€ä¸ª`&str`ï¼Œä¸å¯å˜çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹
- `s.clear()` éœ€è¦ä¸€ä¸ªå¯å˜å€Ÿç”¨ï¼Œä½†æ˜¯ç°åœ¨å·²ç»ï¼ˆwordï¼‰æ˜¯`&str`ï¼Œä¸å¯å˜çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹
- `println!("the first word is: {}", word);` éœ€è¦ä¸€ä¸ªä¸å¯å˜å€Ÿç”¨ï¼Œåœ¨ s.clear() å¤„å¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨è¯•å›¾åŒæ—¶ç”Ÿæ•ˆï¼Œå› æ­¤ç¼–è¯‘æ— æ³•é€šè¿‡ã€‚

```
error[E0502]: cannot borrow `s` as mutable because it is also borrowed as immutable
 --> src/main.rs:6:5
  |
4 |     let word = first_word(&s);
  |                           -- immutable borrow occurs here // ä¸å¯å˜çš„å€Ÿç”¨å‘ç”Ÿåœ¨è¿™é‡Œ
5 | 
6 |     s.clear(); // error!
  |     ^^^^^^^^^ mutable borrow occurs here // å¯å˜å€Ÿç”¨å‘ç”Ÿåœ¨è¿™é‡Œ
7 | 
8 |     println!("the first word is: {}", word);
  |                                       ---- immutable borrow later used here // ä¸å¯å˜å€Ÿåæ¥ç”¨åœ¨è¿™é‡Œ

For more information about this error, try `rustc --explain E0502`.
error: could not compile `Demo` due to previous error
```

> æ³¨ï¼šåœ¨Rustä¸­ï¼Œå¯ä»¥ä½¿ç”¨&æ“ä½œç¬¦å°†Stringç±»å‹çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º&strç±»å‹çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ã€‚è¿™ç§è½¬æ¢å¹¶ä¸æ¶‰åŠå†…å­˜åˆ†é…æˆ–å¤åˆ¶ï¼Œå› ä¸º&stråªæ˜¯ä¸€ä¸ªæŒ‡å‘Stringç±»å‹å­—ç¬¦ä¸²çš„ä¸å¯å˜å¼•ç”¨ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&strå¼•ç”¨çš„å­—ç¬¦ä¸²å¿…é¡»åœ¨Stringå˜é‡çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ‚¬å‚å¼•ç”¨é”™è¯¯ã€‚

### å­—ç¬¦ä¸²å­—é¢é‡æ˜¯åˆ‡ç‰‡
ä¹‹å‰æåˆ°è¿‡å­—ç¬¦ä¸²å­—é¢é‡,ä½†æ˜¯æ²¡æœ‰æåˆ°å®ƒçš„ç±»å‹ï¼š

```rust
let s = "Hello, world!";
```

å®é™…ä¸Šï¼Œs çš„ç±»å‹æ˜¯ &strï¼Œå› æ­¤ä½ ä¹Ÿå¯ä»¥è¿™æ ·å£°æ˜ï¼š

```rust
let s: &str = "Hello, world!";
```

è¯¥åˆ‡ç‰‡æŒ‡å‘äº†ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æŸä¸ªç‚¹ï¼Œ**è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä¸å¯å˜çš„ï¼Œå› ä¸º &str æ˜¯ä¸€ä¸ªä¸å¯å˜å¼•ç”¨**ã€‚

### å­—ç¬¦ä¸²ç±»å‹
- str ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹
- String åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œå½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ String ç±»å‹å’Œ &str å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç ã€‚
- &str å­—ç¬¦ä¸²åˆ‡ç‰‡

### String ä¸ &str çš„è½¬æ¢
 
 &str ç±»å‹ç”Ÿæˆ String ç±»å‹çš„æ“ä½œï¼š
```rust
String::from("hello,world")
"hello,world".to_string()
```

 String ç±»å‹è½¬ä¸º &str ç±»å‹ -- å¼•ç”¨ï¼š
 
```rust
fn main() {
    let s = String::from("hello,world!"); // String
    say_hello(&s); // è¿™é‡Œå¼€å§‹è½¬æ¢æˆ&str
    say_hello(&s[..]);
    say_hello(s.as_str());
}

fn say_hello(s: &str) {
    println!("{}",s);
}
```

### å­—ç¬¦ä¸²ç´¢å¼•
åœ¨Rustä¸­ä¸‹é¢çš„ä»£ç å¦‚æœä½¿ç”¨`a[0]`åˆ™æ— æ³•è®¿é—®ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä½œä¸ºä¸€åJavaç¨‹åºå‘˜ï¼Œæ„Ÿè§‰å¾ˆè›‹ç–¼
```rust
fn main() {
    let a = "123";
    println!("{}", a[0]); // error
    println!("{}", &a[..2]); // running!
}
```
æŠ¥é”™å†…å®¹å¦‚ä¸‹ï¼š
```rust
error[E0277]: the type `str` cannot be indexed by `{integer}`
 --> src/main.rs:3:20
  |
3 |     println!("{}", a[0]); // error
  |                    ^^^^ string indices are ranges of `usize`
  |
  = help: the trait `SliceIndex<str>` is not implemented for `{integer}`
  = note: you can use `.chars().nth()` or `.bytes().nth()`
          for more information, see chapter 8 in The Book: <https://doc.rust-lang.org/book/ch08-02-strings.html#indexing-into-strings>
  = help: the trait `SliceIndex<[T]>` is implemented for `usize`
  = note: required because of the requirements on the impl of `Index<{integer}>` for `str`

For more information about this error, try `rustc --explain E0277`.
error: could not compile `Demo` due to previous error
```

#### åŸå› åˆ†æ
1. Rust å­—ç¬¦ä¸²åº•å±‚æ•°æ®å­˜å‚¨æ ¼å¼æ˜¯` Vec<u8>`ï¼Œä¸€ä¸ªå­—èŠ‚æ•°ç»„ã€‚å¯¹äºå¤šå­—èŠ‚å­—ç¬¦ï¼Œæ¯”å¦‚æ±‰å­—ï¼Œä¸€ä¸ªå­—ç¬¦å¯èƒ½ä¼šå ç”¨å¤šä¸ªå­—èŠ‚ï¼Œå› æ­¤å­—ç¬¦ä¸²é•¿åº¦ä¸å­—èŠ‚æ•°å¹¶ä¸ä¸€å®šç›¸ç­‰ã€‚

```rust
let s = String::from("ä¸­å›½äºº");
let bytes = s.as_bytes();
println!("{:?}", bytes); // è¾“å‡º [228, 184, 173, 229, 155, 189, 228, 184, 128]
```

2. Rust æä¾›äº†ä¸åŒçš„å­—ç¬¦ä¸²å±•ç°æ–¹å¼ï¼ŒåŒ…æ‹¬å­—èŠ‚ä¸²ã€Unicode å­—ç¬¦ä¸²å’Œè¯­è¨€å­—ç¬¦ä¸²ã€‚å­—èŠ‚ä¸²æ˜¯åº•å±‚å­—èŠ‚æ•°ç»„çš„ç›´æ¥å±•ç°ï¼ŒUnicode å­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ chars() æ–¹æ³•è·å–ï¼Œè¯­è¨€å­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ graphemes() æ–¹æ³•è·å–ã€‚

```rust
let s = String::from("à¤¨à¤®à¤¸à¥à¤¤à¥‡");
let bytes = s.as_bytes(); // å­—èŠ‚ä¸²
let chars = s.chars(); // Unicode å­—ç¬¦ä¸²
let graphemes = s.graphemes(true); // è¯­è¨€å­—ç¬¦ä¸²
println!("{:?}", bytes); // è¾“å‡º [224, 164, 168, 224, 164, 174, 224, 164, 184, 224, 165, 141, 224, 164, 164, 224, 165, 135]
println!("{:?}", chars.collect::<Vec<char>>()); // è¾“å‡º ['à¤¨', 'à¤®', 'à¤¸', 'à¥', 'à¤¤', 'à¥‡']
println!("{:?}", graphemes.collect::<Vec<&str>>()); // è¾“å‡º ["à¤¨", "à¤®", "à¤¸à¥", "à¤¤à¥‡"]
```

3. Rust ä¸å…è®¸ç›´æ¥ç´¢å¼•å­—ç¬¦ä¸²ï¼Œå³ä¸èƒ½ä½¿ç”¨ç±»ä¼¼ `str[index]` çš„æ–¹å¼è·å–å­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—ç¬¦ã€‚è¿™æ˜¯å› ä¸ºå­—ç¬¦ä¸²çš„å­—ç¬¦å¯èƒ½å ç”¨å¤šä¸ªå­—èŠ‚ï¼Œå› æ­¤æ— æ³•ä¿è¯ O(1) çš„æ€§èƒ½è¡¨ç°ã€‚å¦‚æœç¡®å®éœ€è¦è®¿é—®å­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨è¿­ä»£å™¨æˆ–è€…å­—ç¬¦åˆ‡ç‰‡ç­‰æ–¹å¼æ¥éå†å­—ç¬¦ä¸²ã€‚

```rust
let s = String::from("Hello, world!");
let third = s.chars().nth(2); // ç¬¬ä¸‰ä¸ªå­—ç¬¦ï¼Œè¿”å› Option<char>
let slice = &s[0..5]; // å­—ç¬¦åˆ‡ç‰‡ï¼ŒåŒ…å« s[0] åˆ° s[4]
println!("{:?}", third); // è¾“å‡º Some('l')
println!("{:?}", slice); // è¾“å‡º "Hello"
```

### å­—ç¬¦ä¸²çš„ä¸€äº›å¸¸ç”¨API

#### è¿½åŠ (push)
é¦–å…ˆä»‹ç»`push`å’Œ`push_str`
> pub fn push_str(&mut self, string: &str)
å°†ç»™å®šçš„å­—ç¬¦ä¸²åˆ‡ç‰‡è¿½åŠ åˆ°è¿™ä¸ª String çš„æœ«å°¾ã€‚

```rust
let mut s = String::from("foo");

s.push_str("bar");

assert_eq!("foobar", s);
```

> pub fn push(&mut self, ch: char)
å°†ç»™å®šçš„ char è¿½åŠ åˆ°è¯¥ String çš„æœ«å°¾ã€‚


```rust
let mut s = String::from("abc");

s.push('1');
s.push('2');
s.push('3');

assert_eq!("abc123", s);
```

> æ³¨ï¼šç›®å‰åªè¦çŸ¥é“åŒºåˆ«æ˜¯ï¼špush() æ–¹æ³•åªèƒ½æ·»åŠ å•ä¸ªå­—ç¬¦ï¼Œå¦‚æœæƒ³è¦æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—ç¬¦åˆ‡ç‰‡å†ä½¿ç”¨ push_str() æ–¹æ³•ã€‚

#### æ’å…¥(Insert)
> pub fn insert(&mut self, idx: usize, ch: char)
åœ¨æ­¤ String çš„å­—èŠ‚ä½ç½®æ’å…¥ä¸€ä¸ªå­—ç¬¦ã€‚è¿™æ˜¯ä¸€ä¸ª O(n) æ“ä½œï¼Œå› ä¸ºå®ƒéœ€è¦å¤åˆ¶ç¼“å†²åŒºä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚

```rust
let mut s = String::with_capacity(3);

s.insert(0, 'f');
s.insert(1, 'o');
s.insert(2, 'o');

assert_eq!("foo", s);
```


> pub fn insert_str(&mut self, idx: usize, string: &str)
   åœ¨æ­¤ String çš„å­—èŠ‚ä½ç½®å¤„æ’å…¥å­—ç¬¦ä¸²åˆ‡ç‰‡ã€‚è¿™æ˜¯ä¸€ä¸ª O(n) æ“ä½œï¼Œå› ä¸ºå®ƒéœ€è¦å¤åˆ¶ç¼“å†²åŒºä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚

```rust
let mut s = String::from("bar");

s.insert_str(0, "foo");

assert_eq!("foobar", s);
```



#### æ›¿æ¢(Replace)
> pub fn replace<'a, P>(&'a self, from: P, to: &str) -> String
> ç”¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢æ¨¡å¼çš„æ‰€æœ‰åŒ¹é…é¡¹ã€‚
> replace åˆ›å»ºä¸€ä¸ªæ–°çš„ Stringï¼Œå¹¶å°†æ­¤å­—ç¬¦ä¸²åˆ‡ç‰‡ä¸­çš„æ•°æ®å¤åˆ¶åˆ°å…¶ä¸­ã€‚ è¿™æ ·åšæ—¶ï¼Œå®ƒå°†å°è¯•æŸ¥æ‰¾æŸä¸ªæ¨¡å¼çš„åŒ¹é…é¡¹ã€‚ å¦‚æœæ‰¾åˆ°ï¼Œåˆ™å°†å…¶æ›¿æ¢ä¸ºæ›¿æ¢å­—ç¬¦ä¸²åˆ‡ç‰‡ã€‚


```rust
let s = "this is old";

assert_eq!("this is new", s.replace("old", "new"));
```
å½“æ¨¡å¼ä¸åŒ¹é…æ—¶ï¼š

```rust
let s = "this is old";
assert_eq!(s, s.replace("cookie monster", "little lamb"));
```


> pub fn replacen<'a, P>(&'a self, pat: P, to: &str, count: usize) -> String
> ç”¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢æ¨¡å¼çš„å‰ N ä¸ªåŒ¹é…é¡¹ã€‚
	replacen åˆ›å»ºä¸€ä¸ªæ–°çš„ Stringï¼Œå¹¶å°†æ­¤å­—ç¬¦ä¸²åˆ‡ç‰‡ä¸­çš„æ•°æ®å¤åˆ¶åˆ°å…¶ä¸­ã€‚ è¿™æ ·åšæ—¶ï¼Œå®ƒå°†å°è¯•æŸ¥æ‰¾æŸä¸ªæ¨¡å¼çš„åŒ¹é…é¡¹ã€‚ å¦‚æœæ‰¾åˆ°ä»»ä½•å†…å®¹ï¼Œåˆ™æœ€å¤š count æ¬¡å°†å®ƒä»¬æ›¿æ¢ä¸ºæ›¿æ¢å­—ç¬¦ä¸²åˆ‡ç‰‡ã€‚


```rust
let s = "foo foo 123 foo";
assert_eq!("new new 123 foo", s.replacen("foo", "new", 2));
assert_eq!("faa fao 123 foo", s.replacen('o', "a", 3));
assert_eq!("foo foo new23 foo", s.replacen(char::is_numeric, "new", 1));
```
ä¸åŒ¹é…æ—¶ï¼š

```rust
let s = "this is old";
assert_eq!(s, s.replacen("cookie monster", "little lamb", 10));
```



> pub fn replace_range`<R>`(&mut self, range: R, replace_with: &str) 
>åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šèŒƒå›´ï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸ºç»™å®šçš„å­—ç¬¦ä¸²ã€‚ ç»™å®šçš„å­—ç¬¦ä¸²ä¸å¿…ä¸èŒƒå›´ç›¸åŒã€‚


```rust
let mut s = String::from("Î± is alpha, Î² is beta");
let beta_offset = s.find('Î²').unwrap_or(s.len());

// æ›¿æ¢èŒƒå›´ç›´åˆ°å­—ç¬¦ä¸²ä¸­çš„ Î²
s.replace_range(..beta_offset, "Î‘ is capital alpha; ");
assert_eq!(s, "Î‘ is capital alpha; Î² is beta");
```


#### åˆ é™¤
> pub fn pop(&mut self) -> Option`<char>`
> ä»å­—ç¬¦ä¸²ç¼“å†²åŒºä¸­åˆ é™¤æœ€åä¸€ä¸ªå­—ç¬¦å¹¶è¿”å›å®ƒã€‚
> å¦‚æœ String ä¸ºç©ºï¼Œåˆ™è¿”å› Noneã€‚


```rust
let mut s = String::from("foo");

assert_eq!(s.pop(), Some('o'));
assert_eq!(s.pop(), Some('o'));
assert_eq!(s.pop(), Some('f'));

assert_eq!(s.pop(), None);
```

>pub fn remove(&mut self, idx: usize) -> char
>ä»è¯¥ String çš„å­—èŠ‚ä½ç½®åˆ é™¤ char å¹¶å°†å…¶è¿”å›ã€‚
>è¿™æ˜¯ O(n) æ“ä½œï¼Œå› ä¸ºå®ƒéœ€è¦å¤åˆ¶ç¼“å†²åŒºä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚


```rust
let mut s = String::from("foo");

assert_eq!(s.remove(0), 'f');
assert_eq!(s.remove(1), 'o');
assert_eq!(s.remove(0), 'o');
```

> pub fn truncate(&mut self, new_len: usize)
> å°†æ­¤ String ç¼©çŸ­ä¸ºæŒ‡å®šçš„é•¿åº¦ã€‚
> å¦‚æœ new_len å¤§äºå­—ç¬¦ä¸²çš„å½“å‰é•¿åº¦ï¼Œåˆ™æ— æ•ˆã€‚
> è¯·æ³¨æ„ï¼Œæ­¤æ–¹æ³•å¯¹å­—ç¬¦ä¸²çš„åˆ†é…å®¹é‡æ²¡æœ‰å½±å“


```rust
let mut s = String::from("hello");

s.truncate(2);

assert_eq!("he", s);
```

> pub fn clear(&mut self)
> æˆªæ–­æ­¤ Stringï¼Œåˆ é™¤æ‰€æœ‰å†…å®¹ã€‚
> è™½ç„¶è¿™æ„å‘³ç€ String çš„é•¿åº¦ä¸ºé›¶ï¼Œä½†å®ƒå¹¶æœªè§¦åŠå…¶å®¹é‡ã€‚


```rust
let mut s = String::from("foo");

s.clear();

assert!(s.is_empty());
assert_eq!(0, s.len());
assert_eq!(3, s.capacity());
```


#### è¿æ¥ (Concatenate)

1. ä½¿ç”¨ + æˆ–è€… += è¿æ¥å­—ç¬¦ä¸²
ç†è®ºä¸Šæ¥è¯´ï¼Œå¯¹äºJavaç¨‹åºå‘˜ï¼Œç›´æ¥ä¸Šå°±å®Œäº‹ã€‚But

```rust
fn main() {
    let string_append = String::from("hello ");
    let string_rust = String::from("rust");
    println!("{}", string_append + string_rust)
}
```
æŠ¥é”™å¦‚ä¸‹ï¼š

```
error[E0308]: mismatched types
 --> src/main.rs:4:36
  |
4 |     println!("{}", string_append + string_rust)
  |                                    ^^^^^^^^^^^
  |                                    |
  |                                    expected `&str`, found struct `String`
  |                                    help: consider borrowing here: `&string_rust`

For more information about this error, try `rustc --explain E0308`.
error: could not compile `Demo` due to previous error
```
æŸ¥çœ‹åˆ«äººå†™ä»£ç æ˜¯è¿™æ ·ï¼š
> let result = string_append + &string_rust;

ç„¶åå°±æœ‰è¿™æ ·çš„ç–‘æƒ‘ï¼š`ä¸ºä»€ä¹ˆæˆ‘è¿›è¡Œå­—ç¬¦ä¸²è¿æ¥çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªStringç±»å‹çš„ä¸ç”¨å¼•ç”¨ï¼Œç¬¬äºŒä¸ªä»¥åŠåé¢çš„è¦å¼•ç”¨ï¼Ÿ`
åŸå› æ˜¯ï¼Œåœ¨ Rust ä¸­ï¼Œ+ è¿ç®—ç¬¦ç”¨äºå­—ç¬¦ä¸²è¿æ¥ï¼Œä½†æ˜¯å®ƒçš„å®ç°æ–¹å¼ä¸æˆ‘ä»¬ç†Ÿæ‚‰çš„åŠ æ³•è¿ç®—ç¬¦ä¸åŒã€‚å…·ä½“æ¥è¯´ï¼Œ+ è¿ç®—ç¬¦ä¼šè°ƒç”¨ add æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„å®šä¹‰å¦‚ä¸‹ï¼š
> fn add(self, s: &str) -> String

å¯ä»¥çœ‹åˆ°ï¼Œadd æ–¹æ³•æ¥æ”¶ä¸€ä¸ª self å‚æ•°å’Œä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ s å‚æ•°ã€‚ç”±äº self å‚æ•°çš„ç±»å‹æ˜¯ Stringï¼Œè€Œ s å‚æ•°çš„ç±»å‹æ˜¯ &strï¼Œå› æ­¤åœ¨ä½¿ç”¨ + è¿ç®—ç¬¦è¿›è¡Œå­—ç¬¦ä¸²è¿æ¥æ—¶ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å¯ä»¥æ˜¯ String ç±»å‹ï¼Œè€Œ`ç¬¬äºŒä¸ªåŠä¹‹åçš„å­—ç¬¦ä¸²å¿…é¡»æ˜¯å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹`ã€‚

æ‰€ä»¥æœ€ç»ˆä»£ç æ˜¯

```rust
fn main() {
    let string_append = String::from("hello ");
    let string_rust = String::from("rust");
    let string_world = String::from("world");
    println!("{}", string_append + &string_rust + &string_world);
}
```
æ€»ç»“ï¼šString + &strè¿”å›ä¸€ä¸ª Stringï¼Œç„¶åå†ç»§ç»­è·Ÿä¸€ä¸ª &str è¿›è¡Œ + æ“ä½œï¼Œè¿”å›ä¸€ä¸ª String ç±»å‹ï¼Œä¸æ–­å¾ªç¯ï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ª sï¼Œä¹Ÿæ˜¯ String ç±»å‹ã€‚

s1 è¿™ä¸ªå˜é‡é€šè¿‡è°ƒç”¨ add() æ–¹æ³•åï¼Œæ‰€æœ‰æƒè¢«è½¬ç§»åˆ° add() æ–¹æ³•é‡Œé¢ï¼Œ add() æ–¹æ³•è°ƒç”¨åå°±è¢«é‡Šæ”¾äº†ï¼ŒåŒæ—¶ s1 ä¹Ÿè¢«é‡Šæ”¾äº†ã€‚å†ä½¿ç”¨ s1 å°±ä¼šå‘ç”Ÿé”™è¯¯ã€‚è¿™é‡Œæ¶‰åŠåˆ°`æ‰€æœ‰æƒè½¬ç§»ï¼ˆMoveï¼‰`çš„ç›¸å…³çŸ¥è¯†ã€‚

2. ä½¿ç”¨ format! è¿æ¥å­—ç¬¦ä¸²

```rust
fn main() {
    let s1 = "hello";
    let s2 = String::from("rust");
    let s = format!("{} {}!", s1, s2);
    println!("{}", s);
}
```

### æ“ä½œ UTF-8 å­—ç¬¦ä¸²
å¦‚æœä½ æƒ³è¦ä»¥ Unicode å­—ç¬¦çš„æ–¹å¼éå†å­—ç¬¦ä¸²ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨ chars æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š

```rust
for c in "ä¸­å›½äºº".chars() {
    println!("{}", c);
}
```

å¦‚æœè¦è¿”å›å­—ç¬¦ä¸²çš„åº•å±‚å­—èŠ‚æ•°ç»„è¡¨ç°å½¢å¼ï¼š

```rust
for b in "ä¸­å›½äºº".bytes() {
    println!("{}", b);
}
```

æƒ³è¦å‡†ç¡®çš„ä» UTF-8 å­—ç¬¦ä¸²ä¸­è·å–å­ä¸²æ˜¯è¾ƒä¸ºå¤æ‚çš„äº‹æƒ…ï¼Œä¾‹å¦‚æƒ³è¦ä» hollaä¸­å›½äººà¤¨à¤®à¤¸à¥à¤¤à¥‡ è¿™ç§å˜é•¿çš„å­—ç¬¦ä¸²ä¸­å–å‡ºæŸä¸€ä¸ªå­ä¸²ï¼Œä½¿ç”¨æ ‡å‡†åº“ä½ æ˜¯åšä¸åˆ°çš„ã€‚ ä½ éœ€è¦åœ¨ crates.io ä¸Šæœç´¢ utf8 æ¥å¯»æ‰¾æƒ³è¦çš„åŠŸèƒ½ã€‚

å¯ä»¥è€ƒè™‘å°è¯•ä¸‹è¿™ä¸ªåº“ï¼š`utf8_slice`ã€‚

### å­—ç¬¦ä¸²æ·±åº¦å‰–æ
é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºå•¥ String å¯å˜ï¼Œè€Œå­—ç¬¦ä¸²å­—é¢å€¼ str å´ä¸å¯ä»¥ï¼Ÿ

å°±å­—ç¬¦ä¸²å­—é¢å€¼æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶å°±çŸ¥é“å…¶å†…å®¹ï¼Œæœ€ç»ˆå­—é¢å€¼æ–‡æœ¬è¢«ç›´æ¥ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œè¿™ä½¿å¾—å­—ç¬¦ä¸²å­—é¢å€¼å¿«é€Ÿä¸”é«˜æ•ˆï¼Œè¿™ä¸»è¦å¾—ç›Šäºå­—ç¬¦ä¸²å­—é¢å€¼çš„ä¸å¯å˜æ€§ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½ä¸ºäº†è·å¾—è¿™ç§æ€§èƒ½ï¼Œè€ŒæŠŠæ¯ä¸€ä¸ªåœ¨ç¼–è¯‘æ—¶å¤§å°æœªçŸ¥çš„æ–‡æœ¬éƒ½æ”¾è¿›å†…å­˜ä¸­ï¼ˆä½ ä¹Ÿåšä¸åˆ°ï¼ï¼‰ï¼Œå› ä¸ºæœ‰çš„å­—ç¬¦ä¸²æ˜¯åœ¨ç¨‹åºè¿è¡Œå¾—è¿‡ç¨‹ä¸­åŠ¨æ€ç”Ÿæˆçš„ã€‚

å¯¹äº String ç±»å‹ï¼Œä¸ºäº†æ”¯æŒä¸€ä¸ªå¯å˜ã€å¯å¢é•¿çš„æ–‡æœ¬ç‰‡æ®µï¼Œéœ€è¦åœ¨å †ä¸Šåˆ†é…ä¸€å—åœ¨ç¼–è¯‘æ—¶æœªçŸ¥å¤§å°çš„å†…å­˜æ¥å­˜æ”¾å†…å®¹ï¼Œè¿™äº›éƒ½æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶å®Œæˆçš„ï¼š

é¦–å…ˆå‘æ“ä½œç³»ç»Ÿè¯·æ±‚å†…å­˜æ¥å­˜æ”¾ String å¯¹è±¡
åœ¨ä½¿ç”¨å®Œæˆåï¼Œå°†å†…å­˜é‡Šæ”¾ï¼Œå½’è¿˜ç»™æ“ä½œç³»ç»Ÿ
å…¶ä¸­ç¬¬ä¸€éƒ¨åˆ†ç”± String::from å®Œæˆï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„ Stringã€‚

é‡ç‚¹æ¥äº†ï¼Œåˆ°äº†ç¬¬äºŒéƒ¨åˆ†ï¼Œå°±æ˜¯ç™¾å®¶é½æ”¾çš„ç¯èŠ‚ï¼Œåœ¨æœ‰åƒåœ¾å›æ”¶ GC çš„è¯­è¨€ä¸­ï¼ŒGC æ¥è´Ÿè´£æ ‡è®°å¹¶æ¸…é™¤è¿™äº›ä¸å†ä½¿ç”¨çš„å†…å­˜å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹éƒ½æ˜¯è‡ªåŠ¨å®Œæˆï¼Œæ— éœ€å¼€å‘è€…å…³å¿ƒï¼Œéå¸¸ç®€å•å¥½ç”¨ï¼›ä½†æ˜¯åœ¨æ—  GC çš„è¯­è¨€ä¸­ï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨å»é‡Šæ”¾è¿™äº›å†…å­˜å¯¹è±¡ï¼Œå°±åƒåˆ›å»ºå¯¹è±¡éœ€è¦é€šè¿‡ç¼–å†™ä»£ç æ¥å®Œæˆä¸€æ ·ï¼Œæœªèƒ½æ­£ç¡®é‡Šæ”¾å¯¹è±¡é€ æˆçš„åæœç®€ç›´ä¸å¯ä¼°é‡ã€‚

å¯¹äº Rust è€Œè¨€ï¼Œå®‰å…¨å’Œæ€§èƒ½æ˜¯å†™åˆ°éª¨å­é‡Œçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå¦‚æœä½¿ç”¨ GCï¼Œé‚£ä¹ˆä¼šç‰ºç‰²æ€§èƒ½ï¼›å¦‚æœä½¿ç”¨æ‰‹åŠ¨ç®¡ç†å†…å­˜ï¼Œé‚£ä¹ˆä¼šç‰ºç‰²å®‰å…¨ï¼Œè¿™è¯¥æ€ä¹ˆåŠï¼Ÿä¸ºæ­¤ï¼ŒRust çš„å¼€å‘è€…æƒ³å‡ºäº†ä¸€ä¸ªæ— æ¯”æƒŠè‰³çš„åŠæ³•ï¼šå˜é‡åœ¨ç¦»å¼€ä½œç”¨åŸŸåï¼Œå°±è‡ªåŠ¨é‡Šæ”¾å…¶å ç”¨çš„å†…å­˜ï¼š

```rust
{
    let s = String::from("hello"); // ä»æ­¤å¤„èµ·ï¼Œs æ˜¯æœ‰æ•ˆçš„

    // ä½¿ç”¨ s
}                                  // æ­¤ä½œç”¨åŸŸå·²ç»“æŸï¼Œ
                                   // s ä¸å†æœ‰æ•ˆï¼Œå†…å­˜è¢«é‡Šæ”¾
```
ä¸å…¶å®ƒç³»ç»Ÿç¼–ç¨‹è¯­è¨€çš„ free å‡½æ•°ç›¸åŒï¼ŒRust ä¹Ÿæä¾›äº†ä¸€ä¸ªé‡Šæ”¾å†…å­˜çš„å‡½æ•°ï¼š dropï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œå…¶å®ƒè¯­è¨€è¦æ‰‹åŠ¨è°ƒç”¨ free æ¥é‡Šæ”¾æ¯ä¸€ä¸ªå˜é‡å ç”¨çš„å†…å­˜ï¼Œè€Œ Rust åˆ™åœ¨å˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ drop å‡½æ•°: ä¸Šé¢ä»£ç ä¸­ï¼ŒRust åœ¨ç»“å°¾çš„ } å¤„è‡ªåŠ¨è°ƒç”¨ dropã€‚

> å…¶å®ï¼Œåœ¨ C++ ä¸­ï¼Œä¹Ÿæœ‰è¿™ç§æ¦‚å¿µ: Resource Acquisition Is Initialization (RAII)ã€‚å¦‚æœä½ ä½¿ç”¨è¿‡ RAII æ¨¡å¼çš„è¯åº”è¯¥å¯¹ Rust çš„ drop å‡½æ•°å¹¶ä¸é™Œç”Ÿã€‚

è¿™ä¸ªæ¨¡å¼å¯¹ç¼–å†™ Rust ä»£ç çš„æ–¹å¼æœ‰ç€æ·±è¿œçš„å½±å“ï¼Œåœ¨åé¢ç« èŠ‚æˆ‘ä»¬ä¼šè¿›è¡Œæ›´æ·±å…¥çš„ä»‹ç»ã€‚

## 1.5 ğŸ¥¥ å…ƒç»„
ä¸å¤šä»‹ç»ï¼Œç›´æ¥çœ‹ç¤ºä¾‹å³å¯ï¼š

```rust
fn main() {
    let s1 = String::from("hello");

    let (s2, len) = calculate_length(s1);

    println!("The length of '{}' is {}.", s2, len);
}

fn calculate_length(s: String) -> (String, usize) {
    let length = s.len(); // len() è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦

    (s, length)
}
```

## 1.6 ğŸ§‡ ç»“æ„ä½“


### ä¸€èˆ¬å®šä¹‰
ç»“æ„ä½“æˆ‘ä¸ªäººè®¤ä¸ºï¼Œå®ƒä¸Goè¯­è¨€ã€c/cppçš„ç»“æ„ä½“æ€æƒ³éƒ½å·®ä¸å¤šï¼Œé‚£ä¹ˆå°±å…ˆç”¨å…¶ä»–è¯­è¨€æ¸å…¥ä½³å¢ƒ

C/C++è¯­è¨€ç»“æ„ä½“ï¼šC/C++è¯­è¨€ä¸­çš„ç»“æ„ä½“å®šä¹‰ä½¿ç”¨å…³é”®å­— structï¼Œå¹¶ä¸”ä½¿ç”¨èŠ±æ‹¬å·åŒ…å«æˆå‘˜å˜é‡ã€‚

```rust
#include <stdio.h>

struct Person {
  char *name;
  int age;
};

int main() {
  struct Person p = {"John", 30};
  printf("Name: %s, Age: %d\n", p.name, p.age);
  return 0;
}
```

Goè¯­è¨€ç»“æ„ä½“ï¼šGoè¯­è¨€ä¸­çš„ç»“æ„ä½“å®šä¹‰ä½¿ç”¨å…³é”®å­— typeï¼Œå¹¶ä¸”ä½¿ç”¨èŠ±æ‹¬å·åŒ…å«æˆå‘˜å˜é‡
```go
package main

import "fmt"

type Person struct {
  name string
  age  int
}

func main() {
  p := Person{"John", 30}
  fmt.Printf("Name: %s, Age: %d\n", p.name, p.age)
}
```

Rustç»“æ„ä½“ï¼šRustè¯­è¨€ä¸­çš„ç»“æ„ä½“å®šä¹‰ä½¿ç”¨å…³é”®å­— structï¼Œå¹¶ä¸”ä½¿ç”¨èŠ±æ‹¬å·åŒ…å«æˆå‘˜å˜é‡ï¼Œä½†æ˜¯æˆå‘˜å˜é‡çš„å®šä¹‰ä½¿ç”¨äº†å†’å·å’Œç±»å‹æ³¨è§£ã€‚

```rust
struct Person {
  name: String,
  age: u32,
}

fn main() {
  let p = Person { name: String::from("John"), age: 30 };
  println!("Name: {}, Age: {}", p.name, p.age);
}
```

### ç»“æ„ä½“çš„å†…å­˜æ’åˆ—
ä¸‹é¢å¯ä»¥æ‰‹æ‰“ä¸‹ä¸‹é¢çš„ä»£ç ï¼š

```rust
#[derive(Debug)]
struct File {
  name: String,
  data: Vec<u8>,
}

fn main() {
  let file = File {
    name: String::from("f1.txt"),
    data: Vec::new()
  };

  let file_name = file.name;
  let file_data_len = file.data.len();

  println!("{:?}", file);
   println!("{} is {} bytes long", file_name, file_data_len);
}
```
å…¶å®è¿™æ®µä»£ç æ˜¯é”™è¯¯çš„ï¼Œåœ¨è¿™æ®µä»£ç ä¸­ï¼Œå½“ä½ ä½¿ç”¨ let file_name = file.name; å’Œ let file_data_len = file.data.len(); æ—¶ï¼Œä½ å°† file çš„ name å’Œ data å­—æ®µçš„æ‰€æœ‰æƒç§»åŠ¨åˆ°äº† file_name å’Œ file_data_len å˜é‡ä¸­ã€‚å› æ­¤ï¼Œå½“ä½ å°è¯•æ‰“å° file å˜é‡æ—¶ï¼Œå®ƒå·²ç»å¤±å»äº† name å’Œ data å­—æ®µçš„æ‰€æœ‰æƒï¼Œå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚æ­£å¥½å¤ä¹ ä¸€ä¸‹æ‰€æœ‰æƒ

åªè¦åŠ ä¸Š`&`å³å¯ï¼Œå‘Šè¯‰Rustå€Ÿæˆ‘ç”¨ä¸‹ï¼Œç”¨å®Œè¿˜ä½ ï¼š

```rust
let file_name = &file.name;
let file_data_len = file.data.len();
```
è¿›å…¥æ­£é¢˜ï¼Œä¸Šé¢å®šä¹‰çš„ File ç»“æ„ä½“åœ¨å†…å­˜ä¸­çš„æ’åˆ—å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![](https://pic3.zhimg.com/80/v2-8cc4ed8cd06d60f974d06ca2199b8df5_1440w.png)
ä»å›¾ä¸­å¯ä»¥æ¸…æ™°åœ°çœ‹å‡º File ç»“æ„ä½“ä¸¤ä¸ªå­—æ®µ name å’Œ data åˆ†åˆ«æ‹¥æœ‰åº•å±‚ä¸¤ä¸ª [u8] æ•°ç»„çš„æ‰€æœ‰æƒ(String ç±»å‹çš„åº•å±‚ä¹Ÿæ˜¯ [u8] æ•°ç»„)ï¼Œé€šè¿‡ ptr æŒ‡é’ˆæŒ‡å‘åº•å±‚æ•°ç»„çš„å†…å­˜åœ°å€ï¼Œè¿™é‡Œä½ å¯ä»¥æŠŠ ptr æŒ‡é’ˆç†è§£ä¸º Rust ä¸­çš„å¼•ç”¨ç±»å‹ã€‚
> å…³äº ptr æŒ‡é’ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘åº•å±‚æ•°ç»„å†…å­˜åœ°å€çš„æŒ‡é’ˆã€‚åœ¨ Rust ä¸­ï¼Œå¼•ç”¨ç±»å‹ä¹Ÿæ˜¯æŒ‡é’ˆç±»å‹ï¼Œå› æ­¤ä½ å¯ä»¥å°† ptr æŒ‡é’ˆç†è§£ä¸º Rust ä¸­çš„å¼•ç”¨ç±»å‹ã€‚å½“ä½ ä½¿ç”¨ & ç¬¦å·æ¥å€Ÿç”¨ name å­—æ®µæ—¶ï¼Œå®é™…ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘ name å­—æ®µåº•å±‚æ•°ç»„å†…å­˜åœ°å€çš„å¼•ç”¨ã€‚è¿™ä¸ªå¼•ç”¨ä¸æ‹¥æœ‰åº•å±‚æ•°ç»„çš„æ‰€æœ‰æƒï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ä¸ç§»åŠ¨æ‰€æœ‰æƒçš„æƒ…å†µä¸‹è®¿é—® name å­—æ®µã€‚

è¯¥å›¾ç‰‡ä¹Ÿä¾§é¢å°è¯äº†ï¼š**æŠŠç»“æ„ä½“ä¸­å…·æœ‰æ‰€æœ‰æƒçš„å­—æ®µè½¬ç§»å‡ºå»åï¼Œå°†æ— æ³•å†è®¿é—®è¯¥å­—æ®µï¼Œä½†æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®å…¶å®ƒçš„å­—æ®µã€‚**

å¾ˆæŠ½è±¡ï¼Œéå¸¸æŠ½è±¡ã€‚ä¸Šé¢è¿™æ®µè¯æ˜¯æˆ‘æ¬è¿äº†ä½œè€…çš„è¯ï¼Œä½†æ˜¯ä¸ªäººæ¥è¯´ä¸æ˜¯å¾ˆç†è§£ã€‚ç»è¿‡ç ”ç©¶æˆ‘çš„ç†è§£æ˜¯ï¼šFile ç»“æ„ä½“çš„ name å’Œ data å­—æ®µéƒ½æ˜¯æ‹¥æœ‰åº•å±‚ [u8] æ•°ç»„çš„æ‰€æœ‰æƒçš„ã€‚åœ¨ Rust ä¸­ï¼ŒString ç±»å‹çš„åº•å±‚ä¹Ÿæ˜¯ [u8] æ•°ç»„ã€‚å› æ­¤ï¼Œname å­—æ®µæ‹¥æœ‰ String ç±»å‹çš„åº•å±‚ [u8] æ•°ç»„çš„æ‰€æœ‰æƒï¼Œè€Œ data å­—æ®µæ‹¥æœ‰ `Vec<u8>` ç±»å‹çš„åº•å±‚ [u8] æ•°ç»„çš„æ‰€æœ‰æƒã€‚
å³ï¼Œåœ¨ Rust ä¸­ï¼Œæ‰€æœ‰æƒæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚å½“ä½ å°†ä¸€ä¸ªæ‹¥æœ‰æ‰€æœ‰æƒçš„å€¼ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå˜é‡ä¸­æ—¶ï¼ŒåŸå§‹å˜é‡å°†å¤±å»å¯¹è¯¥å€¼çš„æ‰€æœ‰æƒã€‚è¿™æ„å‘³ç€ä½ ä¸èƒ½å†è®¿é—®è¯¥å€¼ï¼Œå› ä¸ºå®ƒå·²ç»è¢«ç§»åŠ¨åˆ°äº†å…¶ä»–åœ°æ–¹ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå½“ä½ å°† file.name å’Œ file.data çš„æ‰€æœ‰æƒç§»åŠ¨åˆ° file_name å’Œ file_data_len å˜é‡ä¸­æ—¶ï¼Œfile å˜é‡å°†å¤±å»å¯¹è¿™äº›å€¼çš„æ‰€æœ‰æƒã€‚å› æ­¤ï¼Œä½ ä¸èƒ½å†è®¿é—® file.name å’Œ file.data å­—æ®µäº†ã€‚

æˆ‘ä¸ä¿¡ä¸èƒ½è®¿é—®ï¼Œæ‰€ä»¥æˆ‘åšäº†ä¸‹é¢çš„å®éªŒï¼š

```rust
fn main() {
  let file = File {
    name: String::from("f1.txt"),
    data: Vec::new()
  };

  let file_name = file.name;
  let file_data_len = file.data.len();

  println!("{}", file.name); // error: è½¬ç§»äº†æ‰€æœ‰æƒ
  println!("{}", file.data); // error: è½¬ç§»äº†æ‰€æœ‰æƒ

  println!("{:?}", file);
  println!("{} is {} bytes long", file_name, file_data_len);
}
```
æœç„¶æŠ¥é”™äº†ï¼š

```
error[E0277]: `Vec<u8>` doesn't implement `std::fmt::Display`
  --> src/main.rs:17:18
   |
17 |   println!("{}", file.data);
   |                  ^^^^^^^^^ `Vec<u8>` cannot be formatted with the default formatter // æ— æ³•<u8>ä½¿ç”¨é»˜è®¤æ ¼å¼åŒ–ç¨‹åºæ ¼å¼åŒ–â€œVecâ€
   |
   = help: the trait `std::fmt::Display` is not implemented for `Vec<u8>`
   = helpï¼štrait `stdï¼šï¼šfmtï¼šï¼šDisplay`æœªä¸º`Vec `å®ç°<u8> 
   = note: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
   = æ³¨æ„ï¼šåœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`{ï¼šï¼Ÿ}` (orè”ç³»æˆ‘ä»¬ for pretty-printï¼‰ä»£æ›¿
   = note: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)
   = æ³¨æ„ï¼šæ­¤é”™è¯¯æºäºå®`$crateï¼šï¼šformat_args_nl`ï¼ˆåœ¨Nightly buildä¸­ï¼Œä½¿ç”¨-Zå®å›æº¯è¿è¡Œä»¥è·å–æ›´å¤šä¿¡æ¯ï¼‰
For more information about this error, try `rustc --explain E0277`.
error: could not compile `Demo` due to previous error
```



### å…ƒç»„ç»“æ„ä½“(Tuple Struct)
çœ‹ç¤ºä¾‹å³å¯å­¦ä¹ 
```rust
#![allow(unused)]
fn main() {
    struct Color(i32, i32, i32);
    struct Point(i32, i32, i32);

    let black = Color(0, 0, 0);
    let origin = Point(0, 0, 0);
}

```


### å•å…ƒç»“æ„ä½“(Unit-like Struct)
åœ¨Rustä¸­ï¼Œå•å…ƒç»“æ„ä½“ï¼ˆUnit-like Structï¼‰æ˜¯ä¸€ç§ç±»ä¼¼äºå…ƒç»„ç»“æ„ä½“çš„ç»“æ„ä½“ï¼Œä½†å®ƒä¸åŒ…å«ä»»ä½•å­—æ®µã€‚å…·ä½“æ¥è¯´ï¼Œå•å…ƒç»“æ„ä½“çš„å®šä¹‰å½¢å¼ä¸ºï¼šstruct MyUnitStruct;ï¼Œå®ƒä¸åŒ…å«ä»»ä½•å­—æ®µï¼Œä¹Ÿä¸éœ€è¦ä»»ä½•è¯­å¥ä½œä¸ºç»“æ„ä½“å®šä¹‰çš„ä¸»ä½“ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯åœ¨æŸäº›åœºæ™¯ä¸‹æä¾›ä¸€ç§ç©ºç±»å‹ï¼Œç”¨äºè¡¨ç¤ºæŸä¸ªæ“ä½œæˆ–çŠ¶æ€çš„å­˜åœ¨æˆ–è€…ä¸å­˜åœ¨ã€‚

å•å…ƒç»“æ„ä½“çš„å®šä¹‰å½¢å¼å’Œæ™®é€šç»“æ„ä½“çš„å®šä¹‰å½¢å¼éå¸¸ç±»ä¼¼ï¼Œå®ƒä¹Ÿå¯ä»¥ä½¿ç”¨implå—æ¥ä¸ºå®ƒå®šä¹‰æ–¹æ³•ã€‚åœ¨ä½¿ç”¨å•å…ƒç»“æ„ä½“æ—¶ï¼Œé€šå¸¸åªéœ€è¦ä½¿ç”¨å®ƒçš„ç±»å‹åå³å¯ï¼Œå› ä¸ºå®ƒä¸åŒ…å«ä»»ä½•å­—æ®µã€‚

å•å…ƒç»“æ„ä½“åœ¨Rustä¸­çš„ä¸»è¦ä½œç”¨æ˜¯æä¾›ä¸€ç§ç©ºç±»å‹ï¼Œç”¨äºè¡¨ç¤ºæŸä¸ªæ“ä½œæˆ–çŠ¶æ€çš„å­˜åœ¨æˆ–è€…ä¸å­˜åœ¨ï¼Œæ¯”å¦‚åœ¨æŸäº›å‡½æ•°ä¸­ï¼Œå¯èƒ½éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä½†å®é™…ä¸Šè¿™ä¸ªå‚æ•°å¹¶ä¸éœ€è¦ä½¿ç”¨ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨å•å…ƒç»“æ„ä½“ä½œä¸ºå‚æ•°ç±»å‹ï¼Œè¡¨ç¤ºè¿™ä¸ªæ“ä½œéœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä½†å®é™…ä¸Šè¿™ä¸ªå‚æ•°æ˜¯æ²¡æœ‰ç”¨çš„ã€‚
```rust

#![allow(unused)]
fn main() {
	struct AlwaysEqual;
	
	let subject = AlwaysEqual;
	
	// æˆ‘ä»¬ä¸å…³å¿ƒ AlwaysEqual çš„å­—æ®µæ•°æ®ï¼Œåªå…³å¿ƒå®ƒçš„è¡Œä¸ºï¼Œå› æ­¤å°†å®ƒå£°æ˜ä¸ºå•å…ƒç»“æ„ä½“ï¼Œç„¶åå†ä¸ºå®ƒå®ç°æŸä¸ªç‰¹å¾
	impl SomeTrait for AlwaysEqual {
	
	}
}

```


### ç»“æ„ä½“æ•°æ®çš„æ‰€æœ‰æƒ
åœ¨ä¹‹å‰çš„ User ç»“æ„ä½“çš„å®šä¹‰ä¸­ï¼Œæœ‰ä¸€å¤„ç»†èŠ‚ï¼šæˆ‘ä»¬ä½¿ç”¨äº†è‡ªèº«æ‹¥æœ‰æ‰€æœ‰æƒçš„ String ç±»å‹è€Œä¸æ˜¯åŸºäºå¼•ç”¨çš„ &str å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰æ„è€Œä¸ºä¹‹çš„é€‰æ‹©ï¼šå› ä¸ºæˆ‘ä»¬æƒ³è¦è¿™ä¸ªç»“æ„ä½“æ‹¥æœ‰å®ƒæ‰€æœ‰çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä»å…¶å®ƒåœ°æ–¹å€Ÿç”¨æ•°æ®ã€‚
ä½ ä¹Ÿå¯ä»¥è®© User ç»“æ„ä½“ä»å…¶å®ƒå¯¹è±¡å€Ÿç”¨æ•°æ®ï¼Œä¸è¿‡è¿™ä¹ˆåšï¼Œå°±éœ€è¦å¼•å…¥ç”Ÿå‘½å‘¨æœŸ(lifetimes)è¿™ä¸ªæ–°æ¦‚å¿µï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªå¤æ‚çš„æ¦‚å¿µï¼‰ï¼Œç®€è€Œè¨€ä¹‹ï¼Œç”Ÿå‘½å‘¨æœŸèƒ½ç¡®ä¿ç»“æ„ä½“çš„ä½œç”¨èŒƒå›´è¦æ¯”å®ƒæ‰€å€Ÿç”¨çš„æ•°æ®çš„ä½œç”¨èŒƒå›´è¦å°ã€‚

æ€»ä¹‹ï¼Œå¦‚æœä½ æƒ³åœ¨ç»“æ„ä½“ä¸­ä½¿ç”¨ä¸€ä¸ªå¼•ç”¨ï¼Œå°±å¿…é¡»åŠ ä¸Šç”Ÿå‘½å‘¨æœŸï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ï¼š

```rust
	struct User {
	    username: &str,
	    email: &str,
	    sign_in_count: u64,
	    active: bool,
	}
	
	fn main() {
	    let user1 = User {
	        email: "someone@example.com",
	        username: "someusername123",
	        active: true,
	        sign_in_count: 1,
	    };
	}

```


```
error[E0106]: missing lifetime specifier
 --> src/main.rs:2:15
  |
2 |     username: &str,
  |               ^ expected named lifetime parameter // éœ€è¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸ
  |
help: consider introducing a named lifetime parameter // è€ƒè™‘åƒä¸‹é¢çš„ä»£ç è¿™æ ·å¼•å…¥ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸ
  |
1 ~ struct User<'a> {
2 ~     username: &'a str,
  |

error[E0106]: missing lifetime specifier
 --> src/main.rs:3:12
  |
3 |     email: &str,
  |            ^ expected named lifetime parameter
  |
help: consider introducing a named lifetime parameter
  |
1 ~ struct User<'a> {
2 |     username: &str,
3 ~     email: &'a str,
  |

```


### ä½¿ç”¨ #[derive(Debug)] æ¥æ‰“å°ç»“æ„ä½“çš„ä¿¡æ¯
åœ¨å‰é¢çš„ä»£ç ä¸­æˆ‘ä»¬ä½¿ç”¨ #[derive(Debug)] å¯¹ç»“æ„ä½“è¿›è¡Œäº†æ ‡è®°ï¼Œè¿™æ ·æ‰èƒ½ä½¿ç”¨ println!("{:?}", s); çš„æ–¹å¼å¯¹å…¶è¿›è¡Œæ‰“å°è¾“å‡ºï¼Œå¦‚æœä¸åŠ ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ:

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    println!("rect1 is {}", rect1);
}

```


```
error[E0277]: `Rectangle` doesn't implement `std::fmt::Display`
  --> src/main.rs:12:29
   |
12 |     println!("rect1 is {}", rect1);
   |                             ^^^^^ `Rectangle` cannot be formatted with the default formatter
   |
   = help: the trait `std::fmt::Display` is not implemented for `Rectangle`
   = note: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
   = note: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)

For more information about this error, try `rustc --explain E0277`.
error: could not compile `Demo` due to previous error
```


#[derive(Debug)]æ˜¯ä¸€ä¸ªå®ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨ç”Ÿæˆå®ç°Debug traitçš„ä»£ç ã€‚Debug traitæ˜¯ä¸€ä¸ªç”¨äºè°ƒè¯•çš„traitï¼Œå®ƒå…è®¸æˆ‘ä»¬æ‰“å°å‡ºç»“æ„ä½“çš„å†…å®¹ï¼Œä»¥ä¾¿äºè°ƒè¯•ç¨‹åºã€‚å› æ­¤ï¼Œæ¯æ¬¡æ‰“å°ç»“æ„ä½“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç»“æ„ä½“ä¸ŠåŠ ä¸Š#[derive(Debug)]ï¼Œä»¥ä¾¿äºä½¿ç”¨println!å®æ‰“å°å‡ºç»“æ„ä½“çš„å†…å®¹ã€‚
- å®šä¹‰ï¼š`#[derive(Debug)]`
- æ‰“å°éœ€è¦ï¼š`{:?}`

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    println!("rect1 is {:?}", rect1);
}
```


è¿˜æœ‰ä¸€ä¸ªç®€å•çš„è¾“å‡º debug ä¿¡æ¯çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯ä½¿ç”¨ dbg! å®ï¼Œå®ƒä¼šæ‹¿èµ°è¡¨è¾¾å¼çš„æ‰€æœ‰æƒï¼Œç„¶åæ‰“å°å‡ºç›¸åº”çš„æ–‡ä»¶åã€è¡Œå·ç­‰ debug ä¿¡æ¯ï¼Œå½“ç„¶è¿˜æœ‰æˆ‘ä»¬éœ€è¦çš„è¡¨è¾¾å¼çš„æ±‚å€¼ç»“æœã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒæœ€ç»ˆè¿˜ä¼šæŠŠè¡¨è¾¾å¼å€¼çš„æ‰€æœ‰æƒè¿”å›ï¼
> dbg! è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯è¾“å‡º stderrï¼Œè€Œ println! è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º stdoutã€‚

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let scale = 2;
    let rect1 = Rectangle {
        width: dbg!(30 * scale),
        height: 50,
    };

    dbg!(&rect1);
}
```



## 1.7 æšä¸¾
#### æšä¸¾çš„ä¸€èˆ¬å†™æ³•

```rust
#[derive(Debug)]
enum Poker {
    Clubs,
    Spade,
    Diamonds,
    Hearts,
}

fn main() {
    let heart = Poker::Hearts;
    let diamonds = Poker::Diamonds;

    println!("{:?}", heart);
    println!("{:?}", diamonds);
}
```

å­¦ä¹ åˆ°è¿™é‡Œæˆ‘æ„Ÿè§‰å¿½ç•¥äº†ä¸€ä¸ªç»†èŠ‚ï¼Œæˆ‘ä»¥ä¸º`#[derive(Debug)]`æ”¾åˆ°ç¨‹åºå¤´å°±å¯ä»¥è®©æ¯ä¸€ä¸ªç»“æ„ä½“æ‰“å°ï¼Œå…¶å®ä¸ç„¶ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ç¨‹åºï¼š

```rust
#[derive(Debug)]
enum Poker {
    Clubs,
    Spade,
    Diamonds,
    Hearts,
}

struct PokerCard {
    suit: Poker,
    value: u8,
}

fn main() {
    let c1 = PokerCard {
       suit: Poker::Clubs,
       value: 1,
   };
   let c2 = PokerCard {
       suit: Poker::Diamonds,
       value: 12,
   };

    println!("{:?}", c1);
    println!("{:?}", c2);
}
```
è¿è¡Œä»¥ä¸Šç¨‹åºä¼šæŠ¥é”™ï¼š

```
error[E0277]: `PokerCard` doesn't implement `Debug`
  --> src/main.rs:24:22
   |
24 |     println!("{:?}", c1);
   |                      ^^ `PokerCard` cannot be formatted using `{:?}`
   |
   = help: the trait `Debug` is not implemented for `PokerCard`
   = note: add `#[derive(Debug)]` to `PokerCard` or manually `impl Debug for PokerCard`
   = note: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)
help: consider annotating `PokerCard` with `#[derive(Debug)]`
   |
9  | #[derive(Debug)]
   |

error[E0277]: `PokerCard` doesn't implement `Debug`
  --> src/main.rs:25:22
   |
25 |     println!("{:?}", c2);
   |                      ^^ `PokerCard` cannot be formatted using `{:?}`
   |
   = help: the trait `Debug` is not implemented for `PokerCard`
   = note: add `#[derive(Debug)]` to `PokerCard` or manually `impl Debug for PokerCard`
   = note: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)
help: consider annotating `PokerCard` with `#[derive(Debug)]`
   |
9  | #[derive(Debug)]
   |

For more information about this error, try `rustc --explain E0277`.
error: could not compile `Demo` due to 2 previous errors
```
è¿™å°±æ˜¯ç†è§£ä¸Šå‡ºç°äº†é”™è¯¯ï¼Œéœ€è¦ç»™æ¯ä¸€ä¸ªç»“æ„ä½“åŠ ä¸Š`#[derive(Debug)]`æ‰è¡Œ

```rust
#[derive(Debug)]
enum Poker {
    Clubs,
    Spade,
    Diamonds,
    Hearts,
}

#[derive(Debug)]
struct PokerCard {
    suit: Poker,
    value: u8,
}
```

æšä¸¾å†è¿›é˜¶ä¸€ç‚¹å°±æ˜¯ï¼š

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

fn main() {
    let m1 = Message::Quit;
    let m2 = Message::Move{x:1,y:1};
    let m3 = Message::ChangeColor(255,255,0);
}
```

#### åŒä¸€åŒ–ç±»å‹
æœ€åï¼Œå†ç”¨ä¸€ä¸ªå®é™…é¡¹ç›®ä¸­çš„ç®€åŒ–ç‰‡æ®µï¼Œæ¥ç»“æŸæšä¸¾ç±»å‹çš„è¯­æ³•å­¦ä¹ ã€‚

ä¾‹å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ª WEB æœåŠ¡ï¼Œéœ€è¦æ¥å—ç”¨æˆ·çš„é•¿è¿æ¥ï¼Œå‡è®¾è¿æ¥æœ‰ä¸¤ç§ï¼šTcpStream å’Œ TlsStreamï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›å¯¹è¿™ä¸¤ä¸ªè¿æ¥çš„å¤„ç†æµç¨‹ç›¸åŒï¼Œä¹Ÿå°±æ˜¯ç”¨åŒä¸€ä¸ªå‡½æ•°æ¥å¤„ç†è¿™ä¸¤ä¸ªè¿æ¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

```rust

#![allow(unused)]
fn main() {
fn new (stream: TcpStream) {
  let mut s = stream;
  if tls {
    s = negotiate_tls(stream)
  }

  // websocketæ˜¯ä¸€ä¸ªWebSocket<TcpStream>æˆ–è€…
  //   WebSocket<native_tls::TlsStream<TcpStream>>ç±»å‹
  websocket = WebSocket::from_raw_socket(
    stream, ......)
}
}

```

æ­¤æ—¶ï¼Œæšä¸¾ç±»å‹å°±èƒ½å¸®ä¸Šå¤§å¿™ï¼š
```rust

#![allow(unused)]
fn main() {
enum Websocket {
  Tcp(Websocket<TcpStream>),
  Tls(Websocket<native_tls::TlsStream<TcpStream>>),
}
}

```



#### Option æšä¸¾ç”¨äºå¤„ç†ç©ºå€¼
Option æšä¸¾åŒ…å«ä¸¤ä¸ªæˆå‘˜ï¼Œä¸€ä¸ªæˆå‘˜è¡¨ç¤ºå«æœ‰å€¼ï¼šSome(T), å¦ä¸€ä¸ªè¡¨ç¤ºæ²¡æœ‰å€¼ï¼šNoneï¼Œå®šä¹‰å¦‚ä¸‹ï¼š

```rust
enum Option<T> {
    Some(T),
    None,
}
```
å…¶ä¸­ T æ˜¯æ³›å‹å‚æ•°ï¼ŒSome(T)è¡¨ç¤ºè¯¥æšä¸¾æˆå‘˜çš„æ•°æ®ç±»å‹æ˜¯ Tï¼Œæ¢å¥è¯è¯´ï¼ŒSome å¯ä»¥åŒ…å«ä»»ä½•ç±»å‹çš„æ•°æ®ã€‚\

```rust

fn main() {
    fn plus_one(x: Option<i32>) -> Option<i32> {
        match x {
            None => None,
            Some(i) => Some(i + 1),
        }
    }

    let five = Some(5);
    let six = plus_one(five);
    let none = plus_one(None);

    println!("{:?}", five);
    println!("{:?}", six);
    println!("{:?}", none);
}

```


## 1.8 ğŸ”¢ æ•°ç»„
rustçš„æ•°ç»„åŸºæœ¬å’ŒJavaScriptå·®ä¸å¤šï¼Œç›´æ¥æ¥ä¸€ä¸ªç»¼åˆä¾‹å­ï¼š
- [0; 3]æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯[0, 0, 0]

```rust
fn main() {
  // ç¼–è¯‘å™¨è‡ªåŠ¨æ¨å¯¼å‡ºoneçš„ç±»å‹
  let one             = [1, 2, 3];
  // æ˜¾å¼ç±»å‹æ ‡æ³¨
  let two: [u8; 3]    = [1, 2, 3];
  let blank1          = [0; 3];
  let blank2: [u8; 3] = [0; 3];

  // arraysæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ ç±»å‹æ˜¯[u8; 3]
  let arrays: [[u8; 3]; 4]  = [one, two, blank1, blank2];

  // å€Ÿç”¨arraysçš„å…ƒç´ ç”¨ä½œå¾ªç¯ä¸­
  for a in &arrays {
    print!("{:?}: ", a);
    // å°†aå˜æˆä¸€ä¸ªè¿­ä»£å™¨ï¼Œç”¨äºå¾ªç¯
    // ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨for n in a {}æ¥è¿›è¡Œå¾ªç¯
    for n in a.iter() {
      print!("\t{} + 10 = {}", n, n+10);
    }

    let mut sum = 0;
    // 0..a.len,æ˜¯ä¸€ä¸ª Rust çš„è¯­æ³•ç³–ï¼Œå…¶å®å°±ç­‰äºä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ æ˜¯ä»0,1,2ä¸€ç›´å¢åŠ åˆ°åˆ°a.len-1
    for i in 0..a.len() {
      sum += a[i];
    }
    println!("\t({:?} = {})", a, sum);
  }
}
```
åšä¸ªæ€»ç»“ï¼Œæ•°ç»„è™½ç„¶å¾ˆç®€å•ï¼Œä½†æ˜¯å…¶å®è¿˜æ˜¯å­˜åœ¨å‡ ä¸ªè¦æ³¨æ„çš„ç‚¹ï¼š

- æ•°ç»„ç±»å‹å®¹æ˜“è·Ÿæ•°ç»„åˆ‡ç‰‡æ··æ·†ï¼Œ`[T;n]`æè¿°äº†ä¸€ä¸ªæ•°ç»„çš„ç±»å‹ï¼Œè€Œ[T]æè¿°äº†åˆ‡ç‰‡çš„ç±»å‹ï¼Œ å› ä¸ºåˆ‡ç‰‡æ˜¯è¿è¡ŒæœŸçš„æ•°æ®ç»“æ„ï¼Œå®ƒçš„é•¿åº¦æ— æ³•åœ¨ç¼–è¯‘æœŸå¾—çŸ¥ï¼Œå› æ­¤ä¸èƒ½ç”¨`[T;n]`çš„å½¢å¼å»æè¿°
- `[u8; 3]`å’Œ`[u8; 4]`æ˜¯ä¸åŒçš„ç±»å‹ï¼Œæ•°ç»„çš„é•¿åº¦ä¹Ÿæ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ†
- åœ¨å®é™…å¼€å‘ä¸­ï¼Œä½¿ç”¨æœ€å¤šçš„æ˜¯æ•°ç»„åˆ‡ç‰‡[T]ï¼Œæˆ‘ä»¬å¾€å¾€é€šè¿‡å¼•ç”¨çš„æ–¹å¼å»ä½¿ç”¨`&[T]`ï¼Œå› ä¸ºåè€…æœ‰å›ºå®šçš„ç±»å‹å¤§å°
è‡³æ­¤ï¼Œå…³äºæ•°æ®ç±»å‹éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»å…¨éƒ¨å­¦å®Œäº†ï¼Œå¯¹äº Rust å­¦ä¹ è€Œè¨€ï¼Œæˆ‘ä»¬ä¹Ÿè¿ˆå‡ºäº†åšå®šçš„ç¬¬ä¸€æ­¥ï¼Œåé¢å°†å¼€å§‹æ›´é«˜çº§ç‰¹æ€§çš„å­¦ä¹ ã€‚æœªæ¥å¦‚æœå¤§å®¶æœ‰ç–‘æƒ‘éœ€è¦æ£€ç´¢çŸ¥è¯†ï¼Œä¸€æ ·å¯ä»¥ç»§ç»­å›é¡¾è¿‡å¾€çš„ç« èŠ‚ï¼Œå› ä¸ºæœ¬ä¹¦ä¸ä»…ä»…æ˜¯ä¸€é—¨ Rust çš„æ•™ç¨‹ï¼Œè¿˜æ˜¯ä¸€æœ¬åšé‡çš„ Rust å·¥å…·ä¹¦ã€‚

## 1.9 â­•æµç¨‹æ§åˆ¶
å…¶ä»–éƒ½å·®ä¸å¤šï¼Œå°±è¿™ä¸¤ä¸ªæ¯”è¾ƒç‰¹æ®Šã€‚

### forå¾ªç¯
1.  for item in collection  è½¬ç§»æ‰€æœ‰æƒ

2. for item in &collection æˆ–è€… for item in collection.iter()  ä¸å¯å˜å€Ÿç”¨

3. for item in &mut collection æˆ–è€… for item in collection.iter_mut()  å¯å˜å€Ÿç”¨

### loop

```rust
fn main() {
    loop {
        println!("again!");
    }
}
```

## 1.10 ğŸ’â€â™‚ï¸ æ¨¡å¼åŒ¹é…
å…ˆå±•ç¤ºä¸€ä¸‹Java17çš„Switchï¼Œå°±æ‡‚äº†ï¼š

```java
public class Main {
    public static void main(String[] args) {
        enum Color { RED, GREEN, BLUE }
        Color c = Color.RED;
        switch (c) {
            case RED -> System.out.println("RED");
            case GREEN -> System.out.println("GREEN");
            case BLUE -> System.out.println("BLUE");
            default -> System.out.println("UNKNOWN");
        }
    }
}

```
å†æ¥çœ‹Rustç®€å•çš„ä¾‹å­ï¼š

```rust
fn main() {
    enum Color { Red, Green, Blue }
	let c = Color::Red;
	match c {
		Color::Red => println!("RED"),
		Color::Green => println!("GREEN"),
		Color::Blue => println!("BLUE"),
		_ => println!("UNKNOWN")
	}
}
```

å¦å¤–è¿˜æœ‰ä¸€äº›é¢å¤–çš„æŠ€èƒ½

### ä½¿ç”¨ match è¡¨è¾¾å¼èµ‹å€¼

```rust
enum IpAddr {
   Ipv4,
   Ipv6
}

fn main() {
    let ip1 = IpAddr::Ipv6;
    let ip_str = match ip1 {
        IpAddr::Ipv4 => "127.0.0.1",
        _ => "::1",
    };

    println!("{}", ip_str);
}

```

åŒç† Java17ä¹Ÿèƒ½åšåˆ°

```java
public class Main {
    enum IpAddr {
        Ipv4,
        Ipv6
    }

    public static void main(String[] args) {
        IpAddr ip1 = IpAddr.Ipv6;
        String ipStr = switch (ip1) {
            case Ipv4 -> "127.0.0.1";
            default -> "::1";
        };

        System.out.println(ipStr);
    }
}
```

### _ é€šé…ç¬¦
é€šè¿‡å°† _ å…¶æ”¾ç½®äºå…¶ä»–åˆ†æ”¯åï¼Œ_ å°†ä¼šåŒ¹é…æ‰€æœ‰é—æ¼çš„å€¼ã€‚() è¡¨ç¤ºè¿”å›å•å…ƒç±»å‹ä¸æ‰€æœ‰åˆ†æ”¯è¿”å›å€¼çš„ç±»å‹ç›¸åŒï¼Œæ‰€ä»¥å½“åŒ¹é…åˆ° _ åï¼Œä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿã€‚
```rust

#![allow(unused)]
fn main() {
let some_u8_value = 0u8;
match some_u8_value {
    1 => println!("one"),
    3 => println!("three"),
    5 => println!("five"),
    7 => println!("seven"),
    _ => (),
}
}

```


### let if è¿›è¡ŒåŒ¹é…
å½“ä½ åªè¦åŒ¹é…ä¸€ä¸ªæ¡ä»¶ï¼Œä¸”å¿½ç•¥å…¶ä»–æ¡ä»¶æ—¶å°±ç”¨ if let ï¼Œå¦åˆ™éƒ½ç”¨ matchã€‚

```rust

#![allow(unused)]
fn main() {
if let Some(3) = v {
    println!("three");
}
}

```


### matches!å®
å®ƒå¯ä»¥å°†ä¸€ä¸ªè¡¨è¾¾å¼è·Ÿæ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œç„¶åè¿”å›åŒ¹é…çš„ç»“æœ true or falseã€‚

```rust
#![allow(unused)]
fn main() {
let foo = 'f';
assert!(matches!(foo, 'A'..='Z' | 'a'..='z'));
println!("{}", matches!(foo, 'A'..='Z' | 'a'..='z')); // true

```


### å˜é‡è¦†ç›–
æ— è®ºæ˜¯ match è¿˜æ˜¯ if letï¼Œä»–ä»¬éƒ½å¯ä»¥åœ¨æ¨¡å¼åŒ¹é…æ—¶è¦†ç›–æ‰è€çš„å€¼ï¼Œç»‘å®šæ–°çš„å€¼:

```rust
fn main() {
   let age = Some(30);
   println!("åœ¨åŒ¹é…å‰ï¼Œageæ˜¯{:?}",age);
   if let Some(age) = age {
       println!("åŒ¹é…å‡ºæ¥çš„ageæ˜¯{}",age);
   }

   println!("åœ¨åŒ¹é…åï¼Œageæ˜¯{:?}",age);
}
```

### å°ç»“
æœ¬ç« çš„å†…å®¹å…¶å®æœ‰å¾ˆå¤šè¢«æˆ‘åˆ å‡äº†ï¼Œè€Œä¸”æœ‰äº›æˆ‘çœ‹çš„çŒç¡éƒ½æ¥äº†ï¼Œå› ä¸ºæˆ‘æ„Ÿè§‰æœ‰äº›å†…å®¹Javaä¹Ÿæœ‰ï¼Œåˆ°æ—¶å€™é¡¹ç›®ç”¨åˆ°å†è¯´å…·ä½“å¯ä»¥çœ‹å¤§å¤§æ€»ç»“çš„ï¼š
> https://course.rs/basic/match-pattern/all-patterns.html


## 1.11 ğŸ‘¨â€ğŸ”§ æ–¹æ³•

Rustå’Œå…¶ä»–è¯­è¨€çš„æ–¹æ³•å¯¹æ¯”ï¼š
![](https://pica.zhimg.com/80/v2-0d848e960f3279999eab4b1317f6538e_1440w.png)

ruståˆ›å»ºæ–¹æ³•ï¼š
- `impl` æ˜¯å®ç° `implementation` çš„ç¼©å†™

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
}

fn main() {
    let rect1 = Rectangle { width: 30, height: 50 };

    println!(
        "The area of the rectangle is {} square pixels.",
        rect1.area()
    );
}

```
å…¶å®çœ‹åˆ°è¿™é‡Œæ˜¯ååˆ†ç–‘æƒ‘çš„ï¼Œå°¤å…¶æ˜¯å’Œfnå¯¹æ¯”èµ·æ¥ï¼Œä¸‹é¢æˆ‘æ¥æ€»ç»“ä¸‹ï¼š
- implå—ç”¨äºå®šä¹‰åœ¨ç‰¹å®šç±»å‹ä¸Šçš„æ–¹æ³•ã€‚å®ƒRå¾€å¾€è·Ÿç»“æ„ä½“ã€æšä¸¾ã€ç‰¹å¾(Trait)ä¸€èµ·ä½¿ç”¨ã€‚
- fnç”¨äºå®šä¹‰æ™®é€šçš„å…¨å±€æˆ–å†…éƒ¨åŠŸèƒ½ã€‚å®ƒä¸ä¾èµ–äºä»»ä½•ç‰¹å®šç±»å‹ã€‚
- ç®€å•æ¥è¯´ï¼Œè¦å®ç°ç»“æ„ä½“çš„å‡½æ•°å°±è¦ä½¿ç”¨implï¼Œå®ƒè¿™ä¸ªå®ç°å’ŒGoè¯­è¨€ååˆ†ç±»ä¼¼ï¼

Goè¯­è¨€è¿›è¡Œå¯¹æ¯”å­¦ä¹ ï¼Œå°†personèµ‹äºˆSayHelloèƒ½åŠ›ã€‚ä¸ Rust çš„ impl ä¸åŒçš„æ˜¯ï¼ŒGo ä¸­çš„æ¥æ”¶è€…ç±»å‹å¯ä»¥æ˜¯å€¼ç±»å‹æˆ–æŒ‡é’ˆç±»å‹ã€‚å¦‚æœæ¥æ”¶è€…ç±»å‹æ˜¯å€¼ç±»å‹ï¼Œåˆ™ä¼šå°†è¯¥å€¼çš„å‰¯æœ¬ä¼ é€’ç»™æ–¹æ³•ï¼Œè€Œå¦‚æœæ¥æ”¶è€…ç±»å‹æ˜¯æŒ‡é’ˆç±»å‹ï¼Œåˆ™ä¼šå°†æŒ‡å‘è¯¥å€¼çš„æŒ‡é’ˆä¼ é€’ç»™æ–¹æ³•ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨æ–¹æ³•ä¸­ä¿®æ”¹æ¥æ”¶è€…çš„çŠ¶æ€ï¼Œå¹¶å°†è¿™äº›æ›´æ”¹ä¿æŒåœ¨è°ƒç”¨æ–¹æ³•ä¹‹åã€‚

```go
type Person struct {
    Name string
    Age int
}

func (p Person) SayHello() {
    fmt.Printf("Hello, my name is %s and I am %d years old.\n", p.Name, p.Age)
}
```


å‡½æ•°

```rust
fn add(a: i32, b: i32) -> i32 {
    a + b
}
```

æ–¹æ³•ã€‚è‡³äºè¿™ä¸ªselfå…·ä½“æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œæ˜¯å¦å’ŒPythonçš„selfä¸€æ ·ï¼Œæˆ‘å°†åœ¨ä¸‹ä¸€èŠ‚ä»‹ç»ã€‚

```rust

struct Point {
    x: f64,
    y: f64,
}

impl Point {
    fn distance(&self, other: &Point) -> f64 {
        ((self.x - other.x).powi(2) + (self.y - other.y).powi(2)).sqrt()
    }
}
fn main() {
    let p = Point {
        x: 12.0,
        y: 13.0,
    };
    let p2 = Point {
        x: 14.0,
        y: 15.0,
    };
    let ans = p.distance(&p2);
    println!("{}", ans);
}
```


### selfã€&self å’Œ &mut self
åœ¨ä¸€ä¸ª impl å—å†…ï¼ŒSelf æŒ‡ä»£è¢«å®ç°æ–¹æ³•çš„ç»“æ„ä½“ç±»å‹ï¼Œself æŒ‡ä»£æ­¤ç±»å‹çš„å®ä¾‹ï¼Œæ¢å¥è¯è¯´ï¼Œself æŒ‡ä»£çš„æ˜¯ç»“æ„ä½“å®ä¾‹ï¼Œè¿™æ ·çš„å†™æ³•ä¼šè®©æˆ‘ä»¬çš„ä»£ç ç®€æ´å¾ˆå¤šï¼Œè€Œä¸”éå¸¸ä¾¿äºç†è§£ï¼šæˆ‘ä»¬ä¸ºå“ªä¸ªç»“æ„ä½“å®ç°æ–¹æ³•ï¼Œé‚£ä¹ˆ self å°±æ˜¯æŒ‡ä»£å“ªä¸ªç»“æ„ä½“çš„å®ä¾‹ã€‚
> ä»è€Œå¯ä»¥å¾—å‡º >> è™½ç„¶ Rust å’Œ Python æ˜¯ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œä½†å®ƒä»¬åœ¨æŸäº›æ–¹é¢æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚self å…³é”®å­—åœ¨ä¸¤ç§è¯­è¨€ä¸­éƒ½ç”¨äºè¡¨ç¤ºå½“å‰å®ä¾‹ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨æ–¹æ³•ä¸­è®¿é—®å’Œä¿®æ”¹å®ä¾‹çš„å±æ€§å’Œæ–¹æ³•ã€‚

åœ¨Rustä¸­ï¼Œselfæ˜¯æœ‰æ‰€æœ‰æƒçš„æ¦‚å¿µçš„
- `self` è¡¨ç¤º ç»“æ„ä½“ çš„æ‰€æœ‰æƒè½¬ç§»åˆ°è¯¥æ–¹æ³•ä¸­ï¼Œè¿™ç§å½¢å¼ç”¨çš„è¾ƒå°‘
- `&self` è¡¨ç¤ºè¯¥æ–¹æ³•å¯¹ ç»“æ„ä½“ çš„ä¸å¯å˜å€Ÿç”¨
- `&mut self` è¡¨ç¤ºå¯å˜å€Ÿç”¨
æ€»ä¹‹ï¼Œself çš„ä½¿ç”¨å°±è·Ÿå‡½æ•°å‚æ•°ä¸€æ ·ï¼Œè¦ä¸¥æ ¼éµå®ˆ Rust çš„æ‰€æœ‰æƒè§„åˆ™ã€‚

### å…³è”å‡½æ•°
å‚æ•°ä¸­ä¸åŒ…å« self å³å¯ã€‚åœ¨ impl ä¸­ä¸”æ²¡æœ‰ self çš„å‡½æ•°è¢«ç§°ä¹‹ä¸ºå…³è”å‡½æ•°ï¼š å› ä¸ºå®ƒæ²¡æœ‰ selfï¼Œä¸èƒ½ç”¨ f.read() çš„å½¢å¼è°ƒç”¨ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°è€Œä¸æ˜¯æ–¹æ³•ï¼Œå®ƒåˆåœ¨ impl ä¸­ï¼Œä¸ç»“æ„ä½“ç´§å¯†å…³è”ï¼Œå› æ­¤ç§°ä¸ºå…³è”å‡½æ•°ã€‚

æ³¨æ„è§‚å¯Ÿä¸‹é¢ä¾‹å­ä¸­çš„new

```rust
pub struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    pub fn new(width: u32, height: u32) -> Self {
        Rectangle { width, height }
    }
    pub fn width(&self) -> u32 {
        return self.width;
    }
}

fn main() {
    let rect1 = Rectangle::new(30, 50);

    println!("{}", rect1.width());
}

```
> Rust ä¸­æœ‰ä¸€ä¸ªçº¦å®šä¿—æˆçš„è§„åˆ™ï¼Œä½¿ç”¨ new æ¥ä½œä¸ºæ„é€ å™¨çš„åç§°ï¼Œå‡ºäºè®¾è®¡ä¸Šçš„è€ƒè™‘ï¼ŒRust ç‰¹åœ°æ²¡æœ‰ç”¨ new ä½œä¸ºå…³é”®å­—ã€‚

å› ä¸ºæ˜¯å‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ . çš„æ–¹å¼æ¥è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ :: æ¥è°ƒç”¨ï¼Œä¾‹å¦‚ let sq = Rectangle::new(3, 3);ã€‚è¿™ä¸ªæ–¹æ³•ä½äºç»“æ„ä½“çš„å‘½åç©ºé—´ä¸­ï¼š:: è¯­æ³•ç”¨äºå…³è”å‡½æ•°å’Œæ¨¡å—åˆ›å»ºçš„å‘½åç©ºé—´ã€‚

### å¤šä¸ª impl å®šä¹‰
ç›´æ¥çœ‹ä¾‹å­å³å¯

```rust

#![allow(unused)]
fn main() {
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
}

impl Rectangle {
    fn can_hold(&self, other: &Rectangle) -> bool {
        self.width > other.width && self.height > other.height
    }
}
}

```

### ä¸ºæšä¸¾å®ç°æ–¹æ³•
æšä¸¾ç±»å‹ä¹‹æ‰€ä»¥å¼ºå¤§ï¼Œä¸ä»…ä»…åœ¨äºå®ƒå¥½ç”¨ã€å¯ä»¥**åŒä¸€åŒ–ç±»å‹**ï¼Œè¿˜åœ¨äºï¼Œæˆ‘ä»¬å¯ä»¥åƒç»“æ„ä½“ä¸€æ ·ï¼Œä¸ºæšä¸¾å®ç°æ–¹æ³•ï¼š

```rust
#![allow(unused)]
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

impl Message {
    fn call(&self) {
        // åœ¨è¿™é‡Œå®šä¹‰æ–¹æ³•ä½“
    }
}

fn main() {
    let m = Message::Write(String::from("hello"));
    m.call();
}

```

## 1.12 ğŸ¦œ æ³›å‹å’Œç‰¹å¾
### ç»“æ„ä½“ä¸­ä½¿ç”¨æ³›å‹
å…ˆä¸Šä¾‹å­ä½“éªŒä¸€ä¸‹ï¼š
- ä½¿ç”¨çš„æ—¶å€™éœ€è¦åœ¨ç»“æ„ä½“åå­—åé¢åŠ å…¥`<T>`
```rust
#[derive(Debug)]
struct Point<T> {
    x: T,
    y: T,
}

fn main() {
    let integer = Point { x: 5, y: 10 };
    let float = Point { x: 1.0, y: 4.0 };

    println!("{:?}", integer);
    println!("{:?}", float);
}

```
æ­¤æ—¶çš„å£°æ˜æ˜¯x, yå¿…é¡»æ˜¯ä¸€æ ·çš„ç±»å‹ï¼Œå¦‚æœè¦ä¸ä¸€æ ·çš„å£°æ˜å°±è¦ä¸¤ç§ä¸åŒçš„æ³›å‹ï¼š

```rust
#[derive(Debug)]
struct Point<T,U> {
    x: T,
    y: U,
}

fn main() {
    let integer = Point { x: 5, y: 1.1 };
    let float = Point { x: 222, y: 3.0 };

    println!("{:?}", integer);
    println!("{:?}", float);
}
```

### æšä¸¾ä¸­ä½¿ç”¨æ³›å‹
æåˆ°æšä¸¾ç±»å‹ï¼ŒOption æ°¸è¿œæ˜¯ç¬¬ä¸€ä¸ªåº”è¯¥è¢«æƒ³èµ·æ¥çš„

```rust
enum Option<T> {
    Some(T),
    None,
}
```
`Option<T> `æ˜¯ä¸€ä¸ªæ‹¥æœ‰æ³›å‹ T çš„æšä¸¾ç±»å‹ï¼Œå®ƒç¬¬ä¸€ä¸ªæˆå‘˜æ˜¯ Some(T)ï¼Œå­˜æ”¾äº†ä¸€ä¸ªç±»å‹ä¸º T çš„å€¼ã€‚å¾—ç›Šäºæ³›å‹çš„å¼•å…¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•ä¸€ä¸ªéœ€è¦è¿”å›å€¼çš„å‡½æ•°ä¸­ï¼Œå»ä½¿ç”¨ `Option<T> `æšä¸¾ç±»å‹æ¥åšä¸ºè¿”å›å€¼ï¼Œç”¨äºè¿”å›ä¸€ä¸ªä»»æ„ç±»å‹çš„å€¼ Some(T)ï¼Œæˆ–è€…æ²¡æœ‰å€¼ Noneã€‚

### æ–¹æ³•ä¸­ä½¿ç”¨æ³›å‹
- ä½¿ç”¨æ³›å‹å‚æ•°å‰ï¼Œä¾ç„¶éœ€è¦æå‰å£°æ˜ï¼š`impl<T>`

```rust
struct Point<T> {
    x: T,
    y: T,
}

impl<T> Point<T> {
    fn x(&self) -> &T {
        &self.x
    }
}

fn main() {
    let p = Point { x: 5, y: 10 };

    println!("p.x = {}", p.x());
}


```

### ä¸ºå…·ä½“çš„æ³›å‹ç±»å‹å®ç°æ–¹æ³•
ä¸ä»…èƒ½å®šä¹‰åŸºäº T çš„æ–¹æ³•ï¼Œè¿˜èƒ½é’ˆå¯¹ç‰¹å®šçš„å…·ä½“ç±»å‹ï¼Œè¿›è¡Œæ–¹æ³•å®šä¹‰ï¼Œä¾‹å¦‚f32ï¼š

```rust

#![allow(unused)]
fn main() {
impl Point<f32> {
    fn distance_from_origin(&self) -> f32 {
        (self.x.powi(2) + self.y.powi(2)).sqrt()
    }
}
}

```

### const æ³›å‹ï¼ˆRust 1.51 ç‰ˆæœ¬å¼•å…¥çš„é‡è¦ç‰¹æ€§ï¼‰
@todo 

## 1.13 ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ é›†åˆ
@todo
## 1.14 ğŸ’± ç”Ÿå‘½å‘¨æœŸ
@todo
## 1.15 âŒ è¿”å›å€¼å’Œé”™è¯¯ç±»å‹
@todo
## 1.16 ğŸ‘œ åŒ…å’Œæ¨¡å—
@todo