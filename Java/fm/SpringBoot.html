<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html"><meta property="og:site_name" content="CSLN"><meta property="og:title" content="SpringBoot"><meta property="og:description" content="Spring-Boot-Note (#spring-boot-note); ç¯å¢ƒæ­å»º & ç®€åŒ–éƒ¨ç½² (#ç¯å¢ƒæ­å»º--ç®€åŒ–éƒ¨ç½²); ç¯å¢ƒæ­å»º (#ç¯å¢ƒæ­å»º); ç®€åŒ–éƒ¨ç½² (#ç®€åŒ–éƒ¨ç½²); @SpringBootApplicationå¯åŠ¨åŸç† (#springbootapplicationå¯åŠ¨åŸç†); IDEA å¿«é€Ÿæ„å»º (#idea-å¿«é€Ÿæ„å»º); YAM..."><meta property="og:type" content="article"><meta property="og:image" content="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-04-06T15:04:01.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="SpringBoot"><meta property="article:author" content="zhiyu1998"><meta property="article:modified_time" content="2023-04-06T15:04:01.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"SpringBoot","image":["https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/"],"dateModified":"2023-04-06T15:04:01.000Z","author":[{"@type":"Person","name":"zhiyu1998","url":"https://github.com/zhiyu1998"}]}</script><link rel="manifest" href="/Computer-Science-Learn-Notes/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>SpringBoot | CSLN</title><meta name="description" content="Spring-Boot-Note (#spring-boot-note); ç¯å¢ƒæ­å»º & ç®€åŒ–éƒ¨ç½² (#ç¯å¢ƒæ­å»º--ç®€åŒ–éƒ¨ç½²); ç¯å¢ƒæ­å»º (#ç¯å¢ƒæ­å»º); ç®€åŒ–éƒ¨ç½² (#ç®€åŒ–éƒ¨ç½²); @SpringBootApplicationå¯åŠ¨åŸç† (#springbootapplicationå¯åŠ¨åŸç†); IDEA å¿«é€Ÿæ„å»º (#idea-å¿«é€Ÿæ„å»º); YAM...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/Computer-Science-Learn-Notes/assets/style-a5be085c.css" as="style"><link rel="stylesheet" href="/Computer-Science-Learn-Notes/assets/style-a5be085c.css">
    <link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/app-a3377c6a.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/framework-c8643d23.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/SpringBoot.html-ce2dc7d5.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/SpringBoot.html-09e00b84.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/Computer-Science-Learn-Notes/" class="brand"><img class="logo" src="/Computer-Science-Learn-Notes/logo.svg" alt="CSLN"><!----><span class="site-name hide-in-pad">CSLN</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/Computer-Science-Learn-Notes/" class="nav-link" aria-label="ä¸»é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/Computer-Science-Learn-Notes/intro/" class="nav-link" aria-label="å¯¼è¯»"><span class="font-icon icon iconfont icon-discover" style=""></span>å¯¼è¯»<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes/issues" rel="noopener noreferrer" target="_blank" aria-label="é—®é¢˜åé¦ˆ" class="nav-link"><span class="font-icon icon iconfont icon-note" style=""></span>é—®é¢˜åé¦ˆ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">æœç´¢</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-build" style=""></span><span class="title">è®¡ç®—æœºåŸºç¡€</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-vscode" style=""></span><span class="title">å‰ç«¯</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-timer" style=""></span><span class="title">Golang</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-light" style=""></span><span class="title">Rust</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">Java</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-activity" style=""></span><span class="title">åŸºç¡€</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-branch" style=""></span><span class="title">å¹¶å‘</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-profile" style=""></span><span class="title">é¢è¯•</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-leaf" style=""></span><span class="title">æ¡†æ¶</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/fm/Spring.html" class="nav-link sidebar-link sidebar-page" aria-label="Spring"><!---->Spring<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/fm/SpringMVC.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringMVC"><!---->SpringMVC<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/fm/Mybatis.html" class="nav-link sidebar-link sidebar-page" aria-label="Mybatis"><!---->Mybatis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="SpringBoot"><!---->SpringBoot<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¯å¢ƒæ­å»º-ç®€åŒ–éƒ¨ç½²" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¯å¢ƒæ­å»º &amp; ç®€åŒ–éƒ¨ç½²"><!---->ç¯å¢ƒæ­å»º &amp; ç®€åŒ–éƒ¨ç½²<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¯å¢ƒæ­å»º" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¯å¢ƒæ­å»º"><!---->ç¯å¢ƒæ­å»º<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç®€åŒ–éƒ¨ç½²" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç®€åŒ–éƒ¨ç½²"><!---->ç®€åŒ–éƒ¨ç½²<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootapplicationå¯åŠ¨åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@SpringBootApplicationå¯åŠ¨åŸç†"><!---->@SpringBootApplicationå¯åŠ¨åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#idea-å¿«é€Ÿæ„å»º" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="IDEA å¿«é€Ÿæ„å»º"><!---->IDEA å¿«é€Ÿæ„å»º<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#yaml" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="YAML"><!---->YAML<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#yamlåŸºæœ¬è¯­æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="YAMLåŸºæœ¬è¯­æ³•"><!---->YAMLåŸºæœ¬è¯­æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å•å…ƒæµ‹è¯•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å•å…ƒæµ‹è¯•"><!---->å•å…ƒæµ‹è¯•<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ssm" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SSM"><!---->SSM<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springboot" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBoot"><!---->SpringBoot<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#configurationproperties-value" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@ConfigurationProperties&amp;@Value"><!---->@ConfigurationProperties&amp;@Value<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#propertysource-importresource" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@PropertySource&amp;@ImportResource"><!---->@PropertySource&amp;@ImportResource<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»"><!---->ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é…ç½®æ–‡ä»¶çš„å ä½ç¬¦" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é…ç½®æ–‡ä»¶çš„å ä½ç¬¦"><!---->é…ç½®æ–‡ä»¶çš„å ä½ç¬¦<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å¤šprofileæ”¯æŒ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¤šProfileæ”¯æŒ"><!---->å¤šProfileæ”¯æŒ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§"><!---->åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªåŠ¨é…ç½®åŸç†"><!---->è‡ªåŠ¨é…ç½®åŸç†<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªåŠ¨é…ç½®åŸç†-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªåŠ¨é…ç½®åŸç†"><!---->è‡ªåŠ¨é…ç½®åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä»¥httpencodingautoconfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä»¥HttpEncodingAutoConfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†"><!---->ä»¥HttpEncodingAutoConfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å°ç»“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å°ç»“"><!---->å°ç»“<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#conditionalç›¸å…³æ³¨è§£å’Œdebug" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@Conditionalç›¸å…³æ³¨è§£å’ŒDebug"><!---->@Conditionalç›¸å…³æ³¨è§£å’ŒDebug<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ—¥å¿—æ¡†æ¶sl4j" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ—¥å¿—æ¡†æ¶SL4J"><!---->æ—¥å¿—æ¡†æ¶SL4J<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºsl4j" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºSL4J"><!---->å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºSL4J<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootå’Œæ—¥å¿—å…³ç³»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBootå’Œæ—¥å¿—å…³ç³»"><!---->SpringBootå’Œæ—¥å¿—å…³ç³»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ—¥å¿—çš„é…ç½®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ—¥å¿—çš„é…ç½®"><!---->æ—¥å¿—çš„é…ç½®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æŒ‡å®šæ—¥å¿—æ¡†æ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æŒ‡å®šæ—¥å¿—æ¡†æ¶"><!---->æŒ‡å®šæ—¥å¿—æ¡†æ¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åˆ‡æ¢æ—¥å¿—æ¡†æ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ‡æ¢æ—¥å¿—æ¡†æ¶"><!---->åˆ‡æ¢æ—¥å¿—æ¡†æ¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é™æ€èµ„æºæ˜ å°„è§„åˆ™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é™æ€èµ„æºæ˜ å°„è§„åˆ™"><!---->é™æ€èµ„æºæ˜ å°„è§„åˆ™<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ¨¡æ¿å¼•æ“thymeleaf" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¨¡æ¿å¼•æ“Thymeleaf"><!---->æ¨¡æ¿å¼•æ“Thymeleaf<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springmvcè‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringMVCè‡ªåŠ¨é…ç½®åŸç†"><!---->SpringMVCè‡ªåŠ¨é…ç½®åŸç†<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é»˜è®¤é…ç½®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é»˜è®¤é…ç½®"><!---->é»˜è®¤é…ç½®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#contentnegotiatingviewresolver" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ContentNegotiatingViewResolver"><!---->ContentNegotiatingViewResolver<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#httpmessageconverters" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HttpMessageConverters"><!---->HttpMessageConverters<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#messagecodesresolver" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="MessageCodesResolver"><!---->MessageCodesResolver<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootåœ¨springmvcçš„é…ç½®æ¨¡å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBootåœ¨SpringMVCçš„é…ç½®æ¨¡å¼"><!---->SpringBootåœ¨SpringMVCçš„é…ç½®æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ¥ç®¡springbootçš„springmvc" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¥ç®¡SpringBootçš„SpringMVC"><!---->æ¥ç®¡SpringBootçš„SpringMVC<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å°ç»“-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å°ç»“ï¼š"><!---->å°ç»“ï¼š<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å›½é™…åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å›½é™…åŒ–"><!---->å›½é™…åŒ–<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä½¿ç”¨thymeleafå›½é™…åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨thymeleafå›½é™…åŒ–"><!---->ä½¿ç”¨thymeleafå›½é™…åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootåŒºåŸŸä¿¡æ¯è§£æå™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBootåŒºåŸŸä¿¡æ¯è§£æå™¨"><!---->SpringBootåŒºåŸŸä¿¡æ¯è§£æå™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªå®šä¹‰å›½é™…åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰å›½é™…åŒ–"><!---->è‡ªå®šä¹‰å›½é™…åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ‹¦æˆªå™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‹¦æˆªå™¨"><!---->æ‹¦æˆªå™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é”™è¯¯å¤„ç†åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é”™è¯¯å¤„ç†åŸç†"><!---->é”™è¯¯å¤„ç†åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å®šåˆ¶é”™è¯¯é¡µé¢å’Œjsoné”™è¯¯æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®šåˆ¶é”™è¯¯é¡µé¢å’ŒJSONé”™è¯¯æ•°æ®"><!---->å®šåˆ¶é”™è¯¯é¡µé¢å’ŒJSONé”™è¯¯æ•°æ®<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å®šåˆ¶ä¸€ä¸ªjsonæ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®šåˆ¶ä¸€ä¸ªJSONæ•°æ®"><!---->å®šåˆ¶ä¸€ä¸ªJSONæ•°æ®<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åµŒå…¥å¼servlet" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åµŒå…¥å¼Servlet"><!---->åµŒå…¥å¼Servlet<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springä¸¤ç§é…ç½®æ–¹å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Springä¸¤ç§é…ç½®æ–¹å¼ï¼š"><!---->Springä¸¤ç§é…ç½®æ–¹å¼ï¼š<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åµŒå…¥å¼servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åµŒå…¥å¼Servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®"><!---->åµŒå…¥å¼Servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ³¨å†Œä¸‰å¤§ç»„ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ³¨å†Œä¸‰å¤§ç»„ä»¶"><!---->æ³¨å†Œä¸‰å¤§ç»„ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æºç åˆ¨æ-åµŒå…¥å¼servletåŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æºç åˆ¨æ åµŒå…¥å¼ServletåŸç†"><!---->æºç åˆ¨æ åµŒå…¥å¼ServletåŸç†<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†"><!---->é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å°ç»“-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å°ç»“ï¼š"><!---->å°ç»“ï¼š<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åµŒå…¥å¼servletè‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åµŒå…¥å¼Servletè‡ªåŠ¨é…ç½®åŸç†"><!---->åµŒå…¥å¼Servletè‡ªåŠ¨é…ç½®åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆjdbc" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•´åˆJDBC"><!---->æ•´åˆJDBC<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªåŠ¨é…ç½®åŸç†-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªåŠ¨é…ç½®åŸç†"><!---->è‡ªåŠ¨é…ç½®åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆdruid" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•´åˆDruid"><!---->æ•´åˆDruid<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆmybatis" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•´åˆMybatis"><!---->æ•´åˆMybatis<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#maven" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Maven"><!---->Maven<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä½¿ç”¨æ³¨è§£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨æ³¨è§£"><!---->ä½¿ç”¨æ³¨è§£<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä½¿ç”¨é…ç½®æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨é…ç½®æ–‡ä»¶"><!---->ä½¿ç”¨é…ç½®æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootå¯åŠ¨åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBootå¯åŠ¨åŸç†"><!---->SpringBootå¯åŠ¨åŸç†<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¬¬ä¸€æ­¥-åˆ›å»ºspringapplicationå¯¹è±¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºSpringApplicationå¯¹è±¡"><!---->ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºSpringApplicationå¯¹è±¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¬¬äºŒæ­¥-å¯åŠ¨åº”ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åº”ç”¨"><!---->ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åº”ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°-æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ï¼ˆåŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°ï¼‰æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»"><!---->ï¼ˆåŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°ï¼‰æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘"><!---->è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootç¼“å­˜åŸºæœ¬ä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBootç¼“å­˜åŸºæœ¬ä½¿ç”¨"><!---->SpringBootç¼“å­˜åŸºæœ¬ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åŸºæœ¬ä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸºæœ¬ä½¿ç”¨"><!---->åŸºæœ¬ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å‡ ä¸ªå±æ€§ä»‹ç»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‡ ä¸ªå±æ€§ä»‹ç»"><!---->å‡ ä¸ªå±æ€§ä»‹ç»<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†"><!---->ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä»¥-cacheableä¸ºä¾‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä»¥@Cacheableä¸ºä¾‹"><!---->ä»¥@Cacheableä¸ºä¾‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å°ç»“-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å°ç»“ï¼š"><!---->å°ç»“ï¼š<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#cacheputçš„ä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@CachePutçš„ä½¿ç”¨"><!---->@CachePutçš„ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#cacheevict-æ¸…é™¤ç¼“å­˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@CacheEvict æ¸…é™¤ç¼“å­˜"><!---->@CacheEvict æ¸…é™¤ç¼“å­˜<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#cachingå’Œ-cacheconfig" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@Cachingå’Œ@CacheConfig"><!---->@Cachingå’Œ@CacheConfig<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#caching" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@Caching"><!---->@Caching<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#cacheconfig" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@CacheConfig"><!---->@CacheConfig<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆç¼“å­˜ä¸­é—´ä»¶redis" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•´åˆç¼“å­˜ä¸­é—´ä»¶Redis"><!---->æ•´åˆç¼“å­˜ä¸­é—´ä»¶Redis<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªå®šä¹‰rediscachemanager" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰RedisCacheManager"><!---->è‡ªå®šä¹‰RedisCacheManager<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springsecurityçš„ç®€å•ä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringSecurityçš„ç®€å•ä½¿ç”¨"><!---->SpringSecurityçš„ç®€å•ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#thymeleafæ•´åˆspringsecurity" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Thymeleafæ•´åˆSpringSecurity"><!---->Thymeleafæ•´åˆSpringSecurity<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è®°ä½æˆ‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è®°ä½æˆ‘"><!---->è®°ä½æˆ‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢"><!---->å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#shiroçš„ç®€å•ä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Shiroçš„ç®€å•ä½¿ç”¨"><!---->Shiroçš„ç®€å•ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å¼€å§‹é…ç½®ä¸€ä¸ªshiro" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¼€å§‹é…ç½®ä¸€ä¸ªshiro"><!---->å¼€å§‹é…ç½®ä¸€ä¸ªshiro<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆshiroå¯åŠ¨å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•´åˆShiroå¯åŠ¨å™¨"><!---->æ•´åˆShiroå¯åŠ¨å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ‰©å±•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‰©å±•ï¼š"><!---->æ‰©å±•ï¼š<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/fm/SpringDataJpa.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringDataJpa"><!---->SpringDataJpa<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/fm/SpringSecurity.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringSecurity"><!---->SpringSecurity<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/fm/SpringCloud.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringCloud"><!---->SpringCloud<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-async" style=""></span><span class="title">è™šæ‹Ÿæœº</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-launch" style=""></span><span class="title">Kotlinç»“åˆSpring</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-object" style=""></span><span class="title">LeetCodeåˆ·é¢˜é¡ºåº</span><span class="arrow end"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-repair" style=""></span><span class="title">ç»éªŒæ€»ç»“</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->SpringBoot</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/zhiyu1998" target="_blank" rel="noopener noreferrer">zhiyu1998</a></span><span property="author" content="zhiyu1998"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-04-04T15:12:04.000Z"></span><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" id="ArtalkPV" data-path="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 59 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT59M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category1" role>Spring</span><meta property="articleSection" content="Spring"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¯å¢ƒæ­å»º-ç®€åŒ–éƒ¨ç½²" class="router-link-active router-link-exact-active toc-link level2">ç¯å¢ƒæ­å»º &amp; ç®€åŒ–éƒ¨ç½²</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¯å¢ƒæ­å»º" class="router-link-active router-link-exact-active toc-link level3">ç¯å¢ƒæ­å»º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç®€åŒ–éƒ¨ç½²" class="router-link-active router-link-exact-active toc-link level3">ç®€åŒ–éƒ¨ç½²</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootapplicationå¯åŠ¨åŸç†" class="router-link-active router-link-exact-active toc-link level2">@SpringBootApplicationå¯åŠ¨åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#idea-å¿«é€Ÿæ„å»º" class="router-link-active router-link-exact-active toc-link level2">IDEA å¿«é€Ÿæ„å»º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#yaml" class="router-link-active router-link-exact-active toc-link level2">YAML</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#yamlåŸºæœ¬è¯­æ³•" class="router-link-active router-link-exact-active toc-link level3">YAMLåŸºæœ¬è¯­æ³•</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å•å…ƒæµ‹è¯•" class="router-link-active router-link-exact-active toc-link level2">å•å…ƒæµ‹è¯•</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ssm" class="router-link-active router-link-exact-active toc-link level3">SSM</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springboot" class="router-link-active router-link-exact-active toc-link level3">SpringBoot</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#configurationproperties-value" class="router-link-active router-link-exact-active toc-link level2">@ConfigurationProperties&amp;@Value</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#propertysource-importresource" class="router-link-active router-link-exact-active toc-link level2">@PropertySource&amp;@ImportResource</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»" class="router-link-active router-link-exact-active toc-link level3">ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é…ç½®æ–‡ä»¶çš„å ä½ç¬¦" class="router-link-active router-link-exact-active toc-link level3">é…ç½®æ–‡ä»¶çš„å ä½ç¬¦</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å¤šprofileæ”¯æŒ" class="router-link-active router-link-exact-active toc-link level3">å¤šProfileæ”¯æŒ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§" class="router-link-active router-link-exact-active toc-link level2">åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active toc-link level2">è‡ªåŠ¨é…ç½®åŸç†</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªåŠ¨é…ç½®åŸç†-1" class="router-link-active router-link-exact-active toc-link level3">è‡ªåŠ¨é…ç½®åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä»¥httpencodingautoconfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active toc-link level3">ä»¥HttpEncodingAutoConfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å°ç»“" class="router-link-active router-link-exact-active toc-link level3">å°ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#conditionalç›¸å…³æ³¨è§£å’Œdebug" class="router-link-active router-link-exact-active toc-link level2">@Conditionalç›¸å…³æ³¨è§£å’ŒDebug</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ—¥å¿—æ¡†æ¶sl4j" class="router-link-active router-link-exact-active toc-link level2">æ—¥å¿—æ¡†æ¶SL4J</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºsl4j" class="router-link-active router-link-exact-active toc-link level3">å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºSL4J</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootå’Œæ—¥å¿—å…³ç³»" class="router-link-active router-link-exact-active toc-link level3">SpringBootå’Œæ—¥å¿—å…³ç³»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ—¥å¿—çš„é…ç½®" class="router-link-active router-link-exact-active toc-link level3">æ—¥å¿—çš„é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æŒ‡å®šæ—¥å¿—æ¡†æ¶" class="router-link-active router-link-exact-active toc-link level3">æŒ‡å®šæ—¥å¿—æ¡†æ¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åˆ‡æ¢æ—¥å¿—æ¡†æ¶" class="router-link-active router-link-exact-active toc-link level3">åˆ‡æ¢æ—¥å¿—æ¡†æ¶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é™æ€èµ„æºæ˜ å°„è§„åˆ™" class="router-link-active router-link-exact-active toc-link level2">é™æ€èµ„æºæ˜ å°„è§„åˆ™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ¨¡æ¿å¼•æ“thymeleaf" class="router-link-active router-link-exact-active toc-link level2">æ¨¡æ¿å¼•æ“Thymeleaf</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springmvcè‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active toc-link level2">SpringMVCè‡ªåŠ¨é…ç½®åŸç†</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é»˜è®¤é…ç½®" class="router-link-active router-link-exact-active toc-link level3">é»˜è®¤é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#contentnegotiatingviewresolver" class="router-link-active router-link-exact-active toc-link level3">ContentNegotiatingViewResolver</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#httpmessageconverters" class="router-link-active router-link-exact-active toc-link level3">HttpMessageConverters</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#messagecodesresolver" class="router-link-active router-link-exact-active toc-link level3">MessageCodesResolver</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootåœ¨springmvcçš„é…ç½®æ¨¡å¼" class="router-link-active router-link-exact-active toc-link level3">SpringBootåœ¨SpringMVCçš„é…ç½®æ¨¡å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ¥ç®¡springbootçš„springmvc" class="router-link-active router-link-exact-active toc-link level3">æ¥ç®¡SpringBootçš„SpringMVC</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å°ç»“-1" class="router-link-active router-link-exact-active toc-link level3">å°ç»“ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å›½é™…åŒ–" class="router-link-active router-link-exact-active toc-link level2">å›½é™…åŒ–</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä½¿ç”¨thymeleafå›½é™…åŒ–" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨thymeleafå›½é™…åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootåŒºåŸŸä¿¡æ¯è§£æå™¨" class="router-link-active router-link-exact-active toc-link level3">SpringBootåŒºåŸŸä¿¡æ¯è§£æå™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªå®šä¹‰å›½é™…åŒ–" class="router-link-active router-link-exact-active toc-link level3">è‡ªå®šä¹‰å›½é™…åŒ–</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ‹¦æˆªå™¨" class="router-link-active router-link-exact-active toc-link level2">æ‹¦æˆªå™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é”™è¯¯å¤„ç†åŸç†" class="router-link-active router-link-exact-active toc-link level2">é”™è¯¯å¤„ç†åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å®šåˆ¶é”™è¯¯é¡µé¢å’Œjsoné”™è¯¯æ•°æ®" class="router-link-active router-link-exact-active toc-link level2">å®šåˆ¶é”™è¯¯é¡µé¢å’ŒJSONé”™è¯¯æ•°æ®</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å®šåˆ¶ä¸€ä¸ªjsonæ•°æ®" class="router-link-active router-link-exact-active toc-link level3">å®šåˆ¶ä¸€ä¸ªJSONæ•°æ®</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åµŒå…¥å¼servlet" class="router-link-active router-link-exact-active toc-link level2">åµŒå…¥å¼Servlet</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springä¸¤ç§é…ç½®æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">Springä¸¤ç§é…ç½®æ–¹å¼ï¼š</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åµŒå…¥å¼servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®" class="router-link-active router-link-exact-active toc-link level3">åµŒå…¥å¼Servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ³¨å†Œä¸‰å¤§ç»„ä»¶" class="router-link-active router-link-exact-active toc-link level3">æ³¨å†Œä¸‰å¤§ç»„ä»¶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æºç åˆ¨æ-åµŒå…¥å¼servletåŸç†" class="router-link-active router-link-exact-active toc-link level2">æºç åˆ¨æ åµŒå…¥å¼ServletåŸç†</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†" class="router-link-active router-link-exact-active toc-link level3">é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å°ç»“-2" class="router-link-active router-link-exact-active toc-link level3">å°ç»“ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åµŒå…¥å¼servletè‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active toc-link level2">åµŒå…¥å¼Servletè‡ªåŠ¨é…ç½®åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆjdbc" class="router-link-active router-link-exact-active toc-link level2">æ•´åˆJDBC</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªåŠ¨é…ç½®åŸç†-2" class="router-link-active router-link-exact-active toc-link level3">è‡ªåŠ¨é…ç½®åŸç†</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆdruid" class="router-link-active router-link-exact-active toc-link level2">æ•´åˆDruid</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆmybatis" class="router-link-active router-link-exact-active toc-link level2">æ•´åˆMybatis</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#maven" class="router-link-active router-link-exact-active toc-link level3">Maven</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä½¿ç”¨æ³¨è§£" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨æ³¨è§£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä½¿ç”¨é…ç½®æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨é…ç½®æ–‡ä»¶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootå¯åŠ¨åŸç†" class="router-link-active router-link-exact-active toc-link level2">SpringBootå¯åŠ¨åŸç†</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¬¬ä¸€æ­¥-åˆ›å»ºspringapplicationå¯¹è±¡" class="router-link-active router-link-exact-active toc-link level3">ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºSpringApplicationå¯¹è±¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¬¬äºŒæ­¥-å¯åŠ¨åº”ç”¨" class="router-link-active router-link-exact-active toc-link level3">ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åº”ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°-æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»" class="router-link-active router-link-exact-active toc-link level2">ï¼ˆåŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°ï¼‰æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘" class="router-link-active router-link-exact-active toc-link level2">è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springbootç¼“å­˜åŸºæœ¬ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level2">SpringBootç¼“å­˜åŸºæœ¬ä½¿ç”¨</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#åŸºæœ¬ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">åŸºæœ¬ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å‡ ä¸ªå±æ€§ä»‹ç»" class="router-link-active router-link-exact-active toc-link level3">å‡ ä¸ªå±æ€§ä»‹ç»</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†" class="router-link-active router-link-exact-active toc-link level2">ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#ä»¥-cacheableä¸ºä¾‹" class="router-link-active router-link-exact-active toc-link level3">ä»¥@Cacheableä¸ºä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å°ç»“-3" class="router-link-active router-link-exact-active toc-link level3">å°ç»“ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#cacheputçš„ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level2">@CachePutçš„ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#cacheevict-æ¸…é™¤ç¼“å­˜" class="router-link-active router-link-exact-active toc-link level2">@CacheEvict æ¸…é™¤ç¼“å­˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#cachingå’Œ-cacheconfig" class="router-link-active router-link-exact-active toc-link level2">@Cachingå’Œ@CacheConfig</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#caching" class="router-link-active router-link-exact-active toc-link level3">@Caching</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#cacheconfig" class="router-link-active router-link-exact-active toc-link level3">@CacheConfig</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆç¼“å­˜ä¸­é—´ä»¶redis" class="router-link-active router-link-exact-active toc-link level2">æ•´åˆç¼“å­˜ä¸­é—´ä»¶Redis</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è‡ªå®šä¹‰rediscachemanager" class="router-link-active router-link-exact-active toc-link level2">è‡ªå®šä¹‰RedisCacheManager</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#springsecurityçš„ç®€å•ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level2">SpringSecurityçš„ç®€å•ä½¿ç”¨</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#thymeleafæ•´åˆspringsecurity" class="router-link-active router-link-exact-active toc-link level3">Thymeleafæ•´åˆSpringSecurity</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#è®°ä½æˆ‘" class="router-link-active router-link-exact-active toc-link level3">è®°ä½æˆ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢" class="router-link-active router-link-exact-active toc-link level3">å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#shiroçš„ç®€å•ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level2">Shiroçš„ç®€å•ä½¿ç”¨</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#å¼€å§‹é…ç½®ä¸€ä¸ªshiro" class="router-link-active router-link-exact-active toc-link level3">å¼€å§‹é…ç½®ä¸€ä¸ªshiro</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ•´åˆshiroå¯åŠ¨å™¨" class="router-link-active router-link-exact-active toc-link level3">æ•´åˆShiroå¯åŠ¨å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/fm/SpringBoot.html#æ‰©å±•" class="router-link-active router-link-exact-active toc-link level3">æ‰©å±•ï¼š</a></li><!----><!--]--></ul></li><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="spring-boot-note" tabindex="-1"><a class="header-anchor" href="#spring-boot-note" aria-hidden="true">#</a> Spring-Boot-Note</h1><ul><li><a href="#spring-boot-note">Spring-Boot-Note</a><ul><li><a href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA--%E7%AE%80%E5%8C%96%E9%83%A8%E7%BD%B2">ç¯å¢ƒæ­å»º &amp; ç®€åŒ–éƒ¨ç½²</a><ul><li><a href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA">ç¯å¢ƒæ­å»º</a></li><li><a href="#%E7%AE%80%E5%8C%96%E9%83%A8%E7%BD%B2">ç®€åŒ–éƒ¨ç½²</a></li></ul></li><li><a href="#springbootapplication%E5%90%AF%E5%8A%A8%E5%8E%9F%E7%90%86">@SpringBootApplicationå¯åŠ¨åŸç†</a></li><li><a href="#idea-%E5%BF%AB%E9%80%9F%E6%9E%84%E5%BB%BA">IDEA å¿«é€Ÿæ„å»º</a></li><li><a href="#yaml">YAML</a><ul><li><a href="#yaml%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95">YAMLåŸºæœ¬è¯­æ³•</a></li></ul></li><li><a href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">å•å…ƒæµ‹è¯•</a><ul><li><a href="#ssm">SSM</a></li><li><a href="#springboot">SpringBoot</a></li></ul></li><li><a href="#configurationpropertiesvalue">@ConfigurationProperties&amp;@Value</a></li><li><a href="#propertysourceimportresource">@PropertySource&amp;@ImportResource</a><ul><li><a href="#%E6%8E%A8%E8%8D%90%E8%87%AA%E5%B7%B1%E5%88%9B%E5%BB%BA%E4%B8%AA%E9%85%8D%E7%BD%AE%E7%B1%BB">ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»</a></li><li><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%8D%A0%E4%BD%8D%E7%AC%A6">é…ç½®æ–‡ä»¶çš„å ä½ç¬¦</a></li><li><a href="#%E5%A4%9Aprofile%E6%94%AF%E6%8C%81">å¤šProfileæ”¯æŒ</a></li></ul></li><li><a href="#%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%92%8C%E4%BC%98%E5%85%88%E7%BA%A7">åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§</a></li><li><a href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86">è‡ªåŠ¨é…ç½®åŸç†</a><ul><li><a href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86-1">è‡ªåŠ¨é…ç½®åŸç†</a></li><li><a href="#%E4%BB%A5httpencodingautoconfiguration%E4%B8%BA%E4%BE%8B%E8%A7%A3%E9%87%8A%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86">ä»¥HttpEncodingAutoConfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†</a></li><li><a href="#%E5%B0%8F%E7%BB%93">å°ç»“</a></li></ul></li><li><a href="#conditional%E7%9B%B8%E5%85%B3%E6%B3%A8%E8%A7%A3%E5%92%8Cdebug">@Conditionalç›¸å…³æ³¨è§£å’ŒDebug</a></li><li><a href="#%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6sl4j">æ—¥å¿—æ¡†æ¶SL4J</a><ul><li><a href="#%E5%85%B6%E4%BB%96%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6%E8%BD%AC%E6%8D%A2%E4%B8%BAsl4j">å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºSL4J</a></li><li><a href="#springboot%E5%92%8C%E6%97%A5%E5%BF%97%E5%85%B3%E7%B3%BB">SpringBootå’Œæ—¥å¿—å…³ç³»</a></li><li><a href="#%E6%97%A5%E5%BF%97%E7%9A%84%E9%85%8D%E7%BD%AE">æ—¥å¿—çš„é…ç½®</a></li><li><a href="#%E6%8C%87%E5%AE%9A%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6">æŒ‡å®šæ—¥å¿—æ¡†æ¶</a></li><li><a href="#%E5%88%87%E6%8D%A2%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6">åˆ‡æ¢æ—¥å¿—æ¡†æ¶</a></li></ul></li><li><a href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%98%A0%E5%B0%84%E8%A7%84%E5%88%99">é™æ€èµ„æºæ˜ å°„è§„åˆ™</a></li><li><a href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8Ethymeleaf">æ¨¡æ¿å¼•æ“Thymeleaf</a></li><li><a href="#springmvc%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86">SpringMVCè‡ªåŠ¨é…ç½®åŸç†</a><ul><li><a href="#%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE">é»˜è®¤é…ç½®</a></li><li><a href="#contentnegotiatingviewresolver">ContentNegotiatingViewResolver</a></li><li><a href="#httpmessageconverters">HttpMessageConverters</a></li><li><a href="#messagecodesresolver">MessageCodesResolver</a></li><li><a href="#springboot%E5%9C%A8springmvc%E7%9A%84%E9%85%8D%E7%BD%AE%E6%A8%A1%E5%BC%8F">SpringBootåœ¨SpringMVCçš„é…ç½®æ¨¡å¼</a></li><li><a href="#%E6%8E%A5%E7%AE%A1springboot%E7%9A%84springmvc">æ¥ç®¡SpringBootçš„SpringMVC</a></li><li><a href="#%E5%B0%8F%E7%BB%93-1">å°ç»“ï¼š</a></li></ul></li><li><a href="#%E5%9B%BD%E9%99%85%E5%8C%96">å›½é™…åŒ–</a><ul><li><a href="#%E4%BD%BF%E7%94%A8thymeleaf%E5%9B%BD%E9%99%85%E5%8C%96">ä½¿ç”¨thymeleafå›½é™…åŒ–</a></li><li><a href="#springboot%E5%8C%BA%E5%9F%9F%E4%BF%A1%E6%81%AF%E8%A7%A3%E6%9E%90%E5%99%A8">SpringBootåŒºåŸŸä¿¡æ¯è§£æå™¨</a></li><li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9B%BD%E9%99%85%E5%8C%96">è‡ªå®šä¹‰å›½é™…åŒ–</a></li></ul></li><li><a href="#%E6%8B%A6%E6%88%AA%E5%99%A8">æ‹¦æˆªå™¨</a></li><li><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E5%8E%9F%E7%90%86">é”™è¯¯å¤„ç†åŸç†</a></li><li><a href="#%E5%AE%9A%E5%88%B6%E9%94%99%E8%AF%AF%E9%A1%B5%E9%9D%A2%E5%92%8Cjson%E9%94%99%E8%AF%AF%E6%95%B0%E6%8D%AE">å®šåˆ¶é”™è¯¯é¡µé¢å’ŒJSONé”™è¯¯æ•°æ®</a><ul><li><a href="#%E5%AE%9A%E5%88%B6%E4%B8%80%E4%B8%AAjson%E6%95%B0%E6%8D%AE">å®šåˆ¶ä¸€ä¸ªJSONæ•°æ®</a></li></ul></li><li><a href="#%E5%B5%8C%E5%85%A5%E5%BC%8Fservlet">åµŒå…¥å¼Servlet</a><ul><li><a href="#spring%E4%B8%A4%E7%A7%8D%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F">Springä¸¤ç§é…ç½®æ–¹å¼ï¼š</a></li><li><a href="#%E5%B5%8C%E5%85%A5%E5%BC%8Fservlet%E4%B8%A4%E7%A7%8D%E4%BF%AE%E6%94%B9%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE">åµŒå…¥å¼Servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®</a></li><li><a href="#%E6%B3%A8%E5%86%8C%E4%B8%89%E5%A4%A7%E7%BB%84%E4%BB%B6">æ³¨å†Œä¸‰å¤§ç»„ä»¶</a><ul><li><a href="#%E5%AE%9A%E5%88%B6servlet">å®šåˆ¶Servlet</a></li><li><a href="#%E5%AE%9A%E5%88%B6filter">å®šåˆ¶Filter</a></li><li><a href="#%E5%AE%9A%E5%88%B6listener">å®šåˆ¶Listener</a></li></ul></li></ul></li><li><a href="#%E6%BA%90%E7%A0%81%E5%88%A8%E6%9E%90-%E5%B5%8C%E5%85%A5%E5%BC%8Fservlet%E5%8E%9F%E7%90%86">æºç åˆ¨æ åµŒå…¥å¼ServletåŸç†</a><ul><li><a href="#%E4%BB%A5tomcat%E4%B8%BA%E4%BE%8B">ä»¥Tomcatä¸ºä¾‹</a></li><li><a href="#%E9%85%8D%E7%BD%AE%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E5%8E%9F%E7%90%86">é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†</a></li><li><a href="#%E5%B0%8F%E7%BB%93-2">å°ç»“ï¼š</a></li></ul></li><li><a href="#%E5%B5%8C%E5%85%A5%E5%BC%8Fservlet%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86">åµŒå…¥å¼Servletè‡ªåŠ¨é…ç½®åŸç†</a></li><li><a href="#%E6%95%B4%E5%90%88jdbc">æ•´åˆJDBC</a><ul><li><a href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86-2">è‡ªåŠ¨é…ç½®åŸç†</a></li></ul></li><li><a href="#%E6%95%B4%E5%90%88druid">æ•´åˆDruid</a></li><li><a href="#%E6%95%B4%E5%90%88mybatis">æ•´åˆMybatis</a><ul><li><a href="#maven">Maven</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3">ä½¿ç”¨æ³¨è§£</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">ä½¿ç”¨é…ç½®æ–‡ä»¶</a></li></ul></li><li><a href="#springboot%E5%90%AF%E5%8A%A8%E5%8E%9F%E7%90%86">SpringBootå¯åŠ¨åŸç†</a><ul><li><a href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%E5%88%9B%E5%BB%BAspringapplication%E5%AF%B9%E8%B1%A1">ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºSpringApplicationå¯¹è±¡</a></li><li><a href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%E5%90%AF%E5%8A%A8%E5%BA%94%E7%94%A8">ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åº”ç”¨</a></li></ul></li><li><a href="#%E5%9F%BA%E4%BA%8E%E5%8E%9F%E7%90%86%E7%9A%84%E6%B5%8B%E8%AF%95%E7%AC%94%E8%AE%B0%E6%B5%8B%E8%AF%95%E5%90%AF%E5%8A%A8%E7%9A%84%E5%9B%9B%E4%B8%AA%E7%B1%BB">ï¼ˆåŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°ï¼‰æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»</a></li><li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89starters%E6%9A%82%E6%97%B6%E6%97%A0%E6%B3%95%E7%90%86%E8%A7%A3">è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘</a></li><li><a href="#springboot%E7%BC%93%E5%AD%98%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">SpringBootç¼“å­˜åŸºæœ¬ä½¿ç”¨</a><ul><li><a href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">åŸºæœ¬ä½¿ç”¨</a></li><li><a href="#%E5%87%A0%E4%B8%AA%E5%B1%9E%E6%80%A7%E4%BB%8B%E7%BB%8D">å‡ ä¸ªå±æ€§ä»‹ç»</a></li></ul></li><li><a href="#%E7%BC%93%E5%AD%98%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86">ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†</a><ul><li><a href="#%E4%BB%A5cacheable%E4%B8%BA%E4%BE%8B">ä»¥@Cacheableä¸ºä¾‹</a></li><li><a href="#%E5%B0%8F%E7%BB%93-3">å°ç»“ï¼š</a><ul><li><a href="#%E6%A0%B8%E5%BF%83">æ ¸å¿ƒï¼š</a></li><li><a href="#%E6%80%9D%E8%B7%AF%E6%95%B4%E7%90%86">æ€è·¯æ•´ç†</a></li></ul></li></ul></li><li><a href="#cacheput%E7%9A%84%E4%BD%BF%E7%94%A8">@CachePutçš„ä½¿ç”¨</a></li><li><a href="#cacheevict-%E6%B8%85%E9%99%A4%E7%BC%93%E5%AD%98">@CacheEvict æ¸…é™¤ç¼“å­˜</a></li><li><a href="#caching%E5%92%8Ccacheconfig">@Cachingå’Œ@CacheConfig</a><ul><li><a href="#caching">@Caching</a></li><li><a href="#cacheconfig">@CacheConfig</a></li></ul></li><li><a href="#%E6%95%B4%E5%90%88%E7%BC%93%E5%AD%98%E4%B8%AD%E9%97%B4%E4%BB%B6redis">æ•´åˆç¼“å­˜ä¸­é—´ä»¶Redis</a></li><li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89rediscachemanager">è‡ªå®šä¹‰RedisCacheManager</a><ul><li><a href="#%E6%89%A9%E5%B1%95cachemanager%E7%9A%84%E7%94%A8%E6%B3%95">æ‰©å±•CacheManagerçš„ç”¨æ³•</a></li></ul></li><li><a href="#springsecurity%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8">SpringSecurityçš„ç®€å•ä½¿ç”¨</a><ul><li><a href="#thymeleaf%E6%95%B4%E5%90%88springsecurity">Thymeleafæ•´åˆSpringSecurity</a></li><li><a href="#%E8%AE%B0%E4%BD%8F%E6%88%91"><strong>è®°ä½æˆ‘</strong></a></li><li><a href="#%E5%AE%9A%E5%88%B6%E8%87%AA%E5%B7%B1%E7%9A%84%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2">å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢</a></li></ul></li><li><a href="#shiro%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8">Shiroçš„ç®€å•ä½¿ç”¨</a><ul><li><a href="#%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AE%E4%B8%80%E4%B8%AAshiro">å¼€å§‹é…ç½®ä¸€ä¸ªshiro</a></li><li><a href="#%E6%95%B4%E5%90%88shiro%E5%90%AF%E5%8A%A8%E5%99%A8">æ•´åˆShiroå¯åŠ¨å™¨</a></li><li><a href="#%E6%89%A9%E5%B1%95">æ‰©å±•ï¼š</a><ul><li><a href="#shiro%E9%BB%98%E8%AE%A4%E8%BF%87%E6%BB%A4%E5%99%A8">shiroé»˜è®¤è¿‡æ»¤å™¨</a></li><li><a href="#shiro%E5%B8%B8%E7%94%A8%E7%9A%84%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E6%B3%A8%E8%A7%A3%E5%8F%AF%E4%BB%A5%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%99%A8%E7%B1%BB%E4%B8%8A%E4%BD%BF%E7%94%A8">shiroå¸¸ç”¨çš„æƒé™æ§åˆ¶æ³¨è§£ï¼Œå¯ä»¥åœ¨æ§åˆ¶å™¨ç±»ä¸Šä½¿ç”¨</a></li></ul></li></ul></li></ul></li></ul><h2 id="ç¯å¢ƒæ­å»º-ç®€åŒ–éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒæ­å»º-ç®€åŒ–éƒ¨ç½²" aria-hidden="true">#</a> ç¯å¢ƒæ­å»º &amp; ç®€åŒ–éƒ¨ç½²</h2><h3 id="ç¯å¢ƒæ­å»º" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒæ­å»º" aria-hidden="true">#</a> ç¯å¢ƒæ­å»º</h3><p>å¯¼åŒ…ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--Spring Bootçš„ç‰ˆæœ¬ä»²è£ä¸­å¿ƒ--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.1.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--
Spring Bootå°†æ‰€æœ‰çš„åŠŸèƒ½åœºæ™¯éƒ½æŠ½å–å‡ºæ¥ï¼Œåšæˆä¸€ä¸ªä¸ªçš„startersï¼ˆå¯åŠ¨å™¨ï¼‰ï¼Œ
åªéœ€è¦åœ¨é¡¹ç›®é‡Œé¢å¼•å…¥è¿™äº›starterç›¸å…³åœºæ™¯çš„æ‰€æœ‰ä¾èµ–éƒ½ä¼šå¯¼å…¥è¿›æ¥ã€‚è¦ç”¨ä»€ä¹ˆåŠŸèƒ½å°±å¯¼å…¥ä»€ä¹ˆåœºæ™¯çš„å¯åŠ¨å™¨
--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨é»˜è®¤åŒ…ä¸‹åˆ›å»ºä¸€ä¸ªå¯åŠ¨å™¨ æ ‡æ³¨ä¸ºSpringBootç¨‹åº**@SpringBootApplication**</p><p><strong>æ³¨ï¼šè¿™ä¸ªç±»å¿…é¡»å’Œcontrolleråœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼Œä¸ç„¶å°±æ— æ³•è®¿é—®controller</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorldApplicationContext</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">HelloWorldApplicationContext</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç®€åŒ–éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#ç®€åŒ–éƒ¨ç½²" aria-hidden="true">#</a> ç®€åŒ–éƒ¨ç½²</h3><p>Mavenä¸‹å¯¼å…¥è¿™ä¸ªæ’ä»¶ç‚¹å‡»packageå³å¯æ‰“åŒ…æˆåŠŸ</p><p>java -jar åŒ…åæ—¢å¯ä»¥è¿è¡Œ</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/1-c61d0d80.png" alt="1" tabindex="0" loading="lazy"><figcaption>1</figcaption></figure><p>ä¸€äº›åœºæ™¯å¯åŠ¨å™¨ï¼š</p><table><thead><tr><th>åç§°</th><th>æè¿°</th><th>Pom</th></tr></thead><tbody><tr><td><code>spring-boot-starter</code></td><td>æ ¸å¿ƒ starterï¼ŒåŒ…æ‹¬ auto-configuration æ”¯æŒï¼Œlogging å’Œ YAML</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-activemq</code></td><td>Starter ä½¿ç”¨ Apache ActiveMQ è¿›è¡Œ JMS æ¶ˆæ¯ä¼ é€’</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-amqp</code></td><td>Starter ç”¨äºä½¿ç”¨ Spring AMQP å’Œ Rabbit MQ</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-aop</code></td><td>ä½¿ç”¨ Spring AOP å’Œ AspectJ è¿›è¡Œ aspect-oriented ç¼–ç¨‹çš„ Starter</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-artemis</code></td><td>Starter ä½¿ç”¨ Apache Artemis è¿›è¡Œ JMS æ¶ˆæ¯ä¼ é€’</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-batch</code></td><td>Starter ä½¿ç”¨ Spring Batch</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-cache</code></td><td>Starter ç”¨äºä½¿ç”¨ Spring Framework çš„ç¼“å­˜æ”¯æŒ</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-cloud-connectors</code></td><td>Starter ä½¿ç”¨ Spring Cloud è¿æ¥å™¨ç®€åŒ–è¿æ¥åˆ°äº‘å¹³å°ä¸­çš„æœåŠ¡ï¼Œå¦‚ Cloud Foundry å’Œ Heroku</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-cassandra</code></td><td>Starter ç”¨äºä½¿ç”¨ Cassandra åˆ†å¸ƒå¼æ•°æ®åº“å’Œ Spring Data Cassandra</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-cassandra-reactive</code></td><td>Starter ç”¨äºä½¿ç”¨ Cassandra åˆ†å¸ƒå¼æ•°æ®åº“å’Œ Spring Data Cassandra Reactive</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-couchbase</code></td><td>Starter ç”¨äºä½¿ç”¨ Couchbase document-oriented æ•°æ®åº“å’Œ Spring Data Couchbase</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-couchbase-reactive</code></td><td>Starter ç”¨äºä½¿ç”¨ Couchbase document-oriented æ•°æ®åº“å’Œ Spring Data Couchbase Reactive</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-elasticsearch</code></td><td>Starter ç”¨äºä½¿ç”¨ Elasticsearch æœç´¢å’Œåˆ†æå¼•æ“å’Œ Spring Data Elasticsearch</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-jdbc</code></td><td>Starter ä½¿ç”¨ Spring Data JDBC</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-jpa</code></td><td>Starter ä½¿ç”¨ Spring Data JPA å’Œ Hibernate</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-ldap</code></td><td>Starter ä½¿ç”¨ Spring Data LDAP</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-mongodb</code></td><td>Starter ç”¨äºä½¿ç”¨ MongoDB document-oriented æ•°æ®åº“å’Œ Spring Data MongoDB</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-mongodb-reactive</code></td><td>Starter ç”¨äºä½¿ç”¨ MongoDB document-oriented æ•°æ®åº“å’Œ Spring Data MongoDB Reactive</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-neo4j</code></td><td>Starter ç”¨äºä½¿ç”¨ Neo4j å›¾å½¢æ•°æ®åº“å’Œ Spring Data Neo4j</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-redis</code></td><td>Starter ä½¿ç”¨ Redis key-value data store ä¸ Spring Data Redis å’Œ Lettuce client</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-redis-reactive</code></td><td>Starter ç”¨äºå°† Redis key-value data store ä¸ Spring Data Redis reactive å’Œ Lettuce client ä¸€èµ·ä½¿ç”¨</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-rest</code></td><td>Starter ä½¿ç”¨ Spring Data REST åœ¨ REST ä¸Šå…¬å¼€ Spring Data repositories</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-data-solr</code></td><td>Starter å°† Apache Solr æœç´¢å¹³å°ä¸ Spring Data Solr ä¸€èµ·ä½¿ç”¨</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-freemarker</code></td><td>Starter for building MVC web applications ä½¿ç”¨ FreeMarker è§†å›¾</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-groovy-templates</code></td><td>Starter for building MVC web applications ä½¿ç”¨ Groovy æ¨¡æ¿è§†å›¾</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-hateoas</code></td><td>Starter for building hypermedia-based RESTful web application with Spring MVC and Spring HATEOAS</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-integration</code></td><td>Starter ä½¿ç”¨ Spring Integration</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-jdbc</code></td><td>Starter ç”¨äºå°† JDBC ä¸ HikariCP è¿æ¥æ± ä¸€èµ·ä½¿ç”¨</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-jersey</code></td><td>Starter for building RESTful web applications ä½¿ç”¨ JAX-RS å’Œ Jerseyã€‚ spring-boot-starter-webçš„æ›¿ä»£æ–¹æ¡ˆ</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-jooq</code></td><td>Starter ç”¨äºä½¿ç”¨ jOOQ è®¿é—® SQL æ•°æ®åº“ã€‚ spring-boot-starter-data-jpaæˆ–spring-boot-starter-jdbcçš„æ›¿ä»£æ–¹æ¡ˆ</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-json</code></td><td>Starter ç”¨äºè¯»å†™ json</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-jta-atomikos</code></td><td>Starter for JTA transactions ä½¿ç”¨ Atomikos</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-jta-bitronix</code></td><td>Starter for JTA transactions ä½¿ç”¨ Bitronix</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-mail</code></td><td>Starter ç”¨äºä½¿ç”¨ Java Mail å’Œ Spring Framework çš„ç”µå­é‚®ä»¶å‘é€æ”¯æŒ</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-mustache</code></td><td>Starter for building web applications ä½¿ç”¨ Mustache è§†å›¾</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-oauth2-client</code></td><td>Starter ä½¿ç”¨ Spring Security çš„ OAuth2/OpenID Connect client features</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-oauth2-resource-server</code></td><td>Starter ç”¨äºä½¿ç”¨ Spring Security çš„ OAuth2 èµ„æºæœåŠ¡å™¨ features</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-quartz</code></td><td>Starter ç”¨äºä½¿ç”¨ Quartz è°ƒåº¦ç¨‹åº</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-security</code></td><td>Starter ä½¿ç”¨ Spring Security</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-test</code></td><td>Starter ç”¨äºæµ‹è¯• Spring Boot applications with librariesï¼ŒåŒ…æ‹¬ JUnitï¼ŒHamcrest å’Œ Mockito</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-thymeleaf</code></td><td>Starter for building MVC web applications ä½¿ç”¨ Thymeleaf è§†å›¾</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-validation</code></td><td>Starter ç”¨äºä½¿ç”¨ Hibernate Validator è¿›è¡Œ Java Bean éªŒè¯</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-web</code></td><td>Starter for building webï¼ŒåŒ…æ‹¬ä½¿ç”¨ Spring MVC çš„ RESTfulï¼Œapplicationsã€‚ä½¿ç”¨ Tomcat ä½œä¸ºé»˜è®¤åµŒå…¥å¼å®¹å™¨</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-web-services</code></td><td>Starter ä½¿ç”¨ Spring Web Services</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-webflux</code></td><td>Starter for building WebFlux applications ä½¿ç”¨ Spring Framework çš„ Reactive Web æ”¯æŒ</td><td>Pom</td></tr><tr><td><code>spring-boot-starter-websocket</code></td><td>Starter for building WebSocket applications ä½¿ç”¨ Spring Framework çš„ WebSocket æ”¯æŒ</td><td>Pom</td></tr></tbody></table><h2 id="springbootapplicationå¯åŠ¨åŸç†" tabindex="-1"><a class="header-anchor" href="#springbootapplicationå¯åŠ¨åŸç†" aria-hidden="true">#</a> @SpringBootApplicationå¯åŠ¨åŸç†</h2><p><strong>@SpringBootApplication</strong></p><p>Spring Bootåº”ç”¨æ ‡æ³¨åœ¨æŸä¸ªç±»ä¸Šè¯´æ˜è¿™ä¸ªç±»æ˜¯SpringBootçš„ä¸»é…ç½®ç±»ï¼ŒSpringBootå°±åº”è¯¥è¿è¡Œè¿™ä¸ªç±»çš„mainæ–¹æ³•æ¥å¯åŠ¨SpringBootåº”ç”¨</p><p>ä¸‹é¢æ˜¯è¿™ä¸ªæ³¨è§£çš„å†…éƒ¨ï¼šç»„åˆæ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Inherited</span>
<span class="token annotation punctuation">@SpringBootConfiguration</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">TypeExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">AutoConfigurationExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootApplication</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**@SpringBootConfigurationï¼š**Spring Bootçš„é…ç½®ç±»ï¼›</p><p>â€‹ æ ‡æ³¨åœ¨æŸä¸ªç±»ä¸Šï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªSpring Bootçš„é…ç½®ç±»ï¼›</p><p>è¿™ä¸ªæ³¨è§£è¿›å»åæ˜¯ä¸€ä¸ªæ ‡æ³¨äº†**@Configuration**çš„ç±»ï¼š</p><p>é…ç½®ç±»ä¸Šæ¥æ ‡æ³¨è¿™ä¸ªæ³¨è§£ï¼›é…ç½®ç±» ----- é…ç½®æ–‡ä»¶ï¼›é…ç½®ç±»ä¹Ÿæ˜¯å®¹å™¨ä¸­çš„ä¸€ä¸ªç»„ä»¶</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootConfiguration</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**@EnableAutoConfigurationï¼š**å¼€å¯è‡ªåŠ¨é…ç½®åŠŸèƒ½</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Inherited</span>
<span class="token annotation punctuation">@AutoConfigurationPackage</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableAutoConfiguration</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**@AutoConfigurationPackageï¼š**è‡ªåŠ¨é…ç½®åŒ…</p><p>**@Import(AutoConfigurationPackages.Registrar.class)ï¼š**Springçš„åº•å±‚æ³¨è§£@Importï¼Œç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶ï¼›å¯¼å…¥çš„ç»„ä»¶ç”±AutoConfigurationPackages.Registrar.class</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Inherited</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationPackages<span class="token punctuation">.</span>Registrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">AutoConfigurationPackage</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†…éƒ¨æ³¨å†ŒSpringBootå¯åŠ¨å™¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Registrar</span> <span class="token keyword">implements</span> <span class="token class-name">ImportBeanDefinitionRegistrar</span><span class="token punctuation">,</span> <span class="token class-name">DeterminableImports</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">register</span><span class="token punctuation">(</span>registry<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PackageImports</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackageNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">determineImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PackageImports</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è°ƒè¯•å¯ä»¥çœ‹å‡º</p><figure><img src="/Computer-Science-Learn-Notes/assets/2-6fc9b616.png" alt="2" tabindex="0" loading="lazy"><figcaption>2</figcaption></figure><p>å†æ¬¡è°ƒè¯•è¿™æ®µï¼š<em>register(registry, new PackageImports(metadata).getPackageNames().toArray(new String[0]));</em></p><figure><img src="/Computer-Science-Learn-Notes/assets/3-c35afec2.png" alt="3" tabindex="0" loading="lazy"><figcaption>3</figcaption></figure><p>å¯å¾—å‡ºç»“è®ºï¼šå°†<strong>ä¸»é…ç½®ç±»ï¼ˆ@SpringBootApplicationæ ‡æ³¨çš„ç±»ï¼‰çš„æ‰€åœ¨åŒ…åŠä¸‹é¢æ‰€æœ‰å­åŒ…é‡Œé¢çš„æ‰€æœ‰ç»„ä»¶æ‰«æåˆ°Springå®¹å™¨</strong></p><p>å†çœ‹**EnableAutoConfigurationçš„****@Import(AutoConfigurationImportSelector.class)**ç»™å®¹å™¨å¯¼å…¥ç»„ä»¶ï¼Œå°†æ‰€æœ‰éœ€è¦å¯¼å…¥çš„ç»„ä»¶ä»¥å…¨ç±»åçš„æ–¹å¼è¿”å›ï¼›è¿™äº›ç»„ä»¶å°±ä¼šè¢«æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼›</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">NO_IMPORTS</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">AutoConfigurationEntry</span> autoConfigurationEntry <span class="token operator">=</span> <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">toStringArray</span><span class="token punctuation">(</span>autoConfigurationEntry<span class="token punctuation">.</span><span class="token function">getConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è§‚å¯Ÿï¼Œè¿™ä¸ª2.0çš„SpringBootæ˜¯è·³è½¬åˆ°äº†<strong>getAutoConfigurationEntry</strong>è¿›è¡Œäº†éå†ä¾èµ–åŒ…</p><p>é€šè¿‡å•æ­¥è°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªä¼šç»™å®¹å™¨ä¸­å¯¼å…¥éå¸¸å¤šçš„è‡ªåŠ¨é…ç½®ç±»ï¼ˆxxxAutoConfigurationï¼‰ï¼›å°±æ˜¯ç»™å®¹å™¨ä¸­å¯¼å…¥è¿™ä¸ªåœºæ™¯éœ€è¦çš„æ‰€æœ‰ç»„ä»¶ï¼Œå¹¶é…ç½®å¥½è¿™äº›ç»„ä»¶ï¼›è‡ªåŠ¨é…ç½®ç±»</p><figure><img src="/Computer-Science-Learn-Notes/assets/4-49d73156.png" alt="4" tabindex="0" loading="lazy"><figcaption>4</figcaption></figure><p>å¯ä»¥è§‚å¯Ÿåˆ°è¿™ä¸ªæŸ¥åˆ°åŒ…çš„è°ƒç”¨æ–¹å¼ï¼šgetCandidateConfigurations</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">AutoConfigurationEntry</span> <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">EMPTY_ENTRY</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">AnnotationAttributes</span> attributes <span class="token operator">=</span> <span class="token function">getAttributes</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations <span class="token operator">=</span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    configurations <span class="token operator">=</span> <span class="token function">removeDuplicates</span><span class="token punctuation">(</span>configurations<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> exclusions <span class="token operator">=</span> <span class="token function">getExclusions</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">checkExcludedClasses</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
    configurations<span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span>exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
    configurations <span class="token operator">=</span> <span class="token function">getConfigurationClassFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>configurations<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fireAutoConfigurationImportEvents</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AutoConfigurationEntry</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è°ƒç”¨getSpringFactoriesLoaderFactoryClass</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">AnnotationAttributes</span> attributes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations <span class="token operator">=</span> <span class="token class-name">SpringFactoriesLoader</span><span class="token punctuation">.</span><span class="token function">loadFactoryNames</span><span class="token punctuation">(</span><span class="token function">getSpringFactoriesLoaderFactoryClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                                         <span class="token function">getBeanClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notEmpty</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> <span class="token string">&quot;No auto configuration classes found in META-INF/spring.factories. If you &quot;</span>
                    <span class="token operator">+</span> <span class="token string">&quot;are using a custom packaging, make sure that file is correct.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> configurations<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªæ–¹æ³•ä¸­ï¼šloadFactoryNameså°±æ˜¯å¯¹è¿™ä¸ªSpringBootä¾èµ–åŒ…è¿›è¡ŒåŠ è½½ï¼ˆæŠŠå¾—åˆ°çš„propertiesæ·»åŠ åˆ°å®¹å™¨ä¸­è¿›è¡ŒåŠ è½½ï¼‰</p><figure><img src="/Computer-Science-Learn-Notes/assets/5-7858b046.png" alt="5" tabindex="0" loading="lazy"><figcaption>5</figcaption></figure><p>è¿™ä¸ª<strong>FACTORIES_RESOURCE_LOCATION</strong>é™æ€å˜é‡ä¹Ÿæ ‡è¯†äº†è¿™äº›<strong>åŒ…çš„è·¯å¾„ä½ç½®</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">FACTORIES_RESOURCE_LOCATION</span> <span class="token operator">=</span> <span class="token string">&quot;META-INF/spring.factories&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä»”ç»†çœ‹ï¼Œè¿˜çœŸæ˜¯ã€‚SpringBootå°†è¿™äº›å€¼ä½œä¸ºè‡ªåŠ¨é…ç½®ç±»å¯¼å…¥åˆ°å®¹å™¨ä¸­ï¼Œè‡ªåŠ¨é…ç½®ç±»å°±ç”Ÿæ•ˆ</p><figure><img src="/Computer-Science-Learn-Notes/assets/6-728cd3de.png" alt="6" tabindex="0" loading="lazy"><figcaption>6</figcaption></figure><p><strong>å°ç»“</strong></p><p>å°†META-INF/spring.factoriesé‡Œé¢é…ç½®çš„æ‰€æœ‰é€šè¿‡EnableAutoConfigurationåŠ å…¥åˆ°å®¹å™¨ä¸­</p><h2 id="idea-å¿«é€Ÿæ„å»º" tabindex="-1"><a class="header-anchor" href="#idea-å¿«é€Ÿæ„å»º" aria-hidden="true">#</a> IDEA å¿«é€Ÿæ„å»º</h2><figure><img src="/Computer-Science-Learn-Notes/assets/7-b3e58ae4.png" alt="7" tabindex="0" loading="lazy"><figcaption>7</figcaption></figure><p>é»˜è®¤ç”Ÿæˆçš„Spring Booté¡¹ç›®ç»“æœ</p><p>resourcesæ–‡ä»¶å¤¹ä¸­ç›®å½•ç»“æ„</p><ul><li><strong>static</strong>ï¼šä¿å­˜æ‰€æœ‰çš„é™æ€èµ„æºï¼› js css imagesï¼›</li><li></li><li><strong>templates</strong>ï¼šä¿å­˜æ‰€æœ‰çš„æ¨¡æ¿é¡µé¢ï¼›ï¼ˆSpring Booté»˜è®¤jaråŒ…ä½¿ç”¨åµŒå…¥å¼çš„Tomcatï¼Œé»˜è®¤ä¸æ”¯æŒJSPé¡µé¢ï¼‰ï¼›å¯ä»¥ä½¿ç”¨æ¨¡æ¿å¼•æ“ï¼ˆfreemarkerã€thymeleafï¼‰ï¼›</li><li><strong>application.properties</strong>ï¼šSpring Bootåº”ç”¨çš„é…ç½®æ–‡ä»¶ï¼›å¯ä»¥ä¿®æ”¹ä¸€äº›é»˜è®¤è®¾ç½®ï¼›</li></ul><h2 id="yaml" tabindex="-1"><a class="header-anchor" href="#yaml" aria-hidden="true">#</a> YAML</h2><p>XMLå’ŒYAMLåŒºåˆ«ï¼š</p><p>XMLï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;server&gt;
    &lt;port&gt;8080&lt;/port&gt;
&lt;/server&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>YAML:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>server:
  port: 8080
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="yamlåŸºæœ¬è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#yamlåŸºæœ¬è¯­æ³•" aria-hidden="true">#</a> YAMLåŸºæœ¬è¯­æ³•</h3><p>å†™æ³•ï¼šKey:(ç©ºæ ¼)Value</p><p>å…¶ä»–æ•°ç»„ã€å¯¹è±¡è¯­æ³•å¯ä»¥é˜…è¯»ï¼š<a href="https://juejin.im/post/5c1a4a0fe51d45344a1c3d2a" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5c1a4a0fe51d45344a1c3d2a<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å°†YAMLçš„é…ç½®çš„å±æ€§æ˜ å°„åˆ°å®ä½“ç±»ä¸­**@ConfigurationProperties**å¯¹å®ä½“ç±»çš„é…ç½®è¿›è¡Œç»‘å®š</p><p>**prefixï¼š**é…ç½®ç”¨å“ªä¸ªè¿›è¡Œç»‘å®š</p><p>åœ¨YAMLå¯ä»¥é…ç½®è¿™æ ·ä¸€ä¸ªæ¡ˆä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token key atrule">person</span><span class="token punctuation">:</span>
  <span class="token key atrule">lastName</span><span class="token punctuation">:</span> å¼ ä¸‰
  <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">18</span>
  <span class="token key atrule">isBoss</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">birthday</span><span class="token punctuation">:</span> 2020/2/2
  <span class="token key atrule">map</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">k1</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token key atrule">k2</span><span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">}</span>
  <span class="token key atrule">list</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> lisi
    <span class="token punctuation">-</span> zhaoliu
  <span class="token key atrule">dog</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> å°ç‹—
    <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥åˆ›å»ºä¸€ä¸ªå®ä½“ç±»è¿›è¡Œç»‘å®šæµ‹è¯•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;person&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> isBoss<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Dog</span> dog<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½¿ç”¨ConfigurationPropertieså‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfEAAAAkCAYAAACZtgNVAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAnFSURBVHhe7ZtLbxxFEMfzfXIiCIl4bScBEiC8FwIScCJAFixMnA0KAS0YISSIeSQmyBJC4mBZ3CzOzgfgYzVd1dPTj6menpl9eCf7P/y0mame6uqq6qnu9uTM+oVLijh37hz/AgAAWB1eHb4FegyKOAAArDBXf/wP9BgUcQAAWGGkwgD6wxkq3gAAAFYTqTCA/hDsxG+vrQEAAACgJ6CIAwAAAD0FRRwAAADoKSjiAAAAQE9BEQcAAAB6Chfxtc2rKOIAAABAzzBF/IX3UcQBAACAnoHjdNCY8XCods+fF2UAgMcTzPvl5sydj99Ua5tvzr2Ib19fF+/77I4m6vDoSB1rDvcnam/YPXHG54dqb39/Kh0pSPeB1n0YMJ290xL4bjJSuzO0hcd7dKIePXqkjk/21b2n35ibb7syz3j7jIcjE/vRUJQvO4ueFwfaTygA/aQP857Y2z9Rx5N+zsdZcOby5sW5F/Gb726oG/cvqZ2X04WcAnFyYgrQXlGQ6PqgY8KMhxOdePMJ7vj8SB2S7iP/hXXEyX44ml2Cj0f76lgvDupegnainRTFe29ERWY638WQHSd6Eu8VdszTt02JfbMom3YnJs4nR/VxmQdN8iFmkX6S5sUx5+biffU40CXes2QZ573Eyhdx82HbnIr45pr67NNNNXpwSY3uX1TbH26I7ezkjwvgMq76iLS9+oW1PwruTQNPoswLkIqKP9Ess0zsJnYsmtOwyS6YDvVC6XCGi6SmdBnzIv0kzYuysK/wS7Yrpz3vlnHeS6CIz7CIj58ZqFuX19TOcKCL94Ya/XSRi7dl6/YF+blEUQzkenW/N6Rfc7xDO8+Dor2T0w7eFFJzT+9OdRvxed71u8Cbo8Bil0WyER07hm1cW62nQREnnaSDdBLxqrpOvjvRq3DdB9/X4zgWFgcpO2Lq+sn5RrLD963Vn/Idrd5Jv1/wbPswNi52ok6tixYs5reZTV3HnMLsRPRzWk/84sjpbNJnnc2pfFgmP3F7IR/tvHD6qrFO2ZCTV2Wj8FldiKwP/HdGVtbIL+E4fJr4rq6PJvOfaOcbaQyyfac570Obo3jGfeq+UMSnKeKDgbr53rramujd9m9hwQ74Ve/E9W78k2/lIk7wROegVP+eywHXCUVymxS7tEosrks5T0TzNzh7r0wY3ZaSkeTx83TN/etVJ+38/USSksPp1n3RRx/EyBw1+S+wqk5zbZOyTk7XbCPLzZisXospKm4MKer7qfeNZIfvW1m/851kI7UxO1qny49dVmcnm5qP2doZw6ce9mXD7fVLqLA378d8n/U2V8csP3N6fop1m3sm1sYeI8/H2tkgyQ/0tS1qob3Fs2VBMPbb7xd4jkZjk2RSn2E/8jh8rP5Zxzsm1iH5Jj2Gunyt9m/HvYh5b33A18V4cn3aNqtG9yK+vqa27lyoFmxdrG+9NBCfGV+R7xMcEG/1R8lkV4U24HGgbIDj5PKf8RNGermwXEw4uU9fRnb6+KvGOp25Pq2dueOsuJBIZO2I+jRy5xu+juxoOo42kznoP6OTrzvalOwzGnNMxSeRjpzOrDxjM1/HY14yP7n2+qVML34NvWRdYRD05WwQ5GU76VnvXttn62Q5v8SIY50y3jGzHkMlx5dh3nv3cn3ae6tG5yK+/cFGtYBrtu5sqm+uvaP+/OffCnRf0hVDwd4rPiByAQ+DR/DOSCfZt0/fqMiDhBOeDxKKkjUqhlYuJYeYgGSzv4rM6GzS5zST2JK1I+ObUkdqMuf0N5rMkbyDb1rZ1GDMMXYc9uNB8/Gl2yXkdGblXca8ZH6yuoOFLR+Z+n23i7UkL9uxTO8my49LzQem/olYuVPTO774lC8l6+KXmJzvcn3wNbWpm/9Z37Qbg29fqWPh8z4dz9R46b1rfbaKdC7in3wv7MI1O68M1P2ff+ei/UD/Ulv6pWu6H+upI9xpVyfNMhVxvu8lbjbJG/TJbeomccIOn6wdGd+UOhY+mdv5ppVNDcYcQ7lmX/gluj/bT05nVt5lzEvmJ193LHPydrGW5GU7Kyt2/T5BO63P/hdMqa9Y1sUvMTnf5frga2pTN/+b+KbFGHz7Sh2nMe8T8UyNF0VcF3GibRHnv3NHBXzrrtuF3/tyou5eeZ7b0i9dp3bj9H9v6f9Zx8kaH5fHgaor8kHCiXIvoaSE43tycvi6g/ucZEaPnMSeTRl5qa9mEhPsA6ENfZhCx5pZOzK+4evIjuw4PN/VyZP919hs49HaJl8u9RmN2cd/NnU/pzMrz9jM1/GYe+KnUB7py9kgyMt2CZm/2/b/HduXknXxS4zUZtp4x7T1TW4McWyXYd4T5QmJpLOwSXpPrwqdi/in31V34juvuV34l89dVg//+Ivb0i9dp3bjZSB0IbersOpxOu16XADDjzCEhCieaZqwphjaVeBIy4qdl5AcTre3WrTHq17S2wIrfVjSRM6TSK88fbtjSt+wnsKW4tuCcGxyP018UzeZnX7Zd1YXLba4P5IXx5ip2Didvs1hPGLfyDZ1H7OP7Uva8bDe5ELS6WzSZ53N3F7Ih+ozp+inSLcsbxLrcNyxPPXxFl3z6VwRqzJuVqavbRGok0l9+jalxuHTxHd1fXD7KHYSsY62H7bV2cf9+/ZE8TX65jfv6dqPZyw3YwrzfRXpXMRvvr1uvkjXO/Ktry+o7Y821HhjzRXxy1fUw4O/+d/0S9epIk7wbrxIAoKSw341WQac/n+uToxSXgSa5d61u0dfnxYJU5FTwhu5vaaEMEel1NYkoZQcVndwtEoUCevauSTjRItOG9rIaTLY+zH+BOG2nu9YXtNPI9/QC67yTHPf0QraxY3iaNqnYuPr5Gd07OkjR5rQ7mPH0Dcpm7qO2Yf6tS/GGPaN1nWP/qRTo7ORn2tsjuU2H4J7p+ynWLcsr491bENObmW0aCWZKSruWf+/SpncayZr65eYJr5rM+7U/K+3s90YKvad4rxPxdMfk5Tvq0jnIk7cenbAX6nf1sWbivr29Q13nH73G3X3xavqh63P+Zeu6X7Tj9t8OODCqm2W2L+7WEyf6V0FcMB3AKwemPfLwVRFnBhv6mL+8kDtvL7OfDFwu/EHvzxUP33xFf/W7cJzzLuI27/V8E5aJ6Y5GnJHT9IzwADfAbB6YN4vD1MXcQm7G4/psgsnzDGP+zvJPLBH0vZonP/LCZKxEfAdAKsH5v1yMJciDgAAAID5gyIOAAAA9BQUcQAAAKCnoIgDAAAAPQVFHAAAAOgpKOIAAABATwmK+LVr1wAAAADQE4Ii/sSTTz3W0IDPnj0LAAAAPBagiAMAAAA9BUUcAAAA6CVn1f9CBsguPwCdHgAAAABJRU5ErkJggg==" alt="8" tabindex="0" loading="lazy"><figcaption>8</figcaption></figure><p>è§£å†³æ–¹æ¡ˆï¼šå¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šè¿™é‡Œå¿…é¡»ä½¿ç”¨**@Component<strong>æŠŠå®ƒåŠ å…¥åˆ°å®¹å™¨ä¸­ï¼Œå°±åƒ</strong>@Repository**ä¸€æ ·æ‰èƒ½ä½¿ç”¨</p><p>æµ‹è¯•ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>Person<span class="token punctuation">{</span>lastName=&#39;å¼ ä¸‰&#39;<span class="token punctuation">,</span> age=<span class="token number">18</span><span class="token punctuation">,</span> isBoss=<span class="token null keyword">null</span><span class="token punctuation">,</span> birthday=Sun Feb <span class="token number">02</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> CST <span class="token number">2020</span><span class="token punctuation">,</span> map=<span class="token punctuation">{</span>k1=<span class="token number">12</span><span class="token punctuation">,</span> k2=<span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">,</span> list=<span class="token punctuation">[</span>lisi<span class="token punctuation">,</span> zhaoliu<span class="token punctuation">]</span><span class="token punctuation">,</span> dog=Dog<span class="token punctuation">{</span>name=&#39;å°ç‹—&#39;<span class="token punctuation">,</span> age=<span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="å•å…ƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#å•å…ƒæµ‹è¯•" aria-hidden="true">#</a> å•å…ƒæµ‹è¯•</h2><p>æ³¨ï¼šæµ‹è¯•ç±»å’Œä¸»ç±»è¦åŒ…åè¦ç»Ÿä¸€æ‰èƒ½å¯åŠ¨</p><figure><img src="/Computer-Science-Learn-Notes/assets/9-73c8ea91.png" alt="9" tabindex="0" loading="lazy"><figcaption>9</figcaption></figure><p><strong>ä½¿ç”¨SSMå’Œä½¿ç”¨SpringBootçš„TeståŠŸèƒ½çš„å¯¹æ¯”</strong></p><h3 id="ssm" tabindex="-1"><a class="header-anchor" href="#ssm" aria-hidden="true">#</a> SSM</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//@RunWith æŒ‡å®šç”¨å“ªç§é©±åŠ¨è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œé»˜è®¤æ˜¯junit</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringJUnit4ClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span>locations <span class="token operator">=</span> <span class="token string">&quot;classpath:applicationContext.xml&quot;</span><span class="token punctuation">)</span> <span class="token comment">//æŒ‡å®šé…ç½®æ–‡ä»¶</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringTest</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ioc <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">BookServlet</span> bookServlet<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        bookServlet<span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="springboot" tabindex="-1"><a class="header-anchor" href="#springboot" aria-hidden="true">#</a> SpringBoot</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">Springboot02ApplicationTests</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">Person</span> person<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœè¦ä½¿ç”¨RunWithéœ€è¦è¿›å…¥Mavenåˆ é™¤exclusions</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.junit.vintage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit-vintage-engine<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°±å¯ä»¥ä½¿ç”¨Runnwithæµ‹è¯•å•¦ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">Springboot02ApplicationTests</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">Person</span> person<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="configurationproperties-value" tabindex="-1"><a class="header-anchor" href="#configurationproperties-value" aria-hidden="true">#</a> @ConfigurationProperties&amp;@Value</h2><table><thead><tr><th></th><th>@ConfigurationProperties</th><th>@Value</th></tr></thead><tbody><tr><td>åŠŸèƒ½</td><td>æ‰¹é‡æ³¨å…¥é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§</td><td>ä¸€ä¸ªä¸ªæŒ‡å®š</td></tr><tr><td>æ¾æ•£ç»‘å®šï¼ˆæ¾æ•£è¯­æ³•â€œ-â€ï¼‰</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>SpEL</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>JSR303æ•°æ®æ ¡éªŒ</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>å¤æ‚ç±»å‹å°è£…</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr></tbody></table><p><strong>@Value</strong>æµ‹è¯•çš„å®ä½“ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token comment">//@ConfigurationProperties(prefix = &quot;person&quot;)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;zhiyu&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;#{2*10}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> isBoss<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>Person<span class="token punctuation">{</span>lastName=&#39;zhiyu&#39;<span class="token punctuation">,</span> age=<span class="token number">20</span><span class="token punctuation">,</span> isBoss=<span class="token boolean">true</span><span class="token punctuation">,</span> birthday=<span class="token null keyword">null</span><span class="token punctuation">,</span> map=<span class="token null keyword">null</span><span class="token punctuation">,</span> list=<span class="token null keyword">null</span><span class="token punctuation">,</span> dog=<span class="token null keyword">null</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="propertysource-importresource" tabindex="-1"><a class="header-anchor" href="#propertysource-importresource" aria-hidden="true">#</a> @PropertySource&amp;@ImportResource</h2><p><strong>@PropertySource</strong>ï¼šåŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶</p><p>**æ³¨ï¼š<strong>åŠ è½½é…ç½®æ–‡ä»¶æ—¶éœ€è¦é…ç½®</strong>@ConfigurationProperties(prefix = &quot;&quot;)**ä½¿ç”¨</p><p>ä½¿ç”¨æ¡ˆä¾‹ï¼š</p><p>YAMLæ–‡ä»¶ä¸­åªæœ‰ç«¯å£ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç±»è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼šperson.properties</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">person.lastName</span><span class="token punctuation">=</span><span class="token value attr-value">æå››</span>
<span class="token key attr-name">person.age</span><span class="token punctuation">=</span><span class="token value attr-value">18</span>
<span class="token key attr-name">person.isBoss</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token key attr-name">person.birthday</span><span class="token punctuation">=</span><span class="token value attr-value">2020/2/2</span>
<span class="token key attr-name">person.map.k1</span><span class="token punctuation">=</span><span class="token value attr-value">12</span>
<span class="token key attr-name">person.map.k2</span><span class="token punctuation">=</span><span class="token value attr-value">13</span>
<span class="token key attr-name">person.list</span><span class="token punctuation">=</span><span class="token value attr-value">a,b</span>
<span class="token key attr-name">person.dog.name</span><span class="token punctuation">=</span><span class="token value attr-value">å°ç‹—</span>
<span class="token key attr-name">person.dog.age</span><span class="token punctuation">=</span><span class="token value attr-value">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨å³å¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PropertySource</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:person.properties&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;person&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>Person<span class="token punctuation">{</span>lastName=&#39;æå››&#39;<span class="token punctuation">,</span> age=<span class="token number">18</span><span class="token punctuation">,</span> isBoss=<span class="token null keyword">null</span><span class="token punctuation">,</span> birthday=Sun Feb <span class="token number">02</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> CST <span class="token number">2020</span><span class="token punctuation">,</span> map=<span class="token punctuation">{</span>k2=<span class="token number">13</span><span class="token punctuation">,</span> k1=<span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span> list=<span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> dog=Dog<span class="token punctuation">{</span>name=&#39;å°ç‹—&#39;<span class="token punctuation">,</span> age=<span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>@ImportResource</strong> å¯¼å…¥è‡ªå®šä¹‰çš„Springæ–‡ä»¶</p><p>åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶å¯¼å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„bean</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloService</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºä¸€ä¸ªspringé…ç½®æ–‡ä»¶ï¼šbeans.xmlï¼ŒåŠ å…¥è¿™ä¸ªç±»</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cn.zhiyucs.servcie.HelloService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>helloService<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨å…¥å£åŠ å…¥è¿™ä¸ªæ³¨è§£å¯¼å…¥è¿™ä¸ªspringæ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ImportResource</span><span class="token punctuation">(</span>locations <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;classpath:beans.xml&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Springboot02Application</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•å³å¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">ApplicationContext</span> ioc<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">containServiceTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">boolean</span> b <span class="token operator">=</span> ioc<span class="token punctuation">.</span><span class="token function">containsBean</span><span class="token punctuation">(</span><span class="token string">&quot;helloService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ç»“æœï¼štrue</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç„¶è¿™æ˜¯ä¸æ¨èçš„ï¼ŒSpringBootæ¨èçš„æ–¹å¼å¦‚ä¸‹ï¼š</p><h3 id="ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»" tabindex="-1"><a class="header-anchor" href="#ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»" aria-hidden="true">#</a> ã€æ¨èã€‘è‡ªå·±åˆ›å»ºä¸ªé…ç½®ç±»</h3><p>ä½¿ç”¨**@Configuration**æŒ‡å®šè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»</p><p>ä½¿ç”¨**@Bean**æŠŠè¿™ä¸ªè¿”å›å€¼åŠ å…¥åˆ°å®¹å™¨ä¸­ï¼ŒIDå°±æ˜¯è¿™ä¸ªæ–¹æ³•çš„æ–¹æ³•åã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">HelloService</span> <span class="token function">helloService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HelloService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é…ç½®æ–‡ä»¶çš„å ä½ç¬¦" tabindex="-1"><a class="header-anchor" href="#é…ç½®æ–‡ä»¶çš„å ä½ç¬¦" aria-hidden="true">#</a> é…ç½®æ–‡ä»¶çš„å ä½ç¬¦</h3><p>åœ¨é…ç½®æ–‡ä»¶å¯ä»¥ä½¿ç”¨${} å–å€¼random</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">person.lastName</span><span class="token punctuation">=</span><span class="token value attr-value">${random.uuid}</span>
<span class="token key attr-name">person.age</span><span class="token punctuation">=</span><span class="token value attr-value">${random.int}</span>
<span class="token key attr-name">person.isBoss</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token key attr-name">person.birthday</span><span class="token punctuation">=</span><span class="token value attr-value">2020/2/2</span>
<span class="token key attr-name">person.map.k1</span><span class="token punctuation">=</span><span class="token value attr-value">12</span>
<span class="token key attr-name">person.map.k2</span><span class="token punctuation">=</span><span class="token value attr-value">13</span>
<span class="token key attr-name">person.list</span><span class="token punctuation">=</span><span class="token value attr-value">a,b</span>
<span class="token key attr-name">person.dog.name</span><span class="token punctuation">=</span><span class="token value attr-value">${person.last-name}_dog</span>
<span class="token key attr-name">person.dog.age</span><span class="token punctuation">=</span><span class="token value attr-value">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>Person<span class="token punctuation">{</span>lastName=&#39;20b50b74<span class="token number">-4721</span>-4d80-a786-f0e726b195f3&#39;<span class="token punctuation">,</span> age=<span class="token number">-790018533</span><span class="token punctuation">,</span> isBoss=<span class="token null keyword">null</span><span class="token punctuation">,</span> birthday=Sun Feb <span class="token number">02</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> CST <span class="token number">2020</span><span class="token punctuation">,</span> map=<span class="token punctuation">{</span>k2=<span class="token number">13</span><span class="token punctuation">,</span> k1=<span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span> list=<span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> dog=Dog<span class="token punctuation">{</span>name=&#39;6a1ab7a2-c65c-4df5-be46-3614ef009efd_dog&#39;<span class="token punctuation">,</span> age=<span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å¤šprofileæ”¯æŒ" tabindex="-1"><a class="header-anchor" href="#å¤šprofileæ”¯æŒ" aria-hidden="true">#</a> å¤šProfileæ”¯æŒ</h3><p>åœ¨ç¼–å†™é…ç½®æ–‡ä»¶çš„æ—¶å€™ï¼Œæ–‡ä»¶åå¯ä»¥æ˜¯ï¼Œapplication-{profile}.yml/properties</p><p>ä¸¤ç§æ¿€æ´»æ–¹å¼ï¼šåˆ›å»ºä¸¤ä¸ªç¯å¢ƒ -- å¼€å‘/ç”Ÿäº§</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARUAAAB6CAYAAACRO8fZAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAA4ySURBVHhe7Z1tjxxHEcf5NnwHizt794wdnyG2c7EtIkUJgiQ+3QUEQQiScHdOQBFR7CjsEiFLyEjozkiWJV6fPwmfZujqnpqpqal5vL7dmdn/i592+6m6e7z1v+6Z6fIPfnR1lgAAQCzWJipfLZ4VOP7rt8k77//SrAsAGA+dReXJ06fJq1evKqFyq51Giwrz/qNDsz4AYBx0FpU79/aSly9fmoJC+VRutdNYgtIGyxYAYDj02v4cnTw2RYXyrfoWlmC0Qdu5sn2YLM6Wyf79E/d5npwvw0rnyvbDZH95lrx+/dpz6vL3tq/l7Q6Wyen5uS87PztLjg5EWantSdb2iu9nmRzdL9Y/cvUXzkb78QibFxgrAEOjl6jcuLWbvHjxn4KgUJryrfoWlmC0QdvxTuwcLjjbw8wZ95eUFxw3OK10cGpDIvDQp/cOTpLTtK5su++EI2vLtpxYnLq2JVFxApKJSs142OaRS5N4yLI+YwVgaPS+UfubT35XEBVKW/WqsASjDdoOOzE5dJZnOb7Is8qtelme6KOtqDSNp65M5tW1BWCI9BaVq/PryfPnz72g0CelrXpVWIIhsdpY8F/yglO67cK5yztdLpNFhksLZ+ftxqlbUSyO3XYjbR/auu2LWAmwaJweP2wpKtZ4ijaLZf3GCsAQ6S0qxC8++NCLCn1a5XVYQiKhOv/7946JtFPrxPfd9kNRbOvy3HZi4ZyVnX49otJvrLIcgKFwIVHZujZPPvv8T/7TKq/DEhKJ1cbCdOKKLYP8Cy+/BxupKJii0VDu82pEpWI8dWVtxsp5AAyJC4nKRbCEREJ1rFUKIe1YTkzIG6OU3js2ViNc5tLSsfVNVX0jlVYldCM13Lg99E9+aHtSJSqWTetGbZ+xAjA0Bi0qbfBOrB7xhvzwmDZ/FJs7JrF33O+Rsi93qwt6XJy3DfUzUakZj2XzImMFYGisTVTaYK1SCKsuAGAYDFpUAADjAysVAEBUsFIBAEQFogIAiApEBQAQFYgKACAqEBUAQFQgKgCAqIxeVPSbuEOOdRvenC2+LQvA1JicqDCxY93SGRz9un4Tug0fPKTTzrouAFNhsqLShGWrDn+wLz1UaJVb9GkDwNiBqAj8ysI4uCcP9FGgJD5dTNsZPqFMgZYWbgVCJ4zDZ7lNOGwYDh5y+7qDiwCMEYhKCocsWBixYMn5KeRACE/gvqeOXw6REATCB3My2oQ+8lgodeEQABgrEJWUukBKvlxtZaz6LBp8z6TURohKU38AjBWIiiBbadAWRcWCLQkEpVVYR7/aSMNOmm2kqBjtAZgCEBVF2LaUY8FCVABoB0RFUFiZqPsfJYHA9gcAE4hKSrZySJ1cx4LlcikCdTdqrTZaqHCjFkwRiIqgbdxa678y1Y+UrTZeVPBIGUyc0YsKAGBYQFQAAFGBqAAAogJRAQBEBaICAIgKRAUAEBWICgAgKhAVAEBUICoAgKiMXlT0m7JDjlHbhH6NH4AxMjlRYfrEqKWzOut8Vb6rqKx7vABYTFZUmrBs+QOA4lTxqukjKuscLwAWEJWUuji0xUN/h5kThwOCdLKZ4q/wQcRw0rlgL7PF9emzfHBRiwr13SUGbtN4fTmtbtJ2+tAkADGAqKSQM9bFoaV0cFiXliLhHLQQvsCJBQnAKUWOozY+bkoQiqy+CKng+0zTWlTqQiv0Hy+dkg6nqGUcXkoDEAOIikBvJ8xATCJPi0BmQ0R0Y6EJQhDqc7wVhh1f2usVBKppvEY5ALGBqAhKTuoFgrYWy2SR4dLs+Olf/oITaxslUSk7NW1pqM1bWwe5qChx0rZ8uuN4qU622qG4LioOLwAxgKgIbCeleyBue6Hw5YMUlerxSjtWHF4AYgBREZSctGK7wH/d+4lKLgrMZW5/CLkakd9lf5wHwEWBqAj4L710SnmzlNJ+VZH+de8rKjFu1GZ9dRlvWj8rc2ncYwGxgagIpOPmT0xCXv4YNndKLwIurUWl8J+yk6i49vQYOBOhA2qX2+P2wR49ncnbZuNx7Zpi4Mo8a7xEXRxeAGIwelEZE5moYGUAJgxEZYVAVMAmAFFZIWErlN/vAGCKQFQAAFGBqAAAogJRAQBEBaICAIgKRAUAEBWICgAgKhsnKrc+svMvm/COSnqux7/1WnzTNRaXaTs28ppY5WCcbJSo3Hh3njz4bieZ3Z2b5ZdJQVT8wb/ywcI+lI4FRLR92UBUpslGiMr2ziy5/fE8efi3Hcc82X20XlGxyvuiDzCOCYjKNJmkqGzfmCVXd2fJ9QezZNeJydtfk6DkvPl7W1TCG6/2AT7vAE3xZZvKUwcKde2Dg4R1INEakxWntpttY8xpH1SuoX51+Enuj44e5PY6xOyFqEyOSYjK1rVZcvO9WXLvxInGd0UBkTz4llYqO8m9x7ao1IUaYAfgMAVU3wpb0FSeiYpwJt3vkUuz49WPiYIthZUKx6ltss3pvC4JhRtjFrc2HzOlJWaMF7FSyq6B6I/CPpC9upi9EJVpMXpR2ZrNkjt/tERkJ5nfsdtcu10WFdNh0h+9FBV9r8I7Ka8QWpRrZ7L6ZZrG5NPCqWV5le2qceTlQQhkni6Tc6T5ZWOx7HmRcquVbHy5Das+GD+jF5U3PrAEZZ7c+dRte372bvLsxX9LUL62o3/8Pq/kAGXn90GQnFOHUJBN5WVntvplmsaU1akSlR5z4vIqR5f96famvdL4ICpTZ/Si8tZfbFGZ35slXzxZehH585O/+7r0SWnK13b6OCCxcaIi2th9Q1Q2ndGLSrhPUhSUu5/nq5TffnqS3Lz9pq9Ln5S2Viubu/3R5fWiQoQtz6H/lPVMexCVjWP8K5Uvi4JC7Ozlq5Qfv3E7+fr7f/q69EnpqtWKFwDnAGO5UUvlvBrhPptsc5qcPNRVIpA6fRgnjYWeJBWF0osVPW0qrYIMexCVjWP0onL9nZl/4kMrlrtHO8mtR7Nka34tE5Ubuz9JvvnHv/x3+qR0lahIpyUxKD1SJoepiy/bVJ4+6pXfdb9eMNQj5aoxlcp5RdTaNtVVMXZd/SAkYZwsAFye1XH51F8x37DnRMV6RJ5dUzFWMA1GLyrE1ZvhKdDWPIjMrY/E9uezx8mtn95NPvzVJ/6T0pRv3aytwzuA+ivcpXxKhLlihQFsJiEqxNbOzN+cnb8999C7K7xa+fLp98mv/3DkP6tWKU1AVHL0lgYAyWRExYJXK5quqxQiLNvDvYk+5VOB5rl/7LY46j4LAMykRQUAsHogKgCAqEBUAABRGbyoJMc/BGAQWL9PUAaiAkBLrN8nKDMaUbHKAFgF+A12Y+NEBTFqLwd6/V+/eTtE+ry4B1HpxkaJCmLUXh4QFcBshKggRu3lA1EBzCRFBTFq29o2xpz2QeVVWGOSolLuM4SSpDIauxxDqB/GbB1x8PWVaMr6+RwuLy4uRKUbkxAVxKilcvfdOV6TbU7ndclp3RhbxKhl6sYky0MfaZ/s1FaMl5rVVlP97LqL8fgT1DSvSHFxISrdGL2oIEZt0SGbbFeNIy8PThnaO0E4OExJRavpOlnlIo/ty+tE10hfN6apvjkHL4xutZJdk9yGVb8JiEo3Ri8qiFFbIyo95sTlvr0Tg8VymZKuDCrGy44eymmLw+0IlxaOzNfE26u4rhI5R13fnEPpmkBUVsnoRQUxarUD1dvuIiqcJ6kab1FUXDltxxSZDdGvHr9FXX1zDqU6EJVVMnpRQYxay8mqbZfHocsbRKXpOlXMZ0+lWYT4U5ZZhHrriYsLUenG+FcqiFHrVwbcZ5NtTpPDhbrKIVMHrHO6pjHJckr71ZpeMXnHp22RsZJy9oYUFxei0o3Riwpi1IpyXhG1tk11VUxZVz84dZ6naTsmfpzLj3iLNij+Ld17Kce5ZQEo5gdhoDkW8405OFGxHstn/47i+rQBotKN0YsKgRi10ydc324rjFhAVLoxCVEhEKN22ugtzSqBqHRjMqJiwasVTddVChGW0Pl9gq7loD9+O7XGuLgQlW5MWlQAiAF+g92AqADQAH6D3YCoANAAfoPdgKgA0AB+g92AqADQAH6D3YCoANAAfoPd2DhRQYzazeOiL85BVLqxUaKCGLWbCURltWyEqCBG7WYDUVktkxQVxKhta9sYc9oHlVu0mqcvDzFj+QBg3Tg0NL91x6WVQFS6MQlRQYxaKnffnRM22eZ0Xpcc2I2xZYzatvMMQhPGRHXqxiHtE2bMlnSeco7Snj/BTHOJFJdWAlHpxuhFBTFqc2eT5VW2q8aRlwcHDe2d8+sYtap/xppnZrNhHJyXl4UxyD7IfjZnqw8vbG61kl2H3EZdX22AqHRj9KKCGLU1otJjTlzu2zsxKMWo7XEd2sxDI+el+zTHXboOep4QlYvA16AKWXf0ooIYtdqZ6m03zYnLqxywz3VoMw+N7Meeo9FHoY6eJ0TlIvA1qELWHb2oIEZtjag0bDvCd13eRlSa5qlsNoyD8zRhy7OeuLSSpt/gJsDXoApZd/wrFcSo9asA7rPJNqfJ+UJd5ZypM1Y5YLt5Fm0S9eOgOdMTq6JQeTE6O3OCpFc5xrghKoNh9KKCGLWinFcKrW1TXRXf1dWvi1Hbbp5FmyG/fhwsALoN5dO8ivnGuJ2o6Ot2kbi0EohKN0YvKgRi1K6OVc4z9NV/hRELiEo3JiEqBGLUroaViora0qwLiEo3JiMqFrxa0XRdpRBhOR3uCfQpnwqrmif1s864tBKISjcmLSoAxAC/wW6MRlQAWDfW7xOUgagA0BLr9wnKDF5UAADjAqICAIjKJEXl5/sf+8+vFs9K6LoAgLhMTlRIUFg8tKBwPhgW/vEx4upOhFnyf7LT/Hl6d4tDAAAAAElFTkSuQmCC" alt="10" tabindex="0" loading="lazy"><figcaption>10</figcaption></figure><p>applicationä¸­å†™æ¿€æ´»å“ªä¸ªï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä»–å°±å†™ç”Ÿäº§/å¼€å‘ç¯å¢ƒçš„é…ç½®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥ç›´æ¥éƒ½å†™åœ¨ä¸€ä¸ªé…ç½®ä¸­</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev
    
<span class="token punctuation">---</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span> pro
  
<span class="token punctuation">---</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span> dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿˜å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œçš„æ–¹å¼æ›´æ¢ç¯å¢ƒ</p><p>java -jar åŒ…å --spring.profiles.active=dev/pro</p><p>è¿˜å¯ä»¥ä½¿ç”¨IDEAçš„è™šæ‹Ÿç¯å¢ƒæ¿€æ´»</p><figure><img src="/Computer-Science-Learn-Notes/assets/11-5337b8aa.png" alt="11" tabindex="0" loading="lazy"><figcaption>11</figcaption></figure><h2 id="åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§" tabindex="-1"><a class="header-anchor" href="#åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§" aria-hidden="true">#</a> åŠ è½½é…ç½®æ–‡ä»¶çš„ä½ç½®å’Œä¼˜å…ˆçº§</h2><p>æµ‹è¯•<strong>ç±»è·¯å¾„ä¸‹</strong>ï¼ˆport:8080ï¼‰å’Œ<strong>ç±»è·¯å¾„çš„config</strong>æ–‡ä»¶å¤¹ä¸‹ï¼ˆport:8081ï¼‰ï¼š</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASEAAAB8CAYAAAAmegaGAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAA5JSURBVHhe7Z3fbtzGFYfzNnmGCJX/FkXaIihqxRZgBLbipo0WUooUtZAAdSUnN0UCJLnQAgaMBL4opDQxjF4GkG+Sx+jTsHNmOOTh4eHfJWdI7u/iA5ec4eGswfk8Q+4cvfH7v/43AQCAWLzxq+s3EwAAiAUkBACICiQEAIgKJAQAiMrkJPSv8+cFzr74Jrl/8IFaFwAwfwaT0Fdff528evWqEirXzpNICXkODo/V+gCAeTOYhP7wx73k5cuXqoDoOJVr50k0AbVBiwUAmD6DTsdOn36mSoiOa/U1NMG0QcbZuXacnF+uk9Xdp2Z7lVyt3Uhq59p+slpfJq9fv7ZcmON7127k5x2tk4urK1t2dXmZnB6xstK5T7Nzd+x11snp3WL9U1P/3MRo3x4Wc4O2AjAXBpXQb377u+T77/9TEBDt03GtvoYmmDbIOLbTmw7qOud+1nlXazrmOrrr5FwIdA5JY9/u7x09TS7SuvzclRFNdq6PZeRyYc4tScgIJ5NQTXt8zFOzT7LhZX3aCsBcGPzB9N/+/rggIdrX6lWhCaYNMo7v9CSA7JgmCnZMK9fqZcfYNdpKqKk9dWX8WN25AMyJwSV0/davkxcvXlgB0Zb2tXpVaILhaOdo+JFCoROb6cuVOXaxXifnGWafycFPfy7MiOX8zEx/0vPduWY6xUYaXjIXZ/stJaS1pxizWNavrQDMicElRPzpz3+xEqKtVl6HJh4O1fnfv2+r8Di1nf6umQ4JiueaY2Z6c246t5dEHAn1aysvB2DqjCKh3Ru3kn88+afdauV1aOLhaOdoqJ2+YgrDRxD8s4uRSkSVTEO5PVYjoYr21JW1aas/BsAcGEVCm6CJh0N1tFEQweNonZ7gD4Jpf+9MGe34MrPPRSAfIssHxzTqoQfH7kH1sX0zRtOlKglpMbUH033aCsBcmKWE2mA7vXhl7o671975q+28IxN7Z/1e0dtyM3qh1+/5ua5+JqGa9mgxN2krAHNhchJqgzYKIrS6AIBpM0sJAQCWA0ZCAICoYCQEAIgKJAQAiMroEkrO3gRg1mj3NRgOSAiABrT7GgxHMAlpZQBMGdy7YYCEJsIOrQtjP3wE8cG9G4bFSkj+0nqquartUo30V9YXV+vkcPdesloXfxkN4gAJhWFyEtq2XNVyJb1f9Eor82VdEBZIKAyTk9C25aq2EkoXwWrlIB6QUBgmOR2bUq5qos0iU73MLVpd3aVtutD0ihKQpSlZ2QJUSkxGq+fdOW7Rq4/vV+Pbc/2iWIyURgcSCsMkJTSlXNVE23QbTkhun0Tk03eQYGhFPdWnlBskE1pNT/Xtvj3fPZh25+R5gcrxnZAwXRsfSCgMk30wPZlc1R0Tj3GJSKG4cvcgOhvpiOlY4fya+JDQ+EBCYZishMbOVV2FjCMfHDeVecnYlK9WGFIiHSTUEN8fA+MACYVhshIixsxVXYWMAwltL5BQGCYtoTFzVVch42w+HdtAQlp8ewwSCgEkFIZJS2gTNMG0QYu16YPpvhLK45vRkP1LG8fmXDyYDgUkFAZISKDFcnLp/4q+JCF6xc4kVD6n+Iqe4ttX+DYWpmOhgITCsFgJLYXy3xkrjpTAeODeDQMkNGGy5z/0Z4Sy6Vg+3dPOAcOBezcMkNDE8X+/zE3H6JfS7u+aaXXBsODeDQMkBEAFuHfDAAkBUAHu3TBAQgBUgHs3DJAQABXg3g0DJARABbh3wwAJ9eD91Ud22/bHjmCeQEJhgIQ6QgLyspEC8sdjwH/E6H5lTUs9hn+VP2bsodn0h52QUBggoQ54AXnZcPnw4zEoSGjARa6lZSUzWkALCc0DSKglXEBeNnyfH4/BWMs55ALbOQEJzQNIaAO6SsgvXqWFrj7X9N6Z29oOI/NRX14mp2kHalWedjhXt7wIVl9kW92mtjmwmxbwVuXYltB1L4Tw/PVoEXAe72kez+7fKLY1zXBg60NCkwcSaokmHA3tXE9dvmjfYXz+aapfzEfdrjyTEOt83VKR8DYZEaUjofY5sN1+XtctN9FybNM+R82fxEZi2b8Bu55dS0fXSJez+Omi9u/QFUgoDJBQSzThaGjnEmoHSzsJl5B81mI7tR+BtCiXnU+7rqepTXafSYCXV8Wuakde7sTBj8ky/h3p+2Vt0eJZqZnRUNa+PIZWvwuQUBggoUDIzmKPlTpMWRY0RSEJ3Nk9alFe7vzadT1NbcrqVEmox3fy5VVi4NeT56vxSu2DhOYGJNTALyef94bH6dNhia2TEDtHvzYktDQgoQY+eefd5NmDQyuVZw8+TD41+3s7u8l3j47dsYeHyZ23du1nv/XwONs7HZPl9RIi3BTs2G55PTUeJDR7IKEGfvr4SfLo1tvJj6vHdkv7JJv3rt+2Irq/e7OVhAgrDNNh5vJgmsr9aMdfsym23ycpuLpCGqkkXDupLfSmrShWKzd6G1caZSnxIKHZAwk1QDJ5fnCU3Nu5lnxrtl429JlGRLRtKyHeyUkepVf01MGOzNZ0IlvnUnb+hvL01Tn/LK9rBSNe0Ve1qVTuR1ytY1Pd6hzbVO6F4cuzOuY4Xa94XIlnJKT95CD7N2Vt7QokFAZIqAGSyc8nnxUE4z//sDop7DdJqA7bYcT/8l3Kl4T7rv1HMEMBCYUBEmqAZFIlIblPW8+X+w/VeFVAQjlyihULSCgMkFADXDZd0eJV4aYR7tlKn/KlQN9zdWamXOI5UQwgoTBAQgBUgHs3DJAQABXg3g0DJARABbh3wwAJAVAB7t0wBJMQAHNFu6/BcEBCADSg3ddgOEaXUCxkio2zL75J7h98oNaNjX0tPZO8zQAMzdZIyHNwWFwKsCly2UAbSksN7ELQ8vIFALaBrZNQE1qsOvr8uncqvwgGYApAQgItlh25mJGKXcR5SYtInTy0HMy2frqI0tYXi0I3zdsMwNKAhAQyjl+z5dNN7B1RmgknBZKFzMFMdepTdpTPkQs261JvALA0ICGBjFOXFMyWi6nVGInCAFgykJBAi5WNZGjKRH/VgQtGCoX2B06ZCsCSgYQEWizCTaPo711dFiQBCQGwGZCQQItVGPmI5zcloWA6BkAnICGBjJONTFIp0ENlLglfzqUxdN5mPJgGSwYSEmix+Gt1/oqe4JLxOZELx4ywhszbDMDSWKyEAADzABICAEQFEgIARAUSAgBEBRICAEQFEgIARAUSAgBEBRICAEQFEgIARGWxEpK/hJ5yjukm5LIOAJbE1kjI0yfHNK31irl0oquEYrcXgC5snYSa0GLZBads1Xto+kgoZnsB6AIkJJBx6vJIFxeZHmed3i1IpZX3lH/IL3x1K/EL8bJYvj5tywtlpYTo2l1yWDe115bT6Ck9Ty7SBWBMICGBjEOdty6PNO27Dm72uVRMhy6k4zByIWFcUGZGOsfmDXJiyeqzFCH2mum+lFBdqpD+7aVV/G6VP8+jTfsAjAkkJNBiyemNmriMHZPSyGKwjIleTE4crr7PN+TxouDxeiVNa2qvUg5AKCAhgRar1KmtUGiqs07OM8y+F0U6sih0ehmjJKGyBGiKRefc2T3KJSRkJmPZ/Y7tpTrZaIryGok82gCMCSQk0GLpnZqe4ZjpjsCWT1JC1e3lcbQ82gCMCSQk0GKVOnXF9MWPHvpJKJeIZ8zpGMFHO/wzv54/BsBYQEICLZYfSfBOzB8O074dtaSjh74SGuLBdHatLu1N62dlZh/PiEAoICGBFot39PyNkjuWv9bOO7GVhtmXEuI/ILQSMufTa/VMWkd0Xh7Pn+/i0dur/NysPea8phzW/JjWXqIujzYAY7JYCc2JTEIYeYAtBBKaAJAQ2GYgoQngpmb58xoAtglICAAQFUgIABAVSAgAEBVICAAQFUgIABCVaBJKzt4EYFZo9zHYHEgIgJZo9zHYnOgS0sqG5v3VR4VlGXyZBj8eA/dDRb44tbyQtQ+lZSIDxh4b/m+ilYcGEhqXxUuIC8jLhu/z4zEYq8PJBbNzAhLaLrZiJCTpKiG/2FRbMGo7TFN+6KbytMO5uvpCVUJbAKu1Scsz3S220ub0GlQuoevKdLD+erQUJY/XIec2JLQ1LF5CmnA0tHM9dakzfIfxaTeovpaGo6k8kxDrfPK6p2bfd9T6NlFyMjcS8nmmm2L7/bwuicW0Mcs7nbeZ9jlqjiM2Esv+Ddj1KI0JxavLuQ0JbQeQUIp2LqF2sLSTcAnJZy22U/sRSIty2fm063qa2mT3mQR4eVXsqnbk5U4c/Jgs49+Rvl/WFi2elZoZDWXty2No9WMCCY3LVk7HuiA7iz1W6jBlWdikYUYCLjVrU3m582vX9TS1KatTJaEe38mXV4mBX0+er8YrtQ8S2lYWK6FfTj7vDY/Tp8MSWychdo5+bUgI6CxWQp+8827y7MGhlcqzBx8mn5r9vZ3d5LtHx+7Yw8Pkzlu79rPfenic7Z2OyfJ6CRFuCnZst7yeGg8SAimLldBPHz9JHt16O/lx9dhuaZ9k897121ZE93dvtpIQYYVhOsxcHkxTuR/t+Gs2xfb7JAVXV0gjlYRrJ7WF3rQVxWrlRm/jSqMsJR4kBFIWPR17fnCU3Nu5lnxrtl429JlGRLRtKyHeyUkepVf01MHq8kM3laevzvlneV0rGPGKvqpNpXI/4modm+qKHNmmvhOPa6cXhi/P6pjjdL3icSWekZD2k4Ps35S1NTaQ0LgsWkI/n3xWEIz//MPqpLDfJKE6bIcR/8t3KV8S7rtOZwQzFJDQuGylhOQ+bT1f7j9U41UBCeXIKdZSgITGZdES6osWrwo3jXDPVvqULwX6nqszM+USz4mWACQ0LtElBMBc0O5jsDmQEAAt0e5jsDnRJAQAAAQkBACICiQEAIjIzeT/9Qg6EgTL18kAAAAASUVORK5CYII=" alt="12" tabindex="0" loading="lazy"><figcaption>12</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/12.1-37b3d218.png" alt="12.1" tabindex="0" loading="lazy"><figcaption>12.1</figcaption></figure><p>å‰ä¸¤ä¸ªåŒæ—¶å­˜åœ¨ï¼Œå†æŠŠä¸€ä¸ªç«¯å£ä¸º8083çš„æ–‡ä»¶æ”¾åœ¨<strong>æ ¹ç›®å½•ä¸‹</strong>ï¼š</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAABiCAYAAAA7mr2EAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAuXSURBVHhe7Z3vbxTHGcf5A+jfEfqmKq9KUTAmQJsY1Q6cHRcIJqkTEdtHioNBakh8RhW1+sKhyV0LQWpxavk4BSGl7bvlj5vOM7PP7tzcs3d7d3vLrO/74qO9nR/PrtF8PLNza55jb589p0Jgt/lsJPw4p2fqarsdqcPGcnLebLfU9tJs2majpQ5bO6o2Y8tOzyyr7VZbNeM+3G+73dbt6kkZl/fE4/4baRkAEsEIB8A0AOEAKBEIB0CJQDgASgTCAVAiEA6AEoFwAJQIhAOgRCAcACUSjHD+GySNvz5W1z76RGwLQFUZW7hvHj9W85eviHXD4AvHfPRZ96tVAFSZsYV79eqVevnypWrsPFQX350T2+RBki0PUiwAQqUQ4ZgXLzpq84u76uw7F8S2/ZBkyoMUy7ycHEXq9evXKmq31Xb8UjG/eLy2tKOPkYriF5Pp5eO1Vtu0J9wXmwEokkKFY54/f65WP70lts9CkikPfhwjVURv7ts3/2sbO+qwbQWydVo0I+FyItVai8p2tIjUht78j3r+SgCAIpiIcMyDr74W+0hIMuXBj3Naz16HWjj3z2eSulg4989o+rUHoGiO3AxH8PLwUM9kzUZd1WKZePbz/zYuivQyE0tIUAJH8hmOoKUhLSebWjoWCsKBN00hwoW2S8kzGuEuI0XhsKQEJTK2cJP+Hm4QfpxkxooFqpkdSyuUJByBTRNQFmMLVxSSTHmQYtUa/b8W8IXD1wKgLIIRDoBpAMIBUCIQDoASgXAAlAiEA6BEji1cOqcAAOUA4QAoEQgHQIlAOABKJBjh/nP9F10cXj2p7l3+tdgWgKoytnDN7x6rletXxLph8IVjtq+cEtv3Y36zpTpPdtTq3KxYXxah3AcIh7GF478W2H30UH1QmxPb5EGSLQ9SLBroUScM4UK4DxAOhQjHdDod9eBPd9WV+Qti235IMuXBj7P6SM8q8YvLnU5bzzB1Uz4/t6x2n9gXlKOorZ4+WtZt7XF+rq6edlpq6+aOPkYqyuqzuay29Dn14Xo655ee6VosV9Z9gOmmUOGYH/afqzu3b4nts5BkyoMfhyRYjWeWrZv6cyzA1hMtkimb7RKlw8JpOSItxq6WKk8ft57a2/puWaX7ANPNRIRj/vzwa7GPhCRTHqRY/lJuXs9cHT1D7WpxkjaxZK5wTzed+kF9pHqvDEtK4HPkZjiiRzg6j/SS0Rn4NAPt6uVjKpwnz6A+pp6Wii31NEGfO+JCOOBz5J7hiPKEo+c+vVz06IoB4YBDIcKFvkuZb0nZf3mYlsV9hHpi1ZcWwgGHsYWb9Pdwg5Bi8ezjyjB406RXHtuHZ7G6nt3kTROKSee06+nOitJ9gOlmbOGKQpIpD1IsVyh31zAp03JJXwv4YnAfs61v6tMlZVe9nvVMXCNnGkO6DzDdBCNciLjPYwQvQ93dTACGAcJlkDyv0ZfZyZIy/d5N6gPAICBcH+ZJsmRJScvP9E0SAEYBwgFQIhAOgBLBfyIEQIlAOABKBMIBUCJBC/fx2m1zzJvEA4DQCVY4ko3F8mXj8iKwmXPS9FbD1gMwDEEKx7KxWK5obnkR2ISMkTps2CT8lF/OTVfl1wMwDsEJ58rGYrnnbvkkMAkd28gPByZDJTZNxhXOZjVNX1xubtgEjE09a9kkjVQ225XIkRLyUxZUtz5fLFp+0jF+oZnaOLNjv+SPaX/KTR6pKM7C2tunjl8IFSU44SS5JKS+WfgphXnw0jLRDHItmc0BTon47Qy3tqQ/60Ht1ueLpUU1WVetZCaeLuOsq7397bl7LZu11V7f7WPbxH2QErmSHHnhpKT5PLB94Uydt6R064eNZev1jKhnq0H9Tb3UX+ojlIFqUAnh/vLt9+rT25vq0kJNnX3nonrvd++LfSWSJPuxQKYslmBo4XLF8oVyhBulv+lDy9uWaiboc09MUA2CF45km19cVss3/mA+/+PfL82RzqX+PkdDON2Hlrge3AZUh+CF+2TjjpHr8bMDtXhtxcxwt+89UM9e/JRLuuwl2QjC5YrVRzipvxtf6i/0IWreOagGwQt36f2amdGWrt809b+/8bH6+w8/qvq9L025398McL3kot1DLrObDjxL1LUA8qaJ6R/PKDzA/frBsbKFS/v32zTplcvtQ+e1hv2/U9yZElSD4IU7e/6iEWz2/G8S2ehI5/TZ70+DlpdoaZndTTRb/VqWbS1L1zJOlyfCxW1JItoJzKrPjpXKyu3tL4De+EZU4WsBX7jkmlp8c19G+O42oBoEL9y7lxbMTEYzGstG7WjGk2Y4Cf95xwxsZ9YahiJjgekjeOFW1/9ontXomY2e3egZjp7l6Jku/zOcnoHoy+JkGZgu46Q+WRQZC0wnwQmXBclFM9qwu5TEaRIjWQbSmx+jv6lRZCwwfVRGOACOAhAOgBI59rOfzygAQDlAOABKBMIBUCJBC3fxww1z3P7m+x78tgBUgdzCqcZbALwxpDFZRSAcqATSmKwiQwsn1RUJLSP9paN77pa/CY6fWFe7UaR2V86I9aNyfKWpooOGOnmi2LhlMKl/EwLCCXWTZljhjp9YVPW9+AXkqK127y+qk/ft0QyOg6ZauEDH+GXgg7aqx4MlV308uGxbHTepW1QL8XWJ/b1UoH73dPJ+U+3rmKaPjre/tz5kbOGe42tQvQ9dd9+Tm69Xv8A/F8VrpPHM+Znue9X3mfSFcLkITjhJLgmpL7OwF5nZggaIO1D3WTg9OGhA0uCi9idpdonP89YnwjkDzb9uXZ/zoOx/T1q6eIZbuKA/axEGxebztC1JRL8YrGTuPdO5y3Et0r5X586wyb+Bc726Fo/i7d9ft21MDPnfoUggnFBXJJJcElJfQhxM8YBwhaPPbj8zgHlmyVHvDzTpusygezLnzoB367NiZ91HWm8lccv8OvdnpJ8vuRcpnhFYz3LJ/aUxpPZFAeGEupDwB4Yp6xkcvWLQMosG/C/fWstR3zvQpesyg+4paZMl3Ag/E9dnSeBez+8vxuu5Pwg3CsEI97/PH46MG2eUwUlMnXBOH/naEG4SBCPcnfcW1d7Vz4xAe1dvqTtz+jnl1Bn13YcbtuzaLTX/qzPmMx8ZN870Lin9+v7CEXYZuW6ObjsxHoQrhGCE+3H9K3Vj9rfqX6t3zZHOSazlt88b6ZZOn8slHGHk0IOjKpsmVM+zGF9zUGw+JwFsW0+QWAh7n3QvtOPZ/UvEiEy7oj2zpxAPwhVCUEvKv11fV5dPzahv9ZHFos8009Exr3DugCZRer4WoMG0oo96wJg2B/5AH1Afb9e7n/3rGpm8rwWy7qmnnmfS3LGpbXqP3N5KZu+T5eD6pI0up+t1lwvxtHDS1xzJv6lzr0UC4YS6IiBx/vv5TpdM/Pmfq1td54OE64cZHN5v72HqjxL2Z53MzFQUEE6oKwISJ0s4/5yOzE7tphgvCwiX4i8TQ2TqhQPgTSCNySoC4UAlkMZkFcktHABgfPCfCAFQIhAOgBKBcACUSNDCUYJ9Ovr//TnhtwWgCgQrHMnGYvmycbmEzVbTm4HG1C3tqGacrYbbpVlFme56MY7Q183JPSkobZWbFQhUjyCFY9lYLFc0t1yiXzYbNwMpt6OUU644qXB94gh9D0tI6gHhqk9wwrmysVjuuVsuMaxwWWmm8gjn1iUSTlAICFd9KrFpUgXhCJOptFXvKiNMe5NEUS9p9UxoXlCOkyrWGnp21LGojNJgpX1sIkfTNqIsPZSUEcJVneCEk+SSkPoSqQyUv81DFM5rEy8JhxXOCBJnQnXb2jrbntMGc1sS6TBOd8W55zimkddpz1lTIVy1ObLC0eCU8IXrqY9nmXzCpaKSECSQvMnSG8udbW2bVFgpkT7HgHDVphJLymHoK0rBS0pXVNpAycq7bdt7AtG9OJssXcJ5MjJYUlafYIQ72/xpZNw4ZQqX1dcHwgHLOfV/Ea1qakiWuHUAAAAASUVORK5CYII=" alt="13" tabindex="0" loading="lazy"><figcaption>13</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/13.1-45c6ff87.png" alt="13.1" tabindex="0" loading="lazy"><figcaption>13.1</figcaption></figure><p>å‰ä¸‰ä¸ªåŒæ—¶å­˜åœ¨ï¼ŒæŠŠè¿™ä¸ªæ–‡ä»¶æ”¾åˆ°<strong>æ ¹ç›®å½•ä¸‹çš„config</strong>ï¼ˆç«¯å£ä¸º8084ï¼‰ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/14-5cbd554c.png" alt="14" tabindex="0" loading="lazy"><figcaption>14</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/14.1-ea6aefe8.png" alt="14.1" tabindex="0" loading="lazy"><figcaption>14.1</figcaption></figure><p><strong>å°ç»“</strong>:ä¼˜å…ˆçº§ç”±é«˜åˆ°ä½ -file:./config &gt; -file:./ &gt; -classpath:/config/ &gt; -classpath:/ SpringBootè¿™å››ä¸ªä½ç½®çš„é…ç½®æ–‡ä»¶éƒ½ä¼šåŠ è½½ å¹¶ä¸”ä¼šäº’è¡¥é…ç½®</p><p><strong>æµ‹è¯•ï¼šä½¿ç”¨æœ€ä½çº§çš„é…ç½®æ–‡ä»¶é…ç½®è·¯å¾„</strong></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">servlet</span><span class="token punctuation">:</span>
    <span class="token key atrule">context-path</span><span class="token punctuation">:</span> /admin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/15-02e5534c.png" alt="15" tabindex="0" loading="lazy"><figcaption>15</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/16-4475f37a.png" alt="16" tabindex="0" loading="lazy"><figcaption>16</figcaption></figure><p><strong>è¿ç»´é…ç½®</strong> è¿˜å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œï¼š java -jar åŒ…å --spring.config.location=æŒ‡å®šé…ç½®æ–‡ä»¶ç»å¯¹è·¯å¾„</p><h2 id="è‡ªåŠ¨é…ç½®åŸç†" tabindex="-1"><a class="header-anchor" href="#è‡ªåŠ¨é…ç½®åŸç†" aria-hidden="true">#</a> è‡ªåŠ¨é…ç½®åŸç†</h2><p><a href="https://www.docs4dev.com/docs/zh/spring-boot/2.1.1.RELEASE/reference/common-application-properties.html#a-common-application-properties" target="_blank" rel="noopener noreferrer">åœ¨YML/Propertiesèƒ½é…ç½®çš„å±æ€§<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="è‡ªåŠ¨é…ç½®åŸç†-1" tabindex="-1"><a class="header-anchor" href="#è‡ªåŠ¨é…ç½®åŸç†-1" aria-hidden="true">#</a> è‡ªåŠ¨é…ç½®åŸç†</h3><p>SpringBootå¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»**@SpringBootApplication**ï¼Œå¼€å¯äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½**@EnableAutoConfiguration**</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringbootAutoconfigApplication</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Inherited</span>
<span class="token annotation punctuation">@SpringBootConfiguration</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">TypeExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">AutoConfigurationExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootApplication</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="wiz://open_document?guid=62a96d1e-af78-4e7c-92d5-9a06b8beedf8&amp;kbguid=&amp;private_kbguid=51ed7a20-5f58-11ea-ac04-65f1a2b61811">@EnableAutoConfigurationçš„ä½œç”¨</a></p><h3 id="ä»¥httpencodingautoconfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†" tabindex="-1"><a class="header-anchor" href="#ä»¥httpencodingautoconfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†" aria-hidden="true">#</a> ä»¥HttpEncodingAutoConfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">ServerProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnWebApplication</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">ConditionalOnWebApplication<span class="token punctuation">.</span>Type</span><span class="token punctuation">.</span><span class="token constant">SERVLET</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token class-name">CharacterEncodingFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;server.servlet.encoding&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">&quot;enabled&quot;</span><span class="token punctuation">,</span> matchIfMissing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HttpEncodingAutoConfiguration</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>@Configuration</strong>ï¼šé…ç½®ç±»ï¼ˆç›¸å½“äºé…ç½®æ–‡ä»¶ï¼‰</p><p><strong>@EnableConfigurationProperties</strong>ï¼šå¯ç”¨<a href="wiz://open_document?guid=5294ee2c-1921-4f6e-a62d-cd516a7f3bb2&amp;kbguid=&amp;private_kbguid=51ed7a20-5f58-11ea-ac04-65f1a2b61811">ConfigurationProperties</a>ï¼ˆä»é…ç½®æ–‡ä»¶ä¸­è·å–å€¼å’Œbeançš„å±æ€§è¿›è¡Œç»‘å®šï¼‰åŠŸèƒ½ï¼ˆServerPropertiesï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;server&quot;</span><span class="token punctuation">,</span> ignoreUnknownFields <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServerProperties</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * Server HTTP port.
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> port<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›¸å½“äºæŠŠserverçš„å±æ€§ç»‘å®šåˆ°è¿™ä¸ªServerPropertiesç±»ä¸­çš„å±æ€§ï¼ˆæ¯”å¦‚æˆ‘ä»¬ç†Ÿæ‚‰çš„portï¼‰</p><p><strong>@ConditionalOnWebApplication</strong>ï¼šæ ¹æ®ä¸åŒçš„æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³æŒ‡å®šçš„æ¡ä»¶ï¼Œæ•´ä¸ªé…ç½®ç±»çš„é…ç½®æ‰ä¼šç”Ÿæ•ˆ</p><p><strong>@ConditionalOnClass</strong>ï¼šåˆ¤æ–­å½“å‰é¡¹ç›®æœ‰æ— è¿™ä¸ªç±»ï¼ˆCharacterEncodingFilterï¼‰</p><p><strong>@ConditionalOnProperty</strong>ï¼šâ€œåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨è¿™ä¸ªé…ç½®</p><p><strong>@Bean</strong>ç»™å®¹å™¨æ·»åŠ ç»„ä»¶</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//å’ŒSpringBootçš„å€¼æ˜ å°„</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Encoding</span> properties<span class="token punctuation">;</span>
<span class="token comment">//åªæœ‰ä¸€ä¸ªæœ‰å‚æ„é€ å™¨æƒ…å†µï¼Œå‚æ•°ä»å®¹å™¨ä¸­æ‹¿</span>
<span class="token keyword">public</span> <span class="token class-name">HttpEncodingAutoConfiguration</span><span class="token punctuation">(</span><span class="token class-name">ServerProperties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>properties <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ç»™å®¹å™¨æ·»åŠ ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶ä»propertiesè·å–</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span>
<span class="token keyword">public</span> <span class="token class-name">CharacterEncodingFilter</span> <span class="token function">characterEncodingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CharacterEncodingFilter</span> filter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrderedCharacterEncodingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    filter<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">getCharset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    filter<span class="token punctuation">.</span><span class="token function">setForceRequestEncoding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">shouldForce</span><span class="token punctuation">(</span><span class="token class-name">Encoding<span class="token punctuation">.</span>Type</span><span class="token punctuation">.</span><span class="token constant">REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    filter<span class="token punctuation">.</span><span class="token function">setForceResponseEncoding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">shouldForce</span><span class="token punctuation">(</span><span class="token class-name">Encoding<span class="token punctuation">.</span>Type</span><span class="token punctuation">.</span><span class="token constant">RESPONSE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> filter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸€ç³»åˆ—ä¸‹æ¥ç›¸å½“äºå¯ä»¥å®ç°</p><p>è¿™ä¸ªæ–¹æ³•åœ¨<strong>ServerProperties</strong>ä¸­ï¼Œè€Œè‡ªåŠ¨é…ç½®å®ç°äº†**@EnableConfigurationProperties(ServerProperties.class)**</p><figure><img src="/Computer-Science-Learn-Notes/assets/17-575a6391.png" alt="17" tabindex="0" loading="lazy"><figcaption>17</figcaption></figure><p>ä¸»é…ç½®æ–‡ä»¶å°±å¯ä»¥å†™</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQkAAABCCAYAAABEgCN/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAfuSURBVHhe7dz9UxNHHAZw/h9/cQ0EyGBAK0NAUAwERCgKyIuCAV9qGFpAqjOto2U6giDWYnUUZ2ztWNuOM+i01aJj4Y/69tlwgSPe3gWTYBKfHz4Dyd7tvWT32d1DU1TfGJbtqqjcF7dnz56N3x1V18rek2clODotwct35PLiz3L70VO5Mn9Phsem5PL0XPz119/NOu/vIRAckpnlJZmIVDmWpysQuSQPl5fl4eyQNEVaYUgmlpZleemSNAWzc0x6XyY+B6+2ku229LHF79vgLO7j9q8xuyGRpLnt83goJNPvO23vJRBslYnZS3Iqix9sQDfI2SV5uLRuZhINlQGx49L9HLzayk60pY9FX9sp697NDLY6buNmR0OCiPLPtkOituHwxs4MCaLCt62QCNUfkmDV5s4MCaLCV+T0ZqoYEkSFjyFBRK6KdEcnIjJJeyahfCV5LxKJyK5du4jIAUMCGBJEZgwJYEgQmTEkgCFBZMaQAIYEkdm2Q6I63CG9fX1xDAmiwvdeSATCfRLt65Bqw3+eSTUkdvvKpbLhmLR390qktsJxm1zBkCAycwyJ2LA5JOxMIbFblUpV+IS0huskFO5mSBDlsSL7rKG6HbOIWExGR0clOjyMGUXTe8FgZw4Jv5RVVIhPFUuwkSFBlM+KGvtiGzOHQLAOy4n1mURjCL97zCZSeSbBkCDKb0WBYJP0YvbQG14PhEwsN+wYEkT5DSFRJ8eGYxJtr4t3fIYEEdkxJIAhQWTG5QYwJIjMtjy41B0/HhKxPjkW+vCQ2K32SUPnSensgu5eOa5/QlNNueP2HxtDgshsy59ANb38aOwbjv8ZNPaBfwLNNwwJIjP+3w1gSBCZeYZEQP97iQ1blyAMCaLC5xoSiYeaeukRX34kPdBkSBAVPi43gCFBZMaQAIYEkVnaIVEIdEg4vU9EGfi27ELAkCAyY0gAQ4LIjCEBDAkiM4YEMCSIzBgSwJBIXbhFyWqXcizTvMop/2QtJAKHBmTy+pzcufujLHw/JacPBxy3ywUMidQxJD49WQkJ5Y/IVz/MyXj7ASkr8cuB45OysDAqR4pzs/G4hURxQMl0n5JXF5T8d17JkxNKwrbrUKVKxvDe8jklKyNKHrQpqfVtlrfi9ct2JcPHlfz9hZK/hpRcrFwvV/j5/KKSEf/m9sU1Sl5ju4ESa5s06k+Fvr5rvev7rpxVcv+okmpb/b4yJVf718/pzx6cK8rtIeBV7nV+Xtfndf+9yil92QmJQIMc7wlLlVr/sJTvqEzeuy79Vbn54ZlCQuH8h7qV/INO1Ilzb/wMDfKUkmcYLRPl3Z0oRyc5uQ+Ns1rJ7WElv4Q3r1N3khW8d+MwylHHOOpaHVRyEPvq/b+NKvmpfrO+DnSotzhmuVWeTv2JbUx0/Rew/a8dSrqs+hdR1wPUlSjvR6d7c1rJ6f1KWmqV3DmzGQJe5ZrX9btdny73uv/u5SHpGZuQiYkk0eb4/U2cI7nbkWcSqnpIbiyOS4s1OuYat5AYHUAnanI+b11+HY16Go0z8V4NGvgaGm2Z1Qh1J9GvK6zXKogRN4aR1boXEYy8bzECJ0LhGupbPGhtm4H6t6tFnw9Gff174vg3MbtJvO5CoNhDwq1cczs/r+vT5V733728RMorgxIMJqkoFZ91PuQt6yGhfFXSdWVBZkbqc/aDcVtu1Bxan0r/jtFuHqP8OYx2fus6dCOdQ9kalgyrNmtouPutbXQnSXS6+D6YCnc3KGlILCcwgr7AVFkvLxRGQ738iFrLj0zU72XfASV3sQRYwXHi9aMD20NAH/8qzjGxvf2Zg1e55nZ+qVyf2/1PpZzSl9WQUL5KaRubkYWrAxJKsdF+DG4hoRtyJdbQIxjhpjG1fokG+QANM1GmG/lsHRr9Xhusk4uthprcSZLpOvTsYR5T9foI1tUYRfda+2aifje6w86fU/IIx23CCK/r7k+aKWQ6JOxSuT69jen+e5VzuZEZWQsJ5a+Rnqk5WfhmQOpsD+ZykdtyoxznXmZ7kNaM6fgalgclKNPlerp8Cx3cvp9dKp34KLZ5jW3GsZ5O7gCZqF/zl2J0Tnqgp9Ahn2HmcMa6Pn28Ew7LibnQ5mun5YapXPMKCbfr0+Ve99+9nMuNTMjOg8vSeoleuyUzX3a81zBzkVtITGEq/hyNXj/Ya4Dp0xit0PAT5T2dSt5hmyjW1RFMdW/i96fNm9ecSif27Ued6Cx/YNlxAZ058X6m6lcYmR9jhF3FMSK2zqEwu7uNYy6hvjBG455GJXdwffYQSDyYHLQeTC5GUy/XvELC7fp0udf9dyunzMhOSBwYlBv378t97d49y7yct42SucRtueHHaHsDa2S97n13Xslv3Ura7B0ZI9k4GukLlL3B1H3pmJKDtpEtpU6Mxj49gs5lW4tvlGWifpzvLdT/CvXX2+rXxw2hYz9GeLxFWDxBhz16ZGsn95VjtMd6/1+UP8dSaChpOeFV7nV+Xtfndf+9yil9WX9wmQ/cQoLoU8eQAIYEkRlDAhgSRGYMCWBIEJkxJIAhQWTGkACGBJFZ2iHh9O3T+UaHhNO3BBMRv1I/jiFBZMaQAIYEkRlDAhgSRGYMCWBIEJkxJIAhQWTGkACGBJEZQwIYEkRmDAlgSBCZMSSAIUFkxpAAhgSRGUMCGBJEZgwJYEgQmTEkgCFBZMaQAIYEkRlDAhgSRCa75H9K5/0KBQApxQAAAABJRU5ErkJggg==" alt="18" tabindex="0" loading="lazy"><figcaption>18</figcaption></figure><h3 id="å°ç»“" tabindex="-1"><a class="header-anchor" href="#å°ç»“" aria-hidden="true">#</a> å°ç»“</h3><p>SpringBoot å¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»ï¼Œå¼€å¯äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½ @EnableAutoConfiguration ã€‚</p><p>@EnableAutoConfiguration ç»™å®¹å™¨å¯¼å…¥META-INF/spring.factories é‡Œå®šä¹‰çš„è‡ªåŠ¨é…ç½®ç±»ã€‚</p><p>ç­›é€‰æœ‰æ•ˆçš„è‡ªåŠ¨é…ç½®ç±»ã€‚</p><p>æ¯ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»ç»“åˆå¯¹åº”çš„ xxxProperties.java è¯»å–é…ç½®æ–‡ä»¶è¿›è¡Œè‡ªåŠ¨é…ç½®åŠŸèƒ½ ã€‚</p><ul><li><code>xxxAutoConfiguration</code>ï¼šè‡ªåŠ¨é…ç½®ç±»ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ã€‚</li><li><code>xxxProperties</code>ï¼šå°è£…é…ç½®æ–‡ä»¶ä¸­ç›¸å…³å±æ€§ã€‚</li></ul><h2 id="conditionalç›¸å…³æ³¨è§£å’Œdebug" tabindex="-1"><a class="header-anchor" href="#conditionalç›¸å…³æ³¨è§£å’Œdebug" aria-hidden="true">#</a> @Conditionalç›¸å…³æ³¨è§£å’ŒDebug</h2><p>@ConditionalOnBean:ä»…ä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­å­˜åœ¨æŸä¸ªå¯¹è±¡æ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–ä¸€ä¸ªBean @ConditionalOnClass:æŸä¸ªclassä½äºç±»è·¯å¾„ä¸Šæ‰ä¼šå®ä¾‹åŒ–ä¸€ä¸ªBean @ConditionalOnExpression:å½“è¡¨è¾¾å¼ä¸ºtrueçš„æ—¶å€™ï¼Œæ‰ä¼šå®ä¾‹åŒ–ä¸€ä¸ªBean @ConditionalOnMissingBean:ä»…ä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­ä¸å­˜åœ¨æŸä¸ªå¯¹è±¡æ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–ä¸€ä¸ªBean @ConditionalOnMissingClass:æŸä¸ªclassä¸ä½äºç±»è·¯å¾„ä¸Šæ‰ä¼šå®ä¾‹åŒ–ä¸€ä¸ªBean @ConditionalOnNotWebApplication:ä¸æ˜¯webåº”ç”¨</p><p>å¼€å¯SpringBoot debugæŸ¥çœ‹ä½¿ç”¨äº†å“ªäº›é…ç½®ç±»</p><figure><img src="/Computer-Science-Learn-Notes/assets/19-d0194da3.png" alt="19" tabindex="0" loading="lazy"><figcaption>19</figcaption></figure><p>ä»¥åŠæ²¡æœ‰å¯åŠ¨çš„</p><figure><img src="/Computer-Science-Learn-Notes/assets/20-74d271ce.png" alt="20" tabindex="0" loading="lazy"><figcaption>20</figcaption></figure><h2 id="æ—¥å¿—æ¡†æ¶sl4j" tabindex="-1"><a class="header-anchor" href="#æ—¥å¿—æ¡†æ¶sl4j" aria-hidden="true">#</a> æ—¥å¿—æ¡†æ¶SL4J</h2><p>SL4Jçš„å‡ ç§å®ç°æ–¹å¼ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/21-7a824891.png" alt="21" tabindex="0" loading="lazy"><figcaption>21</figcaption></figure><h3 id="å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºsl4j" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºsl4j" aria-hidden="true">#</a> å…¶ä»–æ—¥å¿—æ¡†æ¶è½¬æ¢ä¸ºSL4J</h3><p><strong>SpringBootï¼ˆsl4j+lockbcakï¼‰</strong></p><p>Springï¼ˆcommons-loggingï¼‰</p><p>Hibernateï¼ˆjboss-loggingï¼‰</p><p>è½¬æ¢æ–¹å¼å¦‚ä¸‹ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/22-88816a2a.png" alt="22" tabindex="0" loading="lazy"><figcaption>22</figcaption></figure><h3 id="springbootå’Œæ—¥å¿—å…³ç³»" tabindex="-1"><a class="header-anchor" href="#springbootå’Œæ—¥å¿—å…³ç³»" aria-hidden="true">#</a> SpringBootå’Œæ—¥å¿—å…³ç³»</h3><figure><img src="/Computer-Science-Learn-Notes/assets/23-8678b99d.png" alt="23" tabindex="0" loading="lazy"><figcaption>23</figcaption></figure><p>SpringBootä½¿ç”¨spring-boot-starter-loggingæ¥è®°å½•æ—¥å¿—</p><figure><img src="/Computer-Science-Learn-Notes/assets/24-f61cd612.png" alt="24" tabindex="0" loading="lazy"><figcaption>24</figcaption></figure><h3 id="æ—¥å¿—çš„é…ç½®" tabindex="-1"><a class="header-anchor" href="#æ—¥å¿—çš„é…ç½®" aria-hidden="true">#</a> æ—¥å¿—çš„é…ç½®</h3><p>è·¯å¾„çš„é…ç½®ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># ä¸æŒ‡å®šè·¯å¾„å½“å‰é¡¹ç›®ä¸‹ç”Ÿæˆspringboot.logæ—¥å¿—</span>
<span class="token comment">#logging.file.name=springboot.log</span>
<span class="token comment"># åœ¨å½“å‰ç£ç›˜æ ¹è·¯å¾„ä¸‹åˆ›å»ºspringæ–‡ä»¶å¤¹å’Œé‡Œé¢çš„logæ–‡ä»¶ï¼Œä½¿ç”¨spring.logä½œä¸ºé»˜è®¤æ–‡ä»¶</span>
<span class="token key attr-name">logging.file.path</span><span class="token punctuation">=</span><span class="token value attr-value">/springLog/log</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/25-8e40dafe.png" alt="25" tabindex="0" loading="lazy"><figcaption>25</figcaption></figure><p>æ—¥å¿—è¾“å‡ºæ ¼å¼æ§åˆ¶ï¼š</p><ul><li>æ—¥å¿—è¾“å‡ºæ ¼å¼ï¼š</li><li>%dè¡¨ç¤ºæ—¥æœŸæ—¶é—´ï¼Œ</li><li>%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ</li><li>%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦</li><li>%logger{50} è¡¨ç¤ºloggeråå­—æœ€é•¿50ä¸ªå­—ç¬¦ï¼Œå¦åˆ™æŒ‰ç…§å¥ç‚¹åˆ†å‰²ã€‚</li><li>%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ</li><li>%næ˜¯æ¢è¡Œç¬¦</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># åœ¨æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—æ ¼å¼
logging.pattern.console=%d{yyyy-MM-dd} [%thread] %-5level %logger{50} - %msg%n
# æŒ‡å®šæ–‡ä»¶ä¸­æ—¥å¿—çš„è¾“å‡ºæ ¼å¼
logging.pattern.file=%d{yyyy-MM-dd} === [%thread] === %-5level === %logger{50} ==== %msg%n
è¾“å‡ºç»“æœï¼š
2020-07-18 === [main] === INFO  === cn.zhiyucs.Springboot04ApplicationTests ==== Starting Springboot04ApplicationTests on DESKTOP-J83JFON with PID 3092 (started by 54271 in C:\Users\54271\Documents\SpringBoot_Twice\springboot_04)
2020-07-18 === [main] === DEBUG === cn.zhiyucs.Springboot04ApplicationTests ==== Running with Spring Boot v2.3.1.RELEASE, Spring v5.2.7.RELEASE
2020-07-18 === [main] === INFO  === cn.zhiyucs.Springboot04ApplicationTests ==== No active profile set, falling back to default profiles: default
2020-07-18 === [main] === INFO  === o.s.scheduling.concurrent.ThreadPoolTaskExecutor ==== Initializing ExecutorService &#39;applicationTaskExecutor&#39;
2020-07-18 === [main] === INFO  === cn.zhiyucs.Springboot04ApplicationTests ==== Started Springboot04ApplicationTests in 1.893 seconds (JVM running for 2.966)
2020-07-18 === [main] === TRACE === cn.zhiyucs.Springboot04ApplicationTests ==== è¿™æ˜¯è·Ÿè¸ªæ—¥å¿—
2020-07-18 === [main] === DEBUG === cn.zhiyucs.Springboot04ApplicationTests ==== è¿™æ˜¯è°ƒè¯•æ—¥å¿—
2020-07-18 === [main] === INFO  === cn.zhiyucs.Springboot04ApplicationTests ==== è¿™æ˜¯ä¿¡æ¯æ—¥å¿—
2020-07-18 === [main] === WARN  === cn.zhiyucs.Springboot04ApplicationTests ==== è¿™æ˜¯è­¦å‘Šæ—¥å¿—
2020-07-18 === [main] === ERROR === cn.zhiyucs.Springboot04ApplicationTests ==== è¿™æ˜¯é”™è¯¯æ—¥å¿—
2020-07-18 === [SpringContextShutdownHook] === INFO  === o.s.scheduling.concurrent.ThreadPoolTaskExecutor ==== Shutting down ExecutorService &#39;applicationTaskExecutor&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æŒ‡å®šæ—¥å¿—æ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#æŒ‡å®šæ—¥å¿—æ¡†æ¶" aria-hidden="true">#</a> æŒ‡å®šæ—¥å¿—æ¡†æ¶</h3><p>åœ¨ç±»è·¯å¾„ä¸‹ç›´æ¥æŒ‡å®šï¼šlogback.xml logback-spring.xml log4j2-spring.xml log4j2.xml</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPQAAABqCAYAAACLQ3zNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAA4eSURBVHhe7Z1tjx03Fcf7XRCogne8QhGb5O6WpNkNeejmQQRVCVKhWTZpCU9qA9psG1aEqKUKu0lKAakK2mUF5IlEqXTDF+HTGB97bJ/xPZ6Hu3tz53r+L36aax/72OPr/7Vn5trz2ncPDVTOHDh4RW0Oh2pz9bBoByAnshb08tnzanl1S20Pd9TaWQga5E+2gj5w8Lxa2dpR2zs7enQ+L6YBIDeyn3ID0CcgaAAy4rWl9x4rAEAeQNAAZAQEDUBGQNAAZERnBX37r09K3Lz3WL2zLqcFAFj2XdB3/vJQPXyYhuxSvphY0I6VjSdiegDABAT9ww8eqX/9WxYzxZNdyhcjibkJki8A+sJEptwbm7KgKV5KLyGJtQmxn8Wrz9T9hy/UtevP9XGohg+eFfFP1bUHX6mXL18adnX8xavhx2bx1gu1Oxwa2/DhV2rjFrON5H3u8y6acl6ojevl9Bs6/X3to3l9mM891BX0i4kI+swvH6vdfz4qiZnCFC+ll5DE2oTYjxGQ7uy2oz/1Qrj2gOKsaKxguLgoDwnwqQlfvPVc7RZped5rWrQ+r/Olhbqr827Egtbi9YKuqI/zuaHDJFxuG6euoF9M7KbYh5+UBU1hKV0KSaxNiP04AZGYfJwkOhYn2aV0Po6V0VTQdfWpsvG4qrygf0xM0Cd+9lh9uW3FTEcKS+lSSGLlSHkk3AhWEoSeog513O6DF+q+R4eZ0NwUd1ePpPfv6ilukd/m1VNmNgI6we7efdpQ0FJ9yj7LtvHqCvrHxARNXLlpR2k6SvYqJBFzKM3//r4gwv1UCui6nvJGlPPqOD2Fva+F4gQ3HUGPV1duB/1gooI+/v5j9fGdR+Yo2auQRMyR8kiIAkpMU/nIxj9bH4UgRcHW2E1chaAT9amyNamriwP9YaKC3guSiDmURhqdCe5HEhDBb0JR+OJdYRR2Nh3moopvYMU3rWg0pptW9ibZM3OHm6bEKUFLPqWbYuPUFfSLmRZ0E4yAosdINt4+CgqPe4IoiIt3x3tsZex6VKVHUiGvTe8FXVEfyede6gr6RWcF3QRpdCaktAD0gZkWNACgDEZoADICIzQAGQFBA5AR2CQQgIyAoAHICAgagIyAoAHIiOwF/fvNL0rc+MNn6sKld8S008a+vmdLreA9XGBMeidox6XLV8T043KAXoq3ta6WDzYXY5znwNl1tT0cqu0beBcXGI/eCroOyVcVJM7hTntBt80DQBUQdALJlxlR3SKInR21VrxzevlGiKe3XW5v2dGfptBrWzs2/XBHbeqRd/mGO47mMe+yNm/LLEbs4g2alMakazkDAP0Dgk4Q+7Evjg+vpl1e1dPjYnQl4dF7qGm0XaF3UheiW9kaFnE2jRMnTamlPPHL6eP8azrsfiwAkICgE8R+7PVt+sXx8fRZSu8E666RR/IwQdeVB4AEBJ1A8uVHWJoW37iilrlYY3FSeLilVoqwiaNRdqehoIX8ANQBQSeQfBF2qrxurnW54CBo0AUg6ASSr9KIHF3vjogTU24wBSDoBLEfP2IWAqMbWlxwzs4FWHVTTMoT/0jgphhoCwSdQPLFHzXxx1YEF+yQPbbycVr8/LGVlMcIGo+twB7IXtAA9AkIGoCMgKAByAgIGoCMgKAByAgIGoCMgKAByAgIGoCMgKAByIjsBR3/A6zLe4rVEf81FICY3gnaMc6eYvTf62n+/bKtoKddX/Dq6a2g65B8mcUUbHXUq2YcQU+zvuDVA0EniP1U7RtWXkBxxQvILragFVq0ftot6rArtkr+vC+Xno6ji0BiQVPZbfYsq6uvsdOoXuSLF6CA7gNBJ4j9kBCq9g2jsBWLDnOBanGUlkBqoZL4tmnHE8pj1j1bkfr0bFmmKbMIx4KuWp45fn1ptZddDcb3TaMw6D4QdALJVzyFFTcxYHGxAL0PthOJE7kVoU3v1ks7nOi4v7E2UKirr2AHswUEnUDyNSIQI06azm6pTY8OO9EVI15JQLGPEUGPCoqm0ZTnrbnVIOjohyH2ZcIt60tp/ChP67KjfdNA94GgE0i+ZIHQNa+e0kYYeycFna4v9yPtmwa6DwSdQPI1IpDEFNWNauMJOgjSMckpN8FHYf6Zl+fiQLeBoBNIvtwIxwXBb0xR2Iymxag2rqD346aYL6tNfYv03qbDuKaeLSDoBJIvLppwZ9jGhUc9QRBGgDocC7r0gjoStM5Pj5r8D8Aq5Qv+XH7rj+5Ch7y+Pjpf3Z5lPE6qL1G1bxroPtkLepbwgsaICMYEgu4QEDTYKxB0h7DT73B9C0BbIGgAMgKCBiAjIGgAMgKCBiAjIGgAMgKCBiAjIOiIY+/K8ZPGPoMu/qdt/s1V/gfXfjFJ37NMLu0CQTOOvD2vzt1ZUINT86J9kpQEbRZRjC7SGIeRv5ruo+9ZJtd2gaA1BxcGaunqvDr/pwXNvFq8PF1BS/ZxMQsu2GIQYMm1XXop6INHBurQ4kC9cW6gFrWQz9wmMQdO/FoWtP0nl7wYwgiybj+wOrsboU1aeREGIS3ukOok7SvWzrdQ56IMssc0Okdjt3usxQtGGteB+ZTzp/d1ozLHa5fZ2HutF4KeOzxQRy8O1Ol1Ldg7ZfFyzn1GI/SCOv2RLOiq5YqmQ+gv2C11pPTS0sc6uxd08Vkqd02HqYPV14k2KrAjkdtXrM63C4e0usObDmtFzOtMYU7Tc7QCsPWhNPV1SPvk+W36In/RPlKZbdol7ZPE79pET9eLtBSeJtkLem4wUCc/lAS8oOZPynkOL40Kum5DAf6Z53Mdoak9FnRqUwKirk4mXHRc19nqfKfqEez6B0WPdDwu2MplO6Rz9Hka1iHpU8rP4qQyTZq27cJ9CvaukL2g3/yxJOZ5dfK6nmr/4G31xT+ejEDxsR/TAYqNAHxc0bmps9kOMfolmw0EdMex2wfV2cud2HwWynXU1cmnSXXcMc6pXtDt2mDP7fpTyk/TZnmftFT++nZJ+6T0fiZE0/QO7b2WvaDf2pAFPX96oD7+dMsI+Hef3jVp6Uhhio/97LnjQdATFLTOz/ZH4/ukpfI3apeET+9D17Nre69lL2h7XVwW86nfhtH559fX1dGlEyYtHSksjdLiNKzoBKHjBSE5Zn/KHdvrBF13jpG/RnWo8Jlon+UiLJVp4lu2C+F8xp95Xhc3LfIfoW+WxUwsLIfR+XtvLqnb9/5m0tKRwqlR2nQi3Qlm5aYY2d1o48qs8+3C1NFt2nLH5oK2dQk3h5qdY9kfUV+HtM84v7HT6F2MmKky27QLhUs+i7zepsPSD8A0yF7Qb1wYmDvbNFKfWltQxy4P1Nz8YS/oI4vH1Seff2k+05HCKUFzwVCHGnlsRV9q1X5gdXa6HnOCLj7H5RqxRo+tUnUasbtRsrFvShvq6NJbEdt6uqmxT197jmV/zmdlHSp88vzhMVIQW5Myq9pF8kl0de+17AVNHDpq73bPzVuBH3uXTbl/85E69v1T6ifv/cIcKUzx0o2xKnzHizpOU3sOTOIc+9Bu+0kvBE3MLQzMjbD5M/MGejbtRumbf7yn3v9gzRxTo3MdEDQE3QV6I2gJN0rHtB2dCTsVDddcbe05MIlz7EO77Se9FjQAuQFBA5AREDQAGQFBA5AREDQAGdFLQf9o5ao5Nn1JHQCzQu8ETWJ2wo3F7OIl7PPQ8NfAvTDJZ6vTfm5r/2FV/ldVV9nP77Qr9ErQTsxOuFzIPF4Cgm6GXdgwupiii0DQMwwXsxMuD/N4CQg6PyDozNiLoO3UUl5Q4Oylvb5Wbfr0Qg4KV+SvWHTBy48FfcDsxRXySdDqIWmhgfFlFiXI9Qz2sF+XjaPzdYtMovzFufiyK9rJpfFpzVY/4dwIs0iCVkW5c2f1sfW10//SPmLFSjWTHoKeTSTxSkh5ifjLr1ryJ9ttp22y1LIuv2R3Syqtb+vHlVM1/XXp3RJIvj9WXT293Yhc/+CwPF7QOm3VnmR15xnD25mXRbZQH9Yu9ENDdaBdRShPcUkQ6gdBzySSeCWkvESpowoL4JvauaDjTms6K4myLr9gL6cjW9GZi9HI2HTcip4VWAoB1vqqqGdh54LgcbLd1qtJO7k4jstPdlePYBPKMz8gepTW5xrnl9LPOr2ecreh1FGjTmLtrKPU2Y2vURGZRfR6dPHb6rTwH9JZ39s6rRvJvE0LKOyRxWcTxahIU2W2P1ZtPaUthXg7CfndeTRpRxcXY38IhPOTyqMyWLrR7wGCnin+e+FbY8P9lDrqDAh6TV8z8qltHeQ/3h+rtp7TErTORz9Ao3mF8qgMCDofuED/c/6b6leHvuHD9JnieBoO91PqqBVTxaS9GFV4R4o77f5OuelGUBBnnI6znDqPunqystL5YzsTdE07uThO8J+ackf+IOi8cOL88/HX1aXvfF19vvS6j6PPFEc2F8fhfuIv33Qm3VHCzZzyFNCGtZjMbpG0Vc+rvynG0/GpKcePkqweTmR19YzLMv5YO8n2IGgKV7cTnVe4YefTFyLmZYVwVB4EnRdOnGe+/TW1e3p0NKY4ssXxBPdjvny6xvSdJ4jMdEDhsRXZ6bp0W3dYd5PKdyTTiekYHq/EHd/5JwG1emzFfNkOrOugRZASdWp/LC+QFnuE8XaS7U6kzkd1O7nPJq25A1+ecUiPrUrl0Q8U+258+f57CHXJAYzQDUfotizrjsnDpvPM2Ghg61we8fabHNqpS+AauuE1dBv8dSCNin4qWT317SKTFnQu7dQleiXotkj+mkL/0KKpnZ1K0hQvPeXtKnZ6aq/TJft+kEM7dYnsBQ1An4CgAcgICBqAbBio/wPeWsx9CM/EdgAAAABJRU5ErkJggg==" alt="26" tabindex="0" loading="lazy"><figcaption>26</figcaption></figure><p>logback.xmlï¼šç›´æ¥è¢«æ—¥å¿—æ¡†æ¶è¯†åˆ«</p><p>logback-spring.xmlï¼šå¯ä»¥ä½¿ç”¨SpringBootæ—¥å¿—çš„Profileçš„é«˜çº§åŠŸèƒ½</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;
    &lt;springProfile name=&quot;dev&quot;&gt;
        &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} ----&gt; [%thread] ---&gt; %-5level %logger{50} - %msg%n&lt;/pattern&gt;
    &lt;/springProfile&gt;
    &lt;springProfile name=&quot;!dev&quot;&gt;
        &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} ==== [%thread] ==== %-5level %logger{50} - %msg%n&lt;/pattern&gt;
    &lt;/springProfile&gt;
&lt;/layout&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ‡æ¢æ—¥å¿—æ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#åˆ‡æ¢æ—¥å¿—æ¡†æ¶" aria-hidden="true">#</a> åˆ‡æ¢æ—¥å¿—æ¡†æ¶</h3><p>ç›´æ¥åœ¨Mavençš„excludeå³å¯</p><h2 id="é™æ€èµ„æºæ˜ å°„è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#é™æ€èµ„æºæ˜ å°„è§„åˆ™" aria-hidden="true">#</a> é™æ€èµ„æºæ˜ å°„è§„åˆ™</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span><span class="token class-name">ResourceHandlerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">isAddMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Default resource handling disabled&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Duration</span> cachePeriod <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPeriod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CacheControl</span> cacheControl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCachecontrol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHttpCacheControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>registry<span class="token punctuation">.</span><span class="token function">hasMappingForPattern</span><span class="token punctuation">(</span><span class="token string">&quot;/webjars/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">customizeResourceHandlerRegistration</span><span class="token punctuation">(</span>registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/webjars/**&quot;</span><span class="token punctuation">)</span>
                                             <span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/META-INF/resources/webjars/&quot;</span><span class="token punctuation">)</span>
                                             <span class="token punctuation">.</span><span class="token function">setCachePeriod</span><span class="token punctuation">(</span><span class="token function">getSeconds</span><span class="token punctuation">(</span>cachePeriod<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCacheControl</span><span class="token punctuation">(</span>cacheControl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">String</span> staticPathPattern <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getStaticPathPattern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>registry<span class="token punctuation">.</span><span class="token function">hasMappingForPattern</span><span class="token punctuation">(</span>staticPathPattern<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">customizeResourceHandlerRegistration</span><span class="token punctuation">(</span>registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span>staticPathPattern<span class="token punctuation">)</span>
                                             <span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token function">getResourceLocations</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getStaticLocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                             <span class="token punctuation">.</span><span class="token function">setCachePeriod</span><span class="token punctuation">(</span><span class="token function">getSeconds</span><span class="token punctuation">(</span>cachePeriod<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCacheControl</span><span class="token punctuation">(</span>cacheControl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>WebJar+Mavenæ–¹å¼åŠ è½½é™æ€èµ„æº</li></ol><p><strong>registry.hasMappingForPattern(&quot;/webjars/**)</strong></p><p>å»<a href="https://www.webjars.org/" target="_blank" rel="noopener noreferrer">WebJars<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ä»¥jarsçš„æ–¹å¼è·å–é™æ€èµ„æº å¦‚ï¼šjquery</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.webjars<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jquery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/27-afd02372.png" alt="27" tabindex="0" loading="lazy"><figcaption>27</figcaption></figure><p>è·¯å¾„æ˜¯åœ¨ï¼šorg\webjars\jquery\3.5.1\jquery-3.5.1.jar!\META-INF\resources\webjars\jquery\3.5.1\jquery.js ç½‘é¡µè®¿é—®è·¯å¾„ï¼š<a href="http://localhost:8080/webjars/jquery/3.5.1/jquery.js" target="_blank" rel="noopener noreferrer">http://localhost:8080/webjars/jquery/3.5.1/jquery.js<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><figure><img src="/Computer-Science-Learn-Notes/assets/28-22516e6b.png" alt="28" tabindex="0" loading="lazy"><figcaption>28</figcaption></figure><ol start="2"><li>å¯ä»¥è®¾ç½®é™æ€èµ„æºçš„æœ‰å…³å‚æ•°ï¼šï¼ˆResourceProperties.classï¼‰</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.resources&quot;</span><span class="token punctuation">,</span> ignoreUnknownFields <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResourceProperties</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token constant">CLASSPATH_RESOURCE_LOCATIONS</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;classpath:/META-INF/resources/&quot;</span><span class="token punctuation">,</span>
                                                                  <span class="token string">&quot;classpath:/resources/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;classpath:/static/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;classpath:/public/&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>è®¿é—®å½“å‰é¡¹ç›®çš„ä»»ä½•èµ„æº</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&quot;/&quot;,
&quot;classpath:/META-INF/resources/&quot;,
&quot;classpath:/resources/&quot;, 
&quot;classpath:/static/&quot;, 
&quot;classpath:/public/&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¾‹å¦‚æ·»åŠ ä¸€ä¸ªèµ„æºåŒ…ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/29-3e5013b2.png" alt="29" tabindex="0" loading="lazy"><figcaption>29</figcaption></figure><p><strong>ç½‘é¡µè®¿é—®è·¯å¾„ï¼š<a href="http://localhost:8080/asserts/js/Chart.min.js" target="_blank" rel="noopener noreferrer">http://localhost:8080/asserts/js/Chart.min.js<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></strong></p><ol start="4"><li>æ¬¢è¿é¡µçš„åŠ è½½æ–¹å¼ï¼šä¹Ÿåœ¨WebMvcAutoConfigurationè¿™ä¸ªç±»ä¸­</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">WelcomePageHandlerMapping</span> <span class="token function">welcomePageHandlerMapping</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">,</span>
                                                           <span class="token class-name">FormattingConversionService</span> mvcConversionService<span class="token punctuation">,</span> <span class="token class-name">ResourceUrlProvider</span> mvcResourceUrlProvider<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">WelcomePageHandlerMapping</span> welcomePageHandlerMapping <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WelcomePageHandlerMapping</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">TemplateAvailabilityProviders</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">)</span><span class="token punctuation">,</span> applicationContext<span class="token punctuation">,</span> <span class="token function">getWelcomePage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getStaticPathPattern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    welcomePageHandlerMapping<span class="token punctuation">.</span><span class="token function">setInterceptors</span><span class="token punctuation">(</span><span class="token function">getInterceptors</span><span class="token punctuation">(</span>mvcConversionService<span class="token punctuation">,</span> mvcResourceUrlProvider<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    welcomePageHandlerMapping<span class="token punctuation">.</span><span class="token function">setCorsConfigurations</span><span class="token punctuation">(</span><span class="token function">getCorsConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> welcomePageHandlerMapping<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æŸ¥çœ‹getWelcomePageæ–¹æ³•å°±å¯ä»¥çœ‹å‡ºæ˜¯<strong>åŠ è½½é™æ€èµ„æºçš„index.html</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> <span class="token function">getWelcomePage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> locations <span class="token operator">=</span> <span class="token function">getResourceLocations</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getStaticLocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>locations<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">getIndexHtml</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">isReadable</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">private</span> <span class="token class-name">Resource</span> <span class="token function">getIndexHtml</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span>location <span class="token operator">+</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ¨¡æ¿å¼•æ“thymeleaf" tabindex="-1"><a class="header-anchor" href="#æ¨¡æ¿å¼•æ“thymeleaf" aria-hidden="true">#</a> æ¨¡æ¿å¼•æ“Thymeleaf</h2><p>æ•´åˆSpringBoot</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-thymeleaf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thymeleafçš„é»˜è®¤é…ç½®</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.thymeleaf&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThymeleafProperties</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Charset</span> <span class="token constant">DEFAULT_ENCODING</span> <span class="token operator">=</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DEFAULT_PREFIX</span> <span class="token operator">=</span> <span class="token string">&quot;classpath:/templates/&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DEFAULT_SUFFIX</span> <span class="token operator">=</span> <span class="token string">&quot;.html&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**æ³¨ï¼š**Controllerä¸­çš„@RequestMapping(&quot;/su&quot;)ä¸èƒ½å’Œreturn&quot;xx&quot;é‡å¤</p><figure><img src="/Computer-Science-Learn-Notes/assets/30-2ac2933b.png" alt="30" tabindex="0" loading="lazy"><figcaption>30</figcaption></figure><h2 id="springmvcè‡ªåŠ¨é…ç½®åŸç†" tabindex="-1"><a class="header-anchor" href="#springmvcè‡ªåŠ¨é…ç½®åŸç†" aria-hidden="true">#</a> SpringMVCè‡ªåŠ¨é…ç½®åŸç†</h2><p><a href="https://www.docs4dev.com/docs/zh/spring-boot/2.1.1.RELEASE/reference/boot-features-developing-web-applications.html#developing-web-applications" target="_blank" rel="noopener noreferrer">æ–‡æ¡£å‚è€ƒï¼šSpringMVC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="é»˜è®¤é…ç½®" tabindex="-1"><a class="header-anchor" href="#é»˜è®¤é…ç½®" aria-hidden="true">#</a> é»˜è®¤é…ç½®</h3><p>auto-configuration åœ¨ Spring çš„é»˜è®¤å€¼ä¹‹ä¸Šæ·»åŠ ä»¥ä¸‹ featuresï¼š</p><ul><li><p>åŒ…å«<code>ContentNegotiatingViewResolver</code>å’Œ<code>BeanNameViewResolver</code> beansï¼ˆè§†å›¾è§£æå™¨ï¼Œæ ¹æ®è¿”å›å€¼è§†å›¾å¯¹è±¡ï¼ˆViewï¼‰ï¼Œç„¶åå¯ä»¥è¿›è¡Œæ¸²æŸ“ï¼ˆè½¬å‘/é‡å®šå‘ï¼‰ï¼‰ã€‚</p></li><li><p>æ”¯æŒæä¾›é™æ€èµ„æºï¼ŒåŒ…æ‹¬å¯¹ WebJars çš„æ”¯æŒ</p></li><li><p>è‡ªåŠ¨æ³¨å†Œ<code>Converter</code>ï¼Œ<code>GenericConverter</code>å’Œ<code>Formatter</code> beans</p></li><li><ul><li>è½¬æ¢å™¨ HttpMessageConverters</li><li>æ ¼å¼åŒ–å™¨</li></ul></li><li><p>æ”¯æŒ<code>HttpMessageConverters è½¬æ¢ HTTP è¯·æ±‚å’Œå“åº”</code></p></li><li><p>è‡ªåŠ¨æ³¨å†Œ<code>MessageCodesResolver å®šä¹‰é”™è¯¯ä»£ç çš„ç”Ÿæˆè§„åˆ™</code></p></li><li><p>é™æ€<code>index.html</code>æ”¯æŒã€‚</p></li><li><p>è‡ªå®šä¹‰<code>Favicon</code>æ”¯æŒ</p></li></ul><h3 id="contentnegotiatingviewresolver" tabindex="-1"><a class="header-anchor" href="#contentnegotiatingviewresolver" aria-hidden="true">#</a> ContentNegotiatingViewResolver</h3><p>é¦–å…ˆæ˜¯<strong>ContentNegotiatingViewResolver</strong>ï¼šç»„åˆæ‰€æœ‰çš„è§†å›¾è§£æå™¨</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConditionalOnBean</span><span class="token punctuation">(</span><span class="token class-name">ViewResolver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;viewResolver&quot;</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token class-name">ContentNegotiatingViewResolver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ContentNegotiatingViewResolver</span> <span class="token function">viewResolver</span><span class="token punctuation">(</span><span class="token class-name">BeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ContentNegotiatingViewResolver</span> resolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentNegotiatingViewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    resolver<span class="token punctuation">.</span><span class="token function">setContentNegotiationManager</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">ContentNegotiationManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ContentNegotiatingViewResolver uses all the other view resolvers to locate</span>
    <span class="token comment">// a view so it should have a high precedence</span>
    resolver<span class="token punctuation">.</span><span class="token function">setOrder</span><span class="token punctuation">(</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token constant">HIGHEST_PRECEDENCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> resolver<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ContentNegotiatingViewResolverä¸­é€šè¿‡resolveViewNameè§£æè§†å›¾</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">public</span> <span class="token class-name">View</span> <span class="token function">resolveViewName</span><span class="token punctuation">(</span><span class="token class-name">String</span> viewName<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">RequestAttributes</span> attrs <span class="token operator">=</span> <span class="token class-name">RequestContextHolder</span><span class="token punctuation">.</span><span class="token function">getRequestAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span>attrs <span class="token keyword">instanceof</span> <span class="token class-name">ServletRequestAttributes</span><span class="token punctuation">,</span> <span class="token string">&quot;No current ServletRequestAttributes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MediaType</span><span class="token punctuation">&gt;</span></span> requestedMediaTypes <span class="token operator">=</span> <span class="token function">getMediaTypes</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ServletRequestAttributes</span><span class="token punctuation">)</span> attrs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>requestedMediaTypes <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">View</span><span class="token punctuation">&gt;</span></span> candidateViews <span class="token operator">=</span> <span class="token function">getCandidateViews</span><span class="token punctuation">(</span>viewName<span class="token punctuation">,</span> locale<span class="token punctuation">,</span> requestedMediaTypes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">View</span> bestView <span class="token operator">=</span> <span class="token function">getBestView</span><span class="token punctuation">(</span>candidateViews<span class="token punctuation">,</span> requestedMediaTypes<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bestView <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> bestView<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡getCandidateViewsè¿›è¡Œéå†æ¯ä¸ªè§£æ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">View</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCandidateViews</span><span class="token punctuation">(</span><span class="token class-name">String</span> viewName<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MediaType</span><span class="token punctuation">&gt;</span></span> requestedMediaTypes<span class="token punctuation">)</span>
    <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">View</span><span class="token punctuation">&gt;</span></span> candidateViews <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>viewResolvers <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>contentNegotiationManager <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;No ContentNegotiationManager set&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ViewResolver</span> viewResolver <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>viewResolvers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">View</span> view <span class="token operator">=</span> viewResolver<span class="token punctuation">.</span><span class="token function">resolveViewName</span><span class="token punctuation">(</span>viewName<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>view <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                candidateViews<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">MediaType</span> requestedMediaType <span class="token operator">:</span> requestedMediaTypes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> extensions <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contentNegotiationManager<span class="token punctuation">.</span><span class="token function">resolveFileExtensions</span><span class="token punctuation">(</span>requestedMediaType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> extension <span class="token operator">:</span> extensions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">String</span> viewNameWithExtension <span class="token operator">=</span> viewName <span class="token operator">+</span> <span class="token char">&#39;.&#39;</span> <span class="token operator">+</span> extension<span class="token punctuation">;</span>
                    view <span class="token operator">=</span> viewResolver<span class="token punctuation">.</span><span class="token function">resolveViewName</span><span class="token punctuation">(</span>viewNameWithExtension<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>view <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        candidateViews<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åç»„åˆèµ·æ¥<strong>ContentNegotiatingViewResolver</strong>é€šè¿‡initServletContextçš„beansOfTypeIncludingAncestors</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initServletContext</span><span class="token punctuation">(</span><span class="token class-name">ServletContext</span> servletContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ViewResolver</span><span class="token punctuation">&gt;</span></span> matchingBeans <span class="token operator">=</span>
        <span class="token class-name">BeanFactoryUtils</span><span class="token punctuation">.</span><span class="token function">beansOfTypeIncludingAncestors</span><span class="token punctuation">(</span><span class="token function">obtainApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">ViewResolver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•å¹¶è°ƒè¯•ï¼šåœ¨ä¸»ç±»åˆ›å»ºä¸€ä¸ªè§†å›¾è§£æå™¨è¿›è¡Œæµ‹è¯•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringbootCrudApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SpringbootCrudApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ViewResolver</span> <span class="token function">myViewResovler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyViewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyViewResolver</span> <span class="token keyword">implements</span> <span class="token class-name">ViewResolver</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">View</span> <span class="token function">resolveViewName</span><span class="token punctuation">(</span><span class="token class-name">String</span> viewName<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨doDispatchè¿›è¡Œè°ƒè¯•ï¼šå³å¯çœ‹è§</p><figure><img src="/Computer-Science-Learn-Notes/assets/31-70808356.png" alt="31" tabindex="0" loading="lazy"><figcaption>31</figcaption></figure><h3 id="httpmessageconverters" tabindex="-1"><a class="header-anchor" href="#httpmessageconverters" aria-hidden="true">#</a> HttpMessageConverters</h3><p>Spring MVC ä½¿ç”¨<code>HttpMessageConverter</code>æ¥å£è½¬æ¢ HTTP è¯·æ±‚å’Œå“åº”ã€‚</p><p>è¿™ä¸ªç»„ä»¶æ˜¯ä»å®¹å™¨ä¸­ç¡®å®šçš„ï¼ˆWebMvcAutoConfiguration.classï¼‰ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public WebMvcAutoConfigurationAdapter(ResourceProperties resourceProperties, WebMvcProperties mvcProperties,
                                      ListableBeanFactory beanFactory, ObjectProvider&lt;HttpMessageConverters&gt; messageConvertersProvider,
                                      ObjectProvider&lt;ResourceHandlerRegistrationCustomizer&gt; resourceHandlerRegistrationCustomizerProvider,
                                      ObjectProvider&lt;DispatcherServletPath&gt; dispatcherServletPath) {
    this.resourceProperties = resourceProperties;
    this.mvcProperties = mvcProperties;
    this.beanFactory = beanFactory;
    this.messageConvertersProvider = messageConvertersProvider;
    this.resourceHandlerRegistrationCustomizer = resourceHandlerRegistrationCustomizerProvider.getIfAvailable();
    this.dispatcherServletPath = dispatcherServletPath;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»æ„é€ å‡½æ•°å°±å¯ä»¥çœ‹å‡ºè¿™ä¸ªç±»æ˜¯è·å–äº†æ‰€æœ‰çš„HttpMessageConverter</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public HttpMessageConverters(HttpMessageConverter&lt;?&gt;... additionalConverters) {
    this(Arrays.asList(additionalConverters));
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯çŸ¥åªè¦è‡ªå®šä¹‰Converterå°±å¯ä»¥åƒä¸Šé¢è§†å›¾è§£æå™¨ä¸€æ ·æ”¾å®¹å™¨å³å¯</p><h3 id="messagecodesresolver" tabindex="-1"><a class="header-anchor" href="#messagecodesresolver" aria-hidden="true">#</a> MessageCodesResolver</h3><p>è¿™ä¸ªæ˜¯ç”¨äºå®šä¹‰é”™è¯¯ä»£ç çš„ç”Ÿæˆè§„åˆ™çš„ï¼Œå¦‚ï¼ˆWebMvcAutoConfiguration.classï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">MessageCodesResolver</span> <span class="token function">getMessageCodesResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getMessageCodesResolverFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DefaultMessageCodesResolver</span> resolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultMessageCodesResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resolver<span class="token punctuation">.</span><span class="token function">setMessageCodeFormatter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getMessageCodesResolverFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> resolver<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æŸ¥çœ‹getMessageCodesResolverFormatï¼ˆï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
     * Formatting strategy for message codes. For instance, `PREFIX_ERROR_CODE`.
     */</span>
<span class="token keyword">private</span> <span class="token class-name">DefaultMessageCodesResolver<span class="token punctuation">.</span>Format</span> messageCodesResolverFormat<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è§‚å¯Ÿæ³¨é‡Šå¯ä»¥çœ‹åˆ°é”™è¯¯ä»£ç çš„å®šä¹‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Format</span> <span class="token keyword">implements</span> <span class="token class-name">MessageCodeFormatter</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
         * Prefix the error code at the beginning of the generated message code. e.g.:
         * <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java">errorCode <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> object name <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> field</span></span><span class="token punctuation">}</span>
         */</span>
    <span class="token constant">PREFIX_ERROR_CODE</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token class-name">String</span> errorCode<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> objectName<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> field<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">toDelimitedString</span><span class="token punctuation">(</span>errorCode<span class="token punctuation">,</span> objectName<span class="token punctuation">,</span> field<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
         * Postfix the error code at the end of the generated message code. e.g.:
         * <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java">object name <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> field <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> errorCode</span></span><span class="token punctuation">}</span>
         */</span>
    <span class="token constant">POSTFIX_ERROR_CODE</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token class-name">String</span> errorCode<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> objectName<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> field<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">toDelimitedString</span><span class="token punctuation">(</span>objectName<span class="token punctuation">,</span> field<span class="token punctuation">,</span> errorCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="springbootåœ¨springmvcçš„é…ç½®æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#springbootåœ¨springmvcçš„é…ç½®æ¨¡å¼" aria-hidden="true">#</a> SpringBootåœ¨SpringMVCçš„é…ç½®æ¨¡å¼</h3><p>ä»¥HiddenHttpMethodFilterä¸ºä¾‹ï¼šSpringåœ¨è‡ªåŠ¨é…ç½®å¾ˆå¤šç»„ä»¶çš„æ—¶å€™ï¼Œå…ˆçœ‹å®¹å™¨æ˜¯å¦ä¹ˆæœ‰è‡ªå·±é…ç½®çš„ï¼ˆ@Bean @Componentï¼‰å¦‚æœæœ‰å°±ç”¨ç”¨æˆ·é…ç½®çš„ï¼ˆå¦‚hiddenHttpMethodFilterï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ‰è‡ªåŠ¨é…ç½®ï¼Œå¦‚æœå¯ä»¥æœ‰å¤šä¸ªï¼ˆViewResolverï¼‰å°†ç”¨æˆ·é…ç½®å’Œè‡ªå·±é»˜è®¤ç»„åˆä¸€èµ·</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">HiddenHttpMethodFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.mvc.hiddenmethod.filter&quot;</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">&quot;enabled&quot;</span><span class="token punctuation">,</span> matchIfMissing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">OrderedHiddenHttpMethodFilter</span> <span class="token function">hiddenHttpMethodFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">OrderedHiddenHttpMethodFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¥ç®¡springbootçš„springmvc" tabindex="-1"><a class="header-anchor" href="#æ¥ç®¡springbootçš„springmvc" aria-hidden="true">#</a> æ¥ç®¡SpringBootçš„SpringMVC</h3><p>ä½¿ç”¨WebMvcConfigurerçš„æ¥å£å¯ä»¥æ‰©å±•SpringMVC</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/32-d522be17.png" alt="32" tabindex="0" loading="lazy"><figcaption>32</figcaption></figure><p>æ¯”å¦‚ä½¿ç”¨SpringMVCçš„Controllerï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addViewControllers</span><span class="token punctuation">(</span><span class="token class-name">ViewControllerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">addViewController</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ†æè¿™ä¸ªWebMvcAutoConfigurationAdapterï¼ˆWebMvcAutoConfiguration.classï¼‰,æŸ¥çœ‹è¿™ä¸ªImport(EnableWebMvcConfiguration.class)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">EnableWebMvcConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">WebMvcProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">ResourceProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcAutoConfigurationAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EnableWebMvcConfiguration</span> <span class="token keyword">extends</span> <span class="token class-name">DelegatingWebMvcConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">ResourceLoaderAware</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®ƒçš„çˆ¶ç±»DelegatingWebMvcConfigurationä¸­ï¼ŒsetConfigurersé€šè¿‡addWebMvcConfigurersä»å®¹å™¨ä¸­è·å–æ‰€æœ‰çš„WebMvcConfigure</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setConfigurers</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">&gt;</span></span> configurers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>configurers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>configurers<span class="token punctuation">.</span><span class="token function">addWebMvcConfigurers</span><span class="token punctuation">(</span>configurers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç„¶ï¼Œä¸‹é¢ä¹Ÿæœ‰å¾ˆå¤šæ–¹æ³•ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/33-4210f2c9.png" alt="33" tabindex="0" loading="lazy"><figcaption>33</figcaption></figure><p>ä»¥addViewControllersä¸ºä¾‹:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addViewControllers</span><span class="token punctuation">(</span><span class="token class-name">ViewControllerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">WebMvcConfigurer</span> delegate <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>delegates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        delegate<span class="token punctuation">.</span><span class="token function">addViewControllers</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-1" tabindex="-1"><a class="header-anchor" href="#å°ç»“-1" aria-hidden="true">#</a> å°ç»“ï¼š</h3><ol><li><p>å®ç°äº†WebMvcConfigureræ¥å£ï¼ŒSpringBootå°±ä¼šå°†è¿™ä¸ªä¸€èµ·å®ç°ï¼Œå¦‚åˆšåˆšMyMvcConfig</p></li><li><p>DelegatingWebMvcConfigurationï¼ˆä¹Ÿå°±æ˜¯æ˜¯å®ç°äº†WebMvcConfigurerï¼‰ï¼ŒSpringBootä¼šæ‰«ææ•´ä¸ªèƒ½ä½¿ç”¨çš„Configureråˆ°SpringMVCï¼Œç„¶åå°±èƒ½ä½¿ç”¨SpringMVCçš„åŠŸèƒ½å•¦ï¼ˆsetConfigurers -- addWebMvcConfigurersï¼‰</p></li></ol><p>ã€ä¸æ¨èã€‘<em>å…¨é¢æ¥ç®¡SpringMVC</em>ï¼šè‡ªå·±é…SpringMVC@EnableWebMvc</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableWebMvc</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addViewControllers</span><span class="token punctuation">(</span><span class="token class-name">ViewControllerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">addViewController</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªçš„æ ¸å¿ƒå°±æ˜¯ -- DelegatingWebMvcConfiguration</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">DelegatingWebMvcConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableWebMvc</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿæ˜¯ç»„åˆè‡ªå·±å†™çš„Configurer</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setConfigurers</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">&gt;</span></span> configurers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>configurers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>configurers<span class="token punctuation">.</span><span class="token function">addWebMvcConfigurers</span><span class="token punctuation">(</span>configurers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€é‡ç‚¹å°ç»“ã€‘åœ¨<strong>DelegatingWebMvcConfiguration</strong>ä¸­ä¸<strong>WebMvcAutoConfiguration</strong>ï¼ˆ<strong>@ConditionalOnMissingBean</strong>ï¼‰æ¯”è¾ƒå¯çŸ¥ï¼šå®¹å™¨ä¸­æ²¡æœ‰è¿™ä¸ªç»„ä»¶çš„æ—¶å€™ï¼Œè¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æ‰ç”Ÿæ•ˆï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨**@EnableWebMvc**ï¼Œè¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»å°±ä¸ä¼šç”Ÿæ•ˆã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DelegatingWebMvcConfiguration</span> <span class="token keyword">extends</span> <span class="token class-name">WebMvcConfigurationSupport</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnWebApplication</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token constant">SERVLET</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">DispatcherServlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">WebMvcConfigurationSupport</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@AutoConfigureOrder</span><span class="token punctuation">(</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token constant">HIGHEST_PRECEDENCE</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@AutoConfigureAfter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">DispatcherServletAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">TaskExecutionAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
                     <span class="token class-name">ValidationAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcAutoConfiguration</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å›½é™…åŒ–" tabindex="-1"><a class="header-anchor" href="#å›½é™…åŒ–" aria-hidden="true">#</a> å›½é™…åŒ–</h2><p>åˆ›å»ºå›½é™…åŒ–æ–‡ä»¶ ä¸­æ–‡ï¼šxxx_zh_CN.properties Englishï¼šxxx_en_US.properties</p><figure><img src="/Computer-Science-Learn-Notes/assets/34-2a1b1596.png" alt="34" tabindex="0" loading="lazy"><figcaption>34</figcaption></figure><p>IDEAå¿«é€Ÿåˆ›å»ºå›½é™…åŒ–æ–‡ä»¶ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/35-3a576ffd.png" alt="35" tabindex="0" loading="lazy"><figcaption>35</figcaption></figure><p>å¯ä»¥åˆ‡æ¢è§†å›¾å¿«é€Ÿå¼€å‘å›½é™…åŒ–</p><figure><img src="/Computer-Science-Learn-Notes/assets/36-297b2ed9.png" alt="36" tabindex="0" loading="lazy"><figcaption>36</figcaption></figure><p>ç„¶åå°±å¯ä»¥å¤šä¸ªæ–‡ä»¶å¼€å‘ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/37-4d153fb8.png" alt="37" tabindex="0" loading="lazy"><figcaption>37</figcaption></figure><p>SpringBootä½¿ç”¨MessageSourceAutoConfigurationè‡ªåŠ¨é…ç½®äº†ç®¡ç†å›½é™…åŒ–çš„ç»„ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token class-name">AbstractApplicationContext</span><span class="token punctuation">.</span><span class="token constant">MESSAGE_SOURCE_BEAN_NAME</span><span class="token punctuation">,</span> search <span class="token operator">=</span> <span class="token class-name">SearchStrategy</span><span class="token punctuation">.</span><span class="token constant">CURRENT</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@AutoConfigureOrder</span><span class="token punctuation">(</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token constant">HIGHEST_PRECEDENCE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">ResourceBundleCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageSourceAutoConfiguration</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">MessageSource</span> <span class="token function">messageSource</span><span class="token punctuation">(</span><span class="token class-name">MessageSourceProperties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ResourceBundleMessageSource</span> messageSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceBundleMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getBasename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è®¾ç½®å›½é™…åŒ–èµ„æºåŠå‡ºé—¨ï¼ˆå»æ‰è¯­è¨€å›½å®¶ä»£ç ï¼‰</span>
        messageSource<span class="token punctuation">.</span><span class="token function">setBasenames</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span>
                                   <span class="token punctuation">.</span><span class="token function">commaDelimitedListToStringArray</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">trimAllWhitespace</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getBasename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        messageSource<span class="token punctuation">.</span><span class="token function">setDefaultEncoding</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    messageSource<span class="token punctuation">.</span><span class="token function">setFallbackToSystemLocale</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">isFallbackToSystemLocale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Duration</span> cacheDuration <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getCacheDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cacheDuration <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        messageSource<span class="token punctuation">.</span><span class="token function">setCacheMillis</span><span class="token punctuation">(</span>cacheDuration<span class="token punctuation">.</span><span class="token function">toMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    messageSource<span class="token punctuation">.</span><span class="token function">setAlwaysUseMessageFormat</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">isAlwaysUseMessageFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    messageSource<span class="token punctuation">.</span><span class="token function">setUseCodeAsDefaultMessage</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">isUseCodeAsDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> messageSource<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±æ­¤å¯ä»¥é…ç½®ä¸»é…ç½®æ–‡ä»¶</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.messages.basename</span><span class="token punctuation">=</span><span class="token value attr-value">i18n/login</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨thymeleafå›½é™…åŒ–" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨thymeleafå›½é™…åŒ–" aria-hidden="true">#</a> ä½¿ç”¨thymeleafå›½é™…åŒ–</h3><figure><img src="/Computer-Science-Learn-Notes/assets/38-af1a2bd4.png" alt="38" tabindex="0" loading="lazy"><figcaption>38</figcaption></figure><h3 id="springbootåŒºåŸŸä¿¡æ¯è§£æå™¨" tabindex="-1"><a class="header-anchor" href="#springbootåŒºåŸŸä¿¡æ¯è§£æå™¨" aria-hidden="true">#</a> SpringBootåŒºåŸŸä¿¡æ¯è§£æå™¨</h3><p>åœ¨WebMvcAutoConfigurationä¸­è§£æåŒºåŸŸä¿¡æ¯localeResolver</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.mvc&quot;</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">&quot;locale&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">LocaleResolver</span> <span class="token function">localeResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getLocaleResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">WebMvcProperties<span class="token punctuation">.</span>LocaleResolver</span><span class="token punctuation">.</span><span class="token constant">FIXED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FixedLocaleResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getLocale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">AcceptHeaderLocaleResolver</span> localeResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AcceptHeaderLocaleResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    localeResolver<span class="token punctuation">.</span><span class="token function">setDefaultLocale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getLocale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> localeResolver<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è·å–åŒºåŸŸä¿¡æ¯çš„æ–¹å¼ï¼šé€šè¿‡AcceptHeaderLocaleResolverï¼Œæ ¹æ®è¯·æ±‚å¤´çš„Accept-Languageï¼šzh_CN/ en_USè·å–</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Locale</span> <span class="token function">resolveLocale</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Locale</span> defaultLocale <span class="token operator">=</span> <span class="token function">getDefaultLocale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>defaultLocale <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Accept-Language&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> defaultLocale<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Locale</span> requestLocale <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getLocale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Locale</span><span class="token punctuation">&gt;</span></span> supportedLocales <span class="token operator">=</span> <span class="token function">getSupportedLocales</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>supportedLocales<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> supportedLocales<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>requestLocale<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> requestLocale<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Locale</span> supportedLocale <span class="token operator">=</span> <span class="token function">findSupportedLocale</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> supportedLocales<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>supportedLocale <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> supportedLocale<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>defaultLocale <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> defaultLocale <span class="token operator">:</span> requestLocale<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è‡ªå®šä¹‰å›½é™…åŒ–" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰å›½é™…åŒ–" aria-hidden="true">#</a> è‡ªå®šä¹‰å›½é™…åŒ–</h3><p>å‰ç«¯è®¾ç½®ï¼šthymeleafçš„(xxx)è¡¨ç¤º?xxx</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-sm<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/index(l=&#39;zh_CN&#39;)}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ä¸­æ–‡<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-sm<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/index(l=&#39;en_US&#39;)}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>English<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡ªå®šä¹‰åˆ›å»ºä¸€ä¸ªåˆ¤åˆ«å‰ç«¯ä¼ å…¥çš„å‚æ•°ï¼šè¦å®ç°LocaleResolveræ¥å£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyLocale</span> <span class="token keyword">implements</span> <span class="token class-name">LocaleResolver</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Locale</span> <span class="token function">resolveLocale</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> l <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;l&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Locale</span> locale <span class="token operator">=</span> <span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> s <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;_&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            locale <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Locale</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> locale<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLocale</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è‡ªå®šä¹‰çš„MVCä¸­å®ç°è¿™ä¸ªå›½é™…åŒ–ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">LocaleResolver</span> <span class="token function">localeResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyLocale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ‹¦æˆªå™¨" tabindex="-1"><a class="header-anchor" href="#æ‹¦æˆªå™¨" aria-hidden="true">#</a> æ‹¦æˆªå™¨</h2><p>ä»¥æ‹¦æˆªç™»å½•ä¸ºä¾‹</p><p>é¦–å…ˆæŠŠç™»å½•åæ”¾å…¥åˆ°sessionä¸­ï¼šsession.setAttribute</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user/login&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span>
                    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">,</span>
                    <span class="token class-name">HttpSession</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">.</span><span class="token function">contentEquals</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;redirect:/main&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç”¨æˆ·åå¯†ç é”™è¯¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨å†Œä¸€ä¸ªæ‹¦æˆªå™¨ï¼š<strong>HandlerInterceptor</strong></p><p>å¹¶ä¸”åˆ¤æ–­ï¼Œå¦‚æœç”¨æˆ·åä¸ºç©ºå°±ä¸æ”¾è¡Œï¼Œè½¬å‘åˆ°ç™»å½•é¡µé¢ï¼Œå¹¶æ”¾å…¥æ²¡æœ‰æƒé™çš„ä¿¡æ¯ï¼Œå¦‚æœæˆåŠŸå°±æ”¾è¡Œ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginHandlerInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> username <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            request<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ²¡æœ‰æƒé™è¯·å…ˆç™»å½•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">getRequestDispatcher</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨SpringMVCä¸­æ³¨å†Œè¿™ä¸ªæ‹¦æˆªå™¨ï¼Œå¹¶<strong>æ‹¦æˆªå“åº”çš„è®¿é—®åœ°å€</strong>ï¼š</p><p>è¿™é‡Œæ‹¦æˆªäº†æ‰€æœ‰çš„åœ°å€ï¼šé™¤äº†/index / /user/loginè¿™ä¸‰ä¸ªåœ°å€</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoginHandlerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/index&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/user/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ºäº†é˜²æ­¢SpringBootæ‹¦æˆªé™æ€èµ„æºå¯ä»¥åŠ å…¥<strong>addResourceHandlers</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span><span class="token class-name">ResourceHandlerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/static/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é”™è¯¯å¤„ç†åŸç†" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯å¤„ç†åŸç†" aria-hidden="true">#</a> é”™è¯¯å¤„ç†åŸç†</h2><p>å¦‚æœè®¿é—®äº†æ²¡æœ‰çš„è·¯å¾„ç½‘é¡µä¼šï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/39-25808dd1.png" alt="39" tabindex="0" loading="lazy"><figcaption>39</figcaption></figure><p>å…¶ä»–å®¢æˆ·ç«¯ä¼šå‘é€jsonæ•°æ®ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2020-07-18T17:08:27.106+00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">,</span>
    <span class="token string">&quot;error&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Not Found&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;No message available&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/aaa&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é”™è¯¯å¤„ç†çš„è‡ªåŠ¨é…ç½®ï¼šErrorMvcAutoConfiguration</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnWebApplication</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token constant">SERVLET</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">DispatcherServlet</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Load before the main WebMvcAutoConfiguration so that the error View is available</span>
<span class="token annotation punctuation">@AutoConfigureBefore</span><span class="token punctuation">(</span><span class="token class-name">WebMvcAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">ServerProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">ResourceProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">WebMvcProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ErrorMvcAutoConfiguration</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç±»ç»™å®¹å™¨æ·»åŠ äº†ä»¥ä¸‹ç»„ä»¶ï¼š</p><ul><li>DefaultErrorAttributes</li><li>BasicErrorController</li><li>ErrorPageCustomizer</li><li>DefaultErrorViewResolver</li></ul><p>é¦–å…ˆçœ‹<strong>ErrorPageCustomizer</strong>ï¼šçœ‹registerErrorPages -- getRelativePath</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ErrorPageCustomizer</span> <span class="token keyword">implements</span> <span class="token class-name">ErrorPageRegistrar</span><span class="token punctuation">,</span> <span class="token class-name">Ordered</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerErrorPages</span><span class="token punctuation">(</span><span class="token class-name">ErrorPageRegistry</span> errorPageRegistry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ErrorPage</span> errorPage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ErrorPage</span><span class="token punctuation">(</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dispatcherServletPath<span class="token punctuation">.</span><span class="token function">getRelativePath</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorPageRegistry<span class="token punctuation">.</span><span class="token function">addErrorPages</span><span class="token punctuation">(</span>errorPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªgetPathçš„è·³è½¬ä½ç½®ï¼šå¯çŸ¥ -- ç³»ç»Ÿå‡ºç°é”™è¯¯ï¼Œæ¥åˆ°errorè¯·æ±‚è¿›è¡Œå¤„ç†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${error.path:/error}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token string">&quot;/error&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>BasicErrorController</strong>ï¼šå¤„ç†é»˜è®¤/errorè¯·æ±‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;${server.error.path:${error.path:/error}}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BasicErrorController</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractErrorController</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼šï¼ˆè¿™é‡Œå°±å¯ä»¥è§£é‡Šå¼€å¤´çš„ç°è±¡ï¼‰ï¼Œé€šè¿‡RequestHeader - <strong>acceptåˆ¤æ–­</strong></p><p>äº§ç”ŸHTMLç±»å‹çš„æ•°æ®</p><figure><img src="/Computer-Science-Learn-Notes/assets/40-3cbbf1d9.png" alt="40" tabindex="0" loading="lazy"><figcaption>40</figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>produces <span class="token operator">=</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">TEXT_HTML_VALUE</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">errorHtml</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">HttpStatus</span> status <span class="token operator">=</span> <span class="token function">getStatus</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> model <span class="token operator">=</span> <span class="token class-name">Collections</span>
        <span class="token punctuation">.</span><span class="token function">unmodifiableMap</span><span class="token punctuation">(</span><span class="token function">getErrorAttributes</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token function">getErrorAttributeOptions</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">TEXT_HTML</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å»å“ªä¸ªé¡µé¢ä½œä¸ºé”™è¯¯é¡µé¢ï¼ŒåŒ…å«é¡µé¢åœ°å€å’Œé¡µé¢å†…å®¹</span>
    <span class="token class-name">ModelAndView</span> modelAndView <span class="token operator">=</span> <span class="token function">resolveErrorView</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> status<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>modelAndView <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> modelAndView <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>äº§ç”ŸJSONæ•°æ®</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgEAAAAeCAYAAAC1+c0GAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAS6SURBVHhe7d05SyRBGMbx/TiKIiIGYm5uZGZiIugHMDAyMDIWE8FMUDDwNhE0MBBF0Mg7EQQv8ABvrOVprdmaskene6bcxv4P/LDnrep2d2vo9+l2xv3z/Pxs/rfz8/PYOgAgv+gN4RECAACZRG8IjxAAAMgkekN4hAAAQCbRG8IjBAAAMoneEF6qEHB2dmZOT0+jBUpC+2hf/3ga82sAgHyjN4SXOASoiU9OTpqWlhZTU1OTiPbRvn4QYKEBAD56Q3iJQ4Cu5tMEAEv76hjuMVloAICP3hBe4hCgRYlr7kn4C/ubF/rx8dHs7u6aqakps7y8HNG2ahqL2wcAQAj4CcFDQF1dnenv7zetra2FWtoQcHd3ZwYGBsz09HTseNbc3t6a2dlZs729be7v7wt1baumMc1x9wEAvCu3N2xsbJjh4eHYMfULt2d8NTePgoaA+vp6s7KyYvQ4Pj4u1NOGgIODAzM0NBQtoAJB3JwsWVhYMFdXV7FjorH5+fnYMQDIuyQhIO7iUH1CPUO9w9ZKzc2rYCGgoaHBrK2tRQFAj9XV1cJY2hCghdMCjo2NFS3qT5mYmDAXFxexYz79+fb29opqm5ubEbemOf/j7wIAWfddb9AFYXt7exHdLbYXifbCUc+/m5tXQUJAY2OjWV9f/2j/7wFAocCOpwkBar5aMH2NS3LuAtuFFW3bur0FpBdGZ2dnVNNX24T1VXPcfez3cY/f29tb+L6lLC0tmYeHh6KaPhXhfzJCczTXrQEAyusNttGLeoM7pvO2W/tqbl5VFAJGRkbM0dGRaWtrK9SamprM1tbWR/s3ZnFxMXpfgB2XNCFAC2abuBsI9FyN2o65VPPDgr+v+1wvkJ6enkIoUE0NX9/bJkm733f82/yHh4fRmwJPTk6K6sKPBADgs+96g73Q0zk67vztnuu/mptnFYWA6+vrqNFfXl5GQaC5udns7OxENT1mZmZMbW1tUQCQNCFADdheiVu2OSvV+YvpvwAs7eMfx94NEB1Lx7TzFSIkaQjQ+wH8moKA+PW4uQCQd+X0hlJ0ro+7OESxikJAd3e3eX19jRq+bmurQdrH+Ph4bACQpCFAx9Vius3ZLnCaEFDqhVHNEKBb/P5HAONCgObw4wAA+KySEKDztc73cWP4p+L3BCgIvLy8fLT+98fo6GjRHF/SEGAbsVtzm7zG4hq7anH72Vv8bl0UAnRXwI65c0uFjVI0b39/v/BczV+3/cUNAppT7jEBIE/ShgC3P8SN45+qvDGwq6srCgJvb29mcHDw07gvaQgo1XzdJq9te3tfi6+mLdq2dRsUbLP356uu7b6+vsKYGyK0rVo5bwx8enqKGn45HxHU3LhxAMiztCHgqzu+KFaVECAdHR1RGIgb8yUNAT9FIcD/cUAlbm5uzNzcXMlfFqQxzXH3AQC8y0pv+M2qFgKSyEsIEH5tMACkQwgIL3EI+M3/gVCIEAAASIcQEF7iEMB/JQwA+An0hvAShwBRE9fVvBYoCe3jBwDRmF8DAOQbvSG8VCGg2lhoAICP3hAeIQAAkEn0hvAIAQCATKI3hEcIAABkEr0hPEIAACCT6A3hEQIAAJlEbwjvj/6RAQBA3pybv+kdgd7LlnaBAAAAAElFTkSuQmCC" alt="41" tabindex="0" loading="lazy"><figcaption>41</figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">HttpStatus</span> status <span class="token operator">=</span> <span class="token function">getStatus</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">NO_CONTENT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> body <span class="token operator">=</span> <span class="token function">getErrorAttributes</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token function">getErrorAttributeOptions</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å“åº”é”™è¯¯é¡µé¢çš„è§£æä»£ç ï¼šerrorHtml -- resolveErrorView(request, response, status, model);</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">ModelAndView</span> <span class="token function">resolveErrorView</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span> status<span class="token punctuation">,</span>
                                        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ErrorViewResolver</span> resolver <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>errorViewResolvers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ModelAndView</span> modelAndView <span class="token operator">=</span> resolver<span class="token punctuation">.</span><span class="token function">resolveErrorView</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> status<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>modelAndView <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> modelAndView<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åçœ‹DefaultErrorViewResolverï¼Œå®ƒé¦–å…ˆå£°æ˜äº†<em>SERIES_VIEWS</em>ï¼Œç”¨äºåˆ¤æ–­çŠ¶æ€ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Series</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token constant">SERIES_VIEWS</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Series</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> views <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EnumMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Series</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    views<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Series</span><span class="token punctuation">.</span><span class="token constant">CLIENT_ERROR</span><span class="token punctuation">,</span> <span class="token string">&quot;4xx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    views<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Series</span><span class="token punctuation">.</span><span class="token constant">SERVER_ERROR</span><span class="token punctuation">,</span> <span class="token string">&quot;5xx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token constant">SERIES_VIEWS</span> <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">unmodifiableMap</span><span class="token punctuation">(</span>views<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨é‡Šè§£é‡Šä¸¤ä¸ªæ–¹æ³•ï¼šSpringBootæ˜¯å¦‚ä½•æ‰¾é”™è¯¯é¡µé¢çš„</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">resolveErrorView</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span> status<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ModelAndView</span> modelAndView <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>modelAndView <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">SERIES_VIEWS</span><span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modelAndView <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token constant">SERIES_VIEWS</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> modelAndView<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">private</span> <span class="token class-name">ModelAndView</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token class-name">String</span> viewName<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// é»˜è®¤Springbootå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªé¡µé¢ error/404</span>
    <span class="token class-name">String</span> errorViewName <span class="token operator">=</span> <span class="token string">&quot;error/&quot;</span> <span class="token operator">+</span> viewName<span class="token punctuation">;</span>
    <span class="token comment">// æ¨¡æ¿å¼•æ“å¯ä»¥è§£æè¿™ä¸ªé¡µé¢åœ°å€å°±ç”¨æ¨¡æ¿å¼•æ“è§£æ</span>
    <span class="token class-name">TemplateAvailabilityProvider</span> provider <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>templateAvailabilityProviders<span class="token punctuation">.</span><span class="token function">getProvider</span><span class="token punctuation">(</span>errorViewName<span class="token punctuation">,</span>
                                                                                           <span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>provider <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ¨¡æ¿å¼•æ“å¯ç”¨çš„æƒ…å†µä¸‹è¿”å›errorviewnameæŒ‡å®šçš„åœ°å€</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span>errorViewName<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// æ¨¡æ¿å¼•æ“ä¸å¯ç”¨æ—¶ï¼Œå°±åœ¨é™æ€èµ„æºæ–‡ä»¶ä¸‹æ‰¾errorViewNameé¡µé¢ /error/404.html</span>
    <span class="token keyword">return</span> <span class="token function">resolveResource</span><span class="token punctuation">(</span>errorViewName<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®šåˆ¶é”™è¯¯é¡µé¢å’Œjsoné”™è¯¯æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å®šåˆ¶é”™è¯¯é¡µé¢å’Œjsoné”™è¯¯æ•°æ®" aria-hidden="true">#</a> å®šåˆ¶é”™è¯¯é¡µé¢å’ŒJSONé”™è¯¯æ•°æ®</h2><p>å®šåˆ¶é”™è¯¯é¡µé¢ ç›´æ¥æŠŠæ–‡ä»¶æ”¾åˆ°erroræ–‡ä»¶å¤¹ä¸‹ï¼Œåå­—ä¸º4xxï¼Œ5xxå³å¯</p><figure><img src="/Computer-Science-Learn-Notes/assets/42-21a18bf7.png" alt="42" tabindex="0" loading="lazy"><figcaption>42</figcaption></figure><p>å½“å‘ç”Ÿé”™è¯¯é¡µé¢çš„æ—¶å€™å¯ä»¥è·å–é”™è¯¯é¡µé¢çš„ä¿¡æ¯ï¼ˆæœ‰æ¨¡æ¿å¼•æ“æƒ…å†µä¸‹ï¼‰ï¼š timestamp æ—¶é—´æˆ³ status çŠ¶æ€ç  error é”™è¯¯ä¿¡æ¯ exception å¼‚å¸¸å¯¹è±¡ message å¼‚å¸¸æ¶ˆæ¯ errors JSR303 æ•°æ®æ ¡éªŒçš„é”™è¯¯</p><figure><img src="/Computer-Science-Learn-Notes/assets/43-f5b8b4bd.png" alt="43" tabindex="0" loading="lazy"><figcaption>43</figcaption></figure><h3 id="å®šåˆ¶ä¸€ä¸ªjsonæ•°æ®" tabindex="-1"><a class="header-anchor" href="#å®šåˆ¶ä¸€ä¸ªjsonæ•°æ®" aria-hidden="true">#</a> å®šåˆ¶ä¸€ä¸ªJSONæ•°æ®</h3><p>è¿™ä¸ªé”™è¯¯å¤„ç†å±äºControllerï¼š</p><ul><li><p><strong>@ControllerAdvice</strong> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„@Componentï¼Œç”¨äºæ ‡è¯†ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»ä¸­è¢«ä»¥ä¸‹ä¸‰ç§æ³¨è§£æ ‡è¯†çš„æ–¹æ³•ï¼š@ExceptionHandlerï¼Œ@InitBinderï¼Œ@ModelAttributeï¼Œå°†ä½œç”¨äºæ‰€æœ‰çš„@Controllerç±»çš„æ¥å£ä¸Š</p></li><li><p>@ResponseBody</p></li><li><p><strong>@ExceptionHandler</strong> (é”™è¯¯ç±».class) ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šè¦å¤„ç†çš„å¼‚å¸¸ç±»å‹</p></li></ul><p>ç¬¬ä¸€ç§å†™æ³•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyExceptionHandler</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">UserNotException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">handlerException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.notexist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬¬äºŒç§ï¼šæ³¨æ„ä½¿ç”¨requestå®šåˆ¶çŠ¶æ€ç setAttribute(&quot;javax.servlet.error.status_code&quot;, 500);</p><p>è®¾ç½®ä»¥åSpringBootè‡ªé€‚åº”å°±ä¼šè¿›å…¥é”™è¯¯é¡µé¢ï¼šï¼ˆresource/error/500ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">UserNotException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">handlerException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä¼ å…¥é”™è¯¯çŠ¶æ€ç </span>
    req<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;javax.servlet.error.status_code&quot;</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.notexist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;forward:/error&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**ã€æ¨èã€‘**ç¬¬ä¸‰ç§ï¼šå“åº”æ˜¯è‡ªé€‚åº”çš„ï¼Œé€šè¿‡ErrorAttributesæ”¹å˜éœ€è¦è¿”å›çš„å†…å®¹</p><p>é¦–å…ˆå®šåˆ¶ä¸€ä¸ªé”™è¯¯æ§åˆ¶ï¼šå®šä¹‰çŠ¶æ€ç ã€é”™è¯¯ä¿¡æ¯ç­‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyExceptionHandler</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">UserNotException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">handlerException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¼ å…¥é”™è¯¯çŠ¶æ€ç </span>
        req<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;javax.servlet.error.status_code&quot;</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.notexist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//        map.put(&quot;message&quot;, e.getMessage());</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç”¨æˆ·ä¸å­˜åœ¨å•¦!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        req<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;ext&quot;</span><span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;forward:/error&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶ååˆ›å»ºä¸€ä¸ªé”™è¯¯æ•°æ®ä¼ è¾“ä¸­é—´ï¼Œè¿™ä¸ªç±»çš„åŠŸèƒ½å°±æ˜¯æŠŠè‡ªå®šä¹‰çš„é”™è¯¯é¡µé¢çš„æ•°æ®ä¼ ç»™SpringBootï¼Œç„¶åå“åº”åˆ°è‡ªé€‚åº”é¡µé¢ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyErrorAttributes</span> <span class="token keyword">extends</span> <span class="token class-name">DefaultErrorAttributes</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">getErrorAttributes</span><span class="token punctuation">(</span><span class="token class-name">WebRequest</span> webRequest<span class="token punctuation">,</span> <span class="token class-name">ErrorAttributeOptions</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>webRequest<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;ext&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³äºç¬¬äºŒä¸ªå‚æ•°scopeæ˜¯æ€ä¹ˆå®šä¹‰çš„ï¼š</p><p>0 - request</p><p>1 - session</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">RequestAttributes</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * Constant that indicates request scope.
     */</span>
    <span class="token keyword">int</span> <span class="token constant">SCOPE_REQUEST</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * Constant that indicates session scope.
     * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>This preferably refers to a locally isolated session, if such
     * a distinction is available.
     * Else, it simply refers to the common session.
     */</span>
    <span class="token keyword">int</span> <span class="token constant">SCOPE_SESSION</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/44-1d377587.png" alt="44" tabindex="0" loading="lazy"><figcaption>44</figcaption></figure><h2 id="åµŒå…¥å¼servlet" tabindex="-1"><a class="header-anchor" href="#åµŒå…¥å¼servlet" aria-hidden="true">#</a> åµŒå…¥å¼Servlet</h2><h3 id="springä¸¤ç§é…ç½®æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#springä¸¤ç§é…ç½®æ–¹å¼" aria-hidden="true">#</a> Springä¸¤ç§é…ç½®æ–¹å¼ï¼š</h3><ul><li>xxxConfigureræ‰©å±•é…ç½®</li><li>xxxCustomizerå®šåˆ¶é…ç½®</li></ul><h3 id="åµŒå…¥å¼servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®" tabindex="-1"><a class="header-anchor" href="#åµŒå…¥å¼servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®" aria-hidden="true">#</a> åµŒå…¥å¼Servletä¸¤ç§ä¿®æ”¹ç›¸å…³é…ç½®</h3><ol><li>é…ç½®æ–‡ä»¶</li></ol><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">8083</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>åœ¨åµŒå…¥å¼Servletä¸­ä¿®æ”¹ï¼šåœ¨è‡ªå®šä¹‰çš„SpringMVCé…ç½®</li></ol><p>æ³¨ï¼šSpringBoot2 ä½¿ç”¨çš„æ˜¯<strong>WebServerFactoryCustomizer</strong><code>&lt;ConfigurableWebServerFactory&gt;</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">WebServerFactoryCustomizer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigurableWebServerFactory</span><span class="token punctuation">&gt;</span></span> <span class="token function">webServerFactoryCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WebServerFactoryCustomizer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigurableWebServerFactory</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//            åµŒå…¥å¼servletå®¹å™¨ç›¸å…³çš„é…ç½®</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customize</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableWebServerFactory</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                factory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">8083</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨å†Œä¸‰å¤§ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#æ³¨å†Œä¸‰å¤§ç»„ä»¶" aria-hidden="true">#</a> æ³¨å†Œä¸‰å¤§ç»„ä»¶</h3><ul><li>Filter</li><li>Servlet</li><li>Linstener</li></ul><h4 id="å®šåˆ¶servlet" tabindex="-1"><a class="header-anchor" href="#å®šåˆ¶servlet" aria-hidden="true">#</a> å®šåˆ¶Servlet</h4><hr><p>åˆ›å»ºä¸€ä¸ªServletï¼Œç»§æ‰¿<strong>HttpServlet</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token function">doPost</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Hello MyServlet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„é…ç½®ç±»ï¼ŒæŠŠè¿™ä¸ªServletåŠ å…¥åˆ°å®¹å™¨ä¸­ï¼ˆ<strong>ServletRegistrationBean</strong>ã€@Beanï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServerConfig</span> <span class="token punctuation">{</span>
<span class="token comment">//    æ³¨å†Œä¸‰å¤§ç»„ä»¶</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServletRegistrationBean</span> <span class="token function">myServelet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServletRegistrationBean</span> registrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletRegistrationBean</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;/myservlet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> registrationBean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®šåˆ¶filter" tabindex="-1"><a class="header-anchor" href="#å®šåˆ¶filter" aria-hidden="true">#</a> å®šåˆ¶Filter</h4><hr><p>å…ˆåˆ›å»ºä¸€ä¸ªè‡ªå·±çš„Filterï¼Œç»§æ‰¿<strong>HttpFilter</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyFilter</span> <span class="token keyword">extends</span> <span class="token class-name">HttpFilter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">MyFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MyFilter process....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> chain<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ ·æ˜¯åœ¨é…ç½®ç±»å†…æ³¨å†Œï¼Œ<strong>FilterRegistrationBean</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServerConfig</span> <span class="token punctuation">{</span>
<span class="token comment">//    æ³¨å†Œä¸‰å¤§ç»„ä»¶</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span> <span class="token function">myFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FilterRegistrationBean</span> filterRegistrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filterRegistrationBean<span class="token punctuation">.</span><span class="token function">setFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filterRegistrationBean<span class="token punctuation">.</span><span class="token function">setUrlPatterns</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> filterRegistrationBean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®šåˆ¶listener" tabindex="-1"><a class="header-anchor" href="#å®šåˆ¶listener" aria-hidden="true">#</a> å®šåˆ¶Listener</h4><hr><p>æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œå®ç°æ¥å£<strong>ServletContextListener</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletContextListener</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> sce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;webåº”ç”¨å¯åŠ¨!!!!!!!!!!!!!!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextDestroyed</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> sce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;webé”€æ¯!!!!!!!!!!!!!!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŠŠç›‘å¬å™¨æ³¨å†Œåˆ°é…ç½®ç±»ä¸­ï¼Œå¹¶æ”¾å…¥å®¹å™¨<strong>ServletListenerRegistrationBean</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServerConfig</span> <span class="token punctuation">{</span>
<span class="token comment">//    æ³¨å†Œä¸‰å¤§ç»„ä»¶</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServletListenerRegistrationBean</span> <span class="token function">myListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServletListenerRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyListener</span><span class="token punctuation">&gt;</span></span> listener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletListenerRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> listener<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨å…¶ä»–çš„åµŒå…¥å¼å®¹å™¨</p><ul><li>Jettyï¼ˆé•¿è¿æ¥ï¼‰</li><li>Undertowï¼ˆä¸æ”¯æŒJSPï¼‰</li><li>Tomcatï¼ˆé»˜è®¤ï¼‰</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/45-2dd40e3a.png" alt="45" tabindex="0" loading="lazy"><figcaption>45</figcaption></figure><p>åˆ‡æ¢å®¹å™¨çš„æ–¹å¼ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/46-75c16a3c.png" alt="46" tabindex="0" loading="lazy"><figcaption>46</figcaption></figure><h2 id="æºç åˆ¨æ-åµŒå…¥å¼servletåŸç†" tabindex="-1"><a class="header-anchor" href="#æºç åˆ¨æ-åµŒå…¥å¼servletåŸç†" aria-hidden="true">#</a> æºç åˆ¨æ åµŒå…¥å¼ServletåŸç†</h2><p>WebServerFactoryCustomizeråµŒå…¥å¼Servletçš„è‡ªåŠ¨é…ç½®ç±»ï¼š<strong>ServletWebServerFactoryAutoConfiguration</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@AutoConfigureOrder</span><span class="token punctuation">(</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token constant">HIGHEST_PRECEDENCE</span><span class="token punctuation">)</span>
<span class="token comment">// ä»…åœ¨ç±» ServletRequest å­˜åœ¨äº classpath ä¸Šæ—¶æ‰ç”Ÿæ•ˆ</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token comment">// ä»…åœ¨å½“å‰åº”ç”¨æ˜¯ Servlet Web åº”ç”¨æ—¶æ‰ç”Ÿæ•ˆ</span>
<span class="token annotation punctuation">@ConditionalOnWebApplication</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token constant">SERVLET</span><span class="token punctuation">)</span>
<span class="token comment">// ç¡®ä¿å‰ç¼€ä¸º server çš„é…ç½®å‚æ•°åŠ è½½åˆ° bean ServerProperties</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">ServerProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token comment">// 1. å¯¼å…¥ ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar ä»¥æ³¨å†Œ</span>
<span class="token comment">// BeanPostProcessor : WebServerFactoryCustomizerBeanPostProcessor å’Œ </span>
<span class="token comment">// ErrorPageRegistrarBeanPostProcessor</span>
<span class="token comment">// 2. å¯¼å…¥ EmbeddedTomcat/EmbeddedJetty/EmbeddedUndertow è¿™ä¸‰ä¸ªå±äº</span>
<span class="token comment">// ServletWebServerFactoryConfiguration çš„åµŒå¥—é…ç½®ç±»ï¼Œè¿™ä¸‰ä¸ªé…ç½®ç±»ä¼šåˆ†åˆ«æ£€æµ‹</span>
<span class="token comment">// classpathä¸Šå­˜åœ¨çš„ç±»ï¼Œä»è€Œåˆ¤æ–­å½“å‰åº”ç”¨ä½¿ç”¨çš„æ˜¯ Tomcat/Jetty/Undertow,</span>
<span class="token comment">// ä»è€Œå†³å®šå®šä¹‰å“ªä¸€ä¸ª Servlet WebæœåŠ¡å™¨çš„å·¥å‚ bean :</span>
<span class="token comment">// TomcatServletWebServerFactory/JettyServletWebServerFactory/UndertowServletWebServerFactory</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">ServletWebServerFactoryAutoConfiguration<span class="token punctuation">.</span>BeanPostProcessorsRegistrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name">ServletWebServerFactoryConfiguration<span class="token punctuation">.</span>EmbeddedTomcat</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name">ServletWebServerFactoryConfiguration<span class="token punctuation">.</span>EmbeddedJetty</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name">ServletWebServerFactoryConfiguration<span class="token punctuation">.</span>EmbeddedUndertow</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletWebServerFactoryAutoConfiguration</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é’ˆå¯¹å½“å‰Servletå®¹å™¨æ˜¯Tomcatæ—¶å®šä¹‰è¯¥ beanï¼Œç”¨äºå®šåˆ¶åŒ– TomcatServletWebServerFactory</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token comment">// ä»…åœ¨ç±» org.apache.catalina.startup.Tomcat å­˜åœ¨äº classpath ä¸Šæ—¶æ‰ç”Ÿæ•ˆ</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;org.apache.catalina.startup.Tomcat&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">TomcatServletWebServerFactoryCustomizer</span> <span class="token function">tomcatServletWebServerFactoryCustomizer</span><span class="token punctuation">(</span>
    <span class="token class-name">ServerProperties</span> serverProperties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TomcatServletWebServerFactoryCustomizer</span><span class="token punctuation">(</span>serverProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ServletWebServerFactoryConfigurationæ˜¯ä¸€ä¸ªé’ˆå¯¹ServletWebServerFactoryè¿›è¡Œé…ç½®çš„é…ç½®ç±»ã€‚å®ƒé€šè¿‡æ£€æµ‹åº”ç”¨classpathå­˜åœ¨çš„ç±»ï¼Œä»è€Œåˆ¤æ–­å½“å‰åº”ç”¨è¦ä½¿ç”¨å“ªä¸ªServletå®¹å™¨:Tomcat,Jettyè¿˜æ˜¯Undertowã€‚æ£€æµ‹å‡ºæ¥ä¹‹åï¼Œå®šä¹‰ç›¸åº”çš„Servlet WebæœåŠ¡å™¨å·¥å‚ç»„ä»¶bean</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">ServletWebServerFactoryConfiguration</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Tomcat</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">UpgradeProtocol</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ServletWebServerFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> search <span class="token operator">=</span> <span class="token class-name">SearchStrategy</span><span class="token punctuation">.</span><span class="token constant">CURRENT</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EmbeddedTomcat</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>   
        
        <span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Server</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Loader</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">WebAppContext</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ServletWebServerFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> search <span class="token operator">=</span> <span class="token class-name">SearchStrategy</span><span class="token punctuation">.</span><span class="token constant">CURRENT</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EmbeddedJetty</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
        
        <span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Undertow</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SslClientAuthMode</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ServletWebServerFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> search <span class="token operator">=</span> <span class="token class-name">SearchStrategy</span><span class="token punctuation">.</span><span class="token constant">CURRENT</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EmbeddedUndertow</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‰ä¸ªå®ç°ç±»éƒ½ç»§æ‰¿è‡ªæŠ½è±¡åŸºç±»AbstractServletWebServerFactoryï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/47-811f4c27.png" alt="47" tabindex="0" loading="lazy"><figcaption>47</figcaption></figure><h4 id="ä»¥tomcatä¸ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»¥tomcatä¸ºä¾‹" aria-hidden="true">#</a> ä»¥Tomcatä¸ºä¾‹</h4><p>è¿›å…¥TomcatServletWebServerFactoryï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œé…ç½®TomcatåŸºæœ¬ç¯å¢ƒï¼Œè¿”å›ä¸€ä¸ªåµŒå…¥å¼Servletå®¹å™¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">WebServer</span> <span class="token function">getWebServer</span><span class="token punctuation">(</span><span class="token class-name">ServletContextInitializer</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> initializers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>disableMBeanRegistry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Registry</span><span class="token punctuation">.</span><span class="token function">disableRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Tomcat</span> tomcat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tomcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">File</span> baseDir <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseDirectory <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseDirectory <span class="token operator">:</span> <span class="token function">createTempDir</span><span class="token punctuation">(</span><span class="token string">&quot;tomcat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tomcat<span class="token punctuation">.</span><span class="token function">setBaseDir</span><span class="token punctuation">(</span>baseDir<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Connector</span> connector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Connector</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>protocol<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connector<span class="token punctuation">.</span><span class="token function">setThrowOnFailure</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tomcat<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addConnector</span><span class="token punctuation">(</span>connector<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">customizeConnector</span><span class="token punctuation">(</span>connector<span class="token punctuation">)</span><span class="token punctuation">;</span>
    tomcat<span class="token punctuation">.</span><span class="token function">setConnector</span><span class="token punctuation">(</span>connector<span class="token punctuation">)</span><span class="token punctuation">;</span>
    tomcat<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAutoDeploy</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">configureEngine</span><span class="token punctuation">(</span>tomcat<span class="token punctuation">.</span><span class="token function">getEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Connector</span> additionalConnector <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>additionalTomcatConnectors<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tomcat<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addConnector</span><span class="token punctuation">(</span>additionalConnector<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">prepareContext</span><span class="token punctuation">(</span>tomcat<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> initializers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">getTomcatWebServer</span><span class="token punctuation">(</span>tomcat<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹æœ€åè¿”å›çš„getTomcatWebServerï¼Œåªè¦ç«¯å£å·å¤§äºç­‰äº0å°±è‡ªåŠ¨å¯åŠ¨</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">TomcatWebServer</span> <span class="token function">getTomcatWebServer</span><span class="token punctuation">(</span><span class="token class-name">Tomcat</span> tomcat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TomcatWebServer</span><span class="token punctuation">(</span>tomcat<span class="token punctuation">,</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">getShutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿›å…¥TomcatWebServerçš„initializeæ–¹æ³•å°±å¯ä»¥çœ‹åˆ°å¯åŠ¨å®¹å™¨</p><figure><img src="/Computer-Science-Learn-Notes/assets/48-5c11279b.png" alt="48" tabindex="0" loading="lazy"><figcaption>48</figcaption></figure><h3 id="é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†" tabindex="-1"><a class="header-anchor" href="#é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†" aria-hidden="true">#</a> é…ç½®æ˜¯å¦‚ä½•ä¿®æ”¹åŸç†</h3><p>çœ‹ServletWebServerFactoryAutoConfigurationä¸­ï¼Œåœ¨è‡ªåŠ¨é…ç½®ä¹‹å‰å…ˆå¯¼å…¥äº†BeanPostProcessorsRegistrarï¼ˆåç½®å¤„ç†å™¨ï¼ŒBeanåˆå§‹åŒ–å‰åï¼Œåˆ›å»ºå®Œå¯¹è±¡æ²¡æœ‰èµ‹å€¼çš„é™¤å››å®³å·¥ä½œï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">ServletWebServerFactoryAutoConfiguration<span class="token punctuation">.</span>BeanPostProcessorsRegistrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">BeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>beanFactory <span class="token keyword">instanceof</span> <span class="token class-name">ConfigurableListableBeanFactory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanFactory <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ConfigurableListableBeanFactory</span><span class="token punctuation">)</span> beanFactory<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è§‚å¯Ÿä¸‹é¢çš„ï¼šregisterBeanDefinitionsæ–¹æ³•ä¸­WebServerFactoryCustomizerBeanPostProcessorï¼Œ</p><p>åˆå§‹ä¹‹å‰ï¼Œå¦‚æœå½“å‰åˆå§‹åŒ–çš„ä¸€ä¸ªWebServerFactoryå°±è°ƒç”¨postProcessBeforeInitialization</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessBeforeInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">WebServerFactory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">postProcessBeforeInitialization</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">WebServerFactory</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è·å–æ‰€æœ‰çš„å®šåˆ¶å…¶ï¼Œè°ƒç”¨æ¯ä¸€ä¸ªå®šåˆ¶å…¶çš„customizeæ–¹æ³•æ¥ç»™servletå®¹å™¨èµ‹å€¼ï¼ˆç«¯å£...ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">postProcessBeforeInitialization</span><span class="token punctuation">(</span><span class="token class-name">WebServerFactory</span> webServerFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaSafe</span><span class="token punctuation">.</span><span class="token function">callbacks</span><span class="token punctuation">(</span><span class="token class-name">WebServerFactoryCustomizer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token function">getCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> webServerFactory<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withLogger</span><span class="token punctuation">(</span><span class="token class-name">WebServerFactoryCustomizerBeanPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span>customizer<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> customizer<span class="token punctuation">.</span><span class="token function">customize</span><span class="token punctuation">(</span>webServerFactory<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†çœ‹WebServerFactoryCustomizerBeanPostProcessorä¸­çš„Collectionï¼Œè¿™ä¸ªä»å®¹å™¨ä¸­è·å–è¿™ä¸ªç±»å‹çš„ç»„ä»¶ã€‚å®šåˆ¶servletå®¹å™¨ç»„ä»¶</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebServerFactoryCustomizer</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>customizers <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Look up does not include the parent context</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>customizers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token function">getWebServerFactoryCustomizerBeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>customizers<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token class-name">AnnotationAwareOrderComparator</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>customizers <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">unmodifiableList</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>customizers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>customizers<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-2" tabindex="-1"><a class="header-anchor" href="#å°ç»“-2" aria-hidden="true">#</a> å°ç»“ï¼š</h3><ol><li>æ ¹æ®å¯¼å…¥æƒ…å†µï¼Œæ·»åŠ ç›¸åº”çš„å®¹å™¨å·¥å‚ï¼š</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">ServletWebServerFactoryAutoConfiguration<span class="token punctuation">.</span>BeanPostProcessorsRegistrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name">ServletWebServerFactoryConfiguration<span class="token punctuation">.</span>EmbeddedTomcat</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name">ServletWebServerFactoryConfiguration<span class="token punctuation">.</span>EmbeddedJetty</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name">ServletWebServerFactoryConfiguration<span class="token punctuation">.</span>EmbeddedUndertow</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>å®¹å™¨ä¸­æŸä¸ªç»„ä»¶åˆ›å»ºå°±ä¼šè§¦å‘<strong>åç½®å¤„ç†å™¨ï¼ˆBeanPostProcessorsRegistrarï¼‰</strong></li></ol><p>åªè¦æ˜¯ConfigurableListableBeanFactoryå°±å·¥ä½œï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>beanFactory <span class="token keyword">instanceof</span> <span class="token class-name">ConfigurableListableBeanFactory</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>è¿™ä¸ªåç½®å¤„ç†å™¨ä»å®¹å™¨ä¸­<strong>è·å–æ‰€æœ‰çš„å®šåˆ¶å™¨ï¼Œç„¶åå®šåˆ¶å±æ€§ï¼ˆç«¯å£..ï¼‰</strong></li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebServerFactoryCustomizer</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>customizers <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Look up does not include the parent context</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>customizers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token function">getWebServerFactoryCustomizerBeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>customizers<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token class-name">AnnotationAwareOrderComparator</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>customizers <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">unmodifiableList</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>customizers<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>customizers<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åµŒå…¥å¼servletè‡ªåŠ¨é…ç½®åŸç†" tabindex="-1"><a class="header-anchor" href="#åµŒå…¥å¼servletè‡ªåŠ¨é…ç½®åŸç†" aria-hidden="true">#</a> åµŒå…¥å¼Servletè‡ªåŠ¨é…ç½®åŸç†</h2><p>æ–­ç‚¹å£°æ˜ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/49-2601b60d.png" alt="49" tabindex="0" loading="lazy"><figcaption>49</figcaption></figure><p>é¦–å…ˆå¯åŠ¨SpringBoot</p><figure><img src="/Computer-Science-Learn-Notes/assets/50-f34020f0.png" alt="50" tabindex="0" loading="lazy"><figcaption>50</figcaption></figure><p>ç„¶åè°ƒç”¨runæ–¹æ³•ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/51-7f30db67.png" alt="51" tabindex="0" loading="lazy"><figcaption>51</figcaption></figure><p>åˆ›å»ºå’Œåˆ·æ–°å®¹å™¨</p><figure><img src="/Computer-Science-Learn-Notes/assets/52-0c645e62.png" alt="52" tabindex="0" loading="lazy"><figcaption>52</figcaption></figure><p>æŸ¥çœ‹æ˜¯å¦‚ä½•åˆ›å»ºå®¹å™¨çš„ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">ConfigurableApplicationContext</span> <span class="token function">createApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> contextClass <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>applicationContextClass<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>contextClass <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>webApplicationType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> <span class="token constant">SERVLET</span><span class="token operator">:</span>
                    contextClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_SERVLET_WEB_CONTEXT_CLASS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token constant">REACTIVE</span><span class="token operator">:</span>
                    contextClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_REACTIVE_WEB_CONTEXT_CLASS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">default</span><span class="token operator">:</span>
                    contextClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_CONTEXT_CLASS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ˜¯ä¸€ä¸ªWEBå®¹å™¨ï¼š<strong>DEFAULT_SERVLET_WEB_CONTEXT_CLASS</strong>ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ™®é€šå®¹å™¨å°±åˆ›å»ºï¼š<strong>DEFAULT_CONTEXT_CLASS</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>    /**
     * The class name of application context that will be used by default for non-web
     * environments.
     */
    public static final String DEFAULT_CONTEXT_CLASS = &quot;org.springframework.context.&quot;
            + &quot;annotation.AnnotationConfigApplicationContext&quot;;
    /**
     * The class name of application context that will be used by default for web
     * environments.
     */
    public static final String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = &quot;org.springframework.boot.&quot;
            + &quot;web.servlet.context.AnnotationConfigServletWebServerApplicationContext&quot;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸»è¦æ˜¯åˆ·æ–°IOCå®¹å™¨</p><figure><img src="/Computer-Science-Learn-Notes/assets/53-e20a1387.png" alt="53" tabindex="0" loading="lazy"><figcaption>53</figcaption></figure><p>åˆ·æ–°IOCå®¹å™¨</p><figure><img src="/Computer-Science-Learn-Notes/assets/54-50256c4e.png" alt="54" tabindex="0" loading="lazy"><figcaption>54</figcaption></figure><p>ä»¥æ­¤ç±»æ¨</p><figure><img src="/Computer-Science-Learn-Notes/assets/55-7b1af54d.png" alt="55" tabindex="0" loading="lazy"><figcaption>55</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/56-f4be0b49.png" alt="56" tabindex="0" loading="lazy"><figcaption>56</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/57-550049f7.png" alt="57" tabindex="0" loading="lazy"><figcaption>57</figcaption></figure><p>ç„¶åå°±åˆ›å»ºåµŒå…¥å¼çš„servletå®¹å™¨ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/58-8bbbfb64.png" alt="58" tabindex="0" loading="lazy"><figcaption>58</figcaption></figure><p>ç„¶åå°±è·å–åˆ°äº†åµŒå…¥å¼servletå®¹å™¨</p><figure><img src="/Computer-Science-Learn-Notes/assets/59-290b23fa.png" alt="59" tabindex="0" loading="lazy"><figcaption>59</figcaption></figure><p><strong>å°ç»“</strong>ï¼šIOCå®¹å™¨å¯åŠ¨åˆ›å»ºåµŒå…¥å¼çš„servletå®¹å™¨</p><ol><li><p>SpringBootå¯åŠ¨è¿è¡Œrunæ–¹æ³•</p></li><li><p>åˆ·æ–°IOCå®¹å™¨ï¼ˆåˆ›å»ºIOCå®¹å™¨å¯¹è±¡ï¼Œåˆå§‹åŒ–å®¹å™¨ï¼Œåˆ›å»ºæ¯ä¸€ä¸ªç»„ä»¶ï¼‰</p></li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token function">refreshContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åå¼€å§‹åˆ›å»ºwebå®¹å™¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>context <span class="token operator">=</span> <span class="token function">createApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœæ˜¯webç¯å¢ƒåˆ›å»ºï¼šAnnotationConfigServletWebServerApplicationContext</p><p>å¦åˆ™åˆ›å»ºï¼šAnnotationConfigApplicationContext</p><ol start="3"><li>åˆ·æ–°åˆšæ‰åˆ›å»ºå·çš„IOCå®¹å™¨ï¼š</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span><span class="token punctuation">)</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="4"><li><p>è°ƒç”¨onRefresh()ï¼Œwebçš„IOCå®¹å™¨é‡å†™äº†onRefreshæ–¹æ³•</p></li><li><p>webIOCå®¹å™¨ä¼šåˆ›å»ºåµŒå…¥å¼çš„Servletå®¹å™¨</p></li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token function">createWebServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li>è·å–åµŒå…¥å¼çš„Servletå®¹å™¨å·¥å‚</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">ServletWebServerFactory</span> factory <span class="token operator">=</span> <span class="token function">getWebServerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åä»IOCå®¹å™¨ä¸­è·å–TomcatServletWebServerFactoryç»„ä»¶ï¼›</p><p>åç½®å¤„ç†å™¨ï¼šBeanPostProcessorsRegistrar è·å–æ‰€æœ‰çš„å®šåˆ¶å™¨æ¥å®šåˆ¶Servletçš„ç›¸å…³é…ç½®</p><ol start="7"><li>åµŒå…¥å¼Servletå®¹å™¨åˆ›å»ºå¹¶å¯åŠ¨Tomcat</li></ol><h2 id="æ•´åˆjdbc" tabindex="-1"><a class="header-anchor" href="#æ•´åˆjdbc" aria-hidden="true">#</a> æ•´åˆJDBC</h2><p>YAMLé…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/mybatis_test
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è‡ªåŠ¨é…ç½®åŸç†-2" tabindex="-1"><a class="header-anchor" href="#è‡ªåŠ¨é…ç½®åŸç†-2" aria-hidden="true">#</a> è‡ªåŠ¨é…ç½®åŸç†</h3><p>DataSourceProperties</p><ol><li>DataSourceConfigurationï¼Œæ ¹æ®é…ç½®åˆ›å»ºæ•°æ®æºï¼Œé»˜è®¤ä½¿ç”¨Tomcatè¿æ¥æ± ï¼Œå¯ä»¥ä½¿ç”¨spring.datasource.typeè‡ªå®šä¹‰æ•°æ®æºç±»å‹</li></ol><ul><li>Tomcat</li><li>Hikari</li><li>Dbcp2</li><li>Generic è‡ªå®šä¹‰æ•°æ®æº</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;spring.datasource.type&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Generic</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProperties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä½¿ç”¨DataSourceBuilderåˆ›å»ºæ•°æ®æºï¼Œåˆ©ç”¨åˆ›å»ºå“åº”typeçš„æ•°æ®æºï¼Œå¹¶ä¸”ç»‘å®šç›¸å…³å±æ€§</span>
        <span class="token keyword">return</span> properties<span class="token punctuation">.</span><span class="token function">initializeDataSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><p>DataSourceAutoConfiguration</p></li><li><p>JdbcTemplateAutoConfiguration</p></li></ol><h2 id="æ•´åˆdruid" tabindex="-1"><a class="header-anchor" href="#æ•´åˆdruid" aria-hidden="true">#</a> æ•´åˆDruid</h2><p>å¯¼å…¥POMï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é¦–å…ˆé…ç½®YAMLï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/mybatis_test
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token key atrule">type</span><span class="token punctuation">:</span> com.alibaba.druid.pool.DruidDataSource
    <span class="token comment">#   æ•°æ®æºå…¶ä»–é…ç½®</span>
    <span class="token key atrule">initialSize</span><span class="token punctuation">:</span> <span class="token number">5</span>
    <span class="token key atrule">minIdle</span><span class="token punctuation">:</span> <span class="token number">5</span>
    <span class="token key atrule">maxActive</span><span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token key atrule">maxWait</span><span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token key atrule">timeBetweenEvictionRunsMillis</span><span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token key atrule">minEvictableIdleTimeMillis</span><span class="token punctuation">:</span> <span class="token number">300000</span>
    <span class="token key atrule">validationQuery</span><span class="token punctuation">:</span> SELECT 1 FROM DUAL
    <span class="token key atrule">testWhileIdle</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">testOnBorrow</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">testOnReturn</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">poolPreparedStatements</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment">#   é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œå»æ‰åç›‘æ§ç•Œé¢sqlæ— æ³•ç»Ÿè®¡ï¼Œ&#39;wall&#39;ç”¨äºé˜²ç«å¢™</span>
    <span class="token key atrule">filters</span><span class="token punctuation">:</span> stat<span class="token punctuation">,</span>wall<span class="token punctuation">,</span>log4j
    <span class="token key atrule">maxPoolPreparedStatementPerConnectionSize</span><span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token key atrule">useGlobalDataSourceStat</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">connectionProperties</span><span class="token punctuation">:</span> druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®Druid</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DruidConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.datasource&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">druid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//    é…ç½®ç›‘æ§</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServletRegistrationBean</span> <span class="token function">statViewServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServletRegistrationBean</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletRegistrationBean</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StatViewServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;/druid/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> initParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        initParams<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;loginUsername&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        initParams<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;loginPassword&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        initParams<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;allow&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤æ‰€æœ‰</span>
<span class="token comment">//        initParams.put(&quot;deny&quot;, &quot;&quot;); // æ‹’ç»è®¿é—®</span>
        bean<span class="token punctuation">.</span><span class="token function">setInitParameters</span><span class="token punctuation">(</span>initParams<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//    é…ç½®ä¸€ä¸ªwebç›‘æ§çš„filter</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span> <span class="token function">webStatFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FilterRegistrationBean</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WebStatFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> initParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        initParams<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;exclusions&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*.js,*.css,/druid/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setInitParameters</span><span class="token punctuation">(</span>initParams<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setUrlPatterns</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå°±å¯ä»¥çœ‹è§æŸ¥è¯¢çš„ä¿¡æ¯ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/60-07fade98.png" alt="60" tabindex="0" loading="lazy"><figcaption>60</figcaption></figure><p>SpringBoot2 ä½¿ç”¨YAMLç›´æ¥é…ç½®ç›‘æ§å™¨å’Œè®¿é—®åœ°å€ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/mybatis_test
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token key atrule">type</span><span class="token punctuation">:</span> com.alibaba.druid.pool.DruidDataSource
    <span class="token comment">#   æ•°æ®æºå…¶ä»–é…ç½®</span>
    <span class="token key atrule">initialSize</span><span class="token punctuation">:</span> <span class="token number">5</span>
    <span class="token key atrule">minIdle</span><span class="token punctuation">:</span> <span class="token number">5</span>
    <span class="token key atrule">maxActive</span><span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token key atrule">maxWait</span><span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token key atrule">timeBetweenEvictionRunsMillis</span><span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token key atrule">minEvictableIdleTimeMillis</span><span class="token punctuation">:</span> <span class="token number">300000</span>
    <span class="token key atrule">validationQuery</span><span class="token punctuation">:</span> SELECT 1 FROM DUAL
    <span class="token key atrule">testWhileIdle</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">testOnBorrow</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">testOnReturn</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">poolPreparedStatements</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment">#   é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œå»æ‰åç›‘æ§ç•Œé¢sqlæ— æ³•ç»Ÿè®¡ï¼Œ&#39;wall&#39;ç”¨äºé˜²ç«å¢™</span>
    <span class="token key atrule">filters</span><span class="token punctuation">:</span> stat<span class="token punctuation">,</span>wall<span class="token punctuation">,</span>log4j
    <span class="token key atrule">maxPoolPreparedStatementPerConnectionSize</span><span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token key atrule">useGlobalDataSourceStat</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">connectionProperties</span><span class="token punctuation">:</span> druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500
    <span class="token key atrule">druid</span><span class="token punctuation">:</span>
      <span class="token key atrule">filters</span><span class="token punctuation">:</span> stat<span class="token punctuation">,</span>wall
      <span class="token key atrule">aop-patterns</span><span class="token punctuation">:</span> com.javayh.druid.*
      <span class="token key atrule">web-stat-filter</span><span class="token punctuation">:</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">url-pattern</span><span class="token punctuation">:</span> /*
        <span class="token key atrule">exclusions</span><span class="token punctuation">:</span> /druid/*<span class="token punctuation">,</span><span class="token important">*.js</span><span class="token punctuation">,</span><span class="token important">*.gif</span><span class="token punctuation">,</span><span class="token important">*.jpg</span><span class="token punctuation">,</span><span class="token important">*.bmp</span><span class="token punctuation">,</span><span class="token important">*.png</span><span class="token punctuation">,</span><span class="token important">*.css</span><span class="token punctuation">,</span><span class="token important">*.ico</span>
        <span class="token key atrule">session-stat-enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">session-stat-max-count</span><span class="token punctuation">:</span> <span class="token number">10</span>
      <span class="token key atrule">stat-view-servlet</span><span class="token punctuation">:</span>
        <span class="token comment"># æ˜¯å¦å¯ç”¨statViewServleté…ç½®</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token comment"># è®¿é—®ç›‘æ§é¡µé¢</span>
        <span class="token key atrule">url-pattern</span><span class="token punctuation">:</span> <span class="token string">&quot;/druid/*&quot;</span>
        <span class="token comment"># ç¦æ­¢æ‰‹åŠ¨é‡ç½®ç›‘æ§æ•°æ®</span>
        <span class="token key atrule">reset-enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
        <span class="token comment"># è®¾ç½®ç›‘æ§é¡µé¢çš„ç™»é™†å</span>
        <span class="token key atrule">login-username</span><span class="token punctuation">:</span> admin
        <span class="token comment"># è®¾ç½®ç›‘æ§é¡µé¢çš„ç™»é™†å¯†ç </span>
        <span class="token key atrule">login-password</span><span class="token punctuation">:</span> <span class="token number">123</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ•´åˆmybatis" tabindex="-1"><a class="header-anchor" href="#æ•´åˆmybatis" aria-hidden="true">#</a> æ•´åˆMybatis</h2><h3 id="maven" tabindex="-1"><a class="header-anchor" href="#maven" aria-hidden="true">#</a> Maven</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ³¨è§£" aria-hidden="true">#</a> ä½¿ç”¨æ³¨è§£</h3><p>åˆ›å»ºå®ä½“ç±»è¿›è¡Œæµ‹è¯•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> gender<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> dId<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Department</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> departmentName<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨æ³¨è§£**@Mapper**æ ‡æ³¨ä½¿ç”¨Mybatis</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DepartmentMapper</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;select * from department where id = #{id} ;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Department</span> <span class="token function">getDepById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">&quot;delete from department where id = #{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deleteDepById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Options</span><span class="token punctuation">(</span>useGeneratedKeys <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> keyProperty <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">&quot;insert into department (department_name) values (#{departmentName});&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Department</span> department<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token string">&quot;update department set department_name=#{departmentName} where id = #{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updateDept</span><span class="token punctuation">(</span><span class="token class-name">Department</span> department<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰Mybatisï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@org.springframework.context.annotation.Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MybatisConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ConfigurationCustomizer</span> <span class="token function">configurationCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ConfigurationCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customize</span><span class="token punctuation">(</span><span class="token class-name">Configuration</span> configuration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                configuration<span class="token punctuation">.</span><span class="token function">setMapUnderscoreToCamelCase</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœ@Mapperè¿‡å¤šå¯ä»¥åœ¨ä¸»ç±»ä¸­ä½¿ç”¨**@MapperScan**æ‰¹é‡æ‰«ææ¥å£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;cn.zhiyucs.mapper&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringbootMybatis01Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SpringbootMybatis01Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> ä½¿ç”¨é…ç½®æ–‡ä»¶</h3><p>åˆ›å»ºMybatisç›®å½•ç»“æ„ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/61-bdd6a332.png" alt="61" tabindex="0" loading="lazy"><figcaption>61</figcaption></figure><p>Mybatisä¸»é…ç½®environmentå¯ä»¥ä»€ä¹ˆéƒ½ä¸å†™ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">configuration</span>
        <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span>
        <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapUnderscoreToCamelCase<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸»é…ç½®æ–‡ä»¶ä¸­é…ç½®MyBatisï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">config-location</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mybatis/mybatis<span class="token punctuation">-</span>config.xml
  <span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mybatis/mapper/<span class="token important">*.xml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="springbootå¯åŠ¨åŸç†" tabindex="-1"><a class="header-anchor" href="#springbootå¯åŠ¨åŸç†" aria-hidden="true">#</a> SpringBootå¯åŠ¨åŸç†</h2><p>ç¨‹åºå…¥å£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SpringbootStartertheoryApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¬¬ä¸€æ­¥-åˆ›å»ºspringapplicationå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#ç¬¬ä¸€æ­¥-åˆ›å»ºspringapplicationå¯¹è±¡" aria-hidden="true">#</a> ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºSpringApplicationå¯¹è±¡</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ConfigurableApplicationContext</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> primarySource<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> primarySource <span class="token punctuation">}</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ConfigurableApplicationContext</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> primarySources<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">(</span>primarySources<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥è§‚å¯Ÿå®ƒçš„æ„é€ æ–¹æ³•ï¼šåˆ›å»ºæ–¹æ³•è§ä¸‹é¢</p><p>ä¸»è¦æ˜¯é…ç½®ä¸¤ä¸ªç±»</p><ul><li>ApplicationContextInitializer</li><li>SpringApplicationRunListener</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">(</span><span class="token class-name">ResourceLoader</span> resourceLoader<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> primarySources<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader <span class="token operator">=</span> resourceLoader<span class="token punctuation">;</span>
    <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>primarySources<span class="token punctuation">,</span> <span class="token string">&quot;PrimarySources must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// é…ç½®source</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>primarySources <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>primarySources<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆ¤æ–­æ˜¯å¦æ˜¯webåº”ç”¨</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>webApplicationType <span class="token operator">=</span> <span class="token class-name">WebApplicationType</span><span class="token punctuation">.</span><span class="token function">deduceFromClasspath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆ›å»ºåˆå§‹åŒ–æ„é€ å™¨</span>
    <span class="token function">setInitializers</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token punctuation">)</span> <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContextInitializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆ›å»ºåº”ç”¨ç›‘å¬å™¨</span>
    <span class="token function">setListeners</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token punctuation">)</span> <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span><span class="token class-name">ApplicationListener</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ¨æ–­å‡ºmainæ–¹æ³•ç±»</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mainApplicationClass <span class="token operator">=</span> <span class="token function">deduceMainpplicationClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†è¿›å…¥ï¼šgetSpringFactoriesInstances</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">private</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> parameterTypes<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–ç±»åŠ è½½å™¨</span>
    <span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Use names and ensure unique to protect against duplicates</span>
    <span class="token comment">// é€šè¿‡ç±»åŠ è½½å™¨ï¼Œè·å–æŒ‡å®šçš„META-INF/spring.factoriesæ–‡ä»¶ï¼Œè·å–æ–‡ä»¶ä¸­å·¥å‚ç±»çš„å…¨ç±»å</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> names <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">SpringFactoriesLoader</span><span class="token punctuation">.</span><span class="token function">loadFactoryNames</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> classLoader<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// é€šè¿‡ç±»è·¯å¾„åå°„å¾—åˆ°å·¥å‚å¯¹è±¡ï¼Œæ„é€ æ–¹æ³•</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> instances <span class="token operator">=</span> <span class="token function">createSpringFactoriesInstances</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> parameterTypes<span class="token punctuation">,</span> classLoader<span class="token punctuation">,</span> args<span class="token punctuation">,</span> names<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AnnotationAwareOrderComparator</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>instances<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> instances<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡loadFactoryNameså°±å¯ä»¥çŸ¥é“</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">FACTORIES_RESOURCE_LOCATION</span> <span class="token operator">=</span> <span class="token string">&quot;META-INF/spring.factories&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="ç¬¬äºŒæ­¥-å¯åŠ¨åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¬¬äºŒæ­¥-å¯åŠ¨åº”ç”¨" aria-hidden="true">#</a> ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åº”ç”¨</h3><p>ä¸»ç±»ï¼šConfigurableApplicationContext</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ConfigurableApplicationContext</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">StopWatch</span> stopWatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åº”ç”¨å¯åŠ¨è®¡æ—¶å™¨å¼€å§‹è®¡æ—¶</span>
    stopWatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ConfigurableApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpringBootExceptionReporter</span><span class="token punctuation">&gt;</span></span> exceptionReporters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Headlessæ¨¡å¼é…ç½®ï¼ˆåšAWTï¼Œæš‚æ—¶ä¸ç”¨ç®¡ï¼‰</span>
    <span class="token function">configureHeadlessProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è·å–å¯åŠ¨ç›‘å¬å™¨</span>
    <span class="token class-name">SpringApplicationRunListeners</span> listeners <span class="token operator">=</span> <span class="token function">getRunListeners</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åº”ç”¨å¯åŠ¨ç›‘å¬å™¨å¼€å§‹è®¡æ—¶ï¼ˆå›è°ƒæ‰€æœ‰çš„SpringApplicationRunListeners.starting()ï¼‰</span>
    listeners<span class="token punctuation">.</span><span class="token function">starting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// å°è£…å‘½ä»¤è¡Œå‚æ•°</span>
        <span class="token class-name">ApplicationArguments</span> applicationArguments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultApplicationArguments</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é…ç½®ç¯å¢ƒæ¨¡å—ï¼ˆç¥¥è§ä¸‹é¢prepareEnvironmentæ–¹æ³•ï¼‰</span>
        <span class="token class-name">ConfigurableEnvironment</span> environment <span class="token operator">=</span> <span class="token function">prepareEnvironment</span><span class="token punctuation">(</span>listeners<span class="token punctuation">,</span> applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é…ç½®éœ€è¦å¿½ç•¥çš„bean</span>
        <span class="token function">configureIgnoreBeanInfo</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Banneré…ç½®(æ‰“å°Springçš„å›¾æ ‡)</span>
        <span class="token class-name">Banner</span> printedBanner <span class="token operator">=</span> <span class="token function">printBanner</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡</span>
        context <span class="token operator">=</span> <span class="token function">createApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¼‚å¸¸åˆ†ææŠ¥å‘Š</span>
        exceptionReporters <span class="token operator">=</span> <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span><span class="token class-name">SpringBootExceptionReporter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
                                                         <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token class-name">ConfigurableApplicationContext</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¸Šä¸‹æ–‡åŸºæœ¬å±æ€§é…ç½®ï¼ˆç¥¥è§ä¸‹é¢prepareContextæ–¹æ³•ï¼‰</span>
        <span class="token function">prepareContext</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> environment<span class="token punctuation">,</span> listeners<span class="token punctuation">,</span> applicationArguments<span class="token punctuation">,</span> printedBanner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ›´æ–°åº”ç”¨ä¸Šä¸‹æ–‡/åˆ·æ–°IOCå®¹å™¨ï¼ˆç¥¥è§ä¸‹é¢refreshæ–¹æ³•ï¼‰</span>
        <span class="token function">refreshContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä»IOCå®¹å™¨ä¸­è·å–æ‰€æœ‰çš„ApplicationRunnerå’ŒCommandLineRunnerè¿›è¡Œå›è°ƒ</span>
        <span class="token comment">// å…ˆApplicationRunner</span>
        <span class="token function">afterRefresh</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stopWatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>logStartupInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token class-name">StartupInfoLogger</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mainApplicationClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">logStarted</span><span class="token punctuation">(</span><span class="token function">getApplicationLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stopWatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        listeners<span class="token punctuation">.</span><span class="token function">started</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callRunners</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">handleRunFailure</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> ex<span class="token punctuation">,</span> exceptionReporters<span class="token punctuation">,</span> listeners<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        listeners<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">handleRunFailure</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> ex<span class="token punctuation">,</span> exceptionReporters<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// æ•´ä¸ªSpringBootå¯åŠ¨å®Œæˆè¿”å›IOCå®¹å™¨</span>
    <span class="token keyword">return</span> context<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è·å–ç›‘å¬å™¨çš„æ–¹æ³•ï¼š<strong>getSpringFactoriesInstances</strong>ï¼Œå¯ä»¥çœ‹å‡ºä¹Ÿæ˜¯ä»<strong>META-INF</strong>è·å–</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">SpringApplicationRunListeners</span> <span class="token function">getRunListeners</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> types <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SpringApplicationRunListeners</span><span class="token punctuation">(</span>logger<span class="token punctuation">,</span>
                                             <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span><span class="token class-name">SpringApplicationRunListener</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> types<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®Listenerç¯å¢ƒï¼š<strong>prepareEnvironment</strong>(listeners, applicationArguments);</p><p>ç¯å¢ƒå®Œæˆåå›è°ƒSpringApplicationRunListeners.environmentPreparedæ–¹æ³•ï¼Œè¡¨ç¤ºç¯å¢ƒå‡†å¤‡å®Œæˆ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">ConfigurableEnvironment</span> <span class="token function">prepareEnvironment</span><span class="token punctuation">(</span><span class="token class-name">SpringApplicationRunListeners</span> listeners<span class="token punctuation">,</span>
                                                   <span class="token class-name">ApplicationArguments</span> applicationArguments<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create and configure the environment</span>
    <span class="token comment">// åˆ›å»ºé…ç½®ç¯å¢ƒ</span>
    <span class="token class-name">ConfigurableEnvironment</span> environment <span class="token operator">=</span> <span class="token function">getOrCreateEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åŠ è½½å±æ€§æ–‡ä»¶</span>
    <span class="token function">configureEnvironment</span><span class="token punctuation">(</span>environment<span class="token punctuation">,</span> applicationArguments<span class="token punctuation">.</span><span class="token function">getSourceArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ConfigurationPropertySources</span><span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç›‘å¬å™¨ç›‘å¬é…ç½®</span>
    listeners<span class="token punctuation">.</span><span class="token function">environmentPrepared</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">bindToSpringApplication</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isCustomEnvironment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        environment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EnvironmentConverter</span><span class="token punctuation">(</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">convertEnvironmentIfNecessary</span><span class="token punctuation">(</span>environment<span class="token punctuation">,</span>
                                                                                               <span class="token function">deduceEnvironmentClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">ConfigurationPropertySources</span><span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> environment<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°æ”¾è¡ŒBanneråå‡ºç°ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/63-f99f616f.png" alt="63" tabindex="0" loading="lazy"><figcaption>63</figcaption></figure><p>ç„¶åçœ‹<strong>createApplicationContext</strong>ï¼šå†³å®šåˆ›å»º</p><p>WEBï¼ˆDEFAULT_SERVLET_WEB_CONTEXT_CLASSï¼‰</p><p>è¿˜æ˜¯</p><p>æ™®é€šIOCï¼ˆDEFAULT_CONTEXT_CLASSï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">ConfigurableApplicationContext</span> <span class="token function">createApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> contextClass <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>applicationContextClass<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>contextClass <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>webApplicationType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> <span class="token constant">SERVLET</span><span class="token operator">:</span>
                    contextClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_SERVLET_WEB_CONTEXT_CLASS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token constant">REACTIVE</span><span class="token operator">:</span>
                    contextClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_REACTIVE_WEB_CONTEXT_CLASS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">default</span><span class="token operator">:</span>
                    contextClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_CONTEXT_CLASS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Unable create a default ApplicationContext, please specify an ApplicationContextClass&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span><span class="token punctuation">)</span> <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">instantiateClass</span><span class="token punctuation">(</span>contextClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çœ‹<strong>prepareContext</strong>å‡†å¤‡ä¸Šä¸‹æ–‡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">prepareContext</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">,</span> <span class="token class-name">ConfigurableEnvironment</span> environment<span class="token punctuation">,</span>
                            <span class="token class-name">SpringApplicationRunListeners</span> listeners<span class="token punctuation">,</span> <span class="token class-name">ApplicationArguments</span> applicationArguments<span class="token punctuation">,</span> <span class="token class-name">Banner</span> printedBanner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¿å­˜åˆšåˆšçš„environment</span>
    context<span class="token punctuation">.</span><span class="token function">setEnvironment</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åç½®å¤„ç†å™¨ï¼Œæ³¨å†Œå°ç»„ä»¶</span>
    <span class="token function">postProcessApplicationContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä¸»è¦ï¼š</span>
    <span class="token function">applyInitializers</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    listeners<span class="token punctuation">.</span><span class="token function">contextPrepared</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>logStartupInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">logStartupInfo</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">logStartupProfileInfo</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Add boot specific singleton beans</span>
    <span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    beanFactory<span class="token punctuation">.</span><span class="token function">registerSingleton</span><span class="token punctuation">(</span><span class="token string">&quot;springApplicationArguments&quot;</span><span class="token punctuation">,</span> applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>printedBanner <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">registerSingleton</span><span class="token punctuation">(</span><span class="token string">&quot;springBootBanner&quot;</span><span class="token punctuation">,</span> printedBanner<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>beanFactory <span class="token keyword">instanceof</span> <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">)</span> beanFactory<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setAllowBeanDefinitionOverriding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>allowBeanDefinitionOverriding<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lazyInitialization<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        context<span class="token punctuation">.</span><span class="token function">addBeanFactoryPostProcessor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LazyInitializationBeanFactoryPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Load the sources</span>
    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> sources <span class="token operator">=</span> <span class="token function">getAllSources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notEmpty</span><span class="token punctuation">(</span>sources<span class="token punctuation">,</span> <span class="token string">&quot;Sources must not be empty&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">load</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> sources<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å®Œæˆåå›è°ƒcontextLoaded</span>
    listeners<span class="token punctuation">.</span><span class="token function">contextLoaded</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çœ‹å…³é”®çš„applyInitializersï¼Œå›è°ƒä¹‹å‰ä¿å­˜çš„ApplicationContextInitializerçš„initializeï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">applyInitializers</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ApplicationContextInitializer</span> initializer <span class="token operator">:</span> <span class="token function">getInitializers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> requiredType <span class="token operator">=</span> <span class="token class-name">GenericTypeResolver</span><span class="token punctuation">.</span><span class="token function">resolveTypeArgument</span><span class="token punctuation">(</span>initializer<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                                        <span class="token class-name">ApplicationContextInitializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">isInstanceOf</span><span class="token punctuation">(</span>requiredType<span class="token punctuation">,</span> context<span class="token punctuation">,</span> <span class="token string">&quot;Unable to call initializer.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        initializer<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åçœ‹ listeners.contextPrepared(context); å›è°ƒä¹‹å‰çš„SpringApplicationRunListenerçš„contextPreparedæ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">contextPrepared</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SpringApplicationRunListener</span> listener <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        listener<span class="token punctuation">.</span><span class="token function">contextPrepared</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå¼€å§‹åˆ·æ–°å®¹å™¨<strong>refreshContext(context)</strong>ï¼šï¼ˆé…ç½®ã€ç»„ä»¶ã€è‡ªåŠ¨é…ç½®ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalStateException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span> var1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>startupShutdownMonitor<span class="token punctuation">;</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>startupShutdownMonitor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//å‡†å¤‡æ›´æ–°ä¸Šä¸‹æ–‡æ—¶çš„é¢„å¤‡å·¥ä½œï¼š1.åˆå§‹åŒ–PropertySource; 2.éªŒè¯Enrivonmentä¸­å¿…è¦çš„å±æ€§</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">prepareRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–ä¸Šä¸‹æ–‡ä¸­çš„BeanFactory</span>
        <span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">obtainFreshBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å¯¹BeanFactoryåšäº›é¢„å¤‡å·¥ä½œ</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">prepareBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//å¯¹BeanFactoryè¿›è¡Œé¢„å¤„ç†</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//æ‰§è¡Œå®¹å™¨ä¸­çš„BeanFactoryPostProcessor</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//æ³¨å†ŒBeanPostProcessor</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerBeanPostProcessors</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//åˆå§‹åŒ–MessageSource(å›½é™…åŒ–ç›¸å…³)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//åˆå§‹åŒ–å®¹å™¨äº‹ä»¶å¹¿æ’­å™¨(ç”¨æ¥å‘å¸ƒäº‹ä»¶)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initApplicationEventMulticaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//åˆå§‹åŒ–ä¸€äº›ç‰¹æ®Šçš„Bean,ä¸»è¦åšäº†: 1.åˆå§‹åŒ–ThemeSource(è·Ÿå›½é™…åŒ–ç›¸å…³çš„æ¥å£) 2.åˆ›å»ºWebServer</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//å°†æ‰€æœ‰ç›‘å¬å™¨æ³¨å†Œåˆ°å‰ä¸¤æ­¥åˆ›å»ºçš„äº‹ä»¶å¹¿æ’­å™¨ä¸­</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//ç»“æŸBeanFactoryçš„åˆå§‹åŒ–å·¥ä½œ(è¿™ä¸€æ­¥ä¸»è¦ç”¨æ¥å°†æ‰€æœ‰çš„å•ä¾‹BeanDefinitionå®ä¾‹åŒ–)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">finishBeanFactoryInitialization</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//ä¸Šä¸‹æ–‡åˆ·æ–°å®Œæ¯•</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">finishRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BeansException</span> var9<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">isWarnEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;Exception encountered during context initialization - cancelling refresh attempt: &quot;</span> <span class="token operator">+</span> var9<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">destroyBeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cancelRefresh</span><span class="token punctuation">(</span>var9<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> var9<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetCommonCaches</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°-æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»" tabindex="-1"><a class="header-anchor" href="#åŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°-æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»" aria-hidden="true">#</a> ï¼ˆåŸºäºåŸç†çš„æµ‹è¯•ç¬”è®°ï¼‰æµ‹è¯•å¯åŠ¨çš„å››ä¸ªç±»</h2><p>æµ‹è¯•ç±»ï¼š</p><ul><li>ApplicationContextInitializer</li><li>SpringApplicationRunListener</li><li>ApplicationRunner</li><li>CommandLineRunner</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloApplicationContextInitializer</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationContextInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigurableApplicationContext</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> applicationContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ApplicationContextInitializer............initialize........&quot;</span> <span class="token operator">+</span> applicationContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloSpringApplicationRunListener</span> <span class="token keyword">implements</span> <span class="token class-name">SpringApplicationRunListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">HelloSpringApplicationRunListener</span><span class="token punctuation">(</span><span class="token class-name">SpringApplication</span> application<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">starting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SpringApplicationRunListener......starting.......&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">environmentPrepared</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableEnvironment</span> environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>environment<span class="token punctuation">.</span><span class="token function">getSystemEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;os.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SpringApplicationRunListener.........environmentPrepared.............&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextPrepared</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SpringApplicationRunListener.........contextPrepared.............&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoaded</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SpringApplicationRunListener.........contextLoaded.............&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">started</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SpringApplicationRunListener.........started.............&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">running</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">failed</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloApplicationRunner</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationRunner</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ApplicationArguments</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ApplicationRunner.........run.........&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloCommandLineRunner</span> <span class="token keyword">implements</span> <span class="token class-name">CommandLineRunner</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CommandLineRunner............run........&quot;</span> <span class="token operator">+</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸»é…ç½®ç±»ä¸­ï¼ˆapplication.propertiesï¼‰é…ç½®å‰ä¸¤ä¸ªç±»ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">org.springframework.context.ApplicationContextInitializer</span><span class="token punctuation">=</span><span class="token value attr-value">\
cn.zhiyucs.listener.HelloApplicationContextInitializer</span>
<span class="token key attr-name">org.springframework.boot.SpringApplicationRunListener</span><span class="token punctuation">=</span><span class="token value attr-value">\
cn.zhiyucs.listener.HelloSpringApplicationRunListener</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘" aria-hidden="true">#</a> è‡ªå®šä¹‰startersã€æš‚æ—¶æ— æ³•ç†è§£ã€‘</h2><p>ç¼–å†™è‡ªåŠ¨é…ç½®ç±»éœ€è¦çš„æ³¨è§£ï¼š</p><ul><li><strong>@Configuration</strong> æŒ‡å®šæ˜¯ä¸€ä¸ªé…ç½®ç±»</li><li><strong>@Conditionalxxx</strong> æŒ‡å®šæ¡ä»¶æˆç«‹çš„æ—¶å€™è‡ªåŠ¨é…ç½®ç”Ÿæ•ˆ</li><li><strong>@AutoConfigureOrder</strong> æŒ‡å®šè‡ªåŠ¨é…ç½®ç±»çš„é¡ºåº</li><li><strong>@AutoConfigureAfter</strong></li><li><strong>@Bean</strong> ç»™å®¹å™¨æ·»åŠ ç»„ä»¶</li><li><strong>@ConfigurationProperties(prefix = &quot;&quot;)</strong> ç»‘å®šç›¸å…³çš„é…ç½®</li><li><strong>@EnableConfigurationProperties</strong> è®©xxxPropertiesç”Ÿæ•ˆåŠ å…¥åˆ°å®¹å™¨ä¸­</li></ul><p>åŠ å…¥åˆ°META-INF-factoriesé‡Œé¢ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># Initializers</span>
<span class="token key attr-name">org.springframework.context.ApplicationContextInitializer</span><span class="token punctuation">=</span><span class="token value attr-value">\
org.springframework.boot.autoconfigure.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¼•å…¥æ¨¡å¼ï¼š</p><p>å¯åŠ¨å™¨ä¾èµ–è‡ªåŠ¨æ¨¡å¼ï¼Œåªéœ€å¼•å…¥starterå³å¯</p><p>æ¨èå‘½åï¼šxxx-spring-boot-starter</p><figure><img src="/Computer-Science-Learn-Notes/assets/64-9064e705.jpg" alt="64" tabindex="0" loading="lazy"><figcaption>64</figcaption></figure><p>åˆ›å»ºä¸€ä¸ªç©ºå·¥ç¨‹</p><p>åˆ›å»ºä¸€ä¸ªmodel</p><figure><img src="/Computer-Science-Learn-Notes/assets/65-300da39c.png" alt="65" tabindex="0" loading="lazy"><figcaption>65</figcaption></figure><p>åˆ›å»ºä¸€ä¸ªspringbootInitialize</p><figure><img src="/Computer-Science-Learn-Notes/assets/66-50ea65ee.png" alt="66" tabindex="0" loading="lazy"><figcaption>66</figcaption></figure><h2 id="springbootç¼“å­˜åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#springbootç¼“å­˜åŸºæœ¬ä½¿ç”¨" aria-hidden="true">#</a> SpringBootç¼“å­˜åŸºæœ¬ä½¿ç”¨</h2><p>åº”ç”¨--ç¼“å­˜--æ•°æ®åº“çš„å…³ç³»</p><figure><img src="/Computer-Science-Learn-Notes/assets/67-61b87b61.png" alt="67" tabindex="0" loading="lazy"><figcaption>67</figcaption></figure><p>å‡ ä¸ªé‡è¦çš„ç¼“å­˜æ³¨è§£ï¼š</p><table><thead><tr><th>Cache</th><th>ç¼“å­˜æ¥å£ï¼Œå®šä¹‰ç¼“å­˜æ“ä½œã€‚å®ç°æœ‰ï¼šRedisCacheã€EhCacheCacheã€ConcurrentMapCacheç­‰</th></tr></thead><tbody><tr><td>CacheManager</td><td>ç¼“å­˜ç®¡ç†å™¨ï¼Œç®¡ç†å„ç§ç¼“å­˜ï¼ˆCacheï¼‰ç»„ä»¶</td></tr><tr><td>@Cacheable</td><td>ä¸»è¦é’ˆå¯¹æ–¹æ³•é…ç½®ï¼Œèƒ½å¤Ÿæ ¹æ®æ–¹æ³•çš„è¯·æ±‚å‚æ•°å¯¹å…¶ç»“æœè¿›è¡Œç¼“å­˜</td></tr><tr><td>@CacheEvict</td><td>æ¸…ç©ºç¼“å­˜</td></tr><tr><td>@CachePut</td><td>ä¿è¯æ–¹æ³•è¢«è°ƒç”¨ï¼Œåˆå¸Œæœ›ç»“æœè¢«ç¼“å­˜ã€‚</td></tr><tr><td>@EnableCaching</td><td>å¼€å¯åŸºäºæ³¨è§£çš„ç¼“å­˜</td></tr><tr><td>keyGenerator</td><td>ç¼“å­˜æ•°æ®æ—¶keyç”Ÿæˆç­–ç•¥</td></tr><tr><td>serialize</td><td>ç¼“å­˜æ•°æ®æ—¶valueåºåˆ—åŒ–ç­–ç•¥</td></tr></tbody></table><p>ç¼“å­˜çš„spel</p><table><thead><tr><th>åå­—</th><th>ä½ç½®</th><th>æè¿°</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>methodName</td><td>root object</td><td>å½“å‰è¢«è°ƒç”¨çš„æ–¹æ³•å</td><td>#root.methodName</td></tr><tr><td>method</td><td>root object</td><td>å½“å‰è¢«è°ƒç”¨çš„æ–¹æ³•</td><td>#<a href="http://root.method.name" target="_blank" rel="noopener noreferrer">root.method.name<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></td></tr><tr><td>target</td><td>root object</td><td>å½“å‰è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡</td><td>#root.target</td></tr><tr><td>targetClass</td><td>root object</td><td>å½“å‰è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡ç±»</td><td>#root.targetClass</td></tr><tr><td>args</td><td>root object</td><td>å½“å‰è¢«è°ƒç”¨çš„æ–¹æ³•çš„å‚æ•°åˆ—è¡¨</td><td>#root.args[0]</td></tr><tr><td>caches</td><td>root object</td><td>å½“å‰æ–¹æ³•è°ƒç”¨ä½¿ç”¨çš„ç¼“å­˜åˆ—è¡¨ï¼ˆå¦‚@Cacheable(value={&quot;cache1&quot;, &quot;cache2&quot;})ï¼‰ï¼Œåˆ™æœ‰ä¸¤ä¸ªcache</td><td>#root.caches[0].name</td></tr><tr><td><em>argument name</em></td><td>evaluation context</td><td>æ–¹æ³•å‚æ•°çš„åå­—. å¯ä»¥ç›´æ¥ #å‚æ•°å ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ #p0æˆ–#a0 çš„å½¢å¼ï¼Œ0ä»£è¡¨å‚æ•°çš„ç´¢å¼•ï¼›</td><td>#iban ã€ #a0 ã€ #p0</td></tr><tr><td>result</td><td>evaluation context</td><td>æ–¹æ³•æ‰§è¡Œåçš„è¿”å›å€¼ï¼ˆä»…å½“æ–¹æ³•æ‰§è¡Œä¹‹åçš„åˆ¤æ–­æœ‰æ•ˆï¼Œå¦‚â€˜unlessâ€™ï¼Œâ€™cache putâ€™çš„è¡¨è¾¾å¼ â€™cache evictâ€™çš„è¡¨è¾¾å¼beforeInvocation=falseï¼‰</td><td>#result</td></tr></tbody></table><h3 id="åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä½¿ç”¨" aria-hidden="true">#</a> åŸºæœ¬ä½¿ç”¨</h3><p>åœ¨ä¸»ç±»å¼€å¯**@EnableCaching**ç¼“å­˜</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;cn.zhiyucs.mapper&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableCaching</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringbootCache01Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SpringbootCache01Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦ç¼“å­˜çš„æ–¹æ³•å¼€å¯**@Cacheable**ï¼šï¼ˆä»‹ç»è§æ³¨é‡Šï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
     * @Cacheable :å°†æ–¹æ³•ç»“æœæ”¾å…¥ç¼“å­˜ï¼Œä»¥åè¦æœ‰ç›¸åŒçš„æ•°æ®ç›´æ¥ä»ç¼“å­˜ä¸­è·å–ï¼Œä¸ç”¨è°ƒæ–¹æ³•
     * CacheManager ç®¡ç†å¤šä¸ªcacheç»„ä»¶ï¼Œå¯¹ç¼“å­˜çš„çœŸæ­£CRUDæ“ä½œå†cacheç»„ä»¶ä¸­ï¼Œæ¯ä¸€ä¸ªç¼“å­˜éƒ½æœ‰è‡ªå·±å”¯ä¸€çš„åå­—
     * @Cacheableå‡ ä¸ªå±æ€§ï¼š
     *      cacheNames/value: æŒ‡å®šç¼“å­˜ç»„ä»¶çš„åå­—
     *      key: ç¼“å­˜æ•°æ®ä½¿ç”¨çš„keyï¼Œé»˜è®¤æ˜¯ä½¿ç”¨å‚æ•°æ–¹æ³•å‚æ•°çš„å€¼ï¼Œ 1-æ–¹æ³•çš„è¿”å›å€¼
     *      keyGenerator: keyçš„ç”Ÿæˆå™¨ï¼Œå¯ä»¥è‡ªå·±æŒ‡å®škeyçš„ç”Ÿæˆå™¨çš„ç»„ä»¶id
     *          key / keyGenerator äºŒé€‰ä¸€
     *      cacheManager: æŒ‡å®šç¼“å­˜ç®¡ç†å™¨/ç¼“å­˜è§£æå™¨ï¼ˆcacheResolverï¼‰
     *      condition: æŒ‡å®šç¬¦åˆæ¡ä»¶ä¸‹æ‰ç¼“å­˜
     *      unless: å¦å®šç¼“å­˜,å½“unlessæŒ‡å®šçš„æ¡ä»¶ä¸ºtrueï¼Œæ–¹æ³•çš„è¿”å›å€¼å°±ä¸ä¼šè¢«ç¼“å­˜
     *          eg. unless = &quot;#result == null&quot; æ•°æ®ä¸ºç©ºä¸ç¼“å­˜
     *      sync: æ˜¯å¦ä½¿ç”¨å¼‚æ­¥æ¨¡å¼
     * <span class="token keyword">@param</span> <span class="token parameter">id</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>condition <span class="token operator">=</span> <span class="token string">&quot;#id&gt;0&quot;</span><span class="token punctuation">,</span>unless <span class="token operator">=</span> <span class="token string">&quot;#result == null&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmp</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç¼“å­˜æµ‹è¯•ä¸“ä¸šSOUT&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Employee</span> emp <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> emp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ•°æ®åº“æ–¹é¢ï¼šå¼€å¯é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„ï¼Œå¼€å¯æ‰“å°SQLï¼š</p><p>æ‰“å°SQLï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">logging.level.cn.zhiyucs.mapper</span><span class="token punctuation">=</span><span class="token value attr-value">debug</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
    <span class="token key atrule">map-underscore-to-camel-case</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‡ ä¸ªå±æ€§ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#å‡ ä¸ªå±æ€§ä»‹ç»" aria-hidden="true">#</a> å‡ ä¸ªå±æ€§ä»‹ç»</h3><p>cacheNames/value: æŒ‡å®šç¼“å­˜ç»„ä»¶çš„åå­—ï¼Œå°†æ–¹æ³•çš„è¿”å›ç»“æœæ”¾åœ¨å“ªä¸ªç¼“å­˜ä¸­ï¼Œæ˜¯æ•°ç»„çš„æ–¹å¼ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ª</p><p>condition #a0&gt;1çš„æ„æ€æ˜¯å½“ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼å¤§äº1æ‰ç”Ÿæ•ˆ</p><p>unless åŒç†ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º2çš„è¯å°±ä¸ä¼šç¼“å­˜</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;keyGenerator&quot;</span><span class="token punctuation">,</span> condition <span class="token operator">=</span> <span class="token string">&quot;#a0&gt;1&quot;</span><span class="token punctuation">,</span>unless <span class="token operator">=</span> <span class="token string">&quot;#a0==2&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>keyçš„ä¸¤ç§æ–¹æ³•ï¼š</strong></p><ul><li>ç›´æ¥æŒ‡å®šï¼š<strong>key = &quot;#root.methodName+&#39;[&#39;+#id+&#39;]&quot;</strong></li><li>ä½¿ç”¨é…ç½®ç±»æŒ‡å®šï¼š</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCacheConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">KeyGenerator</span> <span class="token function">keyGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;[&quot;</span><span class="token operator">+</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åç›´æ¥è°ƒç”¨å³å¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;keyGenerator&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†" aria-hidden="true">#</a> ç¼“å­˜è‡ªåŠ¨é…ç½®åŸç†</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token class-name">CacheManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnBean</span><span class="token punctuation">(</span><span class="token class-name">CacheAspectSupport</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">CacheManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">&quot;cacheResolver&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">CacheProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@AutoConfigureAfter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">CouchbaseAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">HazelcastAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name">HibernateJpaAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">RedisAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">CacheConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">CacheManagerEntityManagerFactoryDependsOnPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CacheAutoConfiguration</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç±»ä¸»è¦æ˜¯å¯¼å…¥äº†ï¼šCacheConfigurationImportSelectorï¼Œå¯¼å…¥äº†ç¼“å­˜è¦ç”¨çš„ç»„ä»¶</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">CacheConfigurationImportSelector</span> <span class="token keyword">implements</span> <span class="token class-name">ImportSelector</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CacheType</span><span class="token punctuation">[</span><span class="token punctuation">]</span> types <span class="token operator">=</span> <span class="token class-name">CacheType</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imports <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>types<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> types<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            imports<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">CacheConfigurations</span><span class="token punctuation">.</span><span class="token function">getConfigurationClass</span><span class="token punctuation">(</span>types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> imports<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸»è¦æ˜¯å¯¼å…¥äº†è¿™å‡ ä¸ªç»„ä»¶ï¼šé»˜è®¤ä½¿ç”¨çš„æ˜¯ -- SimpleCacheConfiguration</p><figure><img src="/Computer-Science-Learn-Notes/assets/68-411b714f.png" alt="68" tabindex="0" loading="lazy"><figcaption>68</figcaption></figure><p><strong>SimpleCacheConfiguration</strong>ï¼šç»™å®¹å™¨ä¸­æ³¨å†Œäº†ä¸€ä¸ªcacheManager</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token class-name">ConcurrentMapCacheManager</span> <span class="token function">cacheManager</span><span class="token punctuation">(</span><span class="token class-name">CacheProperties</span> cacheProperties<span class="token punctuation">,</span>
                                       <span class="token class-name">CacheManagerCustomizers</span> cacheManagerCustomizers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ConcurrentMapCacheManager</span> cacheManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentMapCacheManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> cacheNames <span class="token operator">=</span> cacheProperties<span class="token punctuation">.</span><span class="token function">getCacheNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cacheNames<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cacheManager<span class="token punctuation">.</span><span class="token function">setCacheNames</span><span class="token punctuation">(</span>cacheNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> cacheManagerCustomizers<span class="token punctuation">.</span><span class="token function">customize</span><span class="token punctuation">(</span>cacheManager<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿›å…¥<strong>ConcurrentMapCacheManager</strong></p><p>cacheManagerçš„ä½œç”¨æ˜¯ï¼šé€šè¿‡è¿›å…¥<strong>createConcurrentMapCache</strong>æ–¹æ³•ï¼Œå¯çŸ¥è¿™ä¸ªä¸»è¦æ˜¯åˆ›å»ºäº†<strong>ConcurrentMapCache</strong>ç±»å‹çš„ç¼“å­˜ç»„ä»¶</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">public</span> <span class="token class-name">Cache</span> <span class="token function">getCache</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Cache</span> cache <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cacheMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cache <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cacheMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cache <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cacheMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cache <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cache <span class="token operator">=</span> <span class="token function">createConcurrentMapCache</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>cacheMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> cache<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ConcurrentMapCache</strong>çš„ä½œç”¨æ˜¯æŠŠæ•°æ®ä¿å­˜åœ¨ConcurrentMap&lt;Object, Object&gt;ä¸­ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ConcurrentMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> store<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Override</span>
<span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">lookup</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä»¥-cacheableä¸ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»¥-cacheableä¸ºä¾‹" aria-hidden="true">#</a> ä»¥@Cacheableä¸ºä¾‹</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>condition <span class="token operator">=</span> <span class="token string">&quot;#id&gt;0&quot;</span><span class="token punctuation">,</span>unless <span class="token operator">=</span> <span class="token string">&quot;#result == null&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li>æ–¹æ³•è¿è¡Œä¹‹å‰ï¼Œå…ˆå»æŸ¥è¯¢Cacheï¼ˆç¼“å­˜ç»„ä»¶ï¼‰ï¼ŒæŒ‰ç…§cacheNamesæŒ‡å®šçš„åå­—è·å–ï¼šCacheManagerå…ˆè·å–ç›¸åº”çš„ç¼“å­˜ï¼Œç¬¬ä¸€æ¬¡è·å–ç¼“å­˜ä¼šè‡ªåŠ¨åˆ›å»ºå‡ºæ¥ï¼ˆcreateConcurrentMapCache(name)ï¼‰</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">public</span> <span class="token class-name">Cache</span> <span class="token function">getCache</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/69-d41f7fe5.png" alt="69" tabindex="0" loading="lazy"><figcaption>69</figcaption></figure><ol start="2"><li>CacheæŸ¥æ‰¾ç¼“å­˜çš„å†…å®¹ï¼Œä½¿ç”¨ä¸€ä¸ªkey -- é»˜è®¤æ˜¯æ–¹æ³•çš„å‚æ•°ï¼Œ</li></ol><p>keyæ˜¯æŒ‰ç…§æŸç§ç­–ç•¥ç”Ÿæˆçš„ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨keyGenneratorç”Ÿæˆ -- é»˜è®¤ä½¿ç”¨çš„æ˜¯SimpleKeyGennerator</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// ç”Ÿæˆç­–ç•¥</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> <span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">SimpleKey</span><span class="token punctuation">.</span><span class="token constant">EMPTY</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span> param <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>param <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>param<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> param<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleKey</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>operation<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">EvaluationContext</span> evaluationContext <span class="token operator">=</span> <span class="token function">createEvaluationContext</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> evaluator<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>operation<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>methodKey<span class="token punctuation">,</span> evaluationContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>keyGenerator<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>method<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/70-8a5122dc.png" alt="70" tabindex="0" loading="lazy"><figcaption>70</figcaption></figure><p>æŸ¥è¯¢ç¼“å­˜çš„æ–¹æ³•ï¼šï¼ˆAbstractValueAdaptingCache.classï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">public</span> <span class="token class-name">ValueWrapper</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span> value <span class="token operator">=</span> <span class="token function">lookup</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">toValueWrapper</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>æ²¡æœ‰æŸ¥åˆ°ç¼“å­˜å°±è°ƒç”¨ç›®æ ‡æ–¹æ³•</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">lookup</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/71-733aba71.png" alt="71" tabindex="0" loading="lazy"><figcaption>71</figcaption></figure><ol start="4"><li>å°†ç›®æ ‡æ–¹æ³•è¿”å›çš„ç»“æœï¼Œæ”¾è¿›ç¼“å­˜ä¸­</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token function">toStoreValue</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/72-2c156747.png" alt="72" tabindex="0" loading="lazy"><figcaption>72</figcaption></figure><p>ç¬¬äºŒæ¬¡å†è®¿é—®æ—¶ï¼šlookupå’ŒgetCacheéƒ½ä¼šè¢«è®¿é—®åˆ°</p><p>lookupæ‰¾åˆ°ç¼“å­˜åä¼šè½¬åˆ° ValueWrapper get(Object key) å¾—åˆ°å€¼ï¼›</p><h3 id="å°ç»“-3" tabindex="-1"><a class="header-anchor" href="#å°ç»“-3" aria-hidden="true">#</a> å°ç»“ï¼š</h3><h4 id="æ ¸å¿ƒ" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒ" aria-hidden="true">#</a> æ ¸å¿ƒï¼š</h4><ol><li><p>ä½¿ç”¨CacheManagerï¼ˆConcurrentMapCacheManagerï¼‰æŒ‰ç…§åå­—å¾—åˆ°Cacheç»„ä»¶ï¼ˆConcurrentMapCacheï¼‰</p></li><li><p>keyä½¿ç”¨çš„æ˜¯keyGenneratorç”Ÿæˆï¼Œé»˜è®¤æ˜¯SimpleKeyGennerator</p></li><li><p>@Cacheableæ ‡æ³¨çš„æ–¹æ³•æ‰§è¡Œå‰å…ˆæ£€æŸ¥ç¼“å­˜ä¸­æœ‰æ²¡æœ‰è¿™ä¸ªæ•°æ®ï¼Œé»˜è®¤æŒ‰ç…§å‚æ•°çš„å€¼ä½œä¸ºkeyå»æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰å°±è¿è¡Œæ–¹æ³•å¹¶å°†ç»“æœæ”¾å…¥ç¼“å­˜ã€‚ ä»¥åå†æ¥è°ƒç”¨å°±ç›´æ¥ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®</p></li><li><p>SimpleKeyGenneratorç”Ÿæˆç­–ç•¥ï¼š</p></li></ol><ul><li>å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œkeyå°±ä½¿ç”¨key = new SimpleKey()</li><li>å¦‚æœæœ‰ä¸€ä¸ªå‚æ•°key=å‚æ•°çš„å€¼</li><li>å¦‚æœæœ‰å¤šä¸ªå‚æ•°key = new SimpleKey(params)</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleKeyGenerator</span> <span class="token keyword">implements</span> <span class="token class-name">KeyGenerator</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">generateKey</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/73-b6aa1cb1.png" alt="73" tabindex="0" loading="lazy"><figcaption>73</figcaption></figure><h4 id="æ€è·¯æ•´ç†" tabindex="-1"><a class="header-anchor" href="#æ€è·¯æ•´ç†" aria-hidden="true">#</a> æ€è·¯æ•´ç†</h4><p>ConcurrentMapCacheManageré€šè¿‡getCacheè·å–åˆ°nameï¼ˆkeyï¼‰</p><ol><li>ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œæ²¡æœ‰ç¼“å­˜çš„æƒ…å†µ</li></ol><p>createConcurrentMapCache -&gt; lookupæ ¹æ®key(keyæœ‰ç”Ÿæˆç­–ç•¥)æŸ¥æ‰¾ç¼“å­˜çš„æ•°æ® -&gt; è°ƒç”¨ç›®æ ‡æ–¹æ³• -&gt; æŠŠæ•°æ®æ”¾åœ¨ç¼“å­˜ï¼ˆstoreï¼‰é‡Œ(this.store.put(key, toStoreValue(value)))</p><ol start="2"><li>ç¬¬äºŒæ¬¡è®¿é—®</li></ol><figure><img src="/Computer-Science-Learn-Notes/assets/74-3992b12b.png" alt="74" tabindex="0" loading="lazy"><figcaption>74</figcaption></figure><p>Cache cache = this.cacheMap.get(name);è°ƒå›ç¼“å­˜çš„æ•°æ®-&gt; è¿”å›æ–¹æ³•</p><h2 id="cacheputçš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#cacheputçš„ä½¿ç”¨" aria-hidden="true">#</a> @CachePutçš„ä½¿ç”¨</h2><p><strong>@CachePut</strong>çš„keyå±æ€§æœ‰ä¸¤ç§å†™æ³•ï¼š</p><ul><li>key = &quot;#<a href="http://employee.id" target="_blank" rel="noopener noreferrer">employee.id<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>&quot;</li><li>key = &quot;#<a href="http://result.id" target="_blank" rel="noopener noreferrer">result.id<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>&quot;</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
     * @CachePut æ—¢è°ƒç”¨æ–¹æ³•ï¼Œåˆæ›´æ–°ç¼“å­˜
     * ä¿®æ”¹äº†æ•°æ®åº“çš„æŸä¸ªæ•°æ®ï¼ŒåŒæ—¶æ›´æ–°ç¼“å­˜
     * è¿è¡Œæ—¶æœºï¼š
     *  1. å…ˆè°ƒç”¨ç›®æ ‡æ–¹æ³•
     *  2. å°†ç›®æ ‡æ–¹æ³•çš„ç»“æœç¼“å­˜èµ·æ¥
     */</span>
    <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token string">&quot;#result.id&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">updateEmp</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
        employeeMapper<span class="token punctuation">.</span><span class="token function">updateEmp</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> employee<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ºäº†å®ç°åŒæ­¥ç¼“å­˜ï¼Œè¿™é‡Œçš„cacheNameså¯ä»¥å’ŒæŸ¥è¯¢æ–¹æ³•çš„ä¸€æ ·ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°æ›´æ–°çš„åŒæ—¶æ›´æ¢ç¼“å­˜çš„å†…å®¹ï¼Œä»è€Œè¾¾åˆ°æŸ¥è¯¢ä¹ŸåŒæ­¥ç¼“å­˜ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmp</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/75-541ef9e1.png" alt="75" tabindex="0" loading="lazy"><figcaption>75</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/76-1d215401.png" alt="76" tabindex="0" loading="lazy"><figcaption>76</figcaption></figure><h2 id="cacheevict-æ¸…é™¤ç¼“å­˜" tabindex="-1"><a class="header-anchor" href="#cacheevict-æ¸…é™¤ç¼“å­˜" aria-hidden="true">#</a> @CacheEvict æ¸…é™¤ç¼“å­˜</h2><p>@CacheEvictè¦æ¸…é™¤nameä¸ºempç¼“å­˜ä¸­keyä¸ºidçš„æ‰€æœ‰æ•°æ®</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
     * @CacheEvict ç¼“å­˜æ¸…é™¤
     * key æŒ‡å®šè¦æ¸…é™¤çš„æ•°æ®
     * allEntries è¦æ¸…é™¤è¿™ä¸ªç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®
     * beforeInvocation = false ç¼“å­˜çš„æ¸…é™¤æ˜¯å¦åœ¨æ–¹æ³•ä¹‹å‰æ‰§è¡Œï¼Œé»˜è®¤æ—¶åœ¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œ
     *      å¦‚æœå‡ºç°å¼‚å¸¸å°±ä¸ä¼šæ¸…é™¤
     */</span>
<span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;#id&quot;</span><span class="token punctuation">,</span> allEntries <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> beforeInvocation <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteEmp</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;deleteEmp:&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//        employeeMapper.deleteEmpById(id);</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cachingå’Œ-cacheconfig" tabindex="-1"><a class="header-anchor" href="#cachingå’Œ-cacheconfig" aria-hidden="true">#</a> @Cachingå’Œ@CacheConfig</h2><h3 id="caching" tabindex="-1"><a class="header-anchor" href="#caching" aria-hidden="true">#</a> @Caching</h3><p>â€‹ <strong>@Caching</strong> è¿™ä¸ªcachingå› ä¸ºä½¿ç”¨äº†**@CachePut**æ‰€ä»¥ç¬¬äºŒæ¬¡è¿˜æ˜¯ä¼šæ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœæ‰§è¡Œäº†é€šè¿‡idå’ŒemailæŸ¥è¯¢å°±åœ¨æ‰§è¡Œäº†è¿™ä¸ªæ–¹æ³•åå°±ç›´æ¥æ‰§è¡Œï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•å·²ç»ç¼“å­˜äº†è¿™ä¸ªå†…å®¹</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
     * @Caching å®šä¹‰å¤æ‚çš„ç¼“å­˜è§„åˆ™
     * <span class="token keyword">@param</span> <span class="token parameter">lastName</span>
     * <span class="token keyword">@return</span>
     */</span>
<span class="token annotation punctuation">@Caching</span><span class="token punctuation">(</span>
    cacheable <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token string">&quot;#lastName&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    put <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token string">&quot;#result.id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token string">&quot;#result.email&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmpByLastName</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpByLastName</span><span class="token punctuation">(</span>lastName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cacheconfig" tabindex="-1"><a class="header-anchor" href="#cacheconfig" aria-hidden="true">#</a> @CacheConfig</h3><p>ä½¿ç”¨äº†è¿™ä¸ªç›´æ¥ä¹‹åï¼Œä¹‹åçš„æ‰€æœ‰æ³¨è§£ï¼ˆ@Cacheableã€@CachePutï¼‰å°±ä¸ç”¨å†™å·²ç»åœ¨@CacheConfigä¸­å†™äº†çš„å±æ€§</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@CacheConfig</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">)</span> <span class="token comment">//æŠ½å–ç¼“å­˜çš„å…¬å…±é…ç½®</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeService</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ•´åˆç¼“å­˜ä¸­é—´ä»¶redis" tabindex="-1"><a class="header-anchor" href="#æ•´åˆç¼“å­˜ä¸­é—´ä»¶redis" aria-hidden="true">#</a> æ•´åˆç¼“å­˜ä¸­é—´ä»¶Redis</h2><p>å¯¼åŒ…ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®Redisï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 127.0.0.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¦æ˜¯æœ‰Redisçš„åœ°æ–¹æ³¨å…¥redisï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span> <span class="token comment">// æ“ä½œå­—ç¬¦ä¸²</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">;</span> <span class="token comment">// k-væ“ä½œå¯¹è±¡</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›´æ¥ä½¿ç”¨Redisç±»å‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> msg <span class="token operator">=</span> ops<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡ªå®šä¹‰Redisç±»å‹ï¼ˆJSONç±»å‹ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRedisConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token function">empRedisTemplate</span><span class="token punctuation">(</span>
            <span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> redisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setDefaultSerializer</span><span class="token punctuation">(</span>redisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå°±å¯ä»¥æ³¨å…¥è¿™ä¸ªè‡ªå®šä¹‰çš„ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employeeRedisTemplate<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Employee</span> emp <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpById</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> employeeRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ops<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/77-4dfb1413.png" alt="77" tabindex="0" loading="lazy"><figcaption>77</figcaption></figure><h2 id="è‡ªå®šä¹‰rediscachemanager" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰rediscachemanager" aria-hidden="true">#</a> è‡ªå®šä¹‰RedisCacheManager</h2><p>åœ¨é…ç½®ç±»ä¸­ç›´æ¥æ·»åŠ å³å¯ï¼šå®ç°åºåˆ—åŒ–è½¬ä¸ºJSONæ ¼å¼</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
     * ç¼“å­˜ç®¡ç†å™¨
     */</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">CacheManager</span> <span class="token function">cacheManager</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//åˆå§‹åŒ–ä¸€ä¸ªRedisCacheWriter</span>
    <span class="token class-name">RedisCacheWriter</span> redisCacheWriter <span class="token operator">=</span> <span class="token class-name">RedisCacheWriter</span><span class="token punctuation">.</span><span class="token function">nonLockingRedisCacheWriter</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¾ç½®CacheManagerçš„å€¼åºåˆ—åŒ–æ–¹å¼ä¸ºjsonåºåˆ—åŒ–</span>
    <span class="token class-name">RedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> jsonSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> pair <span class="token operator">=</span> <span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span>
        <span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>jsonSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RedisCacheConfiguration</span> defaultCacheConfig<span class="token operator">=</span> <span class="token class-name">RedisCacheConfiguration</span><span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">serializeValuesWith</span><span class="token punctuation">(</span>pair<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¾ç½®é»˜è®¤è¶…è¿‡æœŸæ—¶é—´æ˜¯30ç§’</span>
    defaultCacheConfig<span class="token punctuation">.</span><span class="token function">entryTtl</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆå§‹åŒ–RedisCacheManager</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RedisCacheManager</span><span class="token punctuation">(</span>redisCacheWriter<span class="token punctuation">,</span> defaultCacheConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/78-94fd2ecb.png" alt="78" tabindex="0" loading="lazy"><figcaption>78</figcaption></figure><p>æœ‰ä¸¤ç§è°ƒç”¨æ–¹å¼ï¼š</p><p>ç¬¬ä¸€ç§å°±æ˜¯å¸¸ç”¨çš„æ³¨è§£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">&quot;dept&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Department</span> <span class="token function">getDeptById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢éƒ¨é—¨&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Department</span> department <span class="token operator">=</span> departmentMapper<span class="token punctuation">.</span><span class="token function">getDeptById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> department<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬¬äºŒç§æ˜¯æ³¨å…¥CacheManageråå¾—åˆ°ç¼“å­˜ï¼Œè¿›è¡ŒAPIè°ƒç”¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">CacheManager</span> cacheManager<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">Department</span> <span class="token function">getDeptById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢éƒ¨é—¨&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Department</span> department <span class="token operator">=</span> departmentMapper<span class="token punctuation">.</span><span class="token function">getDeptById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Cache</span> dept <span class="token operator">=</span> cacheManager<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&quot;dept&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dept<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> department<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> department<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/79-bdf4e687.png" alt="79" tabindex="0" loading="lazy"><figcaption>79</figcaption></figure><h4 id="æ‰©å±•cachemanagerçš„ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•cachemanagerçš„ç”¨æ³•" aria-hidden="true">#</a> æ‰©å±•CacheManagerçš„ç”¨æ³•</h4><p>åˆ¤æ–­åœ¨Redisä¸­æ˜¯å¦å­˜åœ¨è¿™ä¸ªnosqlï¼Œå¦‚æœæœ‰å°±ç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œä¸æŸ¥æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰å°±æŸ¥æ•°æ®åº“ç¼“å­˜æ•°æ®ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Department</span> <span class="token function">getDeptById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Department</span> dp<span class="token punctuation">;</span>
    <span class="token class-name">Cache</span> dept <span class="token operator">=</span> cacheManager<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&quot;dept&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dp <span class="token operator">=</span> dept<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Department</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dp <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dp <span class="token operator">=</span> departmentMapper<span class="token punctuation">.</span><span class="token function">getDeptById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dept<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> dp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="springsecurityçš„ç®€å•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#springsecurityçš„ç®€å•ä½¿ç”¨" aria-hidden="true">#</a> SpringSecurityçš„ç®€å•ä½¿ç”¨</h2><p>å¯¼åŒ…ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å»ºç«‹ä¸€ä¸ªé…ç½®ç±»ï¼š</p><p>@EnableWebSecurity å¼€å¯å®‰å…¨é…ç½®ï¼Œå®ƒé‡Œé¢æœ‰@Configuration</p><p>ç»§æ‰¿ï¼š WebSecurityConfigurerAdapter</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@EnableWebSecurity
public class MySecurityConfig extends WebSecurityConfigurerAdapter {
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å®šä¹‰æˆæƒè§„åˆ™å’Œå®šä¹‰è®¤è¯è§„åˆ™</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// å®šä¹‰æˆæƒè§„åˆ™
@Override
protected void configure(HttpSecurity http) throws Exception {
    //        super.configure(http);
    // å®šåˆ¶æˆæƒè§„åˆ™
    http.authorizeRequests().antMatchers(&quot;/&quot;).permitAll()
        .antMatchers(&quot;/level1/**&quot;).hasRole(&quot;VIP1&quot;)
        .antMatchers(&quot;/level2/**&quot;).hasRole(&quot;VIP2&quot;)
        .antMatchers(&quot;/level3/**&quot;).hasRole(&quot;VIP3&quot;);
    // å¼€å¯è‡ªåŠ¨é…ç½®çš„ç™»å½•åŠŸèƒ½
    // /loginæ¥åˆ°ç™»å½•é¡µ
    // é‡å®šå‘åˆ°/login/errorç™»å½•å¤±è´¥
    // å¦‚æœæ²¡æœ‰ç™»å½•æƒé™å°±ä¼šæ¥åˆ°ç™»å½•é¡µé¢
    http.formLogin();
    // å¼€å¯è‡ªåŠ¨é…ç½®çš„æ³¨é”€åŠŸèƒ½
    // è®¿é—®/loginæ³¨é”€ç”¨æˆ·ï¼Œæ¸…ç©ºsession
    // æ³¨é”€æˆåŠŸä¼šè¿”å›/login?logout
    http.logout().logoutSuccessUrl(&quot;/&quot;);
}
// å®šä¹‰è®¤è¯è§„åˆ™
@Override
protected void configure(AuthenticationManagerBuilder auth) throws Exception {
    //super.configure(auth);
    auth.inMemoryAuthentication().passwordEncoder(NoOpPasswordEncoder.getInstance())
        .withUser(&quot;admin&quot;).password(&quot;123&quot;).roles(&quot;VIP1&quot;,&quot;VIP2&quot;)
        .and()
        .withUser(&quot;lisi&quot;).password(&quot;123&quot;).roles(&quot;VIP2&quot;, &quot;VIP3&quot;)
        .and()
        .withUser(&quot;zhiyu&quot;).password(&quot;123&quot;).roles(&quot;VIP1&quot;, &quot;VIP3&quot;);
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="thymeleafæ•´åˆspringsecurity" tabindex="-1"><a class="header-anchor" href="#thymeleafæ•´åˆspringsecurity" aria-hidden="true">#</a> Thymeleafæ•´åˆSpringSecurity</h3><p>å¯¼åŒ…ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.thymeleaf.extras<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>thymeleaf-extras-springsecurity5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å‰ç«¯åŠ å…¥é¢å¤–çš„xmlnsï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>th</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.thymeleaf.org<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name"><span class="token namespace">xmlns:</span>sec</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.thymeleaf.org/extras/spring-security<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ¤å®šæ˜¯å¦æˆæƒäº†ï¼š<strong>sec:authorize=&quot;!isAuthenticated()&quot;</strong></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">sec:</span>authorize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!isAuthenticated()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æ¸¸å®¢æ‚¨å¥½ï¼Œå¦‚æœæƒ³æŸ¥çœ‹æ­¦æ—ç§˜ç± <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/login}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>è¯·ç™»å½•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è·å–æˆæƒåï¼š<strong>sec:authentication=&quot;name&quot;</strong></li><li>è·å–æˆæƒçš„æƒé™åï¼š<strong>sec:authentication=&quot;principal.authorities&quot;</strong></li><li>æ³¨é”€ç™»å½•ï¼š<strong>th:action=&quot;@{/logout}&quot;</strong></li><li>åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¿™ä¸ªæƒé™ï¼š<strong>sec:authorize=&quot;hasRole(&#39;æƒé™åå­—&#39;)&quot;</strong></li></ul><h3 id="è®°ä½æˆ‘" tabindex="-1"><a class="header-anchor" href="#è®°ä½æˆ‘" aria-hidden="true">#</a> <strong>è®°ä½æˆ‘</strong></h3><p>ç›´æ¥åœ¨æˆæƒè§„åˆ™çš„configureé…ç½®å³å¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// å¼€å¯è®°ä½æˆ‘åŠŸèƒ½</span>
<span class="token comment">// ç™»å½•æˆåŠŸå°†cookieå‘ç»™æµè§ˆå™¨ä¿å­˜ï¼Œä»¥åç™»å½•å°±ä¼šå¸¦ä¸Šè¿™ä¸ªcookie(14å¤©)</span>
http<span class="token punctuation">.</span><span class="token function">rememberMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢" tabindex="-1"><a class="header-anchor" href="#å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢" aria-hidden="true">#</a> å®šåˆ¶è‡ªå·±çš„ç™»å½•é¡µé¢</h3><p>ç›´æ¥åœ¨æˆæƒè§„åˆ™çš„configureé…ç½®ï¼Œ</p><p>å‰ç«¯ä½¿ç”¨postæ–¹å¼ï¼šå¤„ç†å‡­æ®ï¼Œå¦‚æœæœ‰æ•ˆï¼Œåˆ™å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯</p><p>ä½¿ç”¨getï¼šå¤„ç†ç™»å½•è¡¨æ ¼</p><p>å¦‚æœactionå®šä½åˆ°userlogin/errorï¼Œæ–¹æ³•getï¼šé‡å®šå‘åˆ°æ­¤å¤„ä»¥è¿›è¡Œå¤±è´¥çš„èº«ä»½éªŒè¯å°è¯•</p><p>å¦‚æœactionå®šä½åˆ°userlogin/logoutï¼Œæ–¹æ³•getï¼šæˆåŠŸæ³¨é”€åé‡å®šå‘åˆ°æ­¤å¤„</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>http<span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">usernameParameter</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordParameter</span><span class="token punctuation">(</span><span class="token string">&quot;pwd&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span><span class="token string">&quot;/userlogin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤postè¯·æ±‚çš„/loginæ˜¯å¤„ç†ç™»å½•</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name"><span class="token namespace">th:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/userlogin}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            ç”¨æˆ·å:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
            å¯†ç :<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pwd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> è®°ä½æˆ‘ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç™»é™†<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="shiroçš„ç®€å•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#shiroçš„ç®€å•ä½¿ç”¨" aria-hidden="true">#</a> Shiroçš„ç®€å•ä½¿ç”¨</h2><p>Shiroçš„åŠŸèƒ½æ¡†æ¶å›¾ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/80-de8cc043.png" alt="80" tabindex="0" loading="lazy"><figcaption>80</figcaption></figure><p>å¯¼åŒ…ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.shiro<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>shiro-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.4.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ç¯å¢ƒè®¾ç½®ï¼ˆçœç•¥è·³è½¬ç½‘é¡µçš„controllerï¼‰ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/81-abde2017.png" alt="81" tabindex="0" loading="lazy"><figcaption>81</figcaption></figure><p>æ³¨ï¼šä½¿ç”¨Thymeleafæ¨¡æ¿çš„æ—¶å€™éœ€è¦ç”¨åˆ°è·³è½¬é¡µé¢@{}æ³¨æ„ï¼Œå¦‚ï¼šth:href=&quot;@{/alogin}&quot;ï¼Œé‡Œé¢å†…å®¹éœ€è¦æ˜¯controllerçš„å†…å®¹</p><h3 id="å¼€å§‹é…ç½®ä¸€ä¸ªshiro" tabindex="-1"><a class="header-anchor" href="#å¼€å§‹é…ç½®ä¸€ä¸ªshiro" aria-hidden="true">#</a> å¼€å§‹é…ç½®ä¸€ä¸ªshiro</h3><p>Shiro æ¶æ„åŒ…å«ä¸‰ä¸ªä¸»è¦çš„ç†å¿µï¼šSubject è®¤è¯ä¸»ä½“ï¼ŒSecurityManager å®‰å…¨ç®¡ç†å™¨å’Œ Realm åŸŸå¯¹è±¡</p><ul><li>ShiroFilterFactoryBean ShiroFilteræ˜¯æ•´ä¸ªShiroçš„å…¥å£ç‚¹ï¼Œç”¨äºæ‹¦æˆªéœ€è¦å®‰å…¨æ§åˆ¶çš„è¯·æ±‚è¿›è¡Œå¤„ç†</li><li>DefaultWebSecurityManager å®‰å…¨ç®¡ç†å™¨</li><li>Realm åŸŸå¯¹è±¡</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShiroConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">ShiroFilterFactoryBean</span> <span class="token function">shiroFilterFactoryBean</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;securityManager&quot;</span><span class="token punctuation">)</span> <span class="token class-name">DefaultWebSecurityManager</span> securityManager<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ShiroFilterFactoryBean</span> bean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ShiroFilterFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setSecurityManager</span><span class="token punctuation">(</span>securityManager<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®æ— æƒé™æ—¶è·³è½¬çš„ url;</span>
        shiroFilterFactoryBean<span class="token punctuation">.</span><span class="token function">setUnauthorizedUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/notRole&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * anon
         * æ— å‚ï¼Œå¼€æ”¾æƒé™ï¼Œå¯ä»¥ç†è§£ä¸ºåŒ¿åç”¨æˆ·æˆ–æ¸¸å®¢
         * authc
         * æ— å‚ï¼Œéœ€è¦è®¤è¯
         * logout
         * æ— å‚ï¼Œæ³¨é”€ï¼Œæ‰§è¡Œåä¼šç›´æ¥è·³è½¬åˆ°shiroFilterFactoryBean.setLoginUrl(); è®¾ç½®çš„ url
         * authcBasic
         * æ— å‚ï¼Œè¡¨ç¤º httpBasic è®¤è¯
         * user
         * æ— å‚ï¼Œè¡¨ç¤ºå¿…é¡»å­˜åœ¨ç”¨æˆ·ï¼Œå½“ç™»å…¥æ“ä½œæ—¶ä¸åšæ£€æŸ¥
         * ssl
         * æ— å‚ï¼Œè¡¨ç¤ºå®‰å…¨çš„URLè¯·æ±‚ï¼Œåè®®ä¸º https
         * perms[user]
         * å‚æ•°å¯å†™å¤šä¸ªï¼Œè¡¨ç¤ºéœ€è¦æŸä¸ªæˆ–æŸäº›æƒé™æ‰èƒ½é€šè¿‡ï¼Œå¤šä¸ªå‚æ•°æ—¶å†™ perms[&quot;user, admin&quot;]ï¼Œå½“æœ‰å¤šä¸ªå‚æ•°æ—¶å¿…é¡»æ¯ä¸ªå‚æ•°éƒ½é€šè¿‡æ‰ç®—é€šè¿‡
         * roles[admin]
         * å‚æ•°å¯å†™å¤šä¸ªï¼Œè¡¨ç¤ºæ˜¯æŸä¸ªæˆ–æŸäº›è§’è‰²æ‰èƒ½é€šè¿‡ï¼Œå¤šä¸ªå‚æ•°æ—¶å†™ roles[&quot;adminï¼Œuser&quot;]ï¼Œå½“æœ‰å¤šä¸ªå‚æ•°æ—¶å¿…é¡»æ¯ä¸ªå‚æ•°éƒ½é€šè¿‡æ‰ç®—é€šè¿‡
         * rest[user]
         * æ ¹æ®è¯·æ±‚çš„æ–¹æ³•ï¼Œç›¸å½“äº perms[user:method]ï¼Œå…¶ä¸­ method ä¸º postï¼Œgetï¼Œdelete ç­‰
         * port[8081]
         * å½“è¯·æ±‚çš„URLç«¯å£ä¸æ˜¯8081æ—¶ï¼Œè·³è½¬åˆ°schemal://serverName:8081?queryString å…¶ä¸­ schmal æ˜¯åè®® http æˆ– https ç­‰ç­‰ï¼ŒserverName æ˜¯ä½ è®¿é—®çš„ Hostï¼Œ8081 æ˜¯ Port ç«¯å£ï¼ŒqueryString æ˜¯ä½ è®¿é—®çš„ URL é‡Œçš„ ? åé¢çš„å‚æ•°
         */</span>
        <span class="token comment">// è®¾ç½®æ‹¦æˆªå™¨</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> filterMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filterMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;anon&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filterMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;/alogin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;perms[user:add]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filterMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;/ulogin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;authc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setFilterChainDefinitionMap</span><span class="token punctuation">(</span>filterMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">setLoginUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">DefaultWebSecurityManager</span> <span class="token function">securityManager</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;userRealm&quot;</span><span class="token punctuation">)</span> <span class="token class-name">UserRealm</span> userRealm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DefaultWebSecurityManager</span> securityManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultWebSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        securityManager<span class="token punctuation">.</span><span class="token function">setRealm</span><span class="token punctuation">(</span>userRealm<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> securityManager<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">UserRealm</span> <span class="token function">userRealm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">UserRealm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åŸŸå¯¹è±¡</strong>çš„åˆ›å»º</p><ul><li>ç»§æ‰¿AuthorizingRealm</li><li>ä¸»è¦åˆ†ä¸ºï¼šæˆæƒå’Œè®¤è¯</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserRealm</span> <span class="token keyword">extends</span> <span class="token class-name">AuthorizingRealm</span> <span class="token punctuation">{</span>
    <span class="token comment">// æˆæƒ</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">AuthorizationInfo</span> <span class="token function">doGetAuthorizationInfo</span><span class="token punctuation">(</span><span class="token class-name">PrincipalCollection</span> principals<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰§è¡Œäº†æˆæƒ...........&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleAuthorizationInfo</span> info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAuthorizationInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åªè¦ç™»å½•å°±æœ‰æƒé™</span>
<span class="token comment">//        info.addStringPermission(&quot;user:add&quot;);</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span>  <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> principals<span class="token punctuation">.</span><span class="token function">getPrimaryPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> role <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">getRole</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//éœ€è¦å°† role å°è£…åˆ° Set ä½œä¸º info.setRoles() çš„å‚æ•°</span>
        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®è¯¥ç”¨æˆ·æ‹¥æœ‰çš„è§’è‰²</span>
        <span class="token comment">//å°†ç”¨æˆ·å¯¹åº”çš„è§’è‰²å’Œæƒé™ä¿¡æ¯ æ”¾åˆ°æƒé™å™¨ä¸­</span>
        info<span class="token punctuation">.</span><span class="token function">addStringPermissions</span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
        info<span class="token punctuation">.</span><span class="token function">setRoles</span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> info<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// è®¤è¯</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">AuthenticationInfo</span> <span class="token function">doGetAuthenticationInfo</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationToken</span> token<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AuthenticationException</span> <span class="token punctuation">{</span>
       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰§è¡Œäº†è®¤è¯............&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        ä¸€èˆ¬åœ¨æ•°æ®åº“ä¸­å–è´¦å·å’Œå¯†ç </span>
        <span class="token class-name">UsernamePasswordToken</span> userToken <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">)</span> token<span class="token punctuation">;</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> userToken<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">getUserByName</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">// SimpleAuthenticationInfoå‚æ•°ï¼š</span>
        <span class="token comment">// principle è®¤è¯å®ä½“ï¼Œå¯ä»¥æ˜¯usernameï¼Œä¹Ÿå¯ä»¥æ˜¯å®ä½“ç±»</span>
        <span class="token comment">// credentials å¯†ç </span>
        <span class="token comment">// realmName å½“å‰realmå¯¹è±¡çš„nameï¼Œç›´æ¥è°ƒç”¨çˆ¶ç±»çš„getNameæ–¹æ³•å³å¯</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAuthenticationInfo</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨æ§åˆ¶å±‚çš„è¯·æ±‚æŠŠæ•°æ®ä¼ è¾“ç»™Shiroå’Œæ³¨é”€</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/loginAuth&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">loginAuth</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathParam</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span>
                        <span class="token annotation punctuation">@PathParam</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span>
                        <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–å½“å‰ç”¨æˆ·</span>
    <span class="token class-name">Subject</span> subject <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å°è£…ç”¨æˆ·çš„æ•°æ®</span>
    <span class="token class-name">UsernamePasswordToken</span> token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ‰§è¡Œç™»å½•çš„æ–¹æ³•</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        subject<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnknownAccountException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç”¨æˆ·åé”™è¯¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IncorrectCredentialsException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¯†ç é”™è¯¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/logout&quot;</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span><span class="token constant">GET</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResultMap</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Subject</span> subject <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ³¨é”€</span>
    subject<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> resultMap<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token string">&quot;æˆåŠŸæ³¨é”€ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ•´åˆshiroå¯åŠ¨å™¨" tabindex="-1"><a class="header-anchor" href="#æ•´åˆshiroå¯åŠ¨å™¨" aria-hidden="true">#</a> æ•´åˆShiroå¯åŠ¨å™¨</h3><p>å¯¼åŒ…ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.shiro<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>shiro-spring-boot-web-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.4.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é¡¹ç›®ç»“æ„ï¼šå’Œsecurityæµ‹è¯•çš„æ—¶å€™ä¸€è‡´</p><figure><img src="/Computer-Science-Learn-Notes/assets/82-1a8f2cc3.png" alt="82" tabindex="0" loading="lazy"><figcaption>82</figcaption></figure><p>åŒæ ·çš„é…ç½®ç±»ï¼šï¼ˆåŠ å…¥äº†MD5ç›å€¼åŠ å¯†ç®—æ³•ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShiroConfig</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®¾ç½®ç”¨äºåŒ¹é…å¯†ç çš„CredentialsMatcher</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">HashedCredentialsMatcher</span> <span class="token function">credentialsMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">HashedCredentialsMatcher</span> credentialsMatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashedCredentialsMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è¿™é‡Œæ˜¯ä½¿ç”¨sha256åŠ å¯†</span>
        <span class="token comment">/*credentialsMatcher.setHashAlgorithmName(Sha256Hash.ALGORITHM_NAME);  // æ•£åˆ—ç®—æ³•ï¼Œè¿™é‡Œä½¿ç”¨æ›´å®‰å…¨çš„sha256ç®—æ³•
        credentialsMatcher.setStoredCredentialsHexEncoded(false);  // æ•°æ®åº“å­˜å‚¨çš„å¯†ç å­—æ®µä½¿ç”¨HEXè¿˜æ˜¯BASE64æ–¹å¼åŠ å¯†
        credentialsMatcher.setHashIterations(1024);  // æ•£åˆ—è¿­ä»£æ¬¡æ•°*/</span>
        <span class="token comment">//å¦‚æœMD5å¯†ç åŠ å¯†,å¯ä»¥æ‰“å¼€ä¸‹é¢é…ç½®</span>
        <span class="token comment">//åŠ å¯†ç®—æ³•çš„åç§°</span>
        credentialsMatcher<span class="token punctuation">.</span><span class="token function">setHashAlgorithmName</span><span class="token punctuation">(</span><span class="token string">&quot;MD5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é…ç½®åŠ å¯†çš„æ¬¡æ•°</span>
        credentialsMatcher<span class="token punctuation">.</span><span class="token function">setHashIterations</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ˜¯å¦å­˜å‚¨ä¸º16è¿›åˆ¶</span>
        credentialsMatcher<span class="token punctuation">.</span><span class="token function">setStoredCredentialsHexEncoded</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> credentialsMatcher<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// é…ç½®urlè¿‡æ»¤å™¨</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">ShiroFilterChainDefinition</span> <span class="token function">shiroFilterChainDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DefaultShiroFilterChainDefinition</span> filter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultShiroFilterChainDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filter<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/level1/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;perms[st:vip1]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filter<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/level2/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;perms[st:vip2]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filter<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/level3/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;perms[st:vip3]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filter<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;anon&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filter<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;anon&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> filter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">DefaultWebSecurityManager</span> <span class="token function">securityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DefaultWebSecurityManager</span> manager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultWebSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        manager<span class="token punctuation">.</span><span class="token function">setRealm</span><span class="token punctuation">(</span><span class="token function">userRealm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> manager<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// é…ç½®è‡ªå®šä¹‰Realm</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">UserRealm</span> <span class="token function">userRealm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserRealm</span> userRealm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserRealm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userRealm<span class="token punctuation">.</span><span class="token function">setCredentialsMatcher</span><span class="token punctuation">(</span><span class="token function">credentialsMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> userRealm<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®¤è¯å’Œæˆæƒï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserRealm</span> <span class="token keyword">extends</span> <span class="token class-name">AuthorizingRealm</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">UserMapper</span> userMapper<span class="token punctuation">;</span>
<span class="token comment">//    æˆæƒ</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">AuthorizationInfo</span> <span class="token function">doGetAuthorizationInfo</span><span class="token punctuation">(</span><span class="token class-name">PrincipalCollection</span> principals<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æˆæƒ........................&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleAuthorizationInfo</span> authorizationInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAuthorizationInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§’è‰²</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> roles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æƒé™</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> permissions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æµ‹è¯•ç”¨æƒé™</span>
        <span class="token class-name">String</span> role <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">getRole</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        roles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        permissions<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span>
        authorizationInfo<span class="token punctuation">.</span><span class="token function">setRoles</span><span class="token punctuation">(</span>roles<span class="token punctuation">)</span><span class="token punctuation">;</span>
        authorizationInfo<span class="token punctuation">.</span><span class="token function">setStringPermissions</span><span class="token punctuation">(</span>permissions<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> authorizationInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//    è®¤è¯</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">AuthenticationInfo</span> <span class="token function">doGetAuthenticationInfo</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationToken</span> token<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AuthenticationException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¤è¯........................&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> token<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">getUserByName</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnknownAccountException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token comment">//        MD5ç›å€¼åŠ å¯†ByteSource.Util.bytes(username)</span>
        <span class="token class-name">SimpleAuthenticationInfo</span> authenticationInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAuthenticationInfo</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">ByteSource<span class="token punctuation">.</span>Util</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> authenticationInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ§åˆ¶å±‚åˆ¤æ–­ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/loginAuth&quot;</span><span class="token punctuation">,</span>method <span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">loginAuth</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathParam</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span>
                        <span class="token annotation punctuation">@PathParam</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span>
                        <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–å½“å‰ç”¨æˆ·</span>
    <span class="token class-name">Subject</span> subject <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å°è£…ç”¨æˆ·çš„æ•°æ®</span>
    <span class="token class-name">UsernamePasswordToken</span> token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ‰§è¡Œç™»å½•çš„æ–¹æ³•</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        subject<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;welcome&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnknownAccountException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç”¨æˆ·åé”™è¯¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token constant">PREFIX</span><span class="token operator">+</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IncorrectCredentialsException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¯†ç é”™è¯¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token constant">PREFIX</span><span class="token operator">+</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ‰©å±•" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•" aria-hidden="true">#</a> æ‰©å±•ï¼š</h3><h4 id="shiroé»˜è®¤è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#shiroé»˜è®¤è¿‡æ»¤å™¨" aria-hidden="true">#</a> shiroé»˜è®¤è¿‡æ»¤å™¨</h4><ul><li>anon AnonymousFilter æŒ‡å®šurlå¯ä»¥åŒ¿åè®¿é—®</li><li>authc FormAuthenticationFilter æŒ‡å®šurléœ€è¦formè¡¨å•ç™»å½•ï¼Œé»˜è®¤ä¼šä»è¯·æ±‚ä¸­è·å–usernameã€password,rememberMeç­‰å‚æ•°å¹¶å°è¯•ç™»å½•ï¼Œå¦‚æœç™»å½•ä¸äº†å°±ä¼šè·³è½¬åˆ°loginUrlé…ç½®çš„è·¯å¾„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªè¿‡æ»¤å™¨åšé»˜è®¤çš„ç™»å½•é€»è¾‘ï¼Œä½†æ˜¯ä¸€èˆ¬éƒ½æ˜¯æˆ‘ä»¬è‡ªå·±åœ¨æ§åˆ¶å™¨å†™ç™»å½•é€»è¾‘çš„ï¼Œè‡ªå·±å†™çš„è¯å‡ºé”™è¿”å›çš„ä¿¡æ¯éƒ½å¯ä»¥å®šåˆ¶å˜›ã€‚</li><li>authcBasic BasicHttpAuthenticationFilter æŒ‡å®šurléœ€è¦basicç™»å½•</li><li>logout LogoutFilter ç™»å‡ºè¿‡æ»¤å™¨ï¼Œé…ç½®æŒ‡å®šurlå°±å¯ä»¥å®ç°é€€å‡ºåŠŸèƒ½ï¼Œéå¸¸æ–¹ä¾¿</li><li>noSessionCreation NoSessionCreationFilter ç¦æ­¢åˆ›å»ºä¼šè¯</li><li>perms PermissionsAuthorizationFilter éœ€è¦æŒ‡å®šæƒé™æ‰èƒ½è®¿é—®</li><li>port PortFilter éœ€è¦æŒ‡å®šç«¯å£æ‰èƒ½è®¿é—®</li><li>rest HttpMethodPermissionFilter å°†httpè¯·æ±‚æ–¹æ³•è½¬åŒ–æˆç›¸åº”çš„åŠ¨è¯æ¥æ„é€ ä¸€ä¸ªæƒé™å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæ„Ÿè§‰æ„ä¹‰ä¸å¤§ï¼Œæœ‰å…´è¶£è‡ªå·±çœ‹æºç çš„æ³¨é‡Š</li><li>roles RolesAuthorizationFilter éœ€è¦æŒ‡å®šè§’è‰²æ‰èƒ½è®¿é—®</li><li>ssl SslFilter éœ€è¦httpsè¯·æ±‚æ‰èƒ½è®¿é—®</li><li>user UserFilter éœ€è¦å·²ç™»å½•æˆ–â€œè®°ä½æˆ‘â€çš„ç”¨æˆ·æ‰èƒ½è®¿é—®</li></ul><h4 id="shiroå¸¸ç”¨çš„æƒé™æ§åˆ¶æ³¨è§£-å¯ä»¥åœ¨æ§åˆ¶å™¨ç±»ä¸Šä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#shiroå¸¸ç”¨çš„æƒé™æ§åˆ¶æ³¨è§£-å¯ä»¥åœ¨æ§åˆ¶å™¨ç±»ä¸Šä½¿ç”¨" aria-hidden="true">#</a> shiroå¸¸ç”¨çš„æƒé™æ§åˆ¶æ³¨è§£ï¼Œå¯ä»¥åœ¨æ§åˆ¶å™¨ç±»ä¸Šä½¿ç”¨</h4><ul><li>@RequiresGuest åªæœ‰æ¸¸å®¢å¯ä»¥è®¿é—®</li><li>@RequiresAuthentication éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®</li><li>@RequiresUser å·²ç™»å½•çš„ç”¨æˆ·æˆ–â€œè®°ä½æˆ‘â€çš„ç”¨æˆ·èƒ½è®¿é—®</li><li>@RequiresRoles å·²ç™»å½•çš„ç”¨æˆ·éœ€å…·æœ‰æŒ‡å®šçš„è§’è‰²æ‰èƒ½è®¿é—®</li><li>@RequiresPermissions å·²ç™»å½•çš„ç”¨æˆ·éœ€å…·æœ‰æŒ‡å®šçš„æƒé™æ‰èƒ½è®¿é—®</li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes/edit/main/demo/theme-docs/src/Java/fm/SpringBoot.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 542716863@qq.com">RrOrange</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/Computer-Science-Learn-Notes/Java/fm/Mybatis.html" class="nav-link prev" aria-label="Mybatis"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Mybatis</div></a><a href="/Computer-Science-Learn-Notes/Java/fm/SpringDataJpa.html" class="nav-link next" aria-label="SpringDataJpa"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">SpringDataJpa<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">é»˜è®¤é¡µè„š</div><div class="copyright">Copyright Â© 2023 zhiyu1998</div></footer></div><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/Computer-Science-Learn-Notes/assets/app-a3377c6a.js" defer></script>
  </body>
</html>
