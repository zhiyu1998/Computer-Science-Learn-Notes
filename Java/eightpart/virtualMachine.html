<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html"><meta property="og:title" content="JVM"><meta property="og:description" content="â™»ï¸ JVM å›å¿†å¤§çº²å›¾ï¼ˆæ”¾å¤§çœ‹å›å¿†çš„æ›´åŠ æ¸…æ¥šå™¢ï¼‰ JVMç®€åŒ–ç‰ˆæ¶æ„ å›¾è§£JVMç»“æ„ æ•´ä½“æ¶æ„å›¾ï¼šå»ºè®®é»˜å†™ image-20220629110459744 ç¨‹åºè®¡æ•°å™¨ ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€..."><meta property="og:type" content="article"><meta property="og:image" content="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-04-04T17:31:51.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="JVM"><meta property="article:author" content="zhiyu1998"><meta property="article:modified_time" content="2023-04-04T17:31:51.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"JVM","image":["https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/"],"dateModified":"2023-04-04T17:31:51.000Z","author":[{"@type":"Person","name":"zhiyu1998"}]}</script><title>JVM</title><meta name="description" content="â™»ï¸ JVM å›å¿†å¤§çº²å›¾ï¼ˆæ”¾å¤§çœ‹å›å¿†çš„æ›´åŠ æ¸…æ¥šå™¢ï¼‰ JVMç®€åŒ–ç‰ˆæ¶æ„ å›¾è§£JVMç»“æ„ æ•´ä½“æ¶æ„å›¾ï¼šå»ºè®®é»˜å†™ image-20220629110459744 ç¨‹åºè®¡æ•°å™¨ ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/Computer-Science-Learn-Notes/assets/style-0f2cd90d.css" as="style"><link rel="stylesheet" href="/Computer-Science-Learn-Notes/assets/style-0f2cd90d.css">
    <link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/app-704f16ef.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/framework-afce0fe7.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/virtualMachine.html-30e4851b.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/virtualMachine.html-c1769886.js"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-ab9663f9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/slides.html-5dd0d534.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/datastruct.html-0b366c34.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/learnInProblem.html-29ed48eb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-05aed989.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/disable.html-a65c957b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/encrypt.html-54a2a05d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/markdown.html-092b7105.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/page.html-d1821179.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/personal_tech.html-6a099bc1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/rent_house.html-121b75a0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/basic.html-e21de5f9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/concurrent.html-9e969ecd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/concurrency.html-d36ae9ad.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/datastruct.html-00f05c63.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/distribution.html-c9397e0a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/foundation.html-f17c724a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/giant.html-fb88033d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/intelligenceQuestion.html-0db69bea.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/intro.html-48b86b17.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/messageQueue.html-c1470cb2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/mysql.html-9cdb2e0d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/netty.html-819912fe.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/network.html-5632afff.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/redis.html-ccff1a83.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/spring.html-f59db907.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/system.html-77d46565.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/think.html-de4f58af.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/Mybatis.html-4f954aee.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/Spring.html-f958657f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringBoot.html-186bac63.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringCloud.html-4a751517.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringDataJpa.html-3648c630.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringMVC.html-d9ed0d58.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringSecurity.html-dde21f89.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/kotlin.html-5250b61c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/leetcode.html-7365ad38.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/react.html-e3471192.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/typescript.html-961e90d9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/vue.html-d7a01c8f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/1.ç®€ä»‹.html-a313effb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10.å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½.html-836aa2e2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/11.ç›´æ¥å†…å­˜.html-39b43609.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/12.æ‰§è¡Œå¼•æ“.html-b5a5519e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/13.StringTable.html-7450521a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/14.åƒåœ¾å›æ”¶æ¦‚è¿°.html-8c5cedbe.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/15.åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•.html-12102677.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/16.åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ.html-c6be07c0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/17-åƒåœ¾å›æ”¶å™¨.html-72587bd5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/2.ç±»åŠ è½½å­ç³»ç»Ÿ.html-5555b5be.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/3.è¿è¡Œæ—¶æ•°æ®åŒº.html-6c5be9bb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/4.ç¨‹åºè®¡æ•°å™¨ï¼ˆPCå¯„å­˜å™¨ï¼‰.html-abf84c2d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/5.è™šæ‹Ÿæœºæ ˆ.html-4fe02ff2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/6.æœ¬åœ°æ–¹æ³•æ¥å£.html-1e3338a2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/7.æœ¬åœ°æ–¹æ³•æ ˆ.html-154e99f9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/8.å †.html-f91349d7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/9.æ–¹æ³•åŒº.html-b199c3a2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/03-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—.html-a2f15d8c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾.html-a4a293e8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/05-æ›¿æ¢ç©ºæ ¼.html-33efdac7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.html-074756b4.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10-I.æ–æ³¢é‚£å¥‘æ•°åˆ—.html-cd2083fd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10-IIé’è›™è·³å°é˜¶é—®é¢˜.html-7cc5e995.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/11-æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—.html-14c2c7f0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/12-çŸ©é˜µä¸­çš„è·¯å¾„.html-febfe3f4.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´.html-95124382.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/14-å‰ªç»³å­.html-6acd57e5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/15-äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°.html-a13f43ac.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/16-æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹.html-7043f475.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/17-æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•°.html-334f5faa.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/18-åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹.html-05dc5d45.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹.html-d2bf053f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/24-åè½¬é“¾è¡¨.html-838c65b9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/25-åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨.html-e46311f5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/26-æ ‘çš„å­ç»“æ„.html-a04aa17c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/27-äºŒå‰æ ‘çš„é•œåƒ.html-3001db4e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/28-å¯¹ç§°çš„äºŒå‰æ ‘.html-ec97eb11.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/58-II å·¦æ—‹è½¬å­—ç¬¦ä¸².html-32b45c42.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/å¸¸ç”¨æ–¹æ³•å°è£…åˆé›†.html-002ec8a5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/404.html-5d96f524.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-442f9a12.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-8084fdbe.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-a45aaf26.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-483b1e0c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-e72a1ed0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-d169257b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-cee77397.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-f15819ea.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-0921d40d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-742bcd29.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-de5af138.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-6a3d997b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-7ec36e9e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-c2184a3a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-e0712632.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-719c9ac9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-c04d1150.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-ba00b820.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/slides.html-a991af2c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/datastruct.html-7308e003.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/learnInProblem.html-7f04200b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-c34e5275.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/disable.html-d972dbc6.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/encrypt.html-4170437a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/markdown.html-61862a67.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/page.html-67d96e22.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/personal_tech.html-5568dee3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/rent_house.html-1e0dd4dc.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/basic.html-18911cb1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/concurrent.html-2c57d1b2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/concurrency.html-afad628e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/datastruct.html-6bc5abf5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/distribution.html-37fe1b25.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/foundation.html-85a0e08b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/giant.html-3eed9986.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/intelligenceQuestion.html-482d99cd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/intro.html-34111fe3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/messageQueue.html-f1cfd3be.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/mysql.html-4788adf8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/netty.html-58c97bb7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/network.html-264ac01e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/redis.html-3db37bdc.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/spring.html-a9a42659.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/system.html-fdd3c39f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/think.html-7ddbdace.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/Mybatis.html-3af6d6d4.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/Spring.html-e163eccb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringBoot.html-56483b76.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringCloud.html-03730661.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringDataJpa.html-41f35d61.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringMVC.html-83890e3a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringSecurity.html-62b13e45.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/kotlin.html-b2e2dd46.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/leetcode.html-f644d859.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/react.html-594c07f5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/typescript.html-7057d002.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/vue.html-bc78c79b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/1.ç®€ä»‹.html-50b9c060.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10.å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½.html-8c7802a5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/11.ç›´æ¥å†…å­˜.html-d0d37dbd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/12.æ‰§è¡Œå¼•æ“.html-e00ef777.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/13.StringTable.html-8bba02d8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/14.åƒåœ¾å›æ”¶æ¦‚è¿°.html-93107bc9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/15.åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•.html-8b7d348d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/16.åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ.html-3633af62.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/17-åƒåœ¾å›æ”¶å™¨.html-d2c56119.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/2.ç±»åŠ è½½å­ç³»ç»Ÿ.html-7d72d57f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/3.è¿è¡Œæ—¶æ•°æ®åŒº.html-3d6a37b7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/4.ç¨‹åºè®¡æ•°å™¨ï¼ˆPCå¯„å­˜å™¨ï¼‰.html-95dde1b1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/5.è™šæ‹Ÿæœºæ ˆ.html-dc56806b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/6.æœ¬åœ°æ–¹æ³•æ¥å£.html-7fc16965.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/7.æœ¬åœ°æ–¹æ³•æ ˆ.html-6cad103e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/8.å †.html-f69bf86e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/9.æ–¹æ³•åŒº.html-ef3b6e04.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/03-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—.html-567f5361.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾.html-6e6af06d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/05-æ›¿æ¢ç©ºæ ¼.html-202212eb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.html-19d03253.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10-I.æ–æ³¢é‚£å¥‘æ•°åˆ—.html-b6e27af0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10-IIé’è›™è·³å°é˜¶é—®é¢˜.html-10ebe3d1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/11-æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—.html-f82a7837.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/12-çŸ©é˜µä¸­çš„è·¯å¾„.html-324f8453.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´.html-dad3810f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/14-å‰ªç»³å­.html-c23774d2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/15-äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°.html-14fb859b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/16-æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹.html-64f6fe8a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/17-æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•°.html-8531c65c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/18-åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹.html-3aeace11.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹.html-2517eeed.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/24-åè½¬é“¾è¡¨.html-6a3f1b99.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/25-åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨.html-702f2779.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/26-æ ‘çš„å­ç»“æ„.html-4d99c9a3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/27-äºŒå‰æ ‘çš„é•œåƒ.html-85287fc8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/28-å¯¹ç§°çš„äºŒå‰æ ‘.html-3aeebb13.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/58-II å·¦æ—‹è½¬å­—ç¬¦ä¸².html-a6dd23e1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/å¸¸ç”¨æ–¹æ³•å°è£…åˆé›†.html-f4b05f8b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/404.html-982c42ec.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-b144c1dd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-7186d5f7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-eaa10b62.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-1271cf68.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-1fbfb2e6.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-96bcade0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-90e31230.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-a1738b34.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-81d7f46f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-95691e99.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-a6d8def1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-040d812d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-44563782.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-fca388e5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-e775c7d3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-c6c6d33d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-8663824d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/waline-meta-a31b78ed.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/component-6115c04d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index-b03bef79.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/mermaid.core-282cdc25.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/highlight.esm-a794bb63.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/markdown.esm-d92a2fc9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/notes.esm-224f94d9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/reveal.esm-e5069ce0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/search.esm-2c3fba7d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/VuePlayground-14a37f3b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/photoswipe.esm-36cd6c3c.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/Computer-Science-Learn-Notes/" class="brand"><img class="logo" src="/Computer-Science-Learn-Notes/logo.svg" alt><!----><!----></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/Computer-Science-Learn-Notes/" class="nav-link" aria-label="ä¸»é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/Computer-Science-Learn-Notes/intro/" class="nav-link" aria-label="å¯¼è¯»"><span class="font-icon icon iconfont icon-discover" style=""></span>å¯¼è¯»<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes/issues" rel="noopener noreferrer" target="_blank" aria-label="é—®é¢˜åé¦ˆ" class="nav-link"><span class="font-icon icon iconfont icon-note" style=""></span>é—®é¢˜åé¦ˆ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-vscode" style=""></span><span class="title">å‰ç«¯</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-timer" style=""></span><span class="title">Golang</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-build" style=""></span><span class="title">è®¡ç®—æœºåŸºç¡€</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">JavaåŸºç¡€</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-branch" style=""></span><span class="title">Javaå¹¶å‘</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-profile" style=""></span><span class="title">Javaé¢è¯•</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/foundation.html" class="nav-link sidebar-link sidebar-page" aria-label="JavaåŸºç¡€"><!---->JavaåŸºç¡€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/intro.html" class="nav-link sidebar-link sidebar-page" aria-label="å‰è¨€"><!---->å‰è¨€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/concurrency.html" class="nav-link sidebar-link sidebar-page" aria-label="Javaå¹¶å‘"><!---->Javaå¹¶å‘<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="JVM"><!---->JVM<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â™»ï¸-jvm" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â™»ï¸ JVM"><!---->â™»ï¸ JVM<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å›¾è§£jvmç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å›¾è§£JVMç»“æ„"><!---->å›¾è§£JVMç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸ç±»çš„ç”Ÿå‘½å‘¨æœŸã€ç±»åŠ è½½çš„è¿‡ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­ï¸ç±»çš„ç”Ÿå‘½å‘¨æœŸã€ç±»åŠ è½½çš„è¿‡ç¨‹"><!---->â­ï¸ç±»çš„ç”Ÿå‘½å‘¨æœŸã€ç±»åŠ è½½çš„è¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#jdk-ä¸­æœ‰å“ªäº›é»˜è®¤çš„ç±»åŠ è½½å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JDK ä¸­æœ‰å“ªäº›é»˜è®¤çš„ç±»åŠ è½½å™¨"><!---->JDK ä¸­æœ‰å“ªäº›é»˜è®¤çš„ç±»åŠ è½½å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¦‚ä½•å¯¹æ ˆè¿›è¡Œå‚æ•°è°ƒä¼˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¦‚ä½•å¯¹æ ˆè¿›è¡Œå‚æ•°è°ƒä¼˜"><!---->å¦‚ä½•å¯¹æ ˆè¿›è¡Œå‚æ•°è°ƒä¼˜<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#è¯´ä¸€ä¸‹æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¯´ä¸€ä¸‹æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»"><!---->è¯´ä¸€ä¸‹æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡"><!---->å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­ï¸è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«"><!---->â­ï¸è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡"><!---->å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#åŒäº²å§”æ´¾æ¨¡å‹-å¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿå¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠï¼Ÿ"><!---->åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿå¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»"><!---->å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•-å„è‡ªçš„ç‰¹ç‚¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­ï¸åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•ï¼Œå„è‡ªçš„ç‰¹ç‚¹"><!---->â­ï¸åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•ï¼Œå„è‡ªçš„ç‰¹ç‚¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#hotspot-ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HotSpot ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£"><!---->HotSpot ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­ï¸å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›"><!---->â­ï¸å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#minor-gc-å’Œ-full-gc-æœ‰ä»€ä¹ˆä¸åŒå‘¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Minor Gc å’Œ Full GC æœ‰ä»€ä¹ˆä¸åŒå‘¢"><!---->Minor Gc å’Œ Full GC æœ‰ä»€ä¹ˆä¸åŒå‘¢<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­ï¸å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹"><!---->â­ï¸å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¯¹è±¡è®¿é—®æ–¹å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¯¹è±¡è®¿é—®æ–¹å¼"><!---->å¯¹è±¡è®¿é—®æ–¹å¼<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºå„ä»£è¡¨ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºå„ä»£è¡¨ä»€ä¹ˆï¼Ÿ"><!---->å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºå„ä»£è¡¨ä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#ä¸‰è‰²æ ‡è®°æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸‰è‰²æ ‡è®°æ³•"><!---->ä¸‰è‰²æ ‡è®°æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#ä»€ä¹ˆæ˜¯å­—èŠ‚ç -ç±»æ–‡ä»¶ç»“æ„çš„ç»„æˆäº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿç±»æ–‡ä»¶ç»“æ„çš„ç»„æˆäº†è§£å—ï¼Ÿ"><!---->ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿç±»æ–‡ä»¶ç»“æ„çš„ç»„æˆäº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#oom-å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="OOM å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•"><!---->OOM å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/spring.html" class="nav-link sidebar-link sidebar-page" aria-label="Springç³»åˆ—"><!---->Springç³»åˆ—<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQL"><!---->MySQL<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/redis.html" class="nav-link sidebar-link sidebar-page" aria-label="redis"><!---->redis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/distribution.html" class="nav-link sidebar-link sidebar-page" aria-label="åˆ†å¸ƒå¼"><!---->åˆ†å¸ƒå¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/messageQueue.html" class="nav-link sidebar-link sidebar-page" aria-label="æ¶ˆæ¯é˜Ÿåˆ—"><!---->æ¶ˆæ¯é˜Ÿåˆ—<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/netty.html" class="nav-link sidebar-link sidebar-page" aria-label="Netty"><!---->Netty<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/network.html" class="nav-link sidebar-link sidebar-page" aria-label="è®¡ç®—æœºç½‘ç»œ"><!---->è®¡ç®—æœºç½‘ç»œ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/system.html" class="nav-link sidebar-link sidebar-page" aria-label="æ“ä½œç³»ç»Ÿ"><!---->æ“ä½œç³»ç»Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/datastruct.html" class="nav-link sidebar-link sidebar-page" aria-label="æ•°æ®ç»“æ„"><!---->æ•°æ®ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/intelligenceQuestion.html" class="nav-link sidebar-link sidebar-page" aria-label="æ™ºåŠ›é¢˜"><!---->æ™ºåŠ›é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/giant.html" class="nav-link sidebar-link sidebar-page" aria-label="2022å¤§å‚å…«è‚¡æ–‡"><!---->2022å¤§å‚å…«è‚¡æ–‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/think.html" class="nav-link sidebar-link sidebar-page" aria-label="åŸºäºé¢è¯•é¢˜çš„ä¸€äº›æ€è€ƒ"><!---->åŸºäºé¢è¯•é¢˜çš„ä¸€äº›æ€è€ƒ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-leaf" style=""></span><span class="title">Javaæ¡†æ¶</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-async" style=""></span><span class="title">Javaè™šæ‹Ÿæœº</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-launch" style=""></span><span class="title">Kotlinç»“åˆSpring</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-object" style=""></span><span class="title">LeetCodeåˆ·é¢˜é¡ºåº</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-repair" style=""></span><span class="title">ç»éªŒæ€»ç»“</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->JVM</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">zhiyu1998</span></span><span property="author" content="zhiyu1998"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-04-04T15:12:04.000Z"></span><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" id="ArtalkPV" data-path="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 70 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT70M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â™»ï¸-jvm" class="router-link-active router-link-exact-active toc-link level2">â™»ï¸ JVM</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å›¾è§£jvmç»“æ„" class="router-link-active router-link-exact-active toc-link level3">å›¾è§£JVMç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸ç±»çš„ç”Ÿå‘½å‘¨æœŸã€ç±»åŠ è½½çš„è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">â­ï¸ç±»çš„ç”Ÿå‘½å‘¨æœŸã€ç±»åŠ è½½çš„è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#jdk-ä¸­æœ‰å“ªäº›é»˜è®¤çš„ç±»åŠ è½½å™¨" class="router-link-active router-link-exact-active toc-link level3">JDK ä¸­æœ‰å“ªäº›é»˜è®¤çš„ç±»åŠ è½½å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¦‚ä½•å¯¹æ ˆè¿›è¡Œå‚æ•°è°ƒä¼˜" class="router-link-active router-link-exact-active toc-link level3">å¦‚ä½•å¯¹æ ˆè¿›è¡Œå‚æ•°è°ƒä¼˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#è¯´ä¸€ä¸‹æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»" class="router-link-active router-link-exact-active toc-link level3">è¯´ä¸€ä¸‹æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡" class="router-link-active router-link-exact-active toc-link level3">å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«" class="router-link-active router-link-exact-active toc-link level3">â­ï¸è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡" class="router-link-active router-link-exact-active toc-link level3">å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#åŒäº²å§”æ´¾æ¨¡å‹-å¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠ" class="router-link-active router-link-exact-active toc-link level3">åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿå¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»" class="router-link-active router-link-exact-active toc-link level3">å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•-å„è‡ªçš„ç‰¹ç‚¹" class="router-link-active router-link-exact-active toc-link level3">â­ï¸åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•ï¼Œå„è‡ªçš„ç‰¹ç‚¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#hotspot-ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£" class="router-link-active router-link-exact-active toc-link level3">HotSpot ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›" class="router-link-active router-link-exact-active toc-link level3">â­ï¸å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#minor-gc-å’Œ-full-gc-æœ‰ä»€ä¹ˆä¸åŒå‘¢" class="router-link-active router-link-exact-active toc-link level3">Minor Gc å’Œ Full GC æœ‰ä»€ä¹ˆä¸åŒå‘¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#â­ï¸å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">â­ï¸å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å¯¹è±¡è®¿é—®æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">å¯¹è±¡è®¿é—®æ–¹å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºå„ä»£è¡¨ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level3">å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºå„ä»£è¡¨ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#ä¸‰è‰²æ ‡è®°æ³•" class="router-link-active router-link-exact-active toc-link level3">ä¸‰è‰²æ ‡è®°æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#ä»€ä¹ˆæ˜¯å­—èŠ‚ç -ç±»æ–‡ä»¶ç»“æ„çš„ç»„æˆäº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿç±»æ–‡ä»¶ç»“æ„çš„ç»„æˆäº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html#oom-å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">OOM å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•</a></li><!----><!--]--></ul></li><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="â™»ï¸-jvm" tabindex="-1"><a class="header-anchor" href="#â™»ï¸-jvm" aria-hidden="true">#</a> â™»ï¸ JVM</h2><p>å›å¿†å¤§çº²å›¾ï¼ˆæ”¾å¤§çœ‹å›å¿†çš„æ›´åŠ æ¸…æ¥šå™¢ï¼‰</p><figure><img src="/Computer-Science-Learn-Notes/assets/JVMç®€åŒ–ç‰ˆæ¶æ„-0fb4d358.png" alt="JVMç®€åŒ–ç‰ˆæ¶æ„" tabindex="0" loading="lazy"><figcaption>JVMç®€åŒ–ç‰ˆæ¶æ„</figcaption></figure><h3 id="å›¾è§£jvmç»“æ„" tabindex="-1"><a class="header-anchor" href="#å›¾è§£jvmç»“æ„" aria-hidden="true">#</a> å›¾è§£JVMç»“æ„</h3><h4 id="æ•´ä½“æ¶æ„å›¾-å»ºè®®é»˜å†™" tabindex="-1"><a class="header-anchor" href="#æ•´ä½“æ¶æ„å›¾-å»ºè®®é»˜å†™" aria-hidden="true">#</a> æ•´ä½“æ¶æ„å›¾ï¼šå»ºè®®é»˜å†™</h4><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220629110459744-4d594883.png" alt="image-20220629110459744" tabindex="0" loading="lazy"><figcaption>image-20220629110459744</figcaption></figure><h4 id="ç¨‹åºè®¡æ•°å™¨" tabindex="-1"><a class="header-anchor" href="#ç¨‹åºè®¡æ•°å™¨" aria-hidden="true">#</a> ç¨‹åºè®¡æ•°å™¨</h4><p>ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚<strong>å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆ</strong>ã€‚</p><p>ç”±äº Java è™šæ‹Ÿæœºçš„å¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹è½®æµåˆ‡æ¢ã€åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´çš„æ–¹å¼æ¥å®ç°çš„ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªç¡®å®šçš„æ—¶åˆ»ï¼Œä¸€ä¸ªå¤„ç†å™¨ï¼ˆå¯¹äºå¤šæ ¸å¤„ç†å™¨æ¥è¯´æ˜¯ä¸€ä¸ªå†…æ ¸ï¼‰éƒ½åªä¼šæ‰§è¡Œä¸€æ¡çº¿ç¨‹ä¸­çš„æŒ‡ä»¤ã€‚</p><p><strong>å› æ­¤ï¼Œä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„ä¸ªçº¿ç¨‹ä¹‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“</strong>ã€‚</p><p>é‚£ä¹ˆç¨‹åºè®¡æ•°å™¨é‡Œå­˜çš„åˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ</p><ul><li>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ª Java æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€</li><li>å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯æœ¬åœ°ï¼ˆNativeï¼‰æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨å€¼åˆ™åº”ä¸ºç©ºï¼ˆUndefinedï¼‰ã€‚è‡³äºä»€ä¹ˆæ˜¯ Native æ–¹æ³•ï¼Œåœ¨æœ¬åœ°æ–¹æ³•æ ˆé‚£ä¸€å°èŠ‚ä¼šè¯¦ç»†è§£é‡Š</li></ul><blockquote><p>æ³¨æ„ï¼æ­¤å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­æ²¡æœ‰è§„å®šä»»ä½• OutOfMemoryErrorï¼ˆå†…å­˜æº¢å‡ºï¼‰æƒ…å†µçš„åŒºåŸŸã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„é¢è¯•é¢˜äº†</p></blockquote><h4 id="è™šæ‹Ÿæœºæ ˆ" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿæœºæ ˆ" aria-hidden="true">#</a> è™šæ‹Ÿæœºæ ˆ</h4><p>æ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºçš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ ˆï¼Œå…¶å†…éƒ¨ä¿å­˜ä¸€ä¸ªä¸ªçš„æ ˆå¸§(Stack Frameï¼‰</p><p>æ¯ä¸ª<strong>æ ˆå¸§</strong>ï¼ˆStack Frameï¼‰ä¸­å­˜å‚¨ç€ï¼š</p><ul><li>å±€éƒ¨å˜é‡è¡¨ï¼ˆLocal Variablesï¼‰</li><li>æ“ä½œæ•°æ ˆï¼ˆOperand Stackï¼‰(æˆ–ç§°ä¸ºè¡¨è¾¾å¼æ ˆ)</li><li>åŠ¨æ€é“¾æ¥ï¼ˆDynamic Linkingï¼‰ï¼šæŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨</li><li>æ–¹æ³•è¿”å›åœ°å€ï¼ˆReturn Addressï¼‰ï¼šæ–¹æ³•æ­£å¸¸é€€å‡ºæˆ–å¼‚å¸¸é€€å‡ºçš„åœ°å€</li><li>ä¸€äº›é™„åŠ ä¿¡æ¯</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628171657570-c84f53c3.png" alt="image-20220628171657570" tabindex="0" loading="lazy"><figcaption>image-20220628171657570</figcaption></figure><h4 id="æœ¬åœ°æ–¹æ³•æ ˆ" tabindex="-1"><a class="header-anchor" href="#æœ¬åœ°æ–¹æ³•æ ˆ" aria-hidden="true">#</a> æœ¬åœ°æ–¹æ³•æ ˆ</h4><p>æœ¬åœ°æ–¹æ³•æ ˆå’Œä¸Šé¢æˆ‘ä»¬æ‰€è¯´çš„è™šæ‹Ÿæœºæ ˆä½œç”¨åŸºæœ¬ä¸€æ ·ï¼ŒåŒºåˆ«åªä¸è¿‡æ˜¯æœ¬åœ°æ–¹æ³•æ ˆä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„ Native æ–¹æ³•æœåŠ¡ï¼Œè€Œè™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ Java æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ã€‚</p><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹ <strong>Native æ–¹æ³•</strong>çš„æ¦‚å¿µï¼Œå…¶å®ä¸ä»… Javaï¼Œå¾ˆå¤šè¯­è¨€ä¸­éƒ½æœ‰è¿™ä¸ªæ¦‚å¿µã€‚</p><p>&quot;A native method is a Java method whose implementation is provided by non-java code.&quot;</p><p>å°±æ˜¯è¯´ä¸€ä¸ª Native æ–¹æ³•å…¶å®å°±æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä½†æ˜¯å®ƒçš„å…·ä½“å®ç°æ˜¯åœ¨å¤–éƒ¨ç”±é Java è¯­è¨€æ¯”å¦‚ C æˆ– C++ ç­‰æ¥å†™çš„ã€‚Java é€šè¿‡ JNI æ¥è°ƒç”¨æœ¬åœ°æ–¹æ³•ï¼Œ è€Œæœ¬åœ°æ–¹æ³•æ˜¯ä»¥åº“æ–‡ä»¶çš„å½¢å¼å­˜æ”¾çš„ï¼ˆåœ¨ WINDOWS å¹³å°ä¸Šæ˜¯ DLL æ–‡ä»¶å½¢å¼ï¼Œåœ¨ UNIX æœºå™¨ä¸Šæ˜¯ SO æ–‡ä»¶å½¢å¼ï¼‰ã€‚</p><p>æ‰€ä»¥åŒä¸€ä¸ª Native æ–¹æ³•ï¼Œå¦‚æœç”¨ä¸åŒçš„è™šæ‹Ÿæœºå»è°ƒç”¨å®ƒï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç»“æœå’Œè¿è¡Œæ•ˆç‡å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› ä¸ºä¸åŒçš„è™šæ‹Ÿæœºå¯¹äºæŸä¸ª Native æ–¹æ³•éƒ½æœ‰è‡ªå·±çš„å®ç°ï¼Œæ¯”å¦‚ Object ç±»çš„ <code>hashCode</code> æ–¹æ³•ã€‚</p><p><strong>é‚£ä¹ˆä¸ºä»€ä¹ˆéœ€è¦ Native æ–¹æ³•å‘¢</strong>ï¼Ÿ</p><p>å…¶ä¸»è¦åŸå› å°±æ˜¯ Java è™½ç„¶ä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯æœ‰äº›å±‚æ¬¡çš„ä»»åŠ¡ç”¨ Java å®ç°èµ·æ¥ä¸å®¹æ˜“ï¼Œæˆ–è€…å¯¹ç¨‹åºçš„æ•ˆç‡æœ‰æ¯”è¾ƒé«˜çš„è¦æ±‚æ—¶ï¼ŒJava è¯­è¨€å¯èƒ½å¹¶ä¸æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚æ‰€ä»¥ Native æ–¹æ³•ä½¿å¾— Java ç¨‹åºèƒ½å¤Ÿè¶…è¶Š Java è¿è¡Œæ—¶çš„ç•Œé™ï¼Œæœ‰æ•ˆåœ°æ‰©å……äº† JVMã€‚</p><blockquote><p>ä¸è™šæ‹Ÿæœºæ ˆä¸€æ ·ï¼Œæœ¬åœ°æ–¹æ³•æ ˆä¹Ÿä¼šåœ¨æ ˆæ·±åº¦æº¢å‡ºæˆ–è€…æ ˆæ‰©å±•å¤±è´¥æ—¶åˆ†åˆ«æŠ›å‡º StackOverflowError å’Œ OutOfMemoryError å¼‚å¸¸</p></blockquote><h4 id="å †" tabindex="-1"><a class="header-anchor" href="#å †" aria-hidden="true">#</a> å †</h4><p>Java å †æ˜¯è™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ã€‚<strong>å †æ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚æ­¤å†…å­˜åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œâ€œå‡ ä¹â€ æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜</strong>ã€‚</p><p>æ³¨æ„ï¼è¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯å‡ ä¹ï¼ŒæŠ€æœ¯å‘å±•è‡³ä»Šï¼Œ<strong>å…¶å®å¹¶éæ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½ä¼šåˆ†é…åˆ°å †ä¸Š</strong>ï¼Œæ¯”å¦‚é€ƒé€¸æŠ€æœ¯ï¼Œè¿™ä¸ªæˆ‘ä»¬åç»­æ–‡ç« æˆ‘å†åšè§£é‡Š~</p><p>å †æ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„å†…å­˜åŒºåŸŸï¼Œå› æ­¤ä¸€äº›èµ„æ–™ä¸­å®ƒä¹Ÿè¢«ç§°ä½œ â€œGC å †â€ï¼ˆGarbage Collected Heapï¼‰ã€‚</p><p>å¯¹äºå †è¿™ä¸ªæ¦‚å¿µå°ä¼™ä¼´ä»¬è‚¯å®šè¿˜å¬è¯´è¿‡å„ç§è¯¸å¦‚æ–°ç”Ÿä»£ã€è€å¹´ä»£ã€æ°¸ä¹…ä»£ã€Eden ç©ºé—´ã€From Survivor ç©ºé—´ã€To Survivor ç©ºé—´ç­‰åè¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>è¿™äº›åŒºåŸŸåˆ’åˆ†ä»…ä»…æ˜¯ä¸€éƒ¨åˆ†åƒåœ¾æ”¶é›†å™¨çš„å…±åŒç‰¹æ€§æˆ–è€…è¯´è®¾è®¡é£æ ¼è€Œå·²ï¼Œåªæ˜¯ä¸ºäº†é€šè¿‡è¿™ç§åˆ†ä»£è®¾è®¡æ¥æ›´å¥½åœ°å›æ”¶å†…å­˜ï¼Œæˆ–è€…æ›´å¿«åœ°åˆ†é…å†…å­˜ï¼Œè€ŒéæŸä¸ª Java è™šæ‹Ÿæœºå…·ä½“å®ç°çš„å›ºæœ‰å†…å­˜å¸ƒå±€ï¼Œæ›´ä¸æ˜¯ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹é‡Œå¯¹ Java å †çš„è¿›ä¸€æ­¥ç»†è‡´åˆ’åˆ†</strong></p><p>æ ¹æ®ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹çš„è§„å®šï¼ŒJava å †å¯ä»¥å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œä½†åœ¨é€»è¾‘ä¸Šå®ƒåº”è¯¥è¢«è§†ä¸ºè¿ç»­çš„ï¼Œè¿™ç‚¹å°±åƒæˆ‘ä»¬ç”¨ç£ç›˜ç©ºé—´å»å­˜å‚¨æ–‡ä»¶ä¸€æ ·ï¼Œå¹¶ä¸è¦æ±‚æ¯ä¸ªæ–‡ä»¶éƒ½è¿ç»­å­˜æ”¾ã€‚ä½†å¯¹äºå¤§å¯¹è±¡ï¼ˆå…¸å‹çš„å¦‚æ•°ç»„å¯¹è±¡ï¼‰ï¼Œå¤šæ•°è™šæ‹Ÿæœºå®ç°å‡ºäºå®ç°ç®€å•ã€å­˜å‚¨é«˜æ•ˆçš„è€ƒè™‘ï¼Œå¾ˆå¯èƒ½ä¼šè¦æ±‚è¿ç»­çš„å†…å­˜ç©ºé—´ã€‚</p><p>Java å †æ—¢å¯ä»¥è¢«å®ç°æˆå›ºå®šå¤§å°çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯æ‰©å±•çš„ï¼Œå½“å‰ä¸»æµçš„ Java è™šæ‹Ÿæœºéƒ½æ˜¯æŒ‰ç…§å¯æ‰©å±•æ¥å®ç°çš„ï¼ˆé€šè¿‡å‚æ•° <code>-Xmx</code> å’Œ <code>-Xms</code> è®¾å®šï¼‰</p><blockquote><p>å¦‚æœåœ¨å †ä¸­æ²¡æœ‰å†…å­˜æ¥å®Œæˆå¯¹è±¡å®ä¾‹çš„åˆ†é…ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•å†æ‰©å±•æ—¶ï¼ŒJVM å°±ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸</p></blockquote><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628162509521-b24993c6.png" alt="image-20220628162509521" tabindex="0" loading="lazy"><figcaption>image-20220628162509521</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628164028744-e6bfac63.png" alt="image-20220628164028744" tabindex="0" loading="lazy"><figcaption>image-20220628164028744</figcaption></figure><h4 id="æ–¹æ³•åŒº" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•åŒº" aria-hidden="true">#</a> æ–¹æ³•åŒº</h4><p><strong>æ–¹æ³•åŒºé€šä¿—ç‚¹ç†è§£å°±æ˜¯ï¼Œåœ¨è™šæ‹Ÿæœºå®Œæˆç±»åŠ è½½ä¹‹åï¼Œå­˜å‚¨è¿™ä¸ªç±»ç›¸å…³çš„ç±»å‹ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç¼“å­˜ç­‰æ•°æ®</strong>ã€‚</p><blockquote><p>It stores <code>per-class structures</code> such as the <code>run-time constant pool</code>, <code>field</code> and <code>method data</code>, and <code>the code for methods and constructors</code>, including the special methods used in class and instance initialization and interface initialization. å®ƒå­˜å‚¨æ¯ä¸ªç±»çš„ç»“æ„ï¼Œå¦‚è¿è¡Œæ—¶çš„å¸¸é‡æ± ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ï¼Œä»¥åŠæ–¹æ³•å’Œæ„é€ å‡½æ•°çš„ä»£ç ï¼ŒåŒ…æ‹¬ç±»å’Œå®ä¾‹åˆå§‹åŒ–å’Œæ¥å£åˆå§‹åŒ–ä¸­ä½¿ç”¨çš„ç‰¹æ®Šæ–¹æ³•</p></blockquote><p>ä¸¾ä¸ªç®€å•çš„å°ä¾‹å­ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725144553583-7240af45.png" alt="image-20220725144553583" tabindex="0" loading="lazy"><figcaption>image-20220725144553583</figcaption></figure><p>æ–¹æ³•åŒºå…¶å®æœ¬èº«å¾ˆå¥½ç†è§£ï¼Œä½†æ˜¯ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹/ ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹æåˆ°çš„ä¸€å¥è¯ï¼š<strong>æ–¹æ³•åŒºæ˜¯å †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†</strong>ï¼ŒçœŸçš„æ˜¯è®©æˆ‘å›°æƒ‘äº†å¾ˆé•¿æ—¶é—´ã€‚</p><p>ä¸‹é¢æˆ‘æ¥ç»“åˆæˆ‘çš„ç†è§£ç»™å¤§å®¶è§£é‡Šä¸‹ï¼Œæˆ‘è§‰å¾—è¿™ä¸ª â€œæ–¹æ³•åŒºæ˜¯å †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†â€ åº”è¯¥é€‚ç”¨äº JDK 8 ä»¥å‰ï¼Œè€Œä¸é€‚ç”¨ JDK 8</p><p>å…ˆæ¥çœ‹ JDK 8 ä¹‹å‰:</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725144601249-820579da.png" alt="image-20220725144601249" tabindex="0" loading="lazy"><figcaption>image-20220725144601249</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>JDK 8 ä¹‹å‰ï¼Œå †å’Œæ–¹æ³•åŒºå…¶å®æ˜¯è¿åœ¨ä¸€èµ·çš„ï¼Œæˆ–è€…è¯´ï¼Œæ–¹æ³•åŒºå°±æ˜¯å †çš„ä¸€éƒ¨åˆ†</strong>ã€‚</p><p>ä½†æ˜¯å‘¢ï¼Œ<strong>æ–¹æ³•åŒºå­˜å‚¨çš„ä¸œè¥¿åˆæœ‰äº›ç‰¹åˆ«</strong>ï¼Œåœ¨è¿‡å»è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä½¿ç”¨ä¸æ™®éçš„æ—¶å€™ï¼Œç±»å‡ ä¹æ˜¯ â€œé™æ€çš„â€ å¹¶ä¸”å¾ˆå°‘è¢«å¸è½½å’Œå›æ”¶ï¼Œå› æ­¤ç±»ä¹Ÿå¯ä»¥è¢«çœ‹æˆ â€œæ°¸ä¹…çš„â€ï¼ˆè¿™ä¹Ÿå°±æ˜¯æ°¸ä¹…ä»£çš„å«ä¹‰ï¼‰ï¼Œå¦å¤–ç”±äºç±»ä½œä¸º JVM å®ç°çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬ä¸ç”±ç¨‹åºæ¥åˆ›å»ºï¼Œ<strong>æ‰€ä»¥ä¸ºäº†å’Œå †åŒºåˆ†å¼€æ¥å‘¢</strong>ï¼Œå°±ç»™äº† â€œæ–¹æ³•åŒºâ€ è¿™æ ·ä¸€ä¸ªåå­—ç”¨æ¥å­˜å‚¨ç±»çš„ä¿¡æ¯ï¼Œä¹Ÿæœ‰äººæŠŠæ–¹æ³•åŒºç§°ä¸º â€œéå †â€ã€‚</p><p>â­ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>æ— è®ºæ˜¯æ–¹æ³•åŒºè¿˜æ˜¯éå †ï¼Œå…¶å®éƒ½åªæ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„æ¦‚å¿µï¼Œåœ¨ JDK 8 ä¹‹å‰ï¼Œå…¶å…·ä½“çš„å®ç°æ–¹æ³•æ˜¯æ°¸ä¹…ä»£</strong>ã€‚</p><p>æ°¸ä¹…ä»£æ˜¯ HotSpot è™šæ‹Ÿæœºç»™å‡ºçš„å®ç°ï¼Œä½†æ˜¯å¯¹äºå…¶ä»–è™šæ‹Ÿæœºå®ç°ï¼Œè­¬å¦‚ BEA JRockitã€IBM J9 ç­‰æ¥è¯´ï¼Œæ˜¯ä¸å­˜åœ¨æ°¸ä¹…ä»£çš„æ¦‚å¿µçš„ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725144641131-f84f61ab.png" alt="image-20220725144641131" tabindex="0" loading="lazy"><figcaption>image-20220725144641131</figcaption></figure><p><strong>æ°¸ä¹…ä»£æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´</strong>ï¼Œæˆ‘ä»¬åœ¨ JVM å¯åŠ¨ä¹‹å‰å¯ä»¥é€šè¿‡è®¾ç½® <code>-XX:MaxPermSize</code> çš„å€¼æ¥æ§åˆ¶æ°¸ä¹…ä»£çš„å¤§å°ï¼Œ32 ä½æœºå™¨é»˜è®¤çš„æ°¸ä¹…ä»£çš„å¤§å°ä¸º 64Mï¼Œ64 ä½çš„æœºå™¨åˆ™ä¸º 85Mã€‚</p><p><strong>æ°¸ä¹…ä»£çš„åƒåœ¾å›æ”¶å’Œè€å¹´ä»£çš„åƒåœ¾å›æ”¶æ˜¯ç»‘å®šçš„ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªåŒºåŸŸè¢«å æ»¡ï¼Œè¿™ä¸¤ä¸ªåŒºéƒ½è¦è¿›è¡Œåƒåœ¾å›æ”¶</strong>ã€‚</p><p>æ˜¾ç„¶è¿™ç§è®¾è®¡å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„ä¸»æ„ï¼Œç”±äºæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>â€‘XX:MaxPermSize</code> è®¾ç½®æ°¸ä¹…ä»£çš„å¤§å°ï¼Œä¸€æ—¦ç±»çš„å…ƒæ•°æ®è¶…è¿‡äº†è®¾å®šçš„å¤§å°ï¼Œç¨‹åºå°±ä¼šè€—å°½å†…å­˜ï¼Œå¹¶å‡ºç°å†…å­˜æº¢å‡ºé”™è¯¯ (<code>java.lang.OutOfMemoryError: PermGen space</code>)ã€‚</p><p><strong>è€Œä¸”æœ‰æå°‘æ•°çš„æ–¹æ³•</strong>ï¼ˆä¾‹å¦‚é€‚ç”¨ <code>String</code>çš„ <code>intern()</code>æ–¹æ³•å¯ä»¥åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ‰‹åŠ¨çš„å°†å­—ç¬¦ä¸²æ·»åŠ åˆ° å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ï¼Œåœ¨ JDK1.7 ä¹‹å‰çš„ HotSpot è™šæ‹Ÿæœºä¸­ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± è¢«å­˜å‚¨åœ¨æ°¸ä¹…ä»£ä¸­ï¼‰<strong>ä¼šå› æ°¸ä¹…ä»£çš„åŸå› è€Œå¯¼è‡´ä¸åŒè™šæ‹Ÿæœºä¸‹æœ‰ä¸åŒçš„è¡¨ç°</strong>ï¼ˆæ¯”å¦‚ JRockit è™šæ‹Ÿæœºå°±æ²¡æœ‰æ°¸ä¹…ä»£çš„æ¦‚å¿µï¼‰</p><p>æ‰€ä»¥æˆ‘ä»¬æ€»ç»“ä¸‹ HotSpots åœ¨ JDK 8 æŠ›å¼ƒæ°¸ä¹…ä»£ï¼Œè½¬è€Œç”¨å…ƒç©ºé—´æ¥å®ç°æ–¹æ³•åŒºçš„<strong>ä¸¤å¤§åŸå› </strong>ï¼š</p><ol><li>ç”±äºæ°¸ä¹…ä»£çš„åƒåœ¾å›æ”¶å’Œè€å¹´ä»£çš„åƒåœ¾å›æ”¶æ˜¯ç»‘å®šçš„ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªåŒºåŸŸè¢«å æ»¡ï¼Œè¿™ä¸¤ä¸ªåŒºéƒ½è¦è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå¢å¤§äº† OOM å‘ç”Ÿçš„æ¦‚ç‡</li><li>æœ‰å°‘æ•°çš„æ–¹æ³•ä¾‹å¦‚ <code>String</code> çš„ <code>intern()</code> æ–¹æ³•ä¼šå› æ°¸ä¹…ä»£çš„åŸå› è€Œå¯¼è‡´ä¸åŒè™šæ‹Ÿæœºä¸‹æœ‰ä¸åŒçš„è¡¨ç°ï¼Œä¸åˆ©äºä»£ç è¿ç§»</li></ol><p>é‚£ä¹ˆå…ƒç©ºé—´åˆ°åº•æ˜¯ä¸ªå•¥ï¼Œå’Œæ–¹æ³•åŒºæœ‰å•¥åŒºåˆ«ï¼Ÿ</p><p><strong>å…ƒç©ºé—´ä¸æ°¸ä¹…ä»£ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šå…ƒç©ºé—´ä¸å†ä¸å †è¿ç»­ï¼Œå¹¶ä¸”æ˜¯å­˜åœ¨äºæœ¬åœ°å†…å­˜ï¼ˆNative memoryï¼‰ä¸­çš„</strong>ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725144655251-4efbf5b6.png" alt="image-20220725144655251" tabindex="0" loading="lazy"><figcaption>image-20220725144655251</figcaption></figure><p>è¿è¡Œæ—¶æ•°æ®åŒºåŸŸçš„å¯¹æ¯”å¦‚ä¸‹å›¾ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725144703356-9379f2b6.png" alt="image-20220725144703356" tabindex="0" loading="lazy"><figcaption>image-20220725144703356</figcaption></figure><blockquote><p><strong>å…ƒç©ºé—´å­˜åœ¨äºæœ¬åœ°å†…å­˜ï¼Œæ„å‘³ç€åªè¦æœ¬åœ°å†…å­˜è¶³å¤Ÿï¼Œå®ƒå°±ä¸ä¼š OOM</strong>ï¼Œä¸ä¼šå‡ºç°åƒæ°¸ä¹…ä»£ä¸­çš„ <code>java.lang.OutOfMemoryError: PermGenspace</code></p></blockquote><h5 id="è¿è¡Œæ—¶å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#è¿è¡Œæ—¶å¸¸é‡æ± " aria-hidden="true">#</a> è¿è¡Œæ—¶å¸¸é‡æ± </h5><p><strong>è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†</strong>ã€‚ä¸Šé¢æˆ‘ä»¬è¯´è¿‡æ–¹æ³•åŒºåŒ…å«ç±»ä¿¡æ¯ï¼Œè€Œæè¿°ç±»ä¿¡æ¯çš„ Class æ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ã€å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ˜¯<strong>å¸¸é‡æ± è¡¨ (Constant Pool Table)</strong>ï¼Œç”¨äºå­˜æ”¾<strong>ç¼–è¯‘æœŸ</strong>ç”Ÿæˆçš„å„ç§å­—é¢é‡ï¼ˆå­—é¢é‡ç›¸å½“äº Java è¯­è¨€å±‚é¢å¸¸é‡çš„æ¦‚å¿µï¼Œå¦‚æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œå£°æ˜ä¸º final çš„å¸¸é‡å€¼ç­‰ï¼‰ä¸ç¬¦å·å¼•ç”¨ã€‚æœ‰ä¸€äº›æ–‡ç« ä¼šæŠŠ class å¸¸é‡æ± è¡¨ç§°ä¸º<strong>é™æ€å¸¸é‡æ± </strong>ã€‚</p><p>éƒ½æ˜¯å¸¸é‡æ± ï¼Œå¸¸é‡æ± è¡¨å’Œè¿è¡Œæ—¶å¸¸é‡æ± æœ‰å•¥å…³ç³»å—ï¼Ÿè¿è¡Œæ—¶å¸¸é‡æ± æ˜¯å¹²å˜›çš„å‘¢ï¼Ÿ</p><p><strong>è¿è¡Œæ—¶å¸¸é‡æ± å¯ä»¥åœ¨è¿è¡ŒæœŸé—´å°† class å¸¸é‡æ± è¡¨ä¸­çš„ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨</strong>ã€‚ç®€å•æ¥è¯´ï¼Œclass å¸¸é‡æ± è¡¨å°±ç›¸å½“äºä¸€å †ç´¢å¼•ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± æ ¹æ®è¿™äº›ç´¢å¼•æ¥æŸ¥æ‰¾å¯¹åº”æ–¹æ³•æˆ–å­—æ®µæ‰€å±çš„ç±»å‹ä¿¡æ¯å’Œåç§°åŠæè¿°ç¬¦ä¿¡æ¯</p><p>ä¸ºä»€ä¹ˆéœ€è¦å¸¸é‡æ± è¿™ä¸ªä¸œè¥¿å‘¢ï¼Ÿä¸»è¦æ˜¯ä¸ºäº†é¿å…é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯å¯¹è±¡è€Œå½±å“ç³»ç»Ÿæ€§èƒ½ï¼Œå…¶å®ç°äº†å¯¹è±¡çš„å…±äº«ã€‚ä»¥<strong>å­—ç¬¦ä¸²å¸¸é‡æ± </strong>ä¸ºä¾‹ï¼Œå­—ç¬¦ä¸² <code>String</code> æ—¢ç„¶ä½œä¸º <code>Java</code> ä¸­çš„ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆå®ƒå’Œå…¶ä»–çš„å¯¹è±¡åˆ†é…ä¸€æ ·ï¼Œéœ€è¦è€—è´¹é«˜æ˜‚çš„æ—¶é—´ä¸ç©ºé—´ä»£ä»·ï¼Œä½œä¸ºæœ€åŸºç¡€æœ€å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼Œå¤§é‡é¢‘ç¹çš„åˆ›å»ºå­—ç¬¦ä¸²ï¼Œå°†ä¼šæå¤§ç¨‹åº¦çš„å½±å“ç¨‹åºçš„æ€§èƒ½ã€‚ä¸ºæ­¤ï¼ŒJVM ä¸ºäº†æé«˜æ€§èƒ½å’Œå‡å°‘å†…å­˜å¼€é”€ï¼Œåœ¨å®ä¾‹åŒ–å­—ç¬¦ä¸²å¸¸é‡çš„æ—¶å€™è¿›è¡Œäº†ä¸€äº›ä¼˜åŒ–ï¼š</p><ul><li>ä¸ºå­—ç¬¦ä¸²å¼€è¾Ÿäº†ä¸€ä¸ª<strong>å­—ç¬¦ä¸²å¸¸é‡æ±  String Pool</strong>ï¼Œå¯ä»¥ç†è§£ä¸ºç¼“å­˜åŒº</li><li>åˆ›å»ºå­—ç¬¦ä¸²å¸¸é‡æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ˜¯å¦å­˜åœ¨è¯¥å­—ç¬¦ä¸²</li><li><strong>è‹¥å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­˜åœ¨è¯¥å­—ç¬¦ä¸²ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥å¼•ç”¨å®ä¾‹ï¼Œæ— éœ€é‡æ–°å®ä¾‹åŒ–</strong>ï¼›è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å®ä¾‹åŒ–è¯¥å­—ç¬¦ä¸²å¹¶æ”¾å…¥æ± ä¸­ã€‚</li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½ç½®åœ¨ JDK 1.7 å‰åæœ‰æ‰€å˜åŒ–ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢è¿™å¼ è¡¨ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725144724148-bb16d883.png" alt="image-20220725144724148" tabindex="0" loading="lazy"><figcaption>image-20220725144724148</figcaption></figure><h3 id="â­ï¸ç±»çš„ç”Ÿå‘½å‘¨æœŸã€ç±»åŠ è½½çš„è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#â­ï¸ç±»çš„ç”Ÿå‘½å‘¨æœŸã€ç±»åŠ è½½çš„è¿‡ç¨‹" aria-hidden="true">#</a> â­ï¸ç±»çš„ç”Ÿå‘½å‘¨æœŸã€ç±»åŠ è½½çš„è¿‡ç¨‹</h3><h4 id="ç±»çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#ç±»çš„ç”Ÿå‘½å‘¨æœŸ" aria-hidden="true">#</a> ç±»çš„ç”Ÿå‘½å‘¨æœŸ</h4><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628160331611-06c4224f.png" alt="image-20220628160331611" tabindex="0" loading="lazy"><figcaption>image-20220628160331611</figcaption></figure><h4 id="ç±»çš„åŠ è½½è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#ç±»çš„åŠ è½½è¿‡ç¨‹" aria-hidden="true">#</a> ç±»çš„åŠ è½½è¿‡ç¨‹</h4><p>ç²—ç•¥</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628160442776-91cab7f6.png" alt="image-20220628160442776" tabindex="0" loading="lazy"><figcaption>image-20220628160442776</figcaption></figure><p>è¯¦ç»†è¿‡ç¨‹</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628160739969-1d1463ab.png" alt="image-20220628160739969" tabindex="0" loading="lazy"><figcaption>image-20220628160739969</figcaption></figure><h3 id="jdk-ä¸­æœ‰å“ªäº›é»˜è®¤çš„ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#jdk-ä¸­æœ‰å“ªäº›é»˜è®¤çš„ç±»åŠ è½½å™¨" aria-hidden="true">#</a> JDK ä¸­æœ‰å“ªäº›é»˜è®¤çš„ç±»åŠ è½½å™¨</h3><blockquote><p>è¿™é‡Œå‚è€ƒäº†<a href="https://doocs.github.io/jvm/" target="_blank" rel="noopener noreferrer">JVM åº•å±‚åŸç†æœ€å…¨çŸ¥è¯†æ€»ç»“<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628161228908-354f67fe.png" alt="image-20220628161228908" tabindex="0" loading="lazy"><figcaption>image-20220628161228908</figcaption></figure><p>ç³»ç»Ÿæä¾›äº† 3 ç§ç±»åŠ è½½å™¨ï¼š</p><ul><li>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰ï¼š è´Ÿè´£å°†å­˜æ”¾åœ¨ <code>&lt;JAVA_HOME&gt;\lib</code> ç›®å½•ä¸­çš„ï¼Œå¹¶ä¸”èƒ½è¢«è™šæ‹Ÿæœºè¯†åˆ«çš„ï¼ˆä»…æŒ‰ç…§æ–‡ä»¶åè¯†åˆ«ï¼Œå¦‚ rt.jarï¼Œåå­—ä¸ç¬¦åˆçš„ç±»åº“å³ä½¿æ”¾åœ¨ lib ç›®å½•ä¸­ä¹Ÿä¸ä¼šè¢«åŠ è½½ï¼‰ç±»åº“åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­ã€‚</li><li>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ï¼š è´Ÿè´£åŠ è½½ <code>&lt;JAVA_HOME&gt;\lib\ext</code> ç›®å½•ä¸­çš„æ‰€æœ‰ç±»åº“ï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨æ‰©å±•ç±»åŠ è½½å™¨ã€‚</li><li>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰ï¼š ç”±äºè¿™ä¸ªç±»åŠ è½½å™¨æ˜¯ ClassLoader ä¸­çš„ <code>getSystemClassLoader()</code> æ–¹æ³•çš„è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¹Ÿç§°å®ƒä¸ºâ€œç³»ç»Ÿç±»åŠ è½½å™¨â€ã€‚å®ƒè´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆclasspathï¼‰ä¸Šæ‰€æŒ‡å®šçš„ç±»åº“ï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªç±»åŠ è½½å™¨ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­æ²¡æœ‰è‡ªå®šä¹‰è¿‡è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªå°±æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ã€‚</li></ul><h3 id="å¦‚ä½•å¯¹æ ˆè¿›è¡Œå‚æ•°è°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å¯¹æ ˆè¿›è¡Œå‚æ•°è°ƒä¼˜" aria-hidden="true">#</a> å¦‚ä½•å¯¹æ ˆè¿›è¡Œå‚æ•°è°ƒä¼˜</h3><ul><li>å¯ä»¥é€šè¿‡-Xssï¼šè°ƒæ•´æ¯ä¸ªçº¿ç¨‹æ ˆç©ºé—´çš„å¤§å°</li><li>-XXThreadStackSizeï¼šè®¾ç½®çº¿ç¨‹æ ˆçš„å¤§å°</li></ul><h3 id="è¯´ä¸€ä¸‹æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#è¯´ä¸€ä¸‹æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»" aria-hidden="true">#</a> è¯´ä¸€ä¸‹æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»</h3><p>æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£ä»¥åŠå…ƒç©ºé—´çš„å…³ç³»å¾ˆåƒ Java ä¸­æ¥å£å’Œç±»çš„å…³ç³»ï¼Œç±»å®ç°äº†æ¥å£ï¼Œè¿™é‡Œçš„ç±»å°±å¯ä»¥çœ‹ä½œæ˜¯æ°¸ä¹…ä»£å’Œå…ƒç©ºé—´ï¼Œæ¥å£å¯ä»¥çœ‹ä½œæ˜¯æ–¹æ³•åŒºï¼Œä¹Ÿå°±æ˜¯è¯´æ°¸ä¹…ä»£ä»¥åŠå…ƒç©ºé—´æ˜¯ HotSpot è™šæ‹Ÿæœºå¯¹è™šæ‹Ÿæœºè§„èŒƒä¸­æ–¹æ³•åŒºçš„ä¸¤ç§å®ç°æ–¹å¼ã€‚å¹¶ä¸”ï¼Œæ°¸ä¹…ä»£æ˜¯ JDK 1.8 ä¹‹å‰çš„æ–¹æ³•åŒºå®ç°ï¼ŒJDK 1.8 åŠä»¥åæ–¹æ³•åŒºçš„å®ç°å˜æˆäº†å…ƒç©ºé—´ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628171430898-0a51c2c4.png" alt="image-20220628171430898" tabindex="0" loading="lazy"><figcaption>image-20220628171430898</figcaption></figure><h3 id="å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡" aria-hidden="true">#</a> å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡</h3><h4 id="å¼•ç”¨è®¡æ•°æ³•" tabindex="-1"><a class="header-anchor" href="#å¼•ç”¨è®¡æ•°æ³•" aria-hidden="true">#</a> å¼•ç”¨è®¡æ•°æ³•</h4><p>åœ¨å¯¹è±¡å¤´ç»´æŠ¤ç€ä¸€ä¸ª counter è®¡æ•°å™¨ï¼Œå¯¹è±¡è¢«å¼•ç”¨ä¸€æ¬¡åˆ™è®¡æ•°å™¨ +1ï¼›è‹¥å¼•ç”¨å¤±æ•ˆåˆ™è®¡æ•°å™¨ -1ã€‚å½“è®¡æ•°å™¨ä¸º 0 æ—¶ï¼Œå°±è®¤ä¸ºè¯¥å¯¹è±¡æ— æ•ˆäº†ã€‚</p><p>å¼•ç”¨è®¡æ•°ç®—æ³•çš„å®ç°ç®€å•ï¼Œåˆ¤å®šæ•ˆç‡ä¹Ÿå¾ˆé«˜ï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹å®ƒéƒ½æ˜¯ä¸€ä¸ªä¸é”™çš„ç®—æ³•ã€‚ä½†æ˜¯ä¸»æµçš„ Java è™šæ‹Ÿæœºé‡Œæ²¡æœ‰é€‰ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•æ¥ç®¡ç†å†…å­˜ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒå¾ˆéš¾è§£å†³å¯¹è±¡ä¹‹é—´å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚ï¼ˆè™½ç„¶å¾ªç¯å¼•ç”¨çš„é—®é¢˜å¯é€šè¿‡ Recycler ç®—æ³•è§£å†³ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¼•ç”¨è®¡æ•°å˜æ›´ä¹Ÿè¦è¿›è¡Œæ˜‚è´µçš„åŒæ­¥æ“ä½œï¼Œæ€§èƒ½è¾ƒä½ï¼Œæ—©æœŸçš„ç¼–ç¨‹è¯­è¨€ä¼šé‡‡ç”¨æ­¤ç®—æ³•ã€‚ï¼‰</p><h4 id="å¯è¾¾æ€§åˆ†æ" tabindex="-1"><a class="header-anchor" href="#å¯è¾¾æ€§åˆ†æ" aria-hidden="true">#</a> å¯è¾¾æ€§åˆ†æ</h4><p>å¯è¾¾æ€§åˆ†ææ˜¯é€šè¿‡ä¸€ç³»åˆ—è¢«ç§°ä¸º <code>GC Roots</code> çš„æ ¹å¯¹è±¡ä½œä¸ºèµ·å§‹èŠ‚ç‚¹é›†ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹ï¼Œæ ¹æ®å¼•ç”¨å…³ç³»å‘ä¸‹æœç´¢ï¼Œæœç´¢è¿‡ç¨‹æ‰€èµ°è¿‡çš„è·¯å¾„è¢«ç§°ä¸ºå¼•ç”¨é“¾ï¼ˆReference Chainï¼‰ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡åˆ° <code>GC Roots</code> é—´æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œè¿™ä»£è¡¨ <code>GC Roots</code> åˆ°è¯¥å¯¹è±¡ä¸å¯è¾¾ï¼Œ æ­¤æ—¶è¯æ˜æ­¤è¯¥å¯¹è±¡ä¸å¯èƒ½å†è¢«ä½¿ç”¨ã€‚</p><p>GC Roots æ˜¯æŒ‡ï¼š</p><ul><li><strong>è™šæ‹Ÿæœºæ ˆ</strong>ï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡</li><li><strong>æœ¬åœ°æ–¹æ³•æ ˆ</strong>ä¸­å¼•ç”¨çš„å¯¹è±¡</li><li><strong>æ–¹æ³•åŒº</strong>ä¸­<strong>å¸¸é‡</strong>å¼•ç”¨çš„å¯¹è±¡</li><li>æ–¹æ³•åŒºä¸­ç±»<strong>é™æ€</strong>å±æ€§å¼•ç”¨çš„å¯¹è±¡</li></ul><p>GC Roots å¹¶ä¸åŒ…æ‹¬å †ä¸­å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220624223650067-59b1001f.png" alt="image-20220624223650067" tabindex="0" loading="lazy"><figcaption>image-20220624223650067</figcaption></figure><p>â˜ ï¸è¦çœŸæ­£å®£å‘Šä¸€ä¸ªå¯¹è±¡æ­»äº¡ï¼Œéœ€è¦ç»è¿‡è‡³å°‘âœŒï¸æ¬¡æ ‡è®°è¿‡ç¨‹ï¼š</p><ul><li>1ï¸âƒ£å¦‚æœå¯¹è±¡åœ¨è¿›è¡Œå¯è¾¾æ€§åˆ†æåå‘ç° <code>GC Roots</code> ä¸å¯è¾¾ï¼Œå°†ä¼šè¿›è¡Œç¬¬ä¸€æ¬¡æ ‡è®°ï¼›</li><li>2ï¸âƒ£éšåè¿›è¡Œä¸€æ¬¡ç­›é€‰ï¼Œç­›é€‰çš„æ¡ä»¶æ˜¯æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œ <code>finalized()</code> æ–¹æ³•ã€‚å¦‚æœå¯¹è±¡æ²¡æœ‰è¦†ç›– <code>finalized()</code> æ–¹æ³•ï¼Œæˆ–è€… <code>finalized()</code> å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨è¿‡ï¼Œè¿™ä¸¤ç§æƒ…å†µéƒ½ä¼šè§†ä¸ºæ²¡æœ‰å¿…è¦æ‰§è¡Œã€‚å¦‚æœåˆ¤å®šç»“æœæ˜¯æœ‰å¿…è¦æ‰§è¡Œï¼Œæ­¤æ—¶å¯¹è±¡ä¼šè¢«æ”¾å…¥åä¸º <code>F-Queue</code> çš„é˜Ÿåˆ—ï¼Œç­‰å¾… Finalizer çº¿ç¨‹æ‰§è¡Œå…¶ <code>finalized()</code> æ–¹æ³•ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ”¶é›†å™¨ä¼šè¿›è¡Œç¬¬äºŒæ¬¡å°è§„æ¨¡çš„æ ‡è®°ï¼Œå¦‚æœå¯¹è±¡åœ¨ <code>finalized()</code> æ–¹æ³•ä¸­é‡æ–°å°†è‡ªå·±ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡è¿›è¡Œäº†å…³è”ï¼Œå¦‚å°†è‡ªå·±ï¼ˆthis å…³é”®å­—ï¼‰èµ‹å€¼ç»™æŸä¸ªç±»å˜é‡æˆ–è€…å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œæ­¤æ—¶å®ƒå°±å®ç°äº†è‡ªæˆ‘æ‹¯æ•‘ï¼Œåˆ™ç¬¬äºŒæ¬¡æ ‡è®°ä¼šå°†å…¶ç§»é™¤ â€œå³å°†å›æ”¶â€ çš„é›†åˆï¼Œå¦åˆ™è¯¥å¯¹è±¡å°±å°†è¢«çœŸæ­£å›æ”¶ï¼Œèµ°å‘æ­»äº¡ã€‚</li></ul><h3 id="â­ï¸è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#â­ï¸è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«" aria-hidden="true">#</a> â­ï¸è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«</h3><ul><li><p><strong>è™šå¼•ç”¨</strong>ï¼šè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ã€‚å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ç¨‹åºå¯ä»¥é€šè¿‡åˆ¤æ–­å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯å¦å·²ç»åŠ å…¥äº†è™šå¼•ç”¨ï¼Œæ¥äº†è§£è¢«å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å°†è¦è¢«åƒåœ¾å›æ”¶ã€‚ç¨‹åºå¦‚æœå‘ç°æŸä¸ªè™šå¼•ç”¨å·²ç»è¢«åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨æ‰€å¼•ç”¨çš„å¯¹è±¡çš„å†…å­˜è¢«å›æ”¶ä¹‹å‰é‡‡å–å¿…è¦çš„è¡ŒåŠ¨ã€‚</p><ul><li><strong>è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„æ´»åŠ¨</strong>ã€‚</li></ul></li><li><p><strong>è½¯å¼•ç”¨</strong>ï¼šå¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿï¼Œåƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸è¶³äº†ï¼Œå°±ä¼šå›æ”¶è¿™äº›å¯¹è±¡çš„å†…å­˜</p><ul><li>å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜</li></ul></li><li><p><strong>å¼±å¼•ç”¨</strong>ï¼šåªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œ å› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚</p></li></ul><h3 id="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡" aria-hidden="true">#</a> å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡</h3><ol><li>JDK1.7 ä¹‹å‰è¿è¡Œæ—¶å¸¸é‡æ± é€»è¾‘åŒ…å«å­—ç¬¦ä¸²å¸¸é‡æ± å­˜æ”¾åœ¨æ–¹æ³•åŒº, æ­¤æ—¶ hotspot è™šæ‹Ÿæœºå¯¹æ–¹æ³•åŒºçš„å®ç°ä¸ºæ°¸ä¹…ä»£</li><li>JDK1.7 å­—ç¬¦ä¸²å¸¸é‡æ± è¢«ä»æ–¹æ³•åŒºæ‹¿åˆ°äº†å †ä¸­, è¿™é‡Œæ²¡æœ‰æåˆ°è¿è¡Œæ—¶å¸¸é‡æ± ,ä¹Ÿå°±æ˜¯è¯´å­—ç¬¦ä¸²å¸¸é‡æ± è¢«å•ç‹¬æ‹¿åˆ°å †,è¿è¡Œæ—¶å¸¸é‡æ± å‰©ä¸‹çš„ä¸œè¥¿è¿˜åœ¨æ–¹æ³•åŒº, ä¹Ÿå°±æ˜¯ hotspot ä¸­çš„æ°¸ä¹…ä»£</li><li>JDK1.8 hotspot ç§»é™¤äº†æ°¸ä¹…ä»£ç”¨å…ƒç©ºé—´(Metaspace)å–è€Œä»£ä¹‹, è¿™æ—¶å€™å­—ç¬¦ä¸²å¸¸é‡æ± è¿˜åœ¨å †, è¿è¡Œæ—¶å¸¸é‡æ± è¿˜åœ¨æ–¹æ³•åŒº, åªä¸è¿‡æ–¹æ³•åŒºçš„å®ç°ä»æ°¸ä¹…ä»£å˜æˆäº†å…ƒç©ºé—´(Metaspace)</li></ol><p>å‡å¦‚åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­˜åœ¨å­—ç¬¦ä¸² &quot;abc&quot;ï¼Œå¦‚æœå½“å‰æ²¡æœ‰ä»»ä½• String å¯¹è±¡å¼•ç”¨è¯¥å­—ç¬¦ä¸²å¸¸é‡çš„è¯ï¼Œå°±è¯´æ˜å¸¸é‡ &quot;abc&quot; å°±æ˜¯åºŸå¼ƒå¸¸é‡ï¼Œå¦‚æœè¿™æ—¶å‘ç”Ÿå†…å­˜å›æ”¶çš„è¯è€Œä¸”æœ‰å¿…è¦çš„è¯ï¼Œ&quot;abc&quot; å°±ä¼šè¢«ç³»ç»Ÿæ¸…ç†å‡ºå¸¸é‡æ± äº†ã€‚</p><h3 id="åŒäº²å§”æ´¾æ¨¡å‹-å¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠ" tabindex="-1"><a class="header-anchor" href="#åŒäº²å§”æ´¾æ¨¡å‹-å¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠ" aria-hidden="true">#</a> åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿå¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠï¼Ÿ</h3><p>æ¯ä¸€ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªå¯¹åº”å®ƒçš„ç±»åŠ è½½å™¨ã€‚ç³»ç»Ÿä¸­çš„ ClassLoader åœ¨ååŒå·¥ä½œçš„æ—¶å€™ä¼šé»˜è®¤ä½¿ç”¨ <strong>åŒäº²å§”æ´¾æ¨¡å‹</strong> ã€‚å³åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šé¦–å…ˆåˆ¤æ–­å½“å‰ç±»æ˜¯å¦è¢«åŠ è½½è¿‡ã€‚å·²ç»è¢«åŠ è½½çš„ç±»ä¼šç›´æ¥è¿”å›ï¼Œå¦åˆ™æ‰ä¼šå°è¯•åŠ è½½ã€‚åŠ è½½çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæŠŠè¯¥è¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨çš„ <code>loadClass()</code> å¤„ç†ï¼Œå› æ­¤æ‰€æœ‰çš„è¯·æ±‚æœ€ç»ˆéƒ½åº”è¯¥ä¼ é€åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ <code>BootstrapClassLoader</code> ä¸­ã€‚å½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•å¤„ç†æ—¶ï¼Œæ‰ç”±è‡ªå·±æ¥å¤„ç†ã€‚å½“çˆ¶ç±»åŠ è½½å™¨ä¸º null æ—¶ï¼Œä¼šä½¿ç”¨å¯åŠ¨ç±»åŠ è½½å™¨ <code>BootstrapClassLoader</code> ä½œä¸ºçˆ¶ç±»åŠ è½½å™¨ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628172850425-3bdf36ae.png" alt="image-20220628172850425" tabindex="0" loading="lazy"><figcaption>image-20220628172850425</figcaption></figure><p><strong>å¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨åŒäº²å§”æ´¾æ¨¡å‹æ€ä¹ˆåŠ</strong></p><p>è‡ªå®šä¹‰åŠ è½½å™¨çš„è¯ï¼Œéœ€è¦ç»§æ‰¿ <code>ClassLoader</code> ã€‚å¦‚æœæˆ‘ä»¬ä¸æƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œå°±é‡å†™ <code>ClassLoader</code> ç±»ä¸­çš„ <code>findClass()</code> æ–¹æ³•å³å¯ï¼Œæ— æ³•è¢«çˆ¶ç±»åŠ è½½å™¨åŠ è½½çš„ç±»æœ€ç»ˆä¼šé€šè¿‡è¿™ä¸ªæ–¹æ³•è¢«åŠ è½½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹åˆ™éœ€è¦é‡å†™ <code>loadClass()</code> æ–¹æ³•</p><h3 id="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»" aria-hidden="true">#</a> å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»</h3><ul><li>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚</li><li>åŠ è½½è¯¥ç±»çš„ <code>ClassLoader</code> å·²ç»è¢«å›æ”¶ã€‚</li><li>è¯¥ç±»å¯¹åº”çš„ <code>java.lang.Class</code> å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚</li></ul><h3 id="â­ï¸åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•-å„è‡ªçš„ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#â­ï¸åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•-å„è‡ªçš„ç‰¹ç‚¹" aria-hidden="true">#</a> â­ï¸åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•ï¼Œå„è‡ªçš„ç‰¹ç‚¹</h3><ul><li>æ ‡è®°-æ¸…é™¤ç®—æ³•</li><li>æ ‡è®°-å¤åˆ¶ç®—æ³•</li><li>æ ‡è®°-æ•´ç†ç®—æ³•</li></ul><h4 id="æ ‡è®°-æ¸…é™¤ç®—æ³•-mark-sweep" tabindex="-1"><a class="header-anchor" href="#æ ‡è®°-æ¸…é™¤ç®—æ³•-mark-sweep" aria-hidden="true">#</a> æ ‡è®°-æ¸…é™¤ç®—æ³•ï¼ŒMark-Sweep</h4><p>å®ƒæ˜¯æœ€åŸºç¡€çš„åƒåœ¾æ”¶é›†ç®—æ³•ï¼Œæ”¶é›†è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåï¼Œç»Ÿä¸€å›æ”¶æ‰æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ï¼›ä¹Ÿå¯ä»¥åè¿‡æ¥ï¼Œæ ‡è®°å­˜æ´»å¯¹è±¡ï¼Œç»Ÿä¸€å›æ”¶æ‰€æœ‰æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153301516-7cd87e1d.png" alt="image-20220628153301516" tabindex="0" loading="lazy"><figcaption>image-20220628153301516</figcaption></figure><p>å®ƒä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªç¼ºç‚¹ï¼š</p><ul><li>æ‰§è¡Œæ•ˆç‡ä¸ç¨³å®šï¼šå¦‚æœ Java å †ä¸ŠåŒ…å«å¤§é‡éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåˆ™éœ€è¦è¿›è¡Œå¤§é‡æ ‡è®°å’Œæ¸…é™¤åŠ¨ä½œï¼›</li><li>å†…å­˜ç©ºé—´ç¢ç‰‡åŒ–ï¼šæ ‡è®°æ¸…é™¤åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„ç©ºé—´ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ— æ³•ä¸ºå¤§å¯¹è±¡åˆ†é…è¶³å¤Ÿçš„è¿ç»­å†…å­˜ã€‚</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220629095233918-b3f047b0.png" alt="image-20220629095233918" tabindex="0" loading="lazy"><figcaption>image-20220629095233918</figcaption></figure><h4 id="æ ‡è®°-å¤åˆ¶ç®—æ³•-mark-copy" tabindex="-1"><a class="header-anchor" href="#æ ‡è®°-å¤åˆ¶ç®—æ³•-mark-copy" aria-hidden="true">#</a> æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼ŒMark-Copy</h4><p>æ ‡è®°-å¤åˆ¶ç®—æ³•åŸºäº â€åŠåŒºå¤åˆ¶â€œ ç®—æ³•ï¼šå®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œå½“è¿™ä¸€å—çš„å†…å­˜ä½¿ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ç»ä½¿ç”¨è¿‡çš„é‚£å—å†…å­˜ç©ºé—´ä¸€æ¬¡æ€§æ¸…ç†æ‰ã€‚å…¶ä¼˜ç‚¹åœ¨äºé¿å…äº†å†…å­˜ç©ºé—´ç¢ç‰‡åŒ–çš„é—®é¢˜ï¼Œå…¶ç¼ºç‚¹å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœå†…å­˜ä¸­å¤šæ•°å¯¹è±¡éƒ½æ˜¯å­˜æ´»çš„ï¼Œè¿™ç§ç®—æ³•å°†äº§ç”Ÿå¤§é‡çš„å¤åˆ¶å¼€é”€ï¼›</li><li>æµªè´¹å†…å­˜ç©ºé—´ï¼Œå†…å­˜ç©ºé—´å˜ä¸ºäº†åŸæœ‰çš„ä¸€åŠã€‚</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153316648-d4969e27.png" alt="image-20220628153316648" tabindex="0" loading="lazy"><figcaption>image-20220628153316648</figcaption></figure><p>åŸºäºæ–°ç”Ÿä»£ â€œæœç”Ÿå¤•ç­â€ çš„ç‰¹ç‚¹ï¼Œå¤§å¤šæ•°è™šæ‹Ÿæœºéƒ½ä¸ä¼šæŒ‰ç…§ 1:1 çš„æ¯”ä¾‹æ¥è¿›è¡Œå†…å­˜åˆ’åˆ†ï¼Œä¾‹å¦‚ HotSpot è™šæ‹Ÿæœºä¼šå°†å†…å­˜ç©ºé—´åˆ’åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„ <code>Eden</code> å’Œ ä¸¤å—è¾ƒå°çš„ <code>Survivor</code> ç©ºé—´ï¼Œå®ƒä»¬ä¹‹é—´çš„æ¯”ä¾‹æ˜¯ 8:1:1 ã€‚ æ¯æ¬¡åˆ†é…æ—¶åªä¼šä½¿ç”¨ <code>Eden</code> å’Œå…¶ä¸­çš„ä¸€å— <code>Survivor</code> ï¼Œå‘ç”Ÿåƒåœ¾å›æ”¶æ—¶ï¼Œåªéœ€è¦å°†å­˜æ´»çš„å¯¹è±¡ä¸€æ¬¡æ€§å¤åˆ¶åˆ°å¦å¤–ä¸€å— <code>Survivor</code> ä¸Šï¼Œè¿™æ ·åªæœ‰ 10% çš„å†…å­˜ç©ºé—´ä¼šè¢«æµªè´¹æ‰ã€‚å½“ <code>Survivor</code> ç©ºé—´ä¸è¶³ä»¥å®¹çº³ä¸€æ¬¡ <code>Minor GC</code> æ—¶ï¼Œæ­¤æ—¶ç”±å…¶ä»–å†…å­˜åŒºåŸŸï¼ˆé€šå¸¸æ˜¯è€å¹´ä»£ï¼‰æ¥è¿›è¡Œåˆ†é…æ‹…ä¿ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220629095353992-cb3c7761.png" alt="image-20220629095353992" tabindex="0" loading="lazy"><figcaption>image-20220629095353992</figcaption></figure><h4 id="æ ‡è®°-æ•´ç†ç®—æ³•-mark-compact" tabindex="-1"><a class="header-anchor" href="#æ ‡è®°-æ•´ç†ç®—æ³•-mark-compact" aria-hidden="true">#</a> æ ‡è®°-æ•´ç†ç®—æ³•ï¼ŒMark-Compact</h4><p>æ ‡è®°-æ•´ç†ç®—æ³•æ˜¯åœ¨æ ‡è®°å®Œæˆåï¼Œè®©æ‰€æœ‰å­˜æ´»å¯¹è±¡éƒ½å‘å†…å­˜çš„ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚å…¶ä¼˜ç‚¹åœ¨äºå¯ä»¥é¿å…å†…å­˜ç©ºé—´ç¢ç‰‡åŒ–çš„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥å……åˆ†åˆ©ç”¨å†…å­˜ç©ºé—´ï¼›å…¶ç¼ºç‚¹åœ¨äºæ ¹æ®æ‰€ä½¿ç”¨çš„æ”¶é›†å™¨çš„ä¸åŒï¼Œåœ¨ç§»åŠ¨å­˜æ´»å¯¹è±¡æ—¶å¯èƒ½è¦å…¨ç¨‹æš‚åœç”¨æˆ·ç¨‹åºï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153332879-d827d357.png" alt="image-20220628153332879" tabindex="0" loading="lazy"><figcaption>image-20220628153332879</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220629095251304-3ee13928.png" alt="image-20220629095251304" tabindex="0" loading="lazy"><figcaption>image-20220629095251304</figcaption></figure><h4 id="ğŸ™…ã€ignoreã€‘æ ‡è®°-å‹ç¼©-æ•´ç†-ç®—æ³•-mark-compact" tabindex="-1"><a class="header-anchor" href="#ğŸ™…ã€ignoreã€‘æ ‡è®°-å‹ç¼©-æ•´ç†-ç®—æ³•-mark-compact" aria-hidden="true">#</a> ğŸ™…ã€Ignoreã€‘æ ‡è®° - å‹ç¼©ï¼ˆæ•´ç†ï¼‰ç®—æ³•ï¼ŒMark - Compact</h4><ul><li>ç¬¬ä¸€é˜¶æ®µå’Œæ ‡è®°æ¸…é™¤ç®—æ³•ä¸€æ ·ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹æ ‡è®°æ‰€æœ‰è¢«å¼•ç”¨å¯¹è±¡</li><li>ç¬¬äºŒé˜¶æ®µå°†æ‰€æœ‰çš„å­˜æ´»å¯¹è±¡å‹ç¼©åˆ°å†…å­˜çš„ä¸€ç«¯ï¼ŒæŒ‰é¡ºåºæ’æ”¾ã€‚</li><li>ä¹‹åï¼Œæ¸…ç†è¾¹ç•Œå¤–æ‰€æœ‰çš„ç©ºé—´ã€‚</li></ul><blockquote><p>æ ‡è®°æ¸…é™¤å’Œæ ‡è®°å‹ç¼©çš„åŒºåˆ«</p></blockquote><ul><li>æ ‡è®° - å‹ç¼©ç®—æ³•çš„æœ€ç»ˆæ•ˆæœç­‰åŒäºæ ‡è®° - æ¸…é™¤ç®—æ³•æ‰§è¡Œå®Œæˆåï¼Œå†è¿›è¡Œä¸€æ¬¡å†…å­˜ç¢ç‰‡æ•´ç†ï¼Œå› æ­¤ï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒç§°ä¸º<strong>æ ‡è®° - æ¸…é™¤ - å‹ç¼©ï¼ˆMark-Sweep-Compactï¼‰ç®—æ³•ã€‚</strong></li><li>äºŒè€…çš„æœ¬è´¨å·®å¼‚åœ¨äºæ ‡è®° - æ¸…é™¤ç®—æ³•æ˜¯ä¸€ç§<strong>éç§»åŠ¨å¼çš„å›æ”¶ç®—æ³•</strong>ï¼Œæ ‡è®° - å‹ç¼©æ˜¯<strong>ç§»åŠ¨å¼çš„</strong>ã€‚æ˜¯å¦ç§»åŠ¨å›æ”¶åçš„å­˜æ´»å¯¹è±¡æ˜¯ä¸€é¡¹ä¼˜ç¼ºç‚¹å¹¶å­˜çš„é£é™©å†³ç­–ã€‚</li><li>å¯ä»¥çœ‹åˆ°ï¼Œæ ‡è®°çš„å­˜æ´»å¯¹è±¡å°†ä¼šè¢«æ•´ç†ï¼ŒæŒ‰ç…§å†…å­˜åœ°å€ä¾æ¬¡æ’åˆ—ï¼Œè€Œæœªè¢«æ ‡è®°çš„å†…å­˜ä¼šè¢«æ¸…ç†æ‰ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå½“æˆ‘ä»¬éœ€è¦ç»™æ–°å¯¹è±¡åˆ†é…å†…å­˜æ—¶ï¼ŒJVM åªéœ€è¦æŒæœ‰ä¸€ä¸ªå†…å­˜çš„èµ·å§‹åœ°å€å³å¯ï¼Œè¿™æ¯”ç»´æŠ¤ä¸€ä¸ªç©ºé—²åˆ—è¡¨æ˜¾ç„¶å°‘äº†è®¸å¤šå¼€é”€</li></ul><blockquote><p>æ ‡è®°å‹ç¼©ç®—æ³•å†…éƒ¨ä½¿ç”¨æŒ‡é’ˆç¢°æ’</p></blockquote><p>å¦‚æœå†…å­˜ç©ºé—´ä»¥è§„æ•´å’Œæœ‰åºçš„æ–¹å¼åˆ†å¸ƒï¼Œå³å·²ç”¨å’Œæœªç”¨çš„å†…å­˜éƒ½å„è‡ªä¸€è¾¹ï¼Œå½¼æ­¤ä¹‹é—´ç»´ç³»ç€ä¸€ä¸ªè®°å½•ä¸‹ä¸€æ¬¡åˆ†é…èµ·å§‹ç‚¹çš„æ ‡è®°æŒ‡é’ˆï¼Œå½“ä¸ºæ–°å¯¹è±¡åˆ†é…å†…å­˜æ—¶ï¼Œåªéœ€è¦é€šè¿‡ä¿®æ”¹æŒ‡é’ˆçš„åç§»é‡å°†æ–°å¯¹è±¡åˆ†é…åœ¨ç¬¬ä¸€ä¸ªç©ºé—²å†…å­˜ä½ç½®ä¸Šï¼Œè¿™ç§åˆ†é…æ–¹å¼å°±å«åšæŒ‡é’ˆç¢°æ’ï¼ˆBump the Pointerï¼‰</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153345486-f8d676f1.png" alt="image-20220628153345486" tabindex="0" loading="lazy"><figcaption>image-20220628153345486</figcaption></figure><blockquote><p>ä¼˜ç‚¹</p></blockquote><ul><li>æ¶ˆé™¤äº†æ ‡è®° - æ¸…é™¤ç®—æ³•å½“ä¸­ï¼Œå†…å­˜åŒºåŸŸåˆ†æ•£çš„ç¼ºç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ–°å¯¹è±¡åˆ†é…å†…å­˜æ—¶ï¼ŒJVM åªéœ€è¦æŒæœ‰ä¸€ä¸ªå†…å­˜çš„èµ·å§‹åœ°å€å³å¯ã€‚</li><li>æ¶ˆé™¤äº†å¤åˆ¶ç®—æ³•å½“ä¸­ï¼Œå†…å­˜å‡åŠçš„é«˜é¢ä»£ä»·ã€‚</li></ul><blockquote><p>ç¼ºç‚¹</p></blockquote><ul><li>ä»æ•ˆç‡ä¸Šæ¥è¯´ï¼Œæ ‡è®° - æ•´ç†ç®—æ³•è¦ä½äºå¤åˆ¶ç®—æ³•ï¼Œç”šè‡³è¦ä½äºæ ‡è®° - æ¸…é™¤ç®—æ³•</li><li>ç§»åŠ¨å¯¹è±¡çš„åŒæ—¶ï¼Œå¦‚æœå¯¹è±¡è¢«å…¶ä»–å¯¹è±¡å¼•ç”¨ï¼Œåˆ™è¿˜éœ€è¦è°ƒæ•´å¼•ç”¨çš„åœ°å€</li><li>ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å…¨ç¨‹æš‚åœç”¨æˆ·åº”ç”¨ç¨‹åºã€‚å³ï¼šSTW</li></ul><h3 id="hotspot-ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£" tabindex="-1"><a class="header-anchor" href="#hotspot-ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£" aria-hidden="true">#</a> HotSpot ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£</h3><p>ä¸ºäº†è¿›è¡Œé«˜æ•ˆçš„åƒåœ¾å›æ”¶ï¼Œè™šæ‹ŸæœºæŠŠå †å†…å­˜<strong>é€»è¾‘ä¸Š</strong>åˆ’åˆ†æˆä¸‰å—åŒºåŸŸï¼ˆåˆ†ä»£çš„å”¯ä¸€ç†ç”±å°±æ˜¯ä¼˜åŒ– GC æ€§èƒ½ï¼‰</p><h3 id="â­ï¸å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#â­ï¸å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›" aria-hidden="true">#</a> â­ï¸å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›</h3><h4 id="serial-æ”¶é›†å™¨" tabindex="-1"><a class="header-anchor" href="#serial-æ”¶é›†å™¨" aria-hidden="true">#</a> Serial æ”¶é›†å™¨</h4><p>Serialï¼ˆä¸²è¡Œï¼‰æ”¶é›†å™¨æ˜¯æœ€åŸºæœ¬ã€å†å²æœ€æ‚ ä¹…çš„åƒåœ¾æ”¶é›†å™¨äº†ã€‚å¤§å®¶çœ‹åå­—å°±çŸ¥é“è¿™ä¸ªæ”¶é›†å™¨æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨äº†ã€‚å®ƒçš„ <strong>â€œå•çº¿ç¨‹â€</strong> çš„æ„ä¹‰ä¸ä»…ä»…æ„å‘³ç€å®ƒåªä¼šä½¿ç”¨ä¸€æ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œï¼Œæ›´é‡è¦çš„æ˜¯å®ƒåœ¨è¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œçš„æ—¶å€™å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ï¼ˆ <strong>&quot;Stop The World&quot;</strong> ï¼‰ï¼Œç›´åˆ°å®ƒæ”¶é›†ç»“æŸã€‚</p><p>ğŸ‘¶<strong>æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼ŒğŸ‘´è€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153028054-8ec633ab.png" alt="image-20220628153037233" tabindex="0" loading="lazy"><figcaption>image-20220628153037233</figcaption></figure><h4 id="parnew-æ”¶é›†å™¨" tabindex="-1"><a class="header-anchor" href="#parnew-æ”¶é›†å™¨" aria-hidden="true">#</a> ParNew æ”¶é›†å™¨</h4><p><strong>ParNew æ”¶é›†å™¨å…¶å®å°±æ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œé™¤äº†ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å¤–ï¼Œå…¶ä½™è¡Œä¸ºï¼ˆæ§åˆ¶å‚æ•°ã€æ”¶é›†ç®—æ³•ã€å›æ”¶ç­–ç•¥ç­‰ç­‰ï¼‰å’Œ Serial æ”¶é›†å™¨å®Œå…¨ä¸€æ ·ã€‚</strong></p><p>ğŸ‘¶<strong>æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼ŒğŸ‘´è€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153046946-16f41548.png" alt="image-20220628153046946" tabindex="0" loading="lazy"><figcaption>image-20220628153046946</figcaption></figure><h4 id="parallel-scavenge-æ”¶é›†å™¨" tabindex="-1"><a class="header-anchor" href="#parallel-scavenge-æ”¶é›†å™¨" aria-hidden="true">#</a> Parallel Scavenge æ”¶é›†å™¨</h4><p>Parallel Scavenge æ”¶é›†å™¨ä¹Ÿæ˜¯ä½¿ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•çš„å¤šçº¿ç¨‹æ”¶é›†å™¨ï¼Œå®ƒçœ‹ä¸Šå»å‡ ä¹å’Œ ParNew éƒ½ä¸€æ ·ã€‚ <strong>é‚£ä¹ˆå®ƒæœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„å‘¢ï¼Ÿ</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>-XX:+UseParallelGC

    ä½¿ç”¨ Parallel æ”¶é›†å™¨+ è€å¹´ä»£ä¸²è¡Œ

-XX:+UseParallelOldGC

    ä½¿ç”¨ Parallel æ”¶é›†å™¨+ è€å¹´ä»£å¹¶è¡Œ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Parallel Scavenge æ”¶é›†å™¨å…³æ³¨ç‚¹æ˜¯ååé‡ï¼ˆé«˜æ•ˆç‡çš„åˆ©ç”¨ CPUï¼‰ã€‚CMS ç­‰åƒåœ¾æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ›´å¤šçš„æ˜¯ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼ˆæé«˜ç”¨æˆ·ä½“éªŒï¼‰ã€‚æ‰€è°“ååé‡å°±æ˜¯ CPU ä¸­ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸ CPU æ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼ã€‚</strong> Parallel Scavenge æ”¶é›†å™¨æä¾›äº†å¾ˆå¤šå‚æ•°ä¾›ç”¨æˆ·æ‰¾åˆ°æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–æœ€å¤§ååé‡ï¼Œå¦‚æœå¯¹äºæ”¶é›†å™¨è¿ä½œä¸å¤ªäº†è§£ï¼Œæ‰‹å·¥ä¼˜åŒ–å­˜åœ¨å›°éš¾çš„æ—¶å€™ï¼Œä½¿ç”¨ Parallel Scavenge æ”¶é›†å™¨é…åˆè‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ï¼ŒæŠŠå†…å­˜ç®¡ç†ä¼˜åŒ–äº¤ç»™è™šæ‹Ÿæœºå»å®Œæˆä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p><p><strong>æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153107883-a40afc4e.png" alt="image-20220628153114059" tabindex="0" loading="lazy"><figcaption>image-20220628153114059</figcaption></figure><p><strong>è¿™æ˜¯ JDK1.8 é»˜è®¤æ”¶é›†å™¨</strong></p><p>ä½¿ç”¨ java -XX:+PrintCommandLineFlags -version å‘½ä»¤æŸ¥çœ‹</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>-XX:InitialHeapSize=262921408 -XX:MaxHeapSize=4206742528 -XX:+PrintCommandLineFlags -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseParallelGC
java version &quot;1.8.0_211&quot;
Java(TM) SE Runtime Environment (build 1.8.0_211-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.211-b12, mixed mode)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>JDK1.8 é»˜è®¤ä½¿ç”¨çš„æ˜¯ Parallel Scavenge + Parallel Oldï¼Œå¦‚æœæŒ‡å®šäº†-XX:+UseParallelGC å‚æ•°ï¼Œåˆ™é»˜è®¤æŒ‡å®šäº†-XX:+UseParallelOldGCï¼Œå¯ä»¥ä½¿ç”¨-XX:-UseParallelOldGC æ¥ç¦ç”¨è¯¥åŠŸèƒ½</p><h4 id="serial-old-æ”¶é›†å™¨" tabindex="-1"><a class="header-anchor" href="#serial-old-æ”¶é›†å™¨" aria-hidden="true">#</a> Serial Old æ”¶é›†å™¨</h4><p><strong>Serial æ”¶é›†å™¨çš„ğŸ‘´è€å¹´ä»£ç‰ˆæœ¬</strong>ï¼Œå®ƒåŒæ ·æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ã€‚å®ƒä¸»è¦æœ‰ä¸¤å¤§ç”¨é€”ï¼šä¸€ç§ç”¨é€”æ˜¯åœ¨ JDK1.5 ä»¥åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ï¼Œå¦ä¸€ç§ç”¨é€”æ˜¯ä½œä¸º CMS æ”¶é›†å™¨çš„åå¤‡æ–¹æ¡ˆã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153028054-8ec633ab.png" alt="image-20220628153028054" tabindex="0" loading="lazy"><figcaption>image-20220628153028054</figcaption></figure><h4 id="paralled-old-æ”¶é›†å™¨" tabindex="-1"><a class="header-anchor" href="#paralled-old-æ”¶é›†å™¨" aria-hidden="true">#</a> Paralled Old æ”¶é›†å™¨</h4><p><strong>Parallel Scavenge æ”¶é›†å™¨çš„ğŸ‘´è€å¹´ä»£ç‰ˆæœ¬</strong>ã€‚ä½¿ç”¨å¤šçº¿ç¨‹å’Œâ€œæ ‡è®°-æ•´ç†â€ç®—æ³•ã€‚åœ¨æ³¨é‡ååé‡ä»¥åŠ CPU èµ„æºçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavenge æ”¶é›†å™¨å’Œ Parallel Old æ”¶é›†å™¨ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153107883-a40afc4e.png" alt="image-20220628153107883" tabindex="0" loading="lazy"><figcaption>image-20220628153107883</figcaption></figure><h4 id="cms-æ”¶é›†å™¨" tabindex="-1"><a class="header-anchor" href="#cms-æ”¶é›†å™¨" aria-hidden="true">#</a> CMS æ”¶é›†å™¨</h4><p><strong>CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚å®ƒéå¸¸ç¬¦åˆåœ¨æ³¨é‡ç”¨æˆ·ä½“éªŒçš„åº”ç”¨ä¸Šä½¿ç”¨ã€‚</strong></p><p><strong>CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ HotSpot è™šæ‹Ÿæœºç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œå®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹ï¼ˆåŸºæœ¬ä¸Šï¼‰åŒæ—¶å·¥ä½œã€‚</strong></p><p>ä»åå­—ä¸­çš„<strong>Mark Sweep</strong>è¿™ä¸¤ä¸ªè¯å¯ä»¥çœ‹å‡ºï¼ŒCMS æ”¶é›†å™¨æ˜¯ä¸€ç§ <strong>â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•</strong>å®ç°çš„ï¼Œå®ƒçš„è¿ä½œè¿‡ç¨‹ç›¸æ¯”äºå‰é¢å‡ ç§åƒåœ¾æ”¶é›†å™¨æ¥è¯´æ›´åŠ å¤æ‚ä¸€äº›ã€‚æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼š</p><ol><li><strong>åˆå§‹æ ‡è®° (inital mark)</strong>ï¼šæ ‡è®° <code>GC Roots</code> èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œè€—æ—¶çŸ­ä½†éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹ï¼›</li><li><strong>å¹¶å‘æ ‡è®° (concurrent mark)</strong>ï¼šä» <code>GC Roots</code> èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾ï¼Œè€—æ—¶é•¿ä½†ä¸éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹ï¼›</li><li><strong>é‡æ–°æ ‡è®° (remark)</strong>ï¼šé‡‡ç”¨å¢é‡æ›´æ–°ç®—æ³•ï¼Œå¯¹å¹¶å‘æ ‡è®°é˜¶æ®µå› ä¸ºç”¨æˆ·çº¿ç¨‹è¿è¡Œè€Œäº§ç”Ÿå˜åŠ¨çš„é‚£éƒ¨åˆ†å¯¹è±¡è¿›è¡Œé‡æ–°æ ‡è®°ï¼Œè€—æ—¶æ¯”åˆå§‹æ ‡è®°ç¨é•¿ä¸”éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹ï¼›</li><li><strong>å¹¶å‘æ¸…é™¤ (inital sweep)</strong>ï¼šå¹¶å‘æ¸…é™¤æ‰å·²ç»æ­»äº¡çš„å¯¹è±¡ï¼Œè€—æ—¶é•¿ä½†ä¸éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹ã€‚</li></ol><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628153004557-365cb143.png" alt="image-20220628153004557" tabindex="0" loading="lazy"><figcaption>image-20220628153004557</figcaption></figure><p>ä»å®ƒçš„åå­—å°±å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¸»è¦ä¼˜ç‚¹ï¼š<strong>å¹¶å‘æ”¶é›†ã€ä½åœé¡¿</strong>ã€‚ä½†æ˜¯å®ƒæœ‰ä¸‹é¢ä¸‰ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼š</p><ul><li><strong>å¯¹ CPU èµ„æºæ•æ„Ÿï¼›</strong></li><li><strong>æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼›</strong></li><li><strong>å®ƒä½¿ç”¨çš„å›æ”¶ç®—æ³•-â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¼šå¯¼è‡´æ”¶é›†ç»“æŸæ—¶ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿã€‚</strong></li></ul><blockquote><p>CMSé€šå¸¸æœ‰ä¸¤ä¸ªé˜¶æ®µä¼šè¿›è¡ŒSTW</p></blockquote><p>ç¬¬ä¸€é˜¶æ®µå’Œç¬¬ä¸‰é˜¶æ®µ</p><ul><li><p><strong>åˆå§‹æ ‡è®°ï¼ˆInitial-Markï¼‰é˜¶æ®µ</strong>ï¼šåœ¨è¿™ä¸ªé˜¶æ®µä¸­ï¼Œç¨‹åºä¸­æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ (ç”¨æˆ·çº¿ç¨‹) éƒ½å°†ä¼šå› ä¸º â€œStop-The-Worldâ€ æœºåˆ¶è€Œå‡ºç°çŸ­æš‚çš„æš‚åœï¼Œè¿™ä¸ªé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡ä»…ä»…åªæ˜¯æ ‡è®°å‡º GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ã€‚ä¸€æ—¦æ ‡è®°å®Œæˆä¹‹åå°±ä¼šæ¢å¤ä¹‹å‰è¢«æš‚åœçš„æ‰€æœ‰åº”ç”¨çº¿ç¨‹ã€‚ç”±äºç›´æ¥å…³è”å¯¹è±¡æ¯”è¾ƒå°ï¼Œæ‰€ä»¥è¿™é‡Œçš„é€Ÿåº¦éå¸¸å¿«ã€‚</p></li><li><p><strong>é‡æ–°æ ‡è®°ï¼ˆRemarkï¼‰é˜¶æ®µ</strong>ï¼šç”±äºåœ¨å¹¶å‘æ ‡è®°é˜¶æ®µä¸­ï¼Œç¨‹åºçš„å·¥ä½œçº¿ç¨‹ä¼šå’Œåƒåœ¾æ”¶é›†çº¿ç¨‹åŒæ—¶è¿è¡Œæˆ–è€…äº¤å‰è¿è¡Œï¼Œå› æ­¤ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´ï¼Œå› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´é€šå¸¸ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µç¨é•¿ä¸€äº›ï¼Œä½†ä¹Ÿè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µçš„æ—¶é—´çŸ­ã€‚</p></li></ul><h4 id="g1-æ”¶é›†å™¨" tabindex="-1"><a class="header-anchor" href="#g1-æ”¶é›†å™¨" aria-hidden="true">#</a> G1 æ”¶é›†å™¨</h4><p>Garbage Firstï¼ˆç®€ç§° G1ï¼‰æ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¹Ÿæ˜¯ JDK 9 æœåŠ¡ç«¯æ¨¡å¼ä¸‹é»˜è®¤çš„åƒåœ¾æ”¶é›†å™¨ï¼Œå®ƒçš„è¯ç”Ÿå…·æœ‰é‡Œç¨‹ç¢‘å¼çš„æ„ä¹‰ã€‚G1 è™½ç„¶ä¹Ÿéµå¾ªåˆ†ä»£æ”¶é›†ç†è®ºï¼Œä½†ä¸å†ä»¥å›ºå®šå¤§å°å’Œå›ºå®šæ•°é‡æ¥åˆ’åˆ†åˆ†ä»£åŒºåŸŸï¼Œè€Œæ˜¯æŠŠè¿ç»­çš„ Java å †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ã€‚æ¯ä¸€ä¸ª Region éƒ½å¯ä»¥æ ¹æ®ä¸åŒçš„éœ€æ±‚æ¥æ‰®æ¼”æ–°ç”Ÿä»£çš„ <code>Eden</code> ç©ºé—´ã€<code>Survivor</code> ç©ºé—´æˆ–è€…è€å¹´ä»£ç©ºé—´ï¼Œæ”¶é›†å™¨ä¼šæ ¹æ®å…¶æ‰®æ¼”è§’è‰²çš„ä¸åŒè€Œé‡‡ç”¨ä¸åŒçš„æ”¶é›†ç­–ç•¥ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220624224020148-cc523962.png" alt="image-20220624224020148" tabindex="0" loading="lazy"><figcaption>image-20220624224020148</figcaption></figure><p>ä¸Šé¢è¿˜æœ‰ä¸€äº› Region ä½¿ç”¨ H è¿›è¡Œæ ‡æ³¨ï¼Œå®ƒä»£è¡¨ Humongousï¼Œè¡¨ç¤ºè¿™äº› Region ç”¨äºå­˜å‚¨å¤§å¯¹è±¡ï¼ˆhumongous objectï¼ŒH-objï¼‰ï¼Œå³å¤§å°å¤§äºç­‰äº region ä¸€åŠçš„å¯¹è±¡ã€‚G1 æ”¶é›†å™¨çš„è¿è¡Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p><ol><li><strong>åˆå§‹æ ‡è®° (Inital Marking)</strong>ï¼šæ ‡è®° <code>GC Roots</code> èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä¿®æ”¹ TAMSï¼ˆTop at Mark Startï¼‰æŒ‡é’ˆçš„å€¼ï¼Œè®©ä¸‹ä¸€é˜¶æ®µç”¨æˆ·çº¿ç¨‹å¹¶å‘è¿è¡Œæ—¶ï¼Œèƒ½å¤Ÿæ­£ç¡®çš„åœ¨ Reigin ä¸­åˆ†é…æ–°å¯¹è±¡ã€‚G1 ä¸ºæ¯ä¸€ä¸ª Reigin éƒ½è®¾è®¡äº†ä¸¤ä¸ªåä¸º TAMS çš„æŒ‡é’ˆï¼Œæ–°åˆ†é…çš„å¯¹è±¡å¿…é¡»ä½äºè¿™ä¸¤ä¸ªæŒ‡é’ˆä½ç½®ä»¥ä¸Šï¼Œä½äºè¿™ä¸¤ä¸ªæŒ‡é’ˆä½ç½®ä»¥ä¸Šçš„å¯¹è±¡é»˜è®¤è¢«éšå¼æ ‡è®°ä¸ºå­˜æ´»çš„ï¼Œä¸ä¼šçº³å…¥å›æ”¶èŒƒå›´ï¼›</li><li><strong>å¹¶å‘æ ‡è®° (Concurrent Marking)</strong>ï¼šä» <code>GC Roots</code> èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾ã€‚éå†å®Œæˆåï¼Œè¿˜éœ€è¦å¤„ç† SATB è®°å½•ä¸­å˜åŠ¨çš„å¯¹è±¡ã€‚SATBï¼ˆsnapshot-at-the-beginningï¼Œå¼€å§‹é˜¶æ®µå¿«ç…§ï¼‰èƒ½å¤Ÿæœ‰æ•ˆçš„è§£å†³å¹¶å‘æ ‡è®°é˜¶æ®µå› ä¸ºç”¨æˆ·çº¿ç¨‹è¿è¡Œè€Œå¯¼è‡´çš„å¯¹è±¡å˜åŠ¨ï¼Œå…¶æ•ˆç‡æ¯” CMS é‡æ–°æ ‡è®°é˜¶æ®µæ‰€ä½¿ç”¨çš„å¢é‡æ›´æ–°ç®—æ³•æ•ˆç‡æ›´é«˜ï¼›</li><li><strong>æœ€ç»ˆæ ‡è®° (Final Marking)</strong>ï¼šå¯¹ç”¨æˆ·çº¿ç¨‹åšä¸€ä¸ªçŸ­æš‚çš„æš‚åœï¼Œç”¨äºå¤„ç†å¹¶å‘é˜¶æ®µç»“æŸåä»é—ç•™ä¸‹æ¥çš„å°‘é‡çš„ STAB è®°å½•ã€‚è™½ç„¶å¹¶å‘æ ‡è®°é˜¶æ®µä¼šå¤„ç† SATB è®°å½•ï¼Œä½†ç”±äºå¤„ç†æ—¶ç”¨æˆ·çº¿ç¨‹ä¾ç„¶æ˜¯è¿è¡Œä¸­çš„ï¼Œå› æ­¤ä¾ç„¶ä¼šæœ‰å°‘é‡çš„å˜åŠ¨ï¼Œæ‰€ä»¥éœ€è¦æœ€ç»ˆæ ‡è®°æ¥å¤„ç†ï¼›</li><li><strong>ç­›é€‰å›æ”¶ (Live Data Counting and Evacuation)</strong>ï¼šè´Ÿè´£æ›´æ–° Regin ç»Ÿè®¡æ•°æ®ï¼ŒæŒ‰ç…§å„ä¸ª Regin çš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œåœ¨æ ¹æ®ç”¨æˆ·æœŸæœ›çš„åœé¡¿æ—¶é—´è¿›è¡Œæ¥æŒ‡å®šå›æ”¶è®¡åˆ’ï¼Œå¯ä»¥é€‰æ‹©ä»»æ„å¤šä¸ª Regin æ„æˆå›æ”¶é›†ã€‚ç„¶åå°†å›æ”¶é›†ä¸­ Regin çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°ç©ºçš„ Regin ä¸­ï¼Œå†æ¸…ç†æ‰æ•´ä¸ªæ—§çš„ Regin ã€‚æ­¤æ—¶å› ä¸ºæ¶‰åŠåˆ°å­˜æ´»å¯¹è±¡çš„ç§»åŠ¨ï¼Œæ‰€ä»¥éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹ï¼Œå¹¶ç”±å¤šä¸ªæ”¶é›†çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œã€‚</li></ol><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628152953093-7e268260.png" alt="image-20220628152953093" tabindex="0" loading="lazy"><figcaption>image-20220628152953093</figcaption></figure><h4 id="zgc-æ”¶é›†å™¨" tabindex="-1"><a class="header-anchor" href="#zgc-æ”¶é›†å™¨" aria-hidden="true">#</a> ZGC æ”¶é›†å™¨</h4><p>ä¸ CMS ä¸­çš„ ParNew å’Œ G1 ç±»ä¼¼ï¼ŒZGC ä¹Ÿé‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œä¸è¿‡ ZGC å¯¹è¯¥ç®—æ³•åšäº†é‡å¤§æ”¹è¿›ã€‚</p><p>åœ¨ ZGC ä¸­å‡ºç° Stop The World çš„æƒ…å†µä¼šæ›´å°‘ï¼</p><blockquote><p>æ‹“å±•</p></blockquote><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220612165223576-a6f3279f.png" alt="image-20220612165223576" tabindex="0" loading="lazy"><figcaption>image-20220612165223576</figcaption></figure><ul><li>ä¸¤ä¸ªæ”¶é›†å™¨é—´æœ‰è¿çº¿ï¼Œè¡¨æ˜å®ƒä»¬å¯ä»¥æ­é…ä½¿ç”¨ï¼šSerial/Serial Oldã€Serial/CMSã€ParNew/Serial Oldã€ParNew/CMSã€Parallel Scavenge/Serial Oldã€Parallel Scavenge/Parallel Oldã€G1ã€‚</li><li>å…¶ä¸­ Serial Old ä½œä¸º CMS å‡ºç°&quot;Concurrent Mode Failure&quot;å¤±è´¥çš„åå¤‡é¢„æ¡ˆã€‚</li><li>**ï¼ˆçº¢è‰²è™šçº¿ï¼‰**ç”±äºç»´æŠ¤å’Œå…¼å®¹æ€§æµ‹è¯•çš„æˆæœ¬ï¼Œåœ¨ JDK 8 æ—¶å°† Serial + CMSã€ParNew + Serial Old è¿™ä¸¤ä¸ªç»„åˆå£°æ˜ä¸ºåºŸå¼ƒï¼ˆJEP173ï¼‰ï¼Œå¹¶åœ¨ JDK 9 ä¸­å®Œå…¨å–æ¶ˆäº†è¿™äº›ç»„åˆçš„æ”¯æŒï¼ˆJEP214ï¼‰ï¼Œå³ï¼šç§»é™¤ã€‚</li><li>**ï¼ˆç»¿è‰²è™šçº¿ï¼‰**JDK 14 ä¸­ï¼šå¼ƒç”¨ Parallel Scavenge å’Œ Serialold GC ç»„åˆï¼ˆJEP366ï¼‰ã€‚</li><li>**ï¼ˆé’è‰²è™šçº¿ï¼‰**JDK 14 ä¸­ï¼šåˆ é™¤ CMS åƒåœ¾å›æ”¶å™¨ï¼ˆJEP363ï¼‰ã€‚</li></ul><h3 id="minor-gc-å’Œ-full-gc-æœ‰ä»€ä¹ˆä¸åŒå‘¢" tabindex="-1"><a class="header-anchor" href="#minor-gc-å’Œ-full-gc-æœ‰ä»€ä¹ˆä¸åŒå‘¢" aria-hidden="true">#</a> Minor Gc å’Œ Full GC æœ‰ä»€ä¹ˆä¸åŒå‘¢</h3><p>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC / Young GCï¼‰ï¼šåªå¯¹æ–°ç”Ÿä»£è¿›è¡Œåƒåœ¾æ”¶é›†</p><p>æ•´å †æ”¶é›† (Full GC)ï¼šæ”¶é›†æ•´ä¸ª Java å †å’Œæ–¹æ³•åŒº</p><blockquote><p>æ‹“å±•1ï¼šæœ‰å“ªäº›å¸¸è§çš„ GCï¼Ÿ</p></blockquote><p>é’ˆå¯¹ HotSpot VM çš„å®ç°ï¼Œå®ƒé‡Œé¢çš„ GC å…¶å®å‡†ç¡®åˆ†ç±»åªæœ‰ä¸¤å¤§ç§ï¼š</p><p>éƒ¨åˆ†æ”¶é›† (Partial GC)ï¼š</p><ul><li>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC / Young GCï¼‰ï¼šåªå¯¹æ–°ç”Ÿä»£è¿›è¡Œåƒåœ¾æ”¶é›†ï¼›</li><li>è€å¹´ä»£æ”¶é›†ï¼ˆMajor GC / Old GCï¼‰ï¼šåªå¯¹è€å¹´ä»£è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ Major GC åœ¨æœ‰çš„è¯­å¢ƒä¸­ä¹Ÿç”¨äºæŒ‡ä»£æ•´å †æ”¶é›†ï¼›</li><li>æ··åˆæ”¶é›†ï¼ˆMixed GCï¼‰ï¼šå¯¹æ•´ä¸ªæ–°ç”Ÿä»£å’Œéƒ¨åˆ†è€å¹´ä»£è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚</li></ul><p>æ•´å †æ”¶é›† (Full GC)ï¼šæ”¶é›†æ•´ä¸ª Java å †å’Œæ–¹æ³•åŒºã€‚</p><blockquote><p>æ‹“å±•2ï¼šè°ˆè°ˆä½ å¯¹ Minor GCã€è¿˜æœ‰ Full GC çš„ç†è§£ã€‚Minor GC ä¸ Full GC åˆ†åˆ«åœ¨ä»€ä¹ˆæ—¶å€™å‘ç”Ÿï¼Ÿ Minor GC ä¼šå‘ç”Ÿ STW(stop the world) ç°è±¡å—ï¼Ÿ</p></blockquote><p><strong>Minor GC</strong></p><ul><li>å½“å¹´è½»ä»£ç©ºé—´ä¸è¶³æ—¶ï¼Œå°±ä¼šè§¦å‘Minor GCï¼Œè¿™é‡Œçš„å¹´è½»ä»£æ»¡æŒ‡çš„æ˜¯ <code>EdenåŒºæ»¡</code>ï¼ŒSurvivoråŒºæ»¡ä¸ä¼šè§¦å‘GCã€‚ï¼ˆæ¯æ¬¡Minor GCä¼šæ¸…ç†å¹´è½»ä»£çš„å†…å­˜ï¼‰</li><li>å› ä¸ºJavaå¯¹è±¡å¤§å¤šéƒ½å…·å¤‡æœç”Ÿå¤•ç­çš„ç‰¹æ€§ï¼Œæ‰€ä»¥<strong>Minor GCéå¸¸é¢‘ç¹</strong>ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚è¿™ä¸€å®šä¹‰æ—¢æ¸…æ™°åˆæ˜“äºç†è§£ã€‚</li><li>Minor GCä¼šå¼•å‘ <code>STW</code>ï¼Œ<code>æš‚åœå…¶å®ƒç”¨æˆ·çš„çº¿ç¨‹ï¼Œç­‰å¾…åƒåœ¾å›æ”¶çº¿ç¨‹ç»“æŸï¼Œç”¨æˆ·çº¿ç¨‹æ‰æ¢å¤è¿è¡Œ</code></li></ul><p><strong>Major GC</strong></p><ul><li>æŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„GCï¼Œå¯¹è±¡ä»è€å¹´ä»£æ¶ˆå¤±æ—¶ï¼Œæˆ‘ä»¬è¯´ â€œMajor Gcâ€ æˆ– â€œFull GCâ€ å‘ç”Ÿäº†</li><li>å‡ºç°äº†MajorGcï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„Minor GC <ul><li>ä½†éç»å¯¹çš„ï¼Œåœ¨Parallel Scavengeæ”¶é›†å™¨çš„æ”¶é›†ç­–ç•¥é‡Œå°±æœ‰ç›´æ¥è¿›è¡ŒMajor GCçš„ç­–ç•¥é€‰æ‹©è¿‡ç¨‹</li><li>ä¹Ÿå°±æ˜¯åœ¨è€å¹´ä»£ç©ºé—´ä¸è¶³æ—¶ï¼Œä¼šå…ˆå°è¯•è§¦å‘Minor GCï¼Œå¦‚æœä¹‹åç©ºé—´è¿˜ä¸è¶³ï¼Œåˆ™è§¦å‘Major GC</li></ul></li><li><strong>Major GCçš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯”Minor GCæ…¢10å€ä»¥ä¸Š</strong>ï¼ŒSTWçš„æ—¶é—´æ›´é•¿</li><li>å¦‚æœMajor GCåï¼Œå†…å­˜è¿˜ä¸è¶³ï¼Œå°±æŠ¥OOMäº†</li></ul><p><strong>Full GC</strong></p><ul><li>è°ƒç”¨System.gc( )æ—¶ï¼Œç³»ç»Ÿå»ºè®®æ‰§è¡ŒFull GCï¼Œä½†æ˜¯ä¸å¿…ç„¶æ‰§è¡Œ</li><li>è€å¹´ä»£ç©ºé—´ä¸è¶³</li><li>æ–¹æ³•åŒºç©ºé—´ä¸è¶³</li><li><strong>é€šè¿‡Minor GCåè¿›å…¥è€å¹´ä»£çš„å¹³å‡å¤§å° å¤§äº è€å¹´ä»£çš„å¯ç”¨å†…å­˜</strong></li><li>ç”±EdenåŒºã€survivor space0ï¼ˆFrom Spaceï¼‰åŒº å‘survivor space1ï¼ˆTo Spaceï¼‰åŒºå¤åˆ¶æ—¶ï¼Œå¯¹è±¡å¤§å°å¤§äºTo Spaceå¯ç”¨å†…å­˜ï¼Œåˆ™æŠŠè¯¥å¯¹è±¡è½¬å­˜åˆ°è€å¹´ä»£ï¼Œä¸”è€å¹´ä»£çš„å¯ç”¨å†…å­˜ å°äº è¯¥å¯¹è±¡å¤§å°</li></ul><h3 id="â­ï¸å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#â­ï¸å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹" aria-hidden="true">#</a> â­ï¸å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹</h3><h4 id="æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#æ¦‚è¿°" aria-hidden="true">#</a> æ¦‚è¿°</h4><p>é¦–å…ˆåœ¨æ–‡ä»¶å†…åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VM</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å†éšä¾¿newä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå°±å¯ä»¥çœ‹åˆ°å®ƒçš„å­—èŠ‚ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> newObject <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">VM</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">0</span> <span class="token keyword">new</span> #<span class="token number">2</span> <span class="token operator">&lt;</span>cn<span class="token operator">/</span>zhiyucs<span class="token operator">/</span>test<span class="token operator">/</span><span class="token constant">VM</span><span class="token operator">&gt;</span>
<span class="token number">3</span> dup
<span class="token number">4</span> invokespecial #<span class="token number">3</span> <span class="token operator">&lt;</span>cn<span class="token operator">/</span>zhiyucs<span class="token operator">/</span>test<span class="token operator">/</span><span class="token constant">VM</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span><span class="token operator">&gt;</span>
<span class="token number">7</span> astore_1
<span class="token number">8</span> <span class="token keyword">return</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>newæŒ‡ä»¤</strong>ç›¸å½“äºå»å¯¹åº”çš„å†…å­˜ç©ºé—´ç”³è¯·ä¸€å—å†…å­˜å¤§å° ç”¨äºå­˜æ”¾å¯¹è±¡æ•°æ® å¯¹è±¡çš„å¤§å°æ˜¯å¯ä»¥ç¡®å®šçš„ æ¯”å¦‚intå ç”¨4ä¸ªå­—èŠ‚ å¼•ç”¨ä¹Ÿå ç”¨4ä¸ªå­—èŠ‚ æ‰€ä»¥è¿™ä¸ªæ—¶å€™ç”³è¯·çš„å†…å­˜ç©ºé—´å¤§å°æ˜¯å›ºå®šçš„</p><p><strong>dup</strong>ç›¸å½“äºå°†å¯¹åº”çš„å†…å­˜åœ°å€çš„å¼•ç”¨å¤åˆ¶äº†ä¸€ä»½å‹åˆ°æ ˆä¸­ï¼Œé‚£ä¹ˆå¯¹åº”æ ˆä¸­ä¼šæœ‰2ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œè¿™2ä¸ªå¯¹è±¡çš„å¼•ç”¨ä¸€ä¸ªç”¨äºæ“ä½œå¯¹è±¡èµ‹å€¼ï¼Œä¸€ä¸ªç”¨äºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨</p><p><strong>invokespecialæŒ‡ä»¤</strong>æ˜¯è°ƒç”¨å¯¹è±¡çš„æ„é€ å™¨åˆå§‹åŒ–å¯¹è±¡æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯é»˜è®¤æ„é€ å™¨ç©ºå‚æ„é€ ä¸€èˆ¬ç”¨äºåˆå§‹åŒ–å¯¹è±¡æ•°æ®ï¼Œåœ¨ <code>new</code>çš„æ—¶å€™JVMä¼šç»™å¯¹è±¡çš„å…¨å±€å˜é‡èµ‹é»˜è®¤å€¼</p><p><strong>astoreæŒ‡ä»¤</strong>å°±æ˜¯å°†å¯¹åº”å¯¹è±¡çš„å¼•ç”¨å­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­</p><h4 id="ä»jvmå±‚é¢åˆ†æ" tabindex="-1"><a class="header-anchor" href="#ä»jvmå±‚é¢åˆ†æ" aria-hidden="true">#</a> ä»JVMå±‚é¢åˆ†æ</h4><h5 id="_1ï¸âƒ£ç±»åŠ è½½" tabindex="-1"><a class="header-anchor" href="#_1ï¸âƒ£ç±»åŠ è½½" aria-hidden="true">#</a> 1ï¸âƒ£ç±»åŠ è½½</h5><p>å…·ä½“æ¥è¯´ï¼Œå½“ Java è™šæ‹Ÿæœºé‡åˆ°ä¸€æ¡å­—èŠ‚ç  new æŒ‡ä»¤æ—¶ï¼š</p><p>1ï¼‰é¦–å…ˆæ£€æŸ¥æ ¹æ® class æ–‡ä»¶ä¸­çš„å¸¸é‡æ± è¡¨ï¼ˆConstant Pool Tableï¼‰èƒ½å¦æ‰¾åˆ°è¿™ä¸ªç±»å¯¹åº”çš„ç¬¦å·å¼•ç”¨</p><blockquote><p>æ­¤å¤„å¯ä»¥å›é¡¾ä¸€æ³¢<strong>å¸¸é‡æ± è¡¨ (Constant Pool Table)</strong> çš„æ¦‚å¿µï¼š</p><p>ç”¨äºå­˜æ”¾<strong>ç¼–è¯‘æœŸ</strong>ç”Ÿæˆçš„å„ç§å­—é¢é‡ï¼ˆå­—é¢é‡ç›¸å½“äº Java è¯­è¨€å±‚é¢å¸¸é‡çš„æ¦‚å¿µï¼Œå¦‚æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œå£°æ˜ä¸º final çš„å¸¸é‡å€¼ç­‰ï¼‰ä¸ç¬¦å·å¼•ç”¨ã€‚æœ‰ä¸€äº›æ–‡ç« ä¼šæŠŠ class å¸¸é‡æ± è¡¨ç§°ä¸º<strong>é™æ€å¸¸é‡æ± </strong>ã€‚</p><p>éƒ½æ˜¯å¸¸é‡æ± ï¼Œå¸¸é‡æ± è¡¨å’Œæ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶å¸¸é‡æ± æœ‰å•¥å…³ç³»å—ï¼Ÿè¿è¡Œæ—¶å¸¸é‡æ± æ˜¯å¹²å˜›çš„å‘¢ï¼Ÿ</p><p><strong>è¿è¡Œæ—¶å¸¸é‡æ± å¯ä»¥åœ¨è¿è¡ŒæœŸé—´å°† class å¸¸é‡æ± è¡¨ä¸­çš„ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨</strong>ã€‚ç®€å•æ¥è¯´ï¼Œclass å¸¸é‡æ± è¡¨å°±ç›¸å½“äºä¸€å †ç´¢å¼•ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± æ ¹æ®è¿™äº›ç´¢å¼•æ¥æŸ¥æ‰¾å¯¹åº”æ–¹æ³•æˆ–å­—æ®µæ‰€å±çš„ç±»å‹ä¿¡æ¯å’Œåç§°åŠæè¿°ç¬¦ä¿¡æ¯</p></blockquote><p>2ï¼‰ç„¶åå»æ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­æŸ¥æ‰¾è¯¥ç¬¦å·å¼•ç”¨æ‰€æŒ‡å‘çš„ç±»æ˜¯å¦å·²è¢« JVM åŠ è½½ã€è§£æå’Œåˆå§‹åŒ–è¿‡</p><ul><li>å¦‚æœæ²¡æœ‰ï¼Œé‚£å°±å…ˆæ‰§è¡Œç›¸åº”çš„ç±»åŠ è½½è¿‡ç¨‹</li><li>å¦‚æœæœ‰ï¼Œé‚£ä¹ˆè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜</li></ul><h5 id="_2ï¸âƒ£åˆ†é…å†…å­˜-å¯¹è±¡åœ¨å †ä¸Šåˆ†é…çš„ä¸¤ç§æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_2ï¸âƒ£åˆ†é…å†…å­˜-å¯¹è±¡åœ¨å †ä¸Šåˆ†é…çš„ä¸¤ç§æ–¹å¼" aria-hidden="true">#</a> 2ï¸âƒ£åˆ†é…å†…å­˜ï¼ˆå¯¹è±¡åœ¨å †ä¸Šåˆ†é…çš„ä¸¤ç§æ–¹å¼ï¼‰</h5><p>æ ¹æ®å †ä¸­çš„å†…å­˜æ˜¯å¦è§„æ•´ï¼Œæœ‰ä¸¤ç§åˆ’åˆ†æ–¹å¼ï¼Œæˆ–è€…è¯´å¯¹è±¡åœ¨å †ä¸Šçš„åˆ†é…æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p>1ï¼‰<strong>å‡è®¾ Java å †ä¸­å†…å­˜æ˜¯ç»å¯¹è§„æ•´çš„</strong>ï¼Œæ‰€æœ‰è¢«ä½¿ç”¨è¿‡çš„å†…å­˜éƒ½è¢«æ”¾åœ¨ä¸€è¾¹ï¼Œç©ºé—²çš„å†…å­˜è¢«æ”¾åœ¨å¦ä¸€è¾¹ï¼Œä¸­é—´æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºåˆ†ç•Œç‚¹çš„æŒ‡ç¤ºå™¨ï¼Œé‚£æ‰€åˆ†é…å†…å­˜å°±ä»…ä»…æ˜¯æŠŠè¿™ä¸ªæŒ‡é’ˆ å‘ ç©ºé—²ç©ºé—´æ–¹å‘ æŒªåŠ¨ä¸€æ®µä¸å¯¹è±¡å¤§å°ç›¸ç­‰çš„è·ç¦»ï¼Œè¿™ç§åˆ†é…æ–¹å¼ç§°ä¸º <strong>æŒ‡é’ˆç¢°æ’</strong>ï¼ˆBump The Pointerï¼‰</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628113523166-856fd353.png" alt="image-20220628113523166" tabindex="0" loading="lazy"><figcaption>image-20220628113523166</figcaption></figure><p>2ï¼‰<strong>å¦‚æœ Java å †ä¸­çš„å†…å­˜å¹¶ä¸æ˜¯è§„æ•´çš„</strong>ï¼Œå·²è¢«ä½¿ç”¨çš„å†…å­˜å’Œç©ºé—²çš„å†…å­˜ç›¸äº’äº¤é”™åœ¨ä¸€èµ·ï¼Œé‚£å°±æ²¡æœ‰åŠæ³•ç®€å•åœ°è¿›è¡ŒæŒ‡é’ˆç¢°æ’äº†ï¼Œè™šæ‹Ÿæœºå°±å¿…é¡»ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ï¼Œè®°å½•å“ªäº›å†…å­˜å—æ˜¯å¯ç”¨çš„ï¼Œåœ¨åˆ†é…çš„æ—¶å€™ä»åˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„è¿ç»­ç©ºé—´åˆ’åˆ†ç»™è¿™ä¸ªå¯¹è±¡ï¼Œå¹¶æ›´æ–°åˆ—è¡¨ä¸Šçš„è®°å½•ï¼Œè¿™ç§åˆ†é…æ–¹å¼ç§°ä¸º <strong>ç©ºé—²åˆ—è¡¨</strong>ï¼ˆFree Listï¼‰ã€‚</p><blockquote><p>é€‰æ‹©å“ªç§åˆ†é…æ–¹å¼ç”± Java å †æ˜¯å¦è§„æ•´å†³å®šï¼Œé‚£åˆæœ‰åŒå­¦ä¼šé—®äº†ï¼Œå †æ˜¯å¦è§„æ•´åˆç”±è°æ¥å†³å®šå‘¢ï¼Ÿ</p><p>Java å †æ˜¯å¦è§„æ•´ç”±æ‰€é‡‡ç”¨çš„åƒåœ¾æ”¶é›†å™¨æ˜¯å¦å¸¦æœ‰ç©ºé—´å‹ç¼©æ•´ç†ï¼ˆCompactï¼‰çš„èƒ½åŠ›å†³å®šçš„ï¼ˆæˆ–è€…è¯´ç”±åƒåœ¾æ”¶é›†å™¨é‡‡ç”¨çš„åƒåœ¾æ”¶é›†ç®—æ³•æ¥å†³å®šçš„ï¼Œå…·ä½“åƒåœ¾æ”¶é›†ç®—æ³•è§åç»­æ–‡ç« ï¼‰ï¼š</p><ul><li>å› æ­¤ï¼Œå½“ä½¿ç”¨ Serialã€ParNew ç­‰å¸¦å‹ç¼©æ•´ç†è¿‡ç¨‹çš„æ”¶é›†å™¨æ—¶ï¼Œç³»ç»Ÿé‡‡ç”¨çš„åˆ†é…ç®—æ³•æ˜¯æŒ‡é’ˆç¢°æ’ï¼Œæ—¢ç®€å•åˆé«˜æ•ˆ</li><li>è€Œå½“ä½¿ç”¨ CMS è¿™ç§åŸºäºæ¸…é™¤ï¼ˆSweepï¼‰ç®—æ³•çš„æ”¶é›†å™¨æ—¶ï¼Œç†è®ºä¸Šå°±åªèƒ½é‡‡ç”¨è¾ƒä¸ºå¤æ‚çš„ç©ºé—²åˆ—è¡¨æ¥åˆ†é…å†…å­˜</li></ul></blockquote><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628113934143-8eb571d2.png" alt="image-20220628113934143" tabindex="0" loading="lazy"><figcaption>image-20220628113934143</figcaption></figure><h5 id="_3ï¸âƒ£åˆå§‹åŒ–é›¶å€¼" tabindex="-1"><a class="header-anchor" href="#_3ï¸âƒ£åˆå§‹åŒ–é›¶å€¼" aria-hidden="true">#</a> 3ï¸âƒ£åˆå§‹åŒ–é›¶å€¼</h5><p>ä¸¾ä¸ªğŸŒ°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VM</span>  <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> data<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯”å¦‚æˆ‘ä»¬å¯¹è±¡ä¸­ å®šä¹‰äº† <code>value</code>å’Œ <code>data</code></p><p>JVMä¸ºäº†å®ç°æˆ‘ä»¬ä¸åšèµ‹å€¼æ“ä½œçš„å¯¹è±¡ä¹Ÿå¯ä»¥æ‹¿æ¥ç›´æ¥ä½¿ç”¨åœ¨ç”³è¯·ç©ºé—´çš„ä¼šç»™å¯¹è±¡èµ‹å€¼ä¸º <code>null</code>ï¼Œ<strong>åŸºæœ¬æ•°æ®ç±»å‹ä¼šèµ‹å€¼ä¸ºé»˜è®¤å€¼,å¼•ç”¨æ•°æ®ä¸ºèµ‹å€¼ä¸ºnull</strong></p><p>æ¯”å¦‚ä¸Šé¢ä»£ç  <code>value</code>ä¼šèµ‹å€¼ä¸º <code>0</code> ,<code>data</code>ä¼šèµ‹å€¼ä¸º <code>null</code> ,è¿™é‡Œæ˜¯èµ‹ä¸ºé»˜è®¤å€¼ï¼Œä¸æ˜¯èµ‹å€¼</p><p>è¿™æ­¥æ“ä½œä¿è¯äº†å¯¹è±¡çš„å®ä¾‹å­—æ®µåœ¨ Java ä»£ç ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±ç›´æ¥ä½¿ç”¨ï¼Œä½¿ç¨‹åºèƒ½è®¿é—®åˆ°è¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é›¶å€¼ã€‚</p><blockquote><p>å¦‚æœä½¿ç”¨äº† TLAB çš„è¯ï¼Œåˆå§‹åŒ–é›¶å€¼è¿™é¡¹å·¥ä½œå¯ä»¥æå‰è‡³ TLAB åˆ†é…æ—¶å°±é¡ºä¾¿è¿›è¡Œäº†</p></blockquote><h5 id="_4ï¸âƒ£è®¾ç½®å¯¹è±¡å¤´" tabindex="-1"><a class="header-anchor" href="#_4ï¸âƒ£è®¾ç½®å¯¹è±¡å¤´" aria-hidden="true">#</a> 4ï¸âƒ£è®¾ç½®å¯¹è±¡å¤´</h5><p>å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€å¯ä»¥åˆ†ä¸º 3 å—åŒºåŸŸï¼šå¯¹è±¡å¤´ï¼ˆObject Headerï¼‰ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……</p><p>å¯¹é½å¡«å……å¹¶ä¸æ˜¯ä»€ä¹ˆæœ‰æ„ä¹‰çš„æ•°æ®ï¼Œå®ä¾‹æ•°æ®æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥æ“ä½œä¸­è¿›è¡Œäº†åˆå§‹åŒ–é›¶å€¼ï¼Œé‚£ä¹ˆå¯¹äºå‰©ä¸‹çš„å¯¹è±¡å¤´ä¸­çš„ä¿¡æ¯æ¥è¯´ï¼Œè‡ªç„¶ä¸å¿…å¤šè¯´ï¼Œä¹Ÿæ˜¯è¦è¿›è¡Œä¸€äº›èµ‹å€¼æ“ä½œçš„ï¼šä¾‹å¦‚è¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€å¦‚ä½•æ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ã€å¯¹è±¡çš„å“ˆå¸Œç ã€å¯¹è±¡çš„ GC åˆ†ä»£å¹´é¾„ç­‰ä¿¡æ¯ã€‚æ ¹æ®è™šæ‹Ÿæœºå½“å‰è¿è¡ŒçŠ¶æ€çš„ä¸åŒï¼Œå¦‚æ˜¯å¦å¯ç”¨åå‘é”ç­‰ï¼Œå¯¹è±¡å¤´ä¼šæœ‰ä¸åŒçš„è®¾ç½®æ–¹å¼ã€‚</p><blockquote><p>å¯¹è±¡å¤´</p></blockquote><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628152051756-2a357a57.png" alt="image-20220628152051756" tabindex="0" loading="lazy"><figcaption>image-20220628152051756</figcaption></figure><h5 id="_5ï¸âƒ£æ‰§è¡Œinit" tabindex="-1"><a class="header-anchor" href="#_5ï¸âƒ£æ‰§è¡Œinit" aria-hidden="true">#</a> 5ï¸âƒ£æ‰§è¡Œinit</h5><p>ä¸Šé¢å››ä¸ªæ­¥éª¤éƒ½èµ°å®Œä¹‹åï¼Œä» JVM çš„è§†è§’æ¥çœ‹ï¼Œå…¶å®ä¸€ä¸ªæ–°çš„å¯¹è±¡å·²ç»æˆåŠŸè¯ç”Ÿäº†ã€‚</p><p>ä½†æ˜¯ä»æˆ‘ä»¬ç¨‹åºå‘˜çš„è§†è§’æ¥çœ‹ï¼Œè¿™ä¸ªå¯¹è±¡ç¡®å®æ˜¯åˆ›å»ºå‡ºæ¥äº†ï¼Œä½†æ˜¯è¿˜æ²¡æŒ‰ç…§æˆ‘ä»¬å®šä¹‰çš„æ„é€ å‡½æ•°æ¥è¿›è¡Œèµ‹å€¼å‘¢ï¼Œæ‰€æœ‰çš„å­—æ®µéƒ½è¿˜æ˜¯é»˜è®¤çš„é›¶å€¼å•Šã€‚</p><p>æ„é€ å‡½æ•°å³ Class æ–‡ä»¶ä¸­çš„ <code>&lt;init&gt;()</code> æ–¹æ³•ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œnew æŒ‡ä»¤ä¹‹åä¼šæ¥ç€æ‰§è¡Œ <code>&lt;init&gt;()</code> æ–¹æ³•ï¼ŒæŒ‰ç…§æ„é€ å‡½æ•°çš„æ„å›¾å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·ä¸€ä¸ªçœŸæ­£å¯ç”¨çš„å¯¹è±¡æ‰ç®—å®Œå…¨åœ°è¢«æ„é€ å‡ºæ¥äº†</p><p>ä¸¾ä¸ªğŸŒ°ï¼Œä¸Šè¿°ä»£ç ç¼–è¯‘æˆå­—èŠ‚ç ä¹‹å</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token number">0</span> aload_0
 <span class="token number">1</span> invokespecial #<span class="token number">1</span> <span class="token operator">&lt;</span>java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span><span class="token operator">&gt;</span>
 <span class="token number">4</span> aload_0
 <span class="token number">5</span> bipush <span class="token number">100</span>
 <span class="token number">7</span> putfield #<span class="token number">2</span> <span class="token operator">&lt;</span>cn<span class="token operator">/</span>zhiyucs<span class="token operator">/</span>test<span class="token operator">/</span><span class="token constant">VM</span><span class="token punctuation">.</span>value <span class="token operator">:</span> <span class="token class-name">I</span><span class="token operator">&gt;</span>
 <span class="token number">10</span> <span class="token keyword">return</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="ğŸ¤æ€»è§ˆ" tabindex="-1"><a class="header-anchor" href="#ğŸ¤æ€»è§ˆ" aria-hidden="true">#</a> ğŸ¤æ€»è§ˆ</h5><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628151926533-b5172bcb.png" alt="image-20220628151926533" tabindex="0" loading="lazy"><figcaption>image-20220628151926533</figcaption></figure><blockquote><p>å¯¹è±¡åˆ›å»ºæ—¶å€™çš„å¹¶å‘å®‰å…¨é—®é¢˜</p></blockquote><p>å¦å¤–ï¼Œåœ¨ä¸ºå¯¹è±¡åˆ›å»ºå†…å­˜çš„æ—¶å€™ï¼Œè¿˜éœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼š<strong>å¹¶å‘å®‰å…¨é—®é¢˜</strong>ã€‚</p><p>å¯¹è±¡åˆ›å»ºåœ¨è™šæ‹Ÿæœºä¸­æ˜¯éå¸¸é¢‘ç¹çš„è¡Œä¸ºï¼Œä»¥ä¸Šé¢ä»‹ç»çš„æŒ‡é’ˆç¢°æ’æ³•ä¸ºä¾‹ï¼Œå³ä½¿åªä¿®æ”¹ä¸€ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„ä½ç½®ï¼Œåœ¨å¹¶å‘æƒ…å†µä¸‹ä¹Ÿå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯èƒ½å‡ºç°æŸä¸ªçº¿ç¨‹æ­£åœ¨ç»™å¯¹è±¡ A åˆ†é…å†…å­˜ï¼ŒæŒ‡é’ˆè¿˜æ²¡æ¥å¾—åŠä¿®æ”¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åˆ›å»ºäº†å¯¹è±¡ B åˆåŒæ—¶ä½¿ç”¨äº†åŸæ¥çš„æŒ‡é’ˆæ¥åˆ†é…å†…å­˜çš„æƒ…å†µã€‚</p><p>è§£å†³è¿™ä¸ªé—®é¢˜æœ‰ä¸¤ç§å¯é€‰æ–¹æ¡ˆï¼š</p><ul><li>æ–¹æ¡ˆ 1ï¼š<strong>CAS + å¤±è´¥é‡è¯•</strong>ï¼šCAS å¤§ä¼™åº”è¯¥éƒ½ç†Ÿæ‚‰ï¼Œæ¯”è¾ƒå¹¶äº¤æ¢ï¼Œä¹è§‚é”æ–¹æ¡ˆï¼Œå¦‚æœå¤±è´¥å°±é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢</li><li>æ–¹æ¡ˆ 2ï¼š<strong>æœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²</strong>ï¼ˆThread Local Allocation Bufferï¼Œ<code>TLAB</code>ï¼‰ï¼šæ¯ä¸ªçº¿ç¨‹åœ¨å †ä¸­é¢„å…ˆåˆ†é…ä¸€å°å—å†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰çš„è¿™ä¸€å°å—å†…å­˜å°±ç§°ä¸º TLABã€‚å“ªä¸ªçº¿ç¨‹è¦åˆ†é…å†…å­˜äº†ï¼Œå°±åœ¨å“ªä¸ªçº¿ç¨‹çš„ TLAB ä¸­è¿›è¡Œåˆ†é…ï¼Œè¿™æ ·å„ä¸ªçº¿ç¨‹ä¹‹é—´äº’ä¸å¹²æ‰°ã€‚å¦‚æœæŸä¸ªçº¿ç¨‹çš„ TLAB ç”¨å®Œäº†ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºå°±éœ€è¦ä¸ºå®ƒåˆ†é…æ–°çš„ TLABï¼Œè¿™æ—¶æ‰éœ€è¦è¿›è¡ŒåŒæ­¥é”å®šã€‚å¯ä»¥é€šè¿‡ <code>-XXï¼š+/-UseTLAB</code> å‚æ•°æ¥è®¾å®šæ˜¯å¦ä½¿ç”¨ TLABã€‚</li></ul><h3 id="å¯¹è±¡è®¿é—®æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡è®¿é—®æ–¹å¼" aria-hidden="true">#</a> å¯¹è±¡è®¿é—®æ–¹å¼</h3><p>æˆ–æ˜¯è¿™æ ·é—®ä½ ï¼šğŸ‘©â€ğŸ’»å¯¹è±¡çš„è®¿é—®å®šä½çš„ä¸¤ç§æ–¹å¼çŸ¥é“å—ï¼Ÿå„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹</p><h4 id="å¥æŸ„æ± " tabindex="-1"><a class="header-anchor" href="#å¥æŸ„æ± " aria-hidden="true">#</a> å¥æŸ„æ± </h4><p>å¦‚æœä½¿ç”¨å¥æŸ„çš„è¯ï¼Œé‚£ä¹ˆJavaå †ä¸­å°†ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜æ¥ä½œä¸ºå¥æŸ„æ± ï¼Œreference ä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªçš„å…·ä½“åœ°å€ä¿¡æ¯</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628152456384-6c0c2c57.png" alt="image-20220628152456384" tabindex="0" loading="lazy"><figcaption>image-20220628152456384</figcaption></figure><p>ç¼ºç‚¹ æ˜¾ç„¶è€Œè§ éœ€è¦å•ç‹¬å¼€è¾Ÿä¸€å—ç©ºé—´è®°å½•å¥æŸ„æ± å­˜å‚¨,å¹¶ä¸”è®¿é—®çš„æ—¶å€™éœ€è¦ä¸­è½¬ è®¿é—®æ•ˆç‡åä½ä¸€ç‚¹</p><p>ä¼˜ç‚¹ å½“å¯¹è±¡æ•°æ®å˜æ›´çš„æ—¶å€™æ¯”å¦‚åƒåœ¾å›æ”¶å™¨ éœ€è¦æ•´ç†å¯¹è±¡ éœ€è¦ç§»åŠ¨å¤åˆ¶ï¼ŒStackæ ˆç©ºé—´ä¸­çš„å¼•ç”¨ æ˜¯ä¸éœ€è¦ä¿®æ”¹çš„ åªéœ€è¦ä¿®æ”¹å¥æŸ„æ± ä¸­çš„å¼•ç”¨</p><h4 id="ç›´æ¥å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#ç›´æ¥å¼•ç”¨" aria-hidden="true">#</a> ç›´æ¥å¼•ç”¨</h4><p>å¦‚æœä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®ï¼Œé‚£ä¹ˆ Java å †å¯¹è±¡çš„å¸ƒå±€ä¸­å°±å¿…é¡»è€ƒè™‘å¦‚ä½•æ”¾ç½®è®¿é—®ç±»å‹æ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œreference ä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡çš„åœ°å€ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628152505040-c0287d5f.png" alt="image-20220628152505040" tabindex="0" loading="lazy"><figcaption>image-20220628152505040</figcaption></figure><p>ç¼ºç‚¹ å½“å¯¹è±¡æ•°æ®å˜æ›´å¼•ç”¨çš„æ—¶å€™ éœ€è¦ä¿®æ”¹Stackçš„æŒ‡é’ˆ</p><p>ä¼˜ç‚¹ ä¸éœ€è¦é¢å¤–çš„å¼€è¾Ÿä¸€å—ç©ºé—´å­˜å‚¨å¼•ç”¨ï¼Œåœ¨åŸæœ‰å¯¹è±¡å¤´ä¸­æ·»åŠ æŒ‡é’ˆæŒ‡å‘å³å¯ï¼Œè®¿é—®å¯¹è±¡å®ä½“æ•°æ®çš„æ—¶å€™æ•ˆç‡é«˜</p><h3 id="å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºå„ä»£è¡¨ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºå„ä»£è¡¨ä»€ä¹ˆ" aria-hidden="true">#</a> å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºå„ä»£è¡¨ä»€ä¹ˆï¼Ÿ</h3><blockquote><p>æœ¬èŠ‚å†…å®¹æ‘˜è‡ªå‘¨å¿—æ˜è€å¸ˆçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹å†…å®¹</p></blockquote><h4 id="oopmap" tabindex="-1"><a class="header-anchor" href="#oopmap" aria-hidden="true">#</a> OopMap</h4><p>ç”±äºç›®å‰ä¸»æµJavaè™šæ‹Ÿæœºä½¿ç”¨çš„éƒ½æ˜¯å‡†ç¡®å¼åƒåœ¾æ”¶é›†ï¼ˆè¿™ä¸ªæ¦‚å¿µåœ¨ç¬¬1ç« ä»‹ç»Exact VMç›¸å¯¹äºClassic VMçš„æ”¹è¿›æ—¶ä»‹ç»è¿‡ï¼‰ï¼Œæ‰€ä»¥å½“ç”¨æˆ·çº¿ç¨‹åœé¡¿ä¸‹æ¥ä¹‹åï¼Œå…¶å®å¹¶ä¸éœ€è¦ä¸€ä¸ªä¸æ¼åœ°æ£€æŸ¥å®Œæ‰€æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå…¨å±€çš„å¼•ç”¨ä½ç½®ï¼Œè™šæ‹Ÿæœºåº”å½“æ˜¯æœ‰åŠæ³•ç›´æ¥å¾—åˆ°å“ªäº›åœ°æ–¹å­˜æ”¾ç€å¯¹è±¡å¼•ç”¨çš„ã€‚åœ¨HotSpotçš„è§£å†³æ–¹æ¡ˆé‡Œï¼Œæ˜¯ä½¿ç”¨ä¸€ç»„ç§°ä¸ºOopMapï¼ˆOopæ˜¯æ™®é€šå¯¹è±¡æŒ‡é’ˆçš„æ„æ€ï¼šordinary object pointerï¼‰çš„æ•°æ®ç»“æ„æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚ä¸€æ—¦ç±»åŠ è½½åŠ¨ä½œå®Œæˆçš„æ—¶å€™ï¼ŒHotSpotå°±ä¼šæŠŠå¯¹è±¡å†…ä»€ä¹ˆåç§»é‡ä¸Šæ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®è®¡ç®—å‡ºæ¥ï¼Œåœ¨å³æ—¶ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šåœ¨ç‰¹å®šçš„ä½ç½®è®°å½•ä¸‹æ ˆé‡Œå’Œå¯„å­˜å™¨é‡Œå“ªäº›ä½ç½®æ˜¯å¼•ç”¨ã€‚è¿™æ ·æ”¶é›†å™¨åœ¨æ‰«ææ—¶å°±å¯ä»¥ç›´æ¥å¾—çŸ¥è¿™äº›ä¿¡æ¯äº†ï¼Œå¹¶ä¸éœ€è¦çœŸæ­£ä¸€ä¸ªä¸æ¼åœ°ä»æ–¹æ³•åŒºç­‰GC Rootså¼€å§‹æŸ¥æ‰¾ã€‚å› æ­¤ï¼Œåœ¨ HotSpot ä¸­é‡‡å–äº†ç©ºé—´æ¢æ—¶é—´çš„æ–¹æ³•ï¼Œä½¿ç”¨ OopMap æ¥å­˜å‚¨æ ˆä¸Šçš„å¯¹è±¡å¼•ç”¨çš„ä¿¡æ¯ã€‚</p><p>åœ¨ GC Roots æšä¸¾æ—¶ï¼Œåªéœ€è¦éå†æ¯ä¸ªæ ˆæ¡¢çš„ OopMapï¼Œé€šè¿‡ OopMap å­˜å‚¨çš„ä¿¡æ¯ï¼Œå¿«æ·åœ°æ‰¾åˆ° GC Rootsã€‚</p><p>OopMap ä¸­å­˜å‚¨äº†ä¸¤ç§å¯¹è±¡çš„å¼•ç”¨ï¼š</p><blockquote><p>â—‰ æ ˆé‡Œå’Œå¯„å­˜å™¨å†…çš„å¼•ç”¨ åœ¨å³æ—¶ç¼–è¯‘ä¸­ï¼Œåœ¨ç‰¹å®šçš„ä½ç½®è®°å½•ä¸‹æ ˆé‡Œå’Œå¯„å­˜å™¨é‡Œå“ªäº›ä½ç½®æ˜¯å¼•ç”¨</p><p>â—‰ å¯¹è±¡å†…çš„å¼•ç”¨ ç±»åŠ è½½åŠ¨ä½œå®Œæˆæ—¶ï¼ŒHotSpot å°±ä¼šè®¡ç®—å‡ºå¯¹è±¡å†…ä»€ä¹ˆåç§»é‡ä¸Šæ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ® æ³¨ï¼šæŠŠå­˜å‚¨å•å…ƒçš„å®é™…åœ°å€ä¸å…¶æ‰€åœ¨æ®µçš„æ®µåœ°å€ä¹‹é—´çš„è·ç¦»ç§°ä¸ºæ®µå†…åç§»ï¼Œä¹Ÿç§°ä¸ºæœ‰æ•ˆåœ°å€æˆ–åç§»é‡ï¼Œå› æ­¤ï¼Œå®é™…åœ°å€=æ‰€åœ¨æ®µçš„èµ·å§‹åœ°å€+åç§»é‡</p></blockquote><p>åœ¨ JVMä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸ºä¸€ä¸ªæ ˆï¼Œä¸€ä¸ªæ ˆç”±å¤šä¸ªæ ˆæ¡¢ç»„æˆï¼Œä¸€ä¸ªæ ˆæ¡¢å¯¹åº”ä¸€ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ ˆå¸§å¯èƒ½æœ‰å¤šä¸ª OopMapã€‚</p><p>å‡è®¾ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½åªæœ‰ä¸€ä¸ª OopMapï¼Œå¹¶ä¸”æ˜¯åœ¨æ–¹æ³•è¿”å›ä¹‹å‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// æ–¹æ³•1å­˜å‚¨åœ¨æ ˆå¸§3</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testMethod1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ ˆé‡Œå’Œå¯„å­˜å™¨å†…çš„å¼•ç”¨</span>
    <span class="token class-name">DemoD</span> demoD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ–¹æ³•2å­˜å‚¨åœ¨æ ˆå¸§8</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testMethod2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ ˆé‡Œå’Œå¯„å­˜å™¨å†…çš„å¼•ç”¨</span>
    <span class="token class-name">DemoA</span> demoA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¯¹è±¡å†…çš„å¼•ç”¨</span>
    demoA<span class="token punctuation">.</span><span class="token function">setDemoC</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DemoC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// æ ˆé‡Œå’Œå¯„å­˜å™¨å†…çš„å¼•ç”¨</span>
    <span class="token class-name">DemoA</span> demoB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‚£ä¹ˆ testMethod1() å’Œ testMethod2() çš„ OopMap å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723173000230-5549a9af.png" alt="image-20220723173000230" tabindex="0" loading="lazy"><figcaption>image-20220723173000230</figcaption></figure><h4 id="å®‰å…¨ç‚¹" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨ç‚¹" aria-hidden="true">#</a> å®‰å…¨ç‚¹</h4><p>åœ¨ OopMap çš„ååŠ©ä¸‹ï¼ŒHotSpot å¯ä»¥å¿«é€Ÿå®Œæˆæ ¹èŠ‚ç‚¹æšä¸¾äº†ï¼Œä½†ä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜éšä¹‹è€Œæ¥ï¼šç”±äºå¼•ç”¨å…³ç³»å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™å°±ä¼šå¯¼è‡´ OopMap å†…å®¹å˜åŒ–çš„æŒ‡ä»¤éå¸¸å¤šï¼Œå¦‚æœä¸ºæ¯ä¸€æ¡æŒ‡ä»¤éƒ½ç”Ÿæˆå¯¹åº”çš„ OopMapï¼Œé‚£å°†ä¼šéœ€è¦å¤§é‡çš„é¢å¤–å­˜å‚¨ç©ºé—´ï¼Œè¿™æ ·åƒåœ¾æ”¶é›†ä¼´éšè€Œæ¥çš„ç©ºé—´æˆæœ¬å°±ä¼šå˜å¾—æ— æ³•å¿å—çš„é«˜æ˜‚ã€‚</p><p>æ‰€ä»¥å®é™…ä¸Š HotSpot ä¹Ÿç¡®å®æ²¡æœ‰ä¸ºæ¯æ¡æŒ‡ä»¤éƒ½ç”Ÿæˆ OopMapï¼Œåªæ˜¯åœ¨ â€œç‰¹å®šçš„ä½ç½®â€ ç”Ÿæˆ OopMapï¼Œæ¢å¥è¯è¯´ï¼Œåªæœ‰åœ¨æŸäº› â€ç‰¹å®šçš„ä½ç½®â€œ ä¸Šæ‰ä¼šæŠŠå¯¹è±¡å¼•ç”¨çš„ç›¸å…³ä¿¡æ¯ç»™è®°å½•ä¸‹æ¥ï¼Œè¿™äº›ä½ç½®ä¹Ÿè¢«ç§°ä¸º<strong>å®‰å…¨ç‚¹</strong>ï¼ˆSafepointï¼‰ã€‚</p><p>æœ‰äº†å®‰å…¨ç‚¹çš„è®¾å®šï¼Œä¹Ÿå°±å†³å®šäº†ç”¨æˆ·ç¨‹åºæ‰§è¡Œæ—¶å¹¶ä¸æ˜¯éšä¾¿å“ªä¸ªæ—¶å€™éƒ½èƒ½å¤Ÿåœé¡¿ä¸‹æ¥å¼€å§‹ GC çš„ï¼Œè€Œæ˜¯å¼ºåˆ¶è¦æ±‚<strong>ç¨‹åºå¿…é¡»æ‰§è¡Œåˆ°è¾¾å®‰å…¨ç‚¹åæ‰èƒ½å¤Ÿè¿›è¡Œ GC</strong>ï¼ˆå› ä¸ºä¸åˆ°è¾¾å®‰å…¨ç‚¹è¯ï¼Œæ²¡æœ‰ OopMapï¼Œè™šæ‹Ÿæœºå°±æ²¡æ³•å¿«é€ŸçŸ¥é“å¯¹è±¡å¼•ç”¨çš„ä½ç½®å‘€ï¼Œæ²¡æ³•è¿›è¡Œæ ¹èŠ‚ç‚¹æšä¸¾ï¼‰ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220628203702554-12674c52.png" alt="image-20220628203702554" tabindex="0" loading="lazy"><figcaption>image-20220628203702554</figcaption></figure><p>å› æ­¤ï¼Œ<strong>å®‰å…¨ç‚¹çš„è®¾å®šæ—¢ä¸èƒ½å¤ªå°‘ä»¥è‡³äºè®©åƒåœ¾æ”¶é›†å™¨ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œä¹Ÿä¸èƒ½å¤ªå¤šä»¥è‡³äºé¢‘ç¹è¿›è¡Œåƒåœ¾æ”¶é›†ä»è€Œå¯¼è‡´è¿è¡Œæ—¶çš„å†…å­˜è´Ÿè·å¤§å¹…å¢å¤§</strong>ã€‚æ‰€ä»¥ï¼Œå®‰å…¨ç‚¹çš„é€‰å®šåŸºæœ¬ä¸Šæ˜¯ä»¥ â€œ<strong>æ˜¯å¦å…·æœ‰è®©ç¨‹åºé•¿æ—¶é—´æ‰§è¡Œçš„ç‰¹å¾</strong>â€ ä¸ºæ ‡å‡†è¿›è¡Œé€‰å®šçš„ï¼Œæœ€å…¸å‹çš„å°±æ˜¯<strong>æŒ‡ä»¤åºåˆ—çš„å¤ç”¨</strong>ï¼šä¾‹å¦‚æ–¹æ³•è°ƒç”¨ã€å¾ªç¯è·³è½¬ã€å¼‚å¸¸è·³è½¬ç­‰ï¼Œæ‰€ä»¥åªæœ‰å…·æœ‰è¿™äº›åŠŸèƒ½çš„æŒ‡ä»¤æ‰ä¼šäº§ç”Ÿå®‰å…¨ç‚¹ã€‚</p><p>å¯¹äºå®‰å…¨ç‚¹ï¼Œå¦å¤–ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜æ˜¯ï¼Œ<strong>å¦‚ä½•åœ¨ GC å‘ç”Ÿæ—¶è®©æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½æ‰§è¡Œåˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹ï¼Œç„¶ååœé¡¿ä¸‹æ¥å‘¢ï¼Ÿ</strong>ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ï¼š</p><ol><li><p><strong>æŠ¢å…ˆå¼ä¸­æ–­</strong>ï¼ˆPreemptive Suspensionï¼‰ï¼šè¿™ç§æ€è·¯å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ GC å‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿå…ˆæŠŠæ‰€æœ‰ç”¨æˆ·çº¿ç¨‹å…¨éƒ¨ä¸­æ–­æ‰ã€‚ç„¶åå¦‚æœå‘ç°æœ‰ç”¨æˆ·çº¿ç¨‹ä¸­æ–­çš„ä½ç½®ä¸åœ¨å®‰å…¨ç‚¹ä¸Šï¼Œå°±æ¢å¤è¿™æ¡çº¿ç¨‹æ‰§è¡Œï¼Œç›´åˆ°è·‘åˆ°å®‰å…¨ç‚¹ä¸Šå†é‡æ–°ä¸­æ–­ã€‚</p><p>æŠ¢å…ˆå¼ä¸­æ–­çš„æœ€å¤§é—®é¢˜æ˜¯æ—¶é—´æˆæœ¬çš„ä¸å¯æ§ï¼Œè¿›è€Œå¯¼è‡´æ€§èƒ½ä¸ç¨³å®šå’Œååé‡çš„æ³¢åŠ¨ï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹è¿™æ˜¯éå¸¸è‡´å‘½çš„ï¼Œæ‰€ä»¥ç°åœ¨å‡ ä¹æ²¡æœ‰è™šæ‹Ÿæœºå®ç°é‡‡ç”¨æŠ¢å…ˆå¼ä¸­æ–­æ¥æš‚åœçº¿ç¨‹å“åº” GC äº‹ä»¶</p></li><li><p><strong>ä¸»åŠ¨å¼ä¸­æ–­</strong>ï¼ˆVoluntary Suspensionï¼‰ï¼šä¸»åŠ¨å¼ä¸­æ–­ä¸ä¼šç›´æ¥ä¸­æ–­çº¿ç¨‹ï¼Œè€Œæ˜¯å…¨å±€è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½ï¼Œç”¨æˆ·çº¿ç¨‹ä¼šä¸æ–­çš„è½®è¯¢è¿™ä¸ªæ ‡å¿—ä½ï¼Œå½“å‘ç°æ ‡å¿—ä½ä¸ºçœŸæ—¶ï¼Œçº¿ç¨‹ä¼šåœ¨æœ€è¿‘çš„ä¸€ä¸ªå®‰å…¨ç‚¹ä¸»åŠ¨ä¸­æ–­æŒ‚èµ·ã€‚ç°åœ¨çš„è™šæ‹ŸæœºåŸºæœ¬éƒ½æ˜¯ç”¨è¿™ç§æ–¹å¼</p></li></ol><h4 id="å®‰å…¨åŒºåŸŸ-safe-region" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨åŒºåŸŸ-safe-region" aria-hidden="true">#</a> å®‰å…¨åŒºåŸŸ Safe Region</h4><p>å®‰å…¨ç‚¹æœºåˆ¶ä¿è¯äº†ç¨‹åºæ‰§è¡Œæ—¶ï¼Œåœ¨ä¸å¤ªé•¿çš„æ—¶é—´å†…å°±ä¼šé‡åˆ°å¯è¿›å…¥åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„å®‰å…¨ç‚¹ã€‚</p><p>å¯¹äºä¸»åŠ¨å¼ä¸­æ–­æ¥è¯´ï¼Œç”¨æˆ·çº¿ç¨‹éœ€è¦ä¸æ–­åœ°å»è½®è¯¢æ ‡å¿—ä½ï¼Œé‚£å¯¹äºé‚£äº›å¤„äº sleep æˆ–è€… blocked çŠ¶æ€çš„çº¿ç¨‹ï¼ˆä¸åœ¨æ´»è·ƒçŠ¶æ€çš„çº¿ç¨‹ï¼‰æ¥è¯´æ€ä¹ˆåŠï¼Ÿ</p><p>è¿™äº›ä¸åœ¨æ´»è·ƒçŠ¶æ€çš„çº¿ç¨‹æ²¡æœ‰è·å¾— CPU æ—¶é—´ï¼Œæ²¡æ³•å»è½®è¯¢æ ‡å¿—ä½ï¼Œè‡ªç„¶ä¹Ÿå°±æ²¡æ³•æ‰¾åˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹ä¸»åŠ¨ä¸­æ–­æŒ‚èµ·äº†ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå¯¹äºè¿™äº›ä¸æ´»è·ƒçš„çº¿ç¨‹ï¼Œæˆ‘ä»¬æ²¡æ³•æŒæ§å®ƒä»¬é†’è¿‡æ¥çš„æ—¶é—´ã€‚å¾ˆå¯èƒ½å…¶ä»–çº¿ç¨‹éƒ½å·²ç»é€šè¿‡è½®è¯¢æ ‡å¿—ä½åˆ°è¾¾å®‰å…¨ç‚¹è¢«ä¸­æ–­äº†ï¼Œç„¶åè™šæ‹Ÿæœºå¼€å§‹æ ¹èŠ‚ç‚¹æšä¸¾äº†ï¼ˆæ ¹èŠ‚ç‚¹æšä¸¾éœ€è¦æš‚åœæ‰€æœ‰ç”¨æˆ·çº¿ç¨‹ï¼‰ï¼Œä½†æ˜¯è¿™æ—¶å€™é‚£äº›æœ¬ä¸æ´»è·ƒçš„ç”¨æˆ·çº¿ç¨‹åˆé†’è¿‡æ¥äº†å¼€å§‹æ‰§è¡Œï¼Œç ´åäº†å¯¹è±¡ä¹‹é—´çš„å¼•ç”¨å…³ç³»ï¼Œé‚£æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ã€‚</p><p>å¯¹äºè¿™ç§æƒ…å†µï¼Œå°±å¿…é¡»å¼•å…¥<strong>å®‰å…¨åŒºåŸŸ</strong>ï¼ˆSafe Regionï¼‰æ¥è§£å†³ã€‚</p><p>å®‰å…¨åŒºåŸŸçš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼šç¡®ä¿åœ¨æŸä¸€æ®µä»£ç ç‰‡æ®µä¹‹ä¸­ï¼Œå¼•ç”¨å…³ç³»ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤ï¼Œåœ¨è¿™ä¸ªåŒºåŸŸä¸­çš„ä»»æ„åœ°æ–¹å¼€å§‹ GC éƒ½æ˜¯å®‰å…¨çš„ã€‚</p><p>å¯ä»¥ç®€å•åœ°æŠŠå®‰å…¨åŒºåŸŸçœ‹ä½œ<strong>è¢«æ‹‰é•¿äº†çš„å®‰å…¨ç‚¹</strong>ã€‚</p><p><strong>å½“ç”¨æˆ·çº¿ç¨‹æ‰§è¡Œåˆ°å®‰å…¨åŒºåŸŸé‡Œé¢çš„ä»£ç æ—¶ï¼Œé¦–å…ˆä¼šæ ‡è¯†è‡ªå·±å·²ç»è¿›å…¥äº†å®‰å…¨åŒºåŸŸã€‚é‚£æ ·å½“è¿™æ®µæ—¶é—´é‡Œè™šæ‹Ÿæœºè¦å‘èµ· GC æ—¶ï¼Œå°±ä¸å¿…å»ç®¡è¿™äº›åœ¨å®‰å…¨åŒºåŸŸå†…çš„çº¿ç¨‹äº†ã€‚</strong></p><p>å½“å®‰å…¨åŒºåŸŸä¸­çš„çº¿ç¨‹è¢«å”¤é†’å¹¶ç¦»å¼€å®‰å…¨åŒºåŸŸæ—¶ï¼Œå®ƒéœ€è¦æ£€æŸ¥ä¸‹ä¸»åŠ¨å¼ä¸­æ–­ç­–ç•¥çš„æ ‡å¿—ä½æ˜¯å¦ä¸ºçœŸï¼ˆè™šæ‹Ÿæœºæ˜¯å¦å¤„äº STW çŠ¶æ€</p><ul><li>å¦‚æœä¸ºçœŸåˆ™ç»§ç»­æŒ‚èµ·ç­‰å¾…ï¼ˆé˜²æ­¢æ ¹èŠ‚ç‚¹æšä¸¾è¿‡ç¨‹ä¸­è¿™äº›è¢«å”¤é†’çº¿ç¨‹çš„æ‰§è¡Œç ´åäº†å¯¹è±¡ä¹‹é—´çš„å¼•ç”¨å…³ç³»ï¼‰</li><li>å¦‚æœä¸ºå‡åˆ™æ ‡è¯†è¿˜æ²¡å¼€å§‹ STW æˆ–è€… STW åˆšåˆšç»“æŸï¼Œé‚£ä¹ˆçº¿ç¨‹å°±å¯ä»¥è¢«å”¤é†’ç„¶åç»§ç»­æ‰§è¡Œã€‚</li></ul><h3 id="ä¸‰è‰²æ ‡è®°æ³•" tabindex="-1"><a class="header-anchor" href="#ä¸‰è‰²æ ‡è®°æ³•" aria-hidden="true">#</a> ä¸‰è‰²æ ‡è®°æ³•</h3><p>å¯è¾¾æ€§åˆ†æå¯ä»¥åˆ†æˆä¸¤ä¸ªé˜¶æ®µ</p><ol><li>æ ¹èŠ‚ç‚¹æšä¸¾</li><li>ä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†å¯¹è±¡å›¾</li></ol><p>åœ¨å¯è¾¾æ€§åˆ†æä¸­ï¼Œç¬¬ä¸€é˜¶æ®µ â€æ ¹èŠ‚ç‚¹æšä¸¾â€œ æ˜¯å¿…é¡» STW çš„ï¼Œä¸ç„¶å¦‚æœåˆ†æè¿‡ç¨‹ä¸­ç”¨æˆ·è¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´æ ¹èŠ‚ç‚¹é›†åˆçš„å¯¹è±¡å¼•ç”¨å…³ç³»ä¸æ–­å˜åŒ–ï¼Œè¿™æ ·å¯è¾¾æ€§åˆ†æç»“æœçš„å‡†ç¡®æ€§æ˜¾ç„¶ä¹Ÿå°±æ— æ³•ä¿è¯äº†ï¼›è€Œç¬¬äºŒé˜¶æ®µ â€ä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†å¯¹è±¡å›¾â€œï¼Œå¦‚æœä¸è¿›è¡Œ STW çš„è¯ï¼Œä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼Œç”±äºç¬¬äºŒé˜¶æ®µæ—¶é—´æ¯”è¾ƒé•¿ï¼Œé•¿æ—¶é—´çš„ STW å¾ˆå½±å“æ€§èƒ½ï¼Œæ‰€ä»¥å¤§ä½¬ä»¬è®¾è®¡äº†ä¸€äº›è§£å†³æ–¹æ¡ˆï¼Œä»è€Œä½¿å¾—è¿™ä¸ªç¬¬äºŒé˜¶æ®µå¯ä»¥ä¸ç”¨ STWï¼Œå¤§å¹…å‡å°‘æ—¶é—´</p><h4 id="å‰è¨€" tabindex="-1"><a class="header-anchor" href="#å‰è¨€" aria-hidden="true">#</a> å‰è¨€</h4><p>äº‹å®ä¸Šï¼ŒGC Roots ç›¸æ¯”èµ·æ•´ä¸ª Java å †ä¸­å…¨éƒ¨çš„å¯¹è±¡æ¯•ç«Ÿè¿˜ç®—æ˜¯æå°‘æ•°ï¼Œä¸”åœ¨å„ç§ä¼˜åŒ–æŠ€å·§ï¼ˆæ¯”å¦‚ OopMapï¼‰çš„åŠ æŒä¸‹ï¼Œå®ƒå¸¦æ¥çš„åœé¡¿å·²ç»æ˜¯éå¸¸çŸ­æš‚ä¸”ç›¸å¯¹å›ºå®šçš„äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>â€œæ ¹èŠ‚ç‚¹æšä¸¾â€ é˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸ä¼šéšç€å †å®¹é‡çš„å¢é•¿è€Œå¢åŠ </strong>ã€‚</p><p>å½“æˆ‘ä»¬æšä¸¾å®Œäº†æ‰€æœ‰çš„ GC Rootsï¼Œå°±å¾—è¿›å…¥ç¬¬äºŒé˜¶æ®µç»§ç»­å¾€ä¸‹éå†å¯¹è±¡å›¾äº†ï¼Œè¿™ä¸€æ­¥éª¤åŒæ ·éœ€è¦ STWï¼Œå¹¶ä¸”åœé¡¿æ—¶é—´ä¸ Java å †å®¹é‡ç›´æ¥æˆæ­£æ¯”ä¾‹å…³ç³»ï¼šå †è¶Šå¤§ï¼Œå­˜å‚¨çš„å¯¹è±¡è¶Šå¤šï¼Œå¯¹è±¡å›¾ç»“æ„è¶Šå¤æ‚ï¼Œè¦æ ‡è®°æ›´å¤šå¯¹è±¡è€Œäº§ç”Ÿçš„åœé¡¿æ—¶é—´è‡ªç„¶å°±æ›´é•¿ï¼Œè¿™æ˜¯ç†æ‰€å½“ç„¶çš„äº‹æƒ…</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>â€œä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†å¯¹è±¡å›¾â€ é˜¶æ®µçš„åœé¡¿æ—¶é—´éšç€å †å®¹é‡çš„å¢é•¿è€Œå¢åŠ </strong>ã€‚</p><p>è¦çŸ¥é“åŒ…å«â€œæ ‡è®°â€é˜¶æ®µï¼ˆä¹Ÿå°±æ˜¯å¯è¾¾æ€§åˆ†æï¼‰æ˜¯æ‰€æœ‰è¿½è¸ªå¼åƒåœ¾æ”¶é›†ç®—æ³•çš„å…±åŒç‰¹å¾ï¼Œå¦‚æœè¿™ä¸ªé˜¶æ®µä¼šéšç€å †å˜å¤§è€Œç­‰æ¯”ä¾‹å¢åŠ åœé¡¿æ—¶é—´ï¼Œå…¶å½±å“å°±ä¼šæ³¢åŠå‡ ä¹æ‰€æœ‰çš„åƒåœ¾æ”¶é›†å™¨ã€‚å¦‚æœèƒ½å¤Ÿå‡å°‘è¿™éƒ¨åˆ†åœé¡¿æ—¶é—´çš„è¯ï¼Œé‚£æ”¶ç›Šä¹Ÿå°†ä¼šæ˜¯å·¨å¤§çš„</p><p>æƒ³é™ä½ STW æ—¶é—´ç”šè‡³æ˜¯é¿å… STWï¼Œæˆ‘ä»¬å°±<strong>è¦å…ˆææ¸…æ¥šä¸ºä»€ä¹ˆå¿…é¡»åœ¨ä¸€ä¸ªèƒ½ä¿éšœä¸€è‡´æ€§çš„å¿«ç…§ä¸Šæ‰èƒ½è¿›è¡Œå¯¹è±¡å›¾çš„éå†</strong>ï¼Ÿ</p><p>ä¸ºäº†èƒ½è§£é‡Šæ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œå¤§ä½¬ä»¬å¼•å…¥äº†ä¸‰è‰²æ ‡è®°æ³•ï¼ˆTri-color Markingï¼‰è¿™ä¸ªå·¥å…·</p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‰è‰²æ ‡è®°æ³•åªæ˜¯è¾…åŠ©æˆ‘ä»¬åˆ†æçš„å·¥å…·ï¼Œå¹¶ä¸æ˜¯æŸä¸ªåƒåœ¾æ”¶é›†å™¨å…·ä½“ä½¿ç”¨çš„ç®—æ³•ï¼ï¼ï¼ï¼ï¼æ›´ä¸æ˜¯é™ä½ STW æ—¶é—´ or æ¶ˆé™¤ STW çš„æ–¹æ³•ï¼Œå…·ä½“è§£å†³æ–¹æ³•ä¸‹é¢è¿˜ä¼šä»‹ç»</p><p>åœ¨è¿™é‡Œï¼Œä¸‰è‰²æ ‡è®°æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬ææ¸…æ¥šåœ¨å¯è¾¾æ€§åˆ†æçš„ç¬¬äºŒé˜¶æ®µï¼ˆä¹Ÿå°±æ˜¯éå†å¯¹è±¡å›¾ï¼‰ï¼Œå¦‚æœç”¨æˆ·çº¿ç¨‹å’Œåƒåœ¾æ”¶é›†çº¿ç¨‹åŒæ—¶è¿›è¡Œï¼Œä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜</p></blockquote><h4 id="è¾…åŠ©åˆ†æçš„å·¥å…·-ä¸‰è‰²æ ‡è®°æ³•" tabindex="-1"><a class="header-anchor" href="#è¾…åŠ©åˆ†æçš„å·¥å…·-ä¸‰è‰²æ ‡è®°æ³•" aria-hidden="true">#</a> è¾…åŠ©åˆ†æçš„å·¥å…·ï¼šä¸‰è‰²æ ‡è®°æ³•</h4><p>æ‰€è°“ä¸‰è‰²æ ‡è®°æ³•ï¼Œå°±æ˜¯æŠŠéå†å¯¹è±¡å›¾è¿‡ç¨‹ä¸­é‡åˆ°çš„å¯¹è±¡ï¼ŒæŒ‰ç…§ â€œæ˜¯å¦è®¿é—®è¿‡â€ è¿™ä¸ªæ¡ä»¶æ ‡è®°æˆä»¥ä¸‹ä¸‰ç§é¢œè‰²ï¼š</p><ul><li><p><strong>ç™½è‰²</strong>ï¼šè¡¨ç¤ºå¯¹è±¡å°šæœªè¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ã€‚æ˜¾ç„¶åœ¨å¯è¾¾æ€§åˆ†æåˆšåˆšå¼€å§‹çš„é˜¶æ®µï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ç™½è‰²çš„ï¼Œè‹¥åœ¨åˆ†æç»“æŸçš„é˜¶æ®µï¼Œä»ç„¶æ˜¯ç™½è‰²çš„å¯¹è±¡ï¼Œå³ä»£è¡¨ä¸å¯è¾¾ï¼ˆå¯è¾¾æ€§åˆ†æåˆ°ä¸äº†çš„å¯¹è±¡ï¼Œå°±æ˜¯æ­»äº¡å¯¹è±¡ï¼Œéœ€è¦è¢«å›æ”¶ï¼‰</p></li><li><p><strong>é»‘è‰²</strong>ï¼šè¡¨ç¤ºå¯¹è±¡å·²ç»è¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ï¼Œä¸”è¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½å·²ç»æ‰«æè¿‡ã€‚é»‘è‰²çš„å¯¹è±¡ä»£è¡¨å·²ç»æ‰«æè¿‡ï¼Œå®ƒæ˜¯å®‰å…¨å­˜æ´»çš„ï¼Œå¦‚æœæœ‰å…¶ä»–å¯¹è±¡å¼•ç”¨æŒ‡å‘äº†é»‘è‰²å¯¹è±¡ï¼Œæ— é¡»é‡æ–°æ‰«æä¸€éã€‚é»‘è‰²å¯¹è±¡ä¸å¯èƒ½ç›´æ¥ï¼ˆä¸ç»è¿‡ç°è‰²å¯¹è±¡ï¼‰æŒ‡å‘æŸä¸ªç™½è‰²å¯¹è±¡ã€‚</p></li><li><p><strong>ç°è‰²</strong>ï¼šè¡¨ç¤ºå¯¹è±¡å·²ç»è¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡ï¼Œä½†è¿™ä¸ªå¯¹è±¡ä¸Šè‡³å°‘å­˜åœ¨ä¸€ä¸ªå¼•ç”¨è¿˜æ²¡æœ‰è¢«æ‰«æè¿‡</p><blockquote><p>ç°è‰²å¯èƒ½ä¸å¥½ç†è§£ï¼Œè¿™é‡Œä¸¾ä¸ªä¾‹å­ï¼šA(GC roots) â†’ B â†’ Cï¼Œå¦‚æœ B å·²ç»è¢«æ‰«æè¿‡ï¼Œä½†æ˜¯ B çš„å¼•ç”¨ C è¿˜æ²¡æœ‰è¢«æ‰«æè¿‡ï¼Œé‚£ä¹ˆ B å°±æ˜¯ç°è‰²çš„ï¼ŒC ç”±äºè¿˜æ²¡æœ‰è¢«æ‰«æï¼Œæ‰€ä»¥æ˜¯ç™½è‰²çš„</p></blockquote></li></ul><p>æ‰€ä»¥å¯¹è±¡å›¾éå†çš„è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯ç”±ç°è‰²ä»é»‘å‘ç™½æ¨è¿›çš„è¿‡ç¨‹ï¼Œç°è‰²æ˜¯é»‘å’Œç™½çš„åˆ†ç•Œçº¿ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±ç”¨ä¸‰è‰²æ ‡è®°æ³•æ¥åˆ†æä¸‹ï¼Œå¦‚æœåœ¨å¯¹è±¡å›¾éå†è¿™ä¸ªé˜¶æ®µç”¨æˆ·çº¿ç¨‹ä¸æ”¶é›†å™¨å¹¶å‘å·¥ä½œä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜</p><h4 id="é—®é¢˜-1-æµ®åŠ¨åƒåœ¾" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜-1-æµ®åŠ¨åƒåœ¾" aria-hidden="true">#</a> é—®é¢˜ 1ï¼šæµ®åŠ¨åƒåœ¾</h4><p>æ‰€è°“æµ®åŠ¨åƒåœ¾ï¼Œå°±æ˜¯ç”±äºåƒåœ¾æ”¶é›†å’Œç”¨æˆ·çº¿ç¨‹æ˜¯å¹¶è¡Œçš„ï¼Œè¿™ä¸ªå¯¹è±¡å®é™…å·²ç»æ­»äº¡äº†ï¼Œå·²ç»æ²¡æœ‰å…¶ä»–äººå¼•ç”¨å®ƒäº†ï¼Œä½†æ˜¯<strong>è¢«åƒåœ¾æ”¶é›†å™¨é”™è¯¯åœ°æ ‡è®°æˆäº†å­˜æ´»å¯¹è±¡</strong></p><p>ä¸¾ä¸ªä¾‹å­ï¼Œa å¼•ç”¨äº† bï¼Œæ­¤æ—¶ b è¢«æ‰«æä¸ºå¯è¾¾ï¼Œä½†æ˜¯ç”¨æˆ·çº¿ç¨‹éšååˆæ‰§è¡Œäº† a.b = nullï¼Œè¿™ä¸ªæ—¶å€™å…¶å® b å·²ç»æ˜¯æ­»äº¡çš„åƒåœ¾å¯¹è±¡äº†ï¼Œä½†æ˜¯ç”±äº<strong>é»‘è‰²å¯¹è±¡ä¸ä¼šè¢«é‡æ–°æ‰«æ</strong>ï¼Œæ‰€ä»¥åœ¨åƒåœ¾æ”¶é›†é‡Œ b ä¾ç„¶ä½œä¸ºå­˜æ´»å¯¹è±¡è¢«æ ‡è®°æˆé»‘è‰²ï¼Œå› æ­¤å°±æˆäº†æµ®åŠ¨åƒåœ¾ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725143217373-024af479.png" alt="image-20220725143217373" tabindex="0" loading="lazy"><figcaption>image-20220725143217373</figcaption></figure><p>æµ®åŠ¨åƒåœ¾å½“ç„¶ä¸æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œä½†å…¶å®æ˜¯å¯ä»¥å®¹å¿çš„ï¼Œå› ä¸ºè¿™åªä¸è¿‡äº§ç”Ÿäº†ä¸€ç‚¹é€ƒè¿‡æœ¬æ¬¡æ”¶é›†çš„æµ®åŠ¨åƒåœ¾è€Œå·²ï¼Œåæ­£è¿˜ä¼šæœ‰ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†ï¼Œåˆ°æ—¶å€™å°±ä¼šè¢«æ ‡è®°ä¸ºåƒåœ¾è¢«æ¸…ç†æ‰äº†</p><h4 id="é—®é¢˜-2-å¯¹è±¡æ¶ˆå¤±" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜-2-å¯¹è±¡æ¶ˆå¤±" aria-hidden="true">#</a> é—®é¢˜ 2ï¼šå¯¹è±¡æ¶ˆå¤±</h4><p>å¯¹è±¡æ¶ˆå¤±å’Œæµ®åŠ¨åƒåœ¾æ°æ°ç›¸åï¼Œå¯¹è±¡æ¶ˆå¤±æ˜¯<strong>æŠŠåŸæœ¬å­˜æ´»çš„å¯¹è±¡é”™è¯¯æ ‡è®°ä¸ºå·²æ¶ˆäº¡</strong>ï¼Œè¿™å°±æ˜¯éå¸¸è‡´å‘½çš„åæœäº†ï¼Œç¨‹åºè‚¯å®šä¼šå› æ­¤å‘ç”Ÿé”™è¯¯ï¼Œä¸‹é¢è¡¨æ¼”ç¤ºäº†è¿™æ ·çš„è‡´å‘½é”™è¯¯å…·ä½“æ˜¯å¦‚ä½•äº§ç”Ÿçš„</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725143235602-e16595a8.png" alt="image-20220725143235602" tabindex="0" loading="lazy"><figcaption>image-20220725143235602</figcaption></figure><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œb -&gt; c çš„å¼•ç”¨è¢«åˆ‡æ–­ï¼Œä½†åŒæ—¶ç”¨æˆ·çº¿ç¨‹å»ºç«‹äº†ä¸€ä¸ªæ–°çš„ä» a -&gt; c çš„å¼•ç”¨ï¼Œç”±äºå·²ç»éå†åˆ°äº† bï¼Œä¸å¯èƒ½å†å›å»éå† aï¼ˆé»‘è‰²å¯¹è±¡ä¸ä¼šè¢«é‡æ–°æ‰«æï¼‰ï¼Œå†éå† cï¼Œæ‰€ä»¥è¿™ä¸ª c å®é™…æ˜¯å­˜æ´»çš„å¯¹è±¡ï¼Œä½†ç”±äºæ²¡æœ‰è¢«åƒåœ¾æ”¶é›†å™¨æ‰«æåˆ°ï¼Œè¢«é”™è¯¯åœ°æ ‡è®°æˆäº†ç™½è‰²ã€‚</p><p>æ€»ç»“ä¸‹å¯¹è±¡æ¶ˆå¤±é—®é¢˜çš„ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ol><li>æ’å…¥äº†ä¸€æ¡æˆ–å¤šæ¡ä»é»‘è‰²å¯¹è±¡åˆ°ç™½è‰²å¯¹è±¡çš„æ–°å¼•ç”¨</li><li>åˆ é™¤äº†å…¨éƒ¨ä»ç°è‰²å¯¹è±¡åˆ°è¯¥ç™½è‰²å¯¹è±¡çš„ç›´æ¥æˆ–é—´æ¥å¼•ç”¨</li></ol><p>Wilson äº 1994 å¹´åœ¨ç†è®ºä¸Šè¯æ˜äº†ï¼Œå½“ä¸”ä»…å½“ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³æ—¶ï¼Œæ‰ä¼šäº§ç”Ÿ â€œå¯¹è±¡æ¶ˆå¤±â€ çš„é—®é¢˜ï¼Œå³åŸæœ¬åº”è¯¥æ˜¯é»‘è‰²çš„å¯¹è±¡è¢«è¯¯æ ‡ä¸ºç™½è‰²</p><h4 id="éå†å¯¹è±¡å›¾ä¸éœ€è¦-stw-çš„è§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#éå†å¯¹è±¡å›¾ä¸éœ€è¦-stw-çš„è§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a> éå†å¯¹è±¡å›¾ä¸éœ€è¦ STW çš„è§£å†³æ–¹æ¡ˆ</h4><p>å¦‚ä¸Šæ‰€è¿°ï¼Œå¦‚æœéå†å¯¹è±¡å›¾çš„è¿‡ç¨‹ä¸ STW çš„è¯ï¼Œç¬¬ä¸€ä¸ªæµ®åŠ¨åƒåœ¾çš„é—®é¢˜å¾ˆå¥½å¤„ç†ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªå¯¹è±¡æ¶ˆå¤±é—®é¢˜å°±å¾ˆæ£˜æ‰‹äº†ã€‚</p><p>ä½†æ˜¯å‘¢ï¼Œéå†å¯¹è±¡å›¾çš„è¿‡ç¨‹åˆå®åœ¨å¤ªé•¿ï¼Œè®¾è®¡ JVM çš„å¤§ä½¬ä»¬ä¸å¾—ä¸æƒ³å‡ºä¸€äº›åŠæ³•æ¥è§£å†³å¯¹è±¡æ¶ˆå¤±é—®é¢˜ï¼Œä½¿å¾—åœ¨éå†å¯¹è±¡å›¾çš„è¿‡ç¨‹ä¸­ä¸ç”¨è¿›è¡Œ STWï¼ˆä¹Ÿå°±æ˜¯ç”¨æˆ·çº¿ç¨‹å’Œå¯¹è±¡çº¿ç¨‹å¯ä»¥åŒæ—¶å·¥ä½œï¼‰ï¼Œä»è€Œæå‡å¯è¾¾æ€§åˆ†æçš„æ•ˆç‡</p><p>ä¸Šé¢æ€»ç»“äº†å¯¹è±¡æ¶ˆå¤±é—®é¢˜çš„ä¸¤ä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è§£å†³å¹¶å‘æ‰«ææ—¶çš„å¯¹è±¡æ¶ˆå¤±é—®é¢˜ï¼Œåªéœ€ç ´åè¿™ä¸¤ä¸ªæ¡ä»¶çš„ä»»æ„ä¸€ä¸ªå³å¯ã€‚ç”±æ­¤åˆ†åˆ«äº§ç”Ÿäº†ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p><ol><li><strong>å¢é‡æ›´æ–°</strong>ï¼ˆIncremental Updateï¼‰ï¼šå¢é‡æ›´æ–°ç ´åçš„æ˜¯ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œå½“é»‘è‰²å¯¹è±¡æ’å…¥æ–°çš„æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨å…³ç³»æ—¶ï¼ˆå°±æ˜¯ä¸Šå›¾ä¸­çš„ a -&gt; c å¼•ç”¨å…³ç³»ï¼‰ï¼Œå°±å°†è¿™ä¸ªæ–°æ’å…¥çš„å¼•ç”¨è®°å½•ä¸‹æ¥ï¼Œç­‰å¹¶å‘æ‰«æç»“æŸä¹‹åï¼Œå†å°†è¿™äº›è®°å½•è¿‡çš„å¼•ç”¨å…³ç³»ä¸­çš„é»‘è‰²å¯¹è±¡ï¼ˆaï¼‰ä¸ºæ ¹ï¼Œé‡æ–°æ‰«æä¸€æ¬¡ã€‚è¿™å¯ä»¥ç®€åŒ–ç†è§£ä¸ºï¼Œ<strong>é»‘è‰²å¯¹è±¡ä¸€æ—¦æ–°æ’å…¥äº†æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ä¹‹åï¼Œå®ƒå°±å˜å›ç°è‰²å¯¹è±¡äº†</strong>ã€‚</li><li><strong>åŸå§‹å¿«ç…§</strong>ï¼ˆSnapshot At The Beginningï¼ŒSATBï¼‰ï¼šåŸå§‹å¿«ç…§è¦ç ´åçš„æ˜¯ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œå½“ç°è‰²å¯¹è±¡è¦åˆ é™¤æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨å…³ç³»æ—¶ï¼ˆä¸Šå›¾ä¸­çš„ b -&gt; c å¼•ç”¨å…³ç³»ï¼‰ï¼Œå°±å°†è¿™ä¸ªè¦åˆ é™¤çš„å¼•ç”¨è®°å½•ä¸‹æ¥ï¼Œåœ¨å¹¶å‘æ‰«æç»“æŸä¹‹åï¼Œå†å°†è¿™äº›è®°å½•è¿‡çš„å¼•ç”¨å…³ç³»ä¸­çš„ç°è‰²å¯¹è±¡ï¼ˆbï¼‰ä¸ºæ ¹ï¼Œé‡æ–°æ‰«æä¸€æ¬¡ã€‚è¿™ä¹Ÿå¯ä»¥ç®€åŒ–ç†è§£ä¸ºï¼Œ<strong>æ— è®ºå¼•ç”¨å…³ç³»åˆ é™¤ä¸å¦ï¼Œéƒ½ä¼šæŒ‰ç…§åˆšåˆšå¼€å§‹æ‰«æé‚£ä¸€åˆ»çš„å¯¹è±¡å›¾å¿«ç…§æ¥è¿›è¡Œæœç´¢</strong>ã€‚</li></ol><p>åœ¨ HotSpot è™šæ‹Ÿæœºä¸­ï¼Œå¢é‡æ›´æ–°å’ŒåŸå§‹å¿«ç…§è¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆéƒ½æœ‰å®é™…åº”ç”¨ï¼ŒCMS æ˜¯åŸºäºå¢é‡æ›´æ–°æ¥åšå¹¶å‘æ ‡è®°çš„ï¼ŒG1ã€Shenandoah åˆ™æ˜¯ç”¨åŸå§‹å¿«ç…§æ¥å®ç°</p><h3 id="ä»€ä¹ˆæ˜¯å­—èŠ‚ç -ç±»æ–‡ä»¶ç»“æ„çš„ç»„æˆäº†è§£å—" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯å­—èŠ‚ç -ç±»æ–‡ä»¶ç»“æ„çš„ç»„æˆäº†è§£å—" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿç±»æ–‡ä»¶ç»“æ„çš„ç»„æˆäº†è§£å—ï¼Ÿ</h3><p><strong>Java å­—èŠ‚ç </strong>ï¼ˆè‹±è¯­ï¼šJava bytecodeï¼‰æ˜¯<a href="https://zh.wikipedia.org/wiki/Java%E8%99%9A%E6%8B%9F%E6%9C%BA" target="_blank" rel="noopener noreferrer">Javaè™šæ‹Ÿæœº<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>æ‰§è¡Œçš„ä¸€ç§<a href="https://zh.wikipedia.org/wiki/%E6%8C%87%E4%BB%A4" target="_blank" rel="noopener noreferrer">æŒ‡ä»¤<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>æ ¼å¼ã€‚å¤§å¤šæ•°<a href="https://zh.wikipedia.org/w/index.php?title=%E6%93%8D%E4%BD%9C%E7%A0%81&amp;action=edit&amp;redlink=1" target="_blank" rel="noopener noreferrer">æ“ä½œç <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>éƒ½æ˜¯ä¸€ä¸ª<a href="https://zh.wikipedia.org/wiki/%E5%AD%97%E8%8A%82" target="_blank" rel="noopener noreferrer">å­—èŠ‚<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>é•¿ï¼Œè€Œæœ‰äº›æ“ä½œéœ€è¦å‚æ•°ï¼Œå¯¼è‡´äº†æœ‰ä¸€äº›å¤šå­—èŠ‚çš„æ“ä½œç ã€‚è€Œä¸”å¹¶ä¸æ˜¯æ‰€æœ‰å¯èƒ½çš„256ä¸ªæ“ä½œç éƒ½è¢«ä½¿ç”¨ï¼›å…¶ä¸­æœ‰51ä¸ªæ“ä½œç è¢«ä¿ç•™åšå°†æ¥ä½¿ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒåŸå§‹<a href="https://zh.wikipedia.org/wiki/Java%E5%B9%B3%E5%8F%B0" target="_blank" rel="noopener noreferrer">Javaå¹³å°<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>å¼€å‘å•†ï¼Œ<a href="https://zh.wikipedia.org/wiki/%E6%98%87%E9%99%BD%E5%BE%AE%E7%B3%BB%E7%B5%B1" target="_blank" rel="noopener noreferrer">å¤ªé˜³å¾®ç³»ç»Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œé¢å¤–ä¿ç•™äº†3ä¸ªä»£ç æ°¸ä¹…ä¸ä½¿ç”¨ã€‚</p><blockquote><p>ä¸€ä¸ª<a href="https://zh.wikipedia.org/wiki/Java" target="_blank" rel="noopener noreferrer">Java<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ç¨‹åºå‘˜å¹¶ä¸éœ€è¦ç†è§£æ‰€æœ‰çš„Javaå­—èŠ‚ç ã€‚ä½†æ˜¯ï¼Œå°±åƒ<a href="https://zh.wikipedia.org/wiki/IBM" target="_blank" rel="noopener noreferrer">IBM<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> developerWorkså‘¨åˆŠå»ºè®®çš„é‚£æ ·ï¼šâ€œç†è§£å­—èŠ‚ç ä»¥åŠç†è§£Javaç¼–è¯‘å™¨å¦‚ä½•ç”ŸæˆJavaå­—èŠ‚ç ä¸å­¦ä¹ <a href="https://zh.wikipedia.org/wiki/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80" target="_blank" rel="noopener noreferrer">æ±‡ç¼–<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çŸ¥è¯†å¯¹äº<a href="https://zh.wikipedia.org/wiki/C" target="_blank" rel="noopener noreferrer">C<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>/<a href="https://zh.wikipedia.org/wiki/C%2B%2B" target="_blank" rel="noopener noreferrer">C++<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ç¨‹åºå‘˜æœ‰ä¸€æ ·çš„æ„ä¹‰ã€‚â€</p></blockquote><h4 id="class-æ–‡ä»¶ç»“æ„æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#class-æ–‡ä»¶ç»“æ„æ€»ç»“" aria-hidden="true">#</a> Class æ–‡ä»¶ç»“æ„æ€»ç»“</h4><p>æ ¹æ® Java è™šæ‹Ÿæœºè§„èŒƒï¼ŒClass æ–‡ä»¶é€šè¿‡ <code>ClassFile</code> å®šä¹‰ï¼Œæœ‰ç‚¹ç±»ä¼¼ C è¯­è¨€çš„ç»“æ„ä½“ã€‚</p><p><code>ClassFile</code> çš„ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">ClassFile</span> <span class="token punctuation">{</span>
    u4             magic<span class="token punctuation">;</span> <span class="token comment">//Class æ–‡ä»¶çš„æ ‡å¿—</span>
    u2             minor_version<span class="token punctuation">;</span><span class="token comment">//Class çš„å°ç‰ˆæœ¬å·</span>
    u2             major_version<span class="token punctuation">;</span><span class="token comment">//Class çš„å¤§ç‰ˆæœ¬å·</span>
    u2             constant_pool_count<span class="token punctuation">;</span><span class="token comment">//å¸¸é‡æ± çš„æ•°é‡</span>
    cp_info        constant_pool<span class="token punctuation">[</span>constant_pool_count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å¸¸é‡æ± </span>
    u2             access_flags<span class="token punctuation">;</span><span class="token comment">//Class çš„è®¿é—®æ ‡è®°</span>
    u2             this_class<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç±»</span>
    u2             super_class<span class="token punctuation">;</span><span class="token comment">//çˆ¶ç±»</span>
    u2             interfaces_count<span class="token punctuation">;</span><span class="token comment">//æ¥å£</span>
    u2             interfaces<span class="token punctuation">[</span>interfaces_count<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£</span>
    u2             fields_count<span class="token punctuation">;</span><span class="token comment">//Class æ–‡ä»¶çš„å­—æ®µå±æ€§</span>
    field_info     fields<span class="token punctuation">[</span>fields_count<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªå­—æ®µ</span>
    u2             methods_count<span class="token punctuation">;</span><span class="token comment">//Class æ–‡ä»¶çš„æ–¹æ³•æ•°é‡</span>
    method_info    methods<span class="token punctuation">[</span>methods_count<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ä¸€ä¸ªç±»å¯ä»¥æœ‰ä¸ªå¤šä¸ªæ–¹æ³•</span>
    u2             attributes_count<span class="token punctuation">;</span><span class="token comment">//æ­¤ç±»çš„å±æ€§è¡¨ä¸­çš„å±æ€§æ•°</span>
    attribute_info attributes<span class="token punctuation">[</span>attributes_count<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å±æ€§è¡¨é›†åˆ</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡åˆ†æ <code>ClassFile</code> çš„å†…å®¹ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥çŸ¥é“ class æ–‡ä»¶çš„ç»„æˆã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723173831486-e43d0e9c.png" alt="image-20220723173831486" tabindex="0" loading="lazy"><figcaption>image-20220723173831486</figcaption></figure><p>ä¸‹é¢è¿™å¼ å›¾æ˜¯é€šè¿‡ IDEA æ’ä»¶ <code>jclasslib</code> æŸ¥çœ‹çš„ï¼Œä½ å¯ä»¥æ›´ç›´è§‚çœ‹åˆ° Class æ–‡ä»¶ç»“æ„ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723173839688-fe4d0b93.png" alt="image-20220723173839688" tabindex="0" loading="lazy"><figcaption>image-20220723173839688</figcaption></figure><p>ä½¿ç”¨ <code>jclasslib</code> ä¸å…‰å¯ä»¥ç›´è§‚åœ°æŸ¥çœ‹æŸä¸ªç±»å¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶ï¼Œè¿˜å¯ä»¥æŸ¥çœ‹ç±»çš„åŸºæœ¬ä¿¡æ¯ã€å¸¸é‡æ± ã€æ¥å£ã€å±æ€§ã€å‡½æ•°ç­‰ä¿¡æ¯ã€‚</p><p>ä¸‹é¢è¯¦ç»†ä»‹ç»ä¸€ä¸‹ Class æ–‡ä»¶ç»“æ„æ¶‰åŠåˆ°çš„ä¸€äº›ç»„ä»¶ã€‚</p><h4 id="é­”æ•°-magic-number" tabindex="-1"><a class="header-anchor" href="#é­”æ•°-magic-number" aria-hidden="true">#</a> é­”æ•°ï¼ˆMagic Numberï¼‰</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    u4             magic<span class="token punctuation">;</span> <span class="token comment">//Class æ–‡ä»¶çš„æ ‡å¿—</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ¯ä¸ª Class æ–‡ä»¶çš„å¤´ 4 ä¸ªå­—èŠ‚ç§°ä¸ºé­”æ•°ï¼ˆMagic Numberï¼‰,å®ƒçš„å”¯ä¸€ä½œç”¨æ˜¯<strong>ç¡®å®šè¿™ä¸ªæ–‡ä»¶æ˜¯å¦ä¸ºä¸€ä¸ªèƒ½è¢«è™šæ‹Ÿæœºæ¥æ”¶çš„ Class æ–‡ä»¶</strong>ã€‚</p><p>ç¨‹åºè®¾è®¡è€…å¾ˆå¤šæ—¶å€™éƒ½å–œæ¬¢ç”¨ä¸€äº›ç‰¹æ®Šçš„æ•°å­—è¡¨ç¤ºå›ºå®šçš„æ–‡ä»¶ç±»å‹æˆ–è€…å…¶å®ƒç‰¹æ®Šçš„å«ä¹‰ã€‚</p><h4 id="class-æ–‡ä»¶ç‰ˆæœ¬å·-minor-major-version" tabindex="-1"><a class="header-anchor" href="#class-æ–‡ä»¶ç‰ˆæœ¬å·-minor-major-version" aria-hidden="true">#</a> Class æ–‡ä»¶ç‰ˆæœ¬å·ï¼ˆMinor&amp;Major Versionï¼‰</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    u2             minor_version<span class="token punctuation">;</span><span class="token comment">//Class çš„å°ç‰ˆæœ¬å·</span>
    u2             major_version<span class="token punctuation">;</span><span class="token comment">//Class çš„å¤§ç‰ˆæœ¬å·</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç´§æ¥ç€é­”æ•°çš„å››ä¸ªå­—èŠ‚å­˜å‚¨çš„æ˜¯ Class æ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼šç¬¬ 5 å’Œç¬¬ 6 ä½æ˜¯<strong>æ¬¡ç‰ˆæœ¬å·</strong>ï¼Œç¬¬ 7 å’Œç¬¬ 8 ä½æ˜¯<strong>ä¸»ç‰ˆæœ¬å·</strong>ã€‚</p><p>æ¯å½“ Java å‘å¸ƒå¤§ç‰ˆæœ¬ï¼ˆæ¯”å¦‚ Java 8ï¼ŒJava9ï¼‰çš„æ—¶å€™ï¼Œä¸»ç‰ˆæœ¬å·éƒ½ä¼šåŠ  1ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>javap -v</code> å‘½ä»¤æ¥å¿«é€ŸæŸ¥çœ‹ Class æ–‡ä»¶çš„ç‰ˆæœ¬å·ä¿¡æ¯ã€‚</p><p>é«˜ç‰ˆæœ¬çš„ Java è™šæ‹Ÿæœºå¯ä»¥æ‰§è¡Œä½ç‰ˆæœ¬ç¼–è¯‘å™¨ç”Ÿæˆçš„ Class æ–‡ä»¶ï¼Œä½†æ˜¯ä½ç‰ˆæœ¬çš„ Java è™šæ‹Ÿæœºä¸èƒ½æ‰§è¡Œé«˜ç‰ˆæœ¬ç¼–è¯‘å™¨ç”Ÿæˆçš„ Class æ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨å®é™…å¼€å‘çš„æ—¶å€™è¦ç¡®ä¿å¼€å‘çš„çš„ JDK ç‰ˆæœ¬å’Œç”Ÿäº§ç¯å¢ƒçš„ JDK ç‰ˆæœ¬ä¿æŒä¸€è‡´ã€‚</p><h4 id="å¸¸é‡æ± -constant-pool" tabindex="-1"><a class="header-anchor" href="#å¸¸é‡æ± -constant-pool" aria-hidden="true">#</a> å¸¸é‡æ± ï¼ˆConstant Poolï¼‰</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    u2             constant_pool_count<span class="token punctuation">;</span><span class="token comment">//å¸¸é‡æ± çš„æ•°é‡</span>
    cp_info        constant_pool<span class="token punctuation">[</span>constant_pool_count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å¸¸é‡æ± </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç´§æ¥ç€ä¸»æ¬¡ç‰ˆæœ¬å·ä¹‹åçš„æ˜¯å¸¸é‡æ± ï¼Œå¸¸é‡æ± çš„æ•°é‡æ˜¯ <code>constant_pool_count-1</code>ï¼ˆ<strong>å¸¸é‡æ± è®¡æ•°å™¨æ˜¯ä» 1 å¼€å§‹è®¡æ•°çš„ï¼Œå°†ç¬¬ 0 é¡¹å¸¸é‡ç©ºå‡ºæ¥æ˜¯æœ‰ç‰¹æ®Šè€ƒè™‘çš„ï¼Œç´¢å¼•å€¼ä¸º 0 ä»£è¡¨â€œä¸å¼•ç”¨ä»»ä½•ä¸€ä¸ªå¸¸é‡æ± é¡¹â€</strong>ï¼‰ã€‚</p><p>å¸¸é‡æ± ä¸»è¦å­˜æ”¾ä¸¤å¤§å¸¸é‡ï¼šå­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚å­—é¢é‡æ¯”è¾ƒæ¥è¿‘äº Java è¯­è¨€å±‚é¢çš„çš„å¸¸é‡æ¦‚å¿µï¼Œå¦‚æ–‡æœ¬å­—ç¬¦ä¸²ã€å£°æ˜ä¸º final çš„å¸¸é‡å€¼ç­‰ã€‚è€Œç¬¦å·å¼•ç”¨åˆ™å±äºç¼–è¯‘åŸç†æ–¹é¢çš„æ¦‚å¿µã€‚åŒ…æ‹¬ä¸‹é¢ä¸‰ç±»å¸¸é‡ï¼š</p><ul><li>ç±»å’Œæ¥å£çš„å…¨é™å®šå</li><li>å­—æ®µçš„åç§°å’Œæè¿°ç¬¦</li><li>æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦</li></ul><p>å¸¸é‡æ± ä¸­æ¯ä¸€é¡¹å¸¸é‡éƒ½æ˜¯ä¸€ä¸ªè¡¨ï¼Œè¿™ 14 ç§è¡¨æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼š<strong>å¼€å§‹çš„ç¬¬ä¸€ä½æ˜¯ä¸€ä¸ª u1 ç±»å‹çš„æ ‡å¿—ä½ -tag æ¥æ ‡è¯†å¸¸é‡çš„ç±»å‹ï¼Œä»£è¡¨å½“å‰è¿™ä¸ªå¸¸é‡å±äºå“ªç§å¸¸é‡ç±»å‹ï¼</strong></p><table><thead><tr><th style="text-align:center;">ç±»å‹</th><th style="text-align:center;">æ ‡å¿—ï¼ˆtagï¼‰</th><th style="text-align:center;">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center;">CONSTANT_utf8_info</td><td style="text-align:center;">1</td><td style="text-align:center;">UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²</td></tr><tr><td style="text-align:center;">CONSTANT_Integer_info</td><td style="text-align:center;">3</td><td style="text-align:center;">æ•´å½¢å­—é¢é‡</td></tr><tr><td style="text-align:center;">CONSTANT_Float_info</td><td style="text-align:center;">4</td><td style="text-align:center;">æµ®ç‚¹å‹å­—é¢é‡</td></tr><tr><td style="text-align:center;">CONSTANT_Long_info</td><td style="text-align:center;">ï¼•</td><td style="text-align:center;">é•¿æ•´å‹å­—é¢é‡</td></tr><tr><td style="text-align:center;">CONSTANT_Double_info</td><td style="text-align:center;">ï¼–</td><td style="text-align:center;">åŒç²¾åº¦æµ®ç‚¹å‹å­—é¢é‡</td></tr><tr><td style="text-align:center;">CONSTANT_Class_info</td><td style="text-align:center;">ï¼—</td><td style="text-align:center;">ç±»æˆ–æ¥å£çš„ç¬¦å·å¼•ç”¨</td></tr><tr><td style="text-align:center;">CONSTANT_String_info</td><td style="text-align:center;">ï¼˜</td><td style="text-align:center;">å­—ç¬¦ä¸²ç±»å‹å­—é¢é‡</td></tr><tr><td style="text-align:center;">CONSTANT_Fieldref_info</td><td style="text-align:center;">ï¼™</td><td style="text-align:center;">å­—æ®µçš„ç¬¦å·å¼•ç”¨</td></tr><tr><td style="text-align:center;">CONSTANT_Methodref_info</td><td style="text-align:center;">10</td><td style="text-align:center;">ç±»ä¸­æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td></tr><tr><td style="text-align:center;">CONSTANT_InterfaceMethodref_info</td><td style="text-align:center;">11</td><td style="text-align:center;">æ¥å£ä¸­æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td></tr><tr><td style="text-align:center;">CONSTANT_NameAndType_info</td><td style="text-align:center;">12</td><td style="text-align:center;">å­—æ®µæˆ–æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td></tr><tr><td style="text-align:center;">CONSTANT_MothodType_info</td><td style="text-align:center;">16</td><td style="text-align:center;">æ ‡å¿—æ–¹æ³•ç±»å‹</td></tr><tr><td style="text-align:center;">CONSTANT_MethodHandle_info</td><td style="text-align:center;">15</td><td style="text-align:center;">è¡¨ç¤ºæ–¹æ³•å¥æŸ„</td></tr><tr><td style="text-align:center;">CONSTANT_InvokeDynamic_info</td><td style="text-align:center;">18</td><td style="text-align:center;">è¡¨ç¤ºä¸€ä¸ªåŠ¨æ€æ–¹æ³•è°ƒç”¨ç‚¹</td></tr></tbody></table><p><code>.class</code> æ–‡ä»¶å¯ä»¥é€šè¿‡<code>javap -v classç±»å</code> æŒ‡ä»¤æ¥çœ‹ä¸€ä¸‹å…¶å¸¸é‡æ± ä¸­çš„ä¿¡æ¯(<code>javap -v classç±»å-&gt; temp.txt</code> ï¼šå°†ç»“æœè¾“å‡ºåˆ° temp.txt æ–‡ä»¶)ã€‚</p><h4 id="è®¿é—®æ ‡å¿—-access-flags" tabindex="-1"><a class="header-anchor" href="#è®¿é—®æ ‡å¿—-access-flags" aria-hidden="true">#</a> è®¿é—®æ ‡å¿—(Access Flags)</h4><p>åœ¨å¸¸é‡æ± ç»“æŸä¹‹åï¼Œç´§æ¥ç€çš„ä¸¤ä¸ªå­—èŠ‚ä»£è¡¨è®¿é—®æ ‡å¿—ï¼Œè¿™ä¸ªæ ‡å¿—ç”¨äºè¯†åˆ«ä¸€äº›ç±»æˆ–è€…æ¥å£å±‚æ¬¡çš„è®¿é—®ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šè¿™ä¸ª Class æ˜¯ç±»è¿˜æ˜¯æ¥å£ï¼Œæ˜¯å¦ä¸º <code>public</code> æˆ–è€… <code>abstract</code> ç±»å‹ï¼Œå¦‚æœæ˜¯ç±»çš„è¯æ˜¯å¦å£°æ˜ä¸º <code>final</code> ç­‰ç­‰ã€‚</p><p>ç±»è®¿é—®å’Œå±æ€§ä¿®é¥°ç¬¦:</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723173943684-159d79e0.png" alt="image-20220723173943684" tabindex="0" loading="lazy"><figcaption>image-20220723173943684</figcaption></figure><p>æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª Employee ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">top<span class="token punctuation">.</span>snailclimb<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡<code>javap -v classç±»å</code> æŒ‡ä»¤æ¥çœ‹ä¸€ä¸‹ç±»çš„è®¿é—®æ ‡å¿—ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723173952132-edf857e9.png" alt="image-20220723173952132" tabindex="0" loading="lazy"><figcaption>image-20220723173952132</figcaption></figure><h4 id="å½“å‰ç±»-this-class-ã€çˆ¶ç±»-super-class-ã€æ¥å£-interfaces-ç´¢å¼•é›†åˆ" tabindex="-1"><a class="header-anchor" href="#å½“å‰ç±»-this-class-ã€çˆ¶ç±»-super-class-ã€æ¥å£-interfaces-ç´¢å¼•é›†åˆ" aria-hidden="true">#</a> å½“å‰ç±»ï¼ˆThis Classï¼‰ã€çˆ¶ç±»ï¼ˆSuper Classï¼‰ã€æ¥å£ï¼ˆInterfacesï¼‰ç´¢å¼•é›†åˆ</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    u2             this_class<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç±»</span>
    u2             super_class<span class="token punctuation">;</span><span class="token comment">//çˆ¶ç±»</span>
    u2             interfaces_count<span class="token punctuation">;</span><span class="token comment">//æ¥å£</span>
    u2             interfaces<span class="token punctuation">[</span>interfaces_count<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç±»ç´¢å¼•ç”¨äºç¡®å®šè¿™ä¸ªç±»çš„å…¨é™å®šåï¼Œçˆ¶ç±»ç´¢å¼•ç”¨äºç¡®å®šè¿™ä¸ªç±»çš„çˆ¶ç±»çš„å…¨é™å®šåï¼Œç”±äº Java è¯­è¨€çš„å•ç»§æ‰¿ï¼Œæ‰€ä»¥çˆ¶ç±»ç´¢å¼•åªæœ‰ä¸€ä¸ªï¼Œé™¤äº† <code>java.lang.Object</code> ä¹‹å¤–ï¼Œæ‰€æœ‰çš„ java ç±»éƒ½æœ‰çˆ¶ç±»ï¼Œå› æ­¤é™¤äº† <code>java.lang.Object</code> å¤–ï¼Œæ‰€æœ‰ Java ç±»çš„çˆ¶ç±»ç´¢å¼•éƒ½ä¸ä¸º 0ã€‚</p><p>æ¥å£ç´¢å¼•é›†åˆç”¨æ¥æè¿°è¿™ä¸ªç±»å®ç°äº†é‚£äº›æ¥å£ï¼Œè¿™äº›è¢«å®ç°çš„æ¥å£å°†æŒ‰ <code>implements</code> (å¦‚æœè¿™ä¸ªç±»æœ¬èº«æ˜¯æ¥å£çš„è¯åˆ™æ˜¯<code>extends</code>) åçš„æ¥å£é¡ºåºä»å·¦åˆ°å³æ’åˆ—åœ¨æ¥å£ç´¢å¼•é›†åˆä¸­ã€‚</p><h4 id="å­—æ®µè¡¨é›†åˆ-fields" tabindex="-1"><a class="header-anchor" href="#å­—æ®µè¡¨é›†åˆ-fields" aria-hidden="true">#</a> å­—æ®µè¡¨é›†åˆï¼ˆFieldsï¼‰</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    u2             fields_count<span class="token punctuation">;</span><span class="token comment">//Class æ–‡ä»¶çš„å­—æ®µçš„ä¸ªæ•°</span>
    field_info     fields<span class="token punctuation">[</span>fields_count<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ä¸€ä¸ªç±»ä¼šå¯ä»¥æœ‰ä¸ªå­—æ®µ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å­—æ®µè¡¨ï¼ˆfield infoï¼‰ç”¨äºæè¿°æ¥å£æˆ–ç±»ä¸­å£°æ˜çš„å˜é‡ã€‚å­—æ®µåŒ…æ‹¬ç±»çº§å˜é‡ä»¥åŠå®ä¾‹å˜é‡ï¼Œä½†ä¸åŒ…æ‹¬åœ¨æ–¹æ³•å†…éƒ¨å£°æ˜çš„å±€éƒ¨å˜é‡ã€‚</p><p><strong>field info(å­—æ®µè¡¨) çš„ç»“æ„:</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723174020945-3aa1a4f3.png" alt="image-20220723174020945" tabindex="0" loading="lazy"><figcaption>image-20220723174020945</figcaption></figure><ul><li><strong>access_flags:</strong> å­—æ®µçš„ä½œç”¨åŸŸï¼ˆ<code>public</code> ,<code>private</code>,<code>protected</code>ä¿®é¥°ç¬¦ï¼‰ï¼Œæ˜¯å®ä¾‹å˜é‡è¿˜æ˜¯ç±»å˜é‡ï¼ˆ<code>static</code>ä¿®é¥°ç¬¦ï¼‰,å¯å¦è¢«åºåˆ—åŒ–ï¼ˆtransient ä¿®é¥°ç¬¦ï¼‰,å¯å˜æ€§ï¼ˆfinalï¼‰,å¯è§æ€§ï¼ˆvolatile ä¿®é¥°ç¬¦ï¼Œæ˜¯å¦å¼ºåˆ¶ä»ä¸»å†…å­˜è¯»å†™ï¼‰ã€‚</li><li><strong>name_index:</strong> å¯¹å¸¸é‡æ± çš„å¼•ç”¨ï¼Œè¡¨ç¤ºçš„å­—æ®µçš„åç§°ï¼›</li><li><strong>descriptor_index:</strong> å¯¹å¸¸é‡æ± çš„å¼•ç”¨ï¼Œè¡¨ç¤ºå­—æ®µå’Œæ–¹æ³•çš„æè¿°ç¬¦ï¼›</li><li><strong>attributes_count:</strong> ä¸€ä¸ªå­—æ®µè¿˜ä¼šæ‹¥æœ‰ä¸€äº›é¢å¤–çš„å±æ€§ï¼Œattributes_count å­˜æ”¾å±æ€§çš„ä¸ªæ•°ï¼›</li><li><strong>attributes[attributes_count]:</strong> å­˜æ”¾å…·ä½“å±æ€§å…·ä½“å†…å®¹ã€‚</li></ul><p>ä¸Šè¿°è¿™äº›ä¿¡æ¯ä¸­ï¼Œå„ä¸ªä¿®é¥°ç¬¦éƒ½æ˜¯å¸ƒå°”å€¼ï¼Œè¦ä¹ˆæœ‰æŸä¸ªä¿®é¥°ç¬¦ï¼Œè¦ä¹ˆæ²¡æœ‰ï¼Œå¾ˆé€‚åˆä½¿ç”¨æ ‡å¿—ä½æ¥è¡¨ç¤ºã€‚è€Œå­—æ®µå«ä»€ä¹ˆåå­—ã€å­—æ®µè¢«å®šä¹‰ä¸ºä»€ä¹ˆæ•°æ®ç±»å‹è¿™äº›éƒ½æ˜¯æ— æ³•å›ºå®šçš„ï¼Œåªèƒ½å¼•ç”¨å¸¸é‡æ± ä¸­å¸¸é‡æ¥æè¿°ã€‚</p><p><strong>å­—æ®µçš„ access_flag çš„å–å€¼:</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723174028527-11cfe604.png" alt="image-20220723174028527" tabindex="0" loading="lazy"><figcaption>image-20220723174028527</figcaption></figure><h4 id="æ–¹æ³•è¡¨é›†åˆ-methods" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•è¡¨é›†åˆ-methods" aria-hidden="true">#</a> æ–¹æ³•è¡¨é›†åˆï¼ˆMethodsï¼‰</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    u2             methods_count<span class="token punctuation">;</span><span class="token comment">//Class æ–‡ä»¶çš„æ–¹æ³•çš„æ•°é‡</span>
    method_info    methods<span class="token punctuation">[</span>methods_count<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ä¸€ä¸ªç±»å¯ä»¥æœ‰ä¸ªå¤šä¸ªæ–¹æ³•</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>methods_count è¡¨ç¤ºæ–¹æ³•çš„æ•°é‡ï¼Œè€Œ method_info è¡¨ç¤ºæ–¹æ³•è¡¨ã€‚</p><p>Class æ–‡ä»¶å­˜å‚¨æ ¼å¼ä¸­å¯¹æ–¹æ³•çš„æè¿°ä¸å¯¹å­—æ®µçš„æè¿°å‡ ä¹é‡‡ç”¨äº†å®Œå…¨ä¸€è‡´çš„æ–¹å¼ã€‚æ–¹æ³•è¡¨çš„ç»“æ„å¦‚åŒå­—æ®µè¡¨ä¸€æ ·ï¼Œä¾æ¬¡åŒ…æ‹¬äº†è®¿é—®æ ‡å¿—ã€åç§°ç´¢å¼•ã€æè¿°ç¬¦ç´¢å¼•ã€å±æ€§è¡¨é›†åˆå‡ é¡¹ã€‚</p><p><strong>method_info(æ–¹æ³•è¡¨çš„) ç»“æ„:</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723174041110-49ab4a28.png" alt="image-20220723174041110" tabindex="0" loading="lazy"><figcaption>image-20220723174041110</figcaption></figure><p>æ–¹æ³•è¡¨çš„ access_flag å–å€¼ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220723174047943-6e0d0d48.png" alt="image-20220723174047943" tabindex="0" loading="lazy"><figcaption>image-20220723174047943</figcaption></figure><p>æ³¨æ„ï¼šå› ä¸º<code>volatile</code>ä¿®é¥°ç¬¦å’Œ<code>transient</code>ä¿®é¥°ç¬¦ä¸å¯ä»¥ä¿®é¥°æ–¹æ³•ï¼Œæ‰€ä»¥æ–¹æ³•è¡¨çš„è®¿é—®æ ‡å¿—ä¸­æ²¡æœ‰è¿™ä¸¤ä¸ªå¯¹åº”çš„æ ‡å¿—ï¼Œä½†æ˜¯å¢åŠ äº†<code>synchronized</code>ã€<code>native</code>ã€<code>abstract</code>ç­‰å…³é”®å­—ä¿®é¥°æ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿå°±å¤šäº†è¿™äº›å…³é”®å­—å¯¹åº”çš„æ ‡å¿—ã€‚</p><h4 id="å±æ€§è¡¨é›†åˆ-attributes" tabindex="-1"><a class="header-anchor" href="#å±æ€§è¡¨é›†åˆ-attributes" aria-hidden="true">#</a> å±æ€§è¡¨é›†åˆï¼ˆAttributesï¼‰</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>   u2             attributes_count<span class="token punctuation">;</span><span class="token comment">//æ­¤ç±»çš„å±æ€§è¡¨ä¸­çš„å±æ€§æ•°</span>
   attribute_info attributes<span class="token punctuation">[</span>attributes_count<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å±æ€§è¡¨é›†åˆ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ Class æ–‡ä»¶ï¼Œå­—æ®µè¡¨ï¼Œæ–¹æ³•è¡¨ä¸­éƒ½å¯ä»¥æºå¸¦è‡ªå·±çš„å±æ€§è¡¨é›†åˆï¼Œä»¥ç”¨äºæè¿°æŸäº›åœºæ™¯ä¸“æœ‰çš„ä¿¡æ¯ã€‚ä¸ Class æ–‡ä»¶ä¸­å…¶å®ƒçš„æ•°æ®é¡¹ç›®è¦æ±‚çš„é¡ºåºã€é•¿åº¦å’Œå†…å®¹ä¸åŒï¼Œå±æ€§è¡¨é›†åˆçš„é™åˆ¶ç¨å¾®å®½æ¾ä¸€äº›ï¼Œä¸å†è¦æ±‚å„ä¸ªå±æ€§è¡¨å…·æœ‰ä¸¥æ ¼çš„é¡ºåºï¼Œå¹¶ä¸”åªè¦ä¸ä¸å·²æœ‰çš„å±æ€§åé‡å¤ï¼Œä»»ä½•äººå®ç°çš„ç¼–è¯‘å™¨éƒ½å¯ä»¥å‘å±æ€§è¡¨ä¸­å†™ å…¥è‡ªå·±å®šä¹‰çš„å±æ€§ä¿¡æ¯ï¼ŒJava è™šæ‹Ÿæœºè¿è¡Œæ—¶ä¼šå¿½ç•¥æ‰å®ƒä¸è®¤è¯†çš„å±æ€§ã€‚</p><h3 id="oom-å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#oom-å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•" aria-hidden="true">#</a> OOM å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•</h3><blockquote><p>èŠ‚é€‰è‡ªï¼šStabilityGuide</p></blockquote><p>å½“ JVM å†…å­˜ä¸¥é‡ä¸è¶³æ—¶ï¼Œå°±ä¼šæŠ›å‡º java.lang.OutOfMemoryError é”™è¯¯ã€‚æœ¬æ–‡æ€»ç»“äº†å¸¸è§çš„ OOM åŸå› åŠå…¶è§£å†³æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¦‚æœ‰é—æ¼æˆ–é”™è¯¯ï¼Œæ¬¢è¿è¡¥å……æŒ‡æ­£ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220726150913148-b8917245.png" alt="image-20220726150913148" tabindex="0" loading="lazy"><figcaption>image-20220726150913148</figcaption></figure><h4 id="java-heap-space" tabindex="-1"><a class="header-anchor" href="#java-heap-space" aria-hidden="true">#</a> Java heap space</h4><p>å½“å †å†…å­˜ï¼ˆHeap Spaceï¼‰æ²¡æœ‰è¶³å¤Ÿç©ºé—´å­˜æ”¾æ–°åˆ›å»ºçš„å¯¹è±¡æ—¶ï¼Œå°±ä¼šæŠ›å‡º <code>java.lang.OutOfMemoryError: Java heap space</code> é”™è¯¯ï¼ˆæ ¹æ®å®é™…ç”Ÿäº§ç»éªŒï¼Œå¯ä»¥å¯¹ç¨‹åºæ—¥å¿—ä¸­çš„ OutOfMemoryError é…ç½®å…³é”®å­—å‘Šè­¦ï¼Œä¸€ç»å‘ç°ï¼Œç«‹å³å¤„ç†ï¼‰</p><h5 id="åŸå› åˆ†æ" tabindex="-1"><a class="header-anchor" href="#åŸå› åˆ†æ" aria-hidden="true">#</a> åŸå› åˆ†æ</h5><p><code>Java heap space</code> é”™è¯¯äº§ç”Ÿçš„å¸¸è§åŸå› å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li>è¯·æ±‚åˆ›å»ºä¸€ä¸ªè¶…å¤§å¯¹è±¡ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå¤§æ•°ç»„ã€‚</li><li>è¶…å‡ºé¢„æœŸçš„è®¿é—®é‡/æ•°æ®é‡ï¼Œé€šå¸¸æ˜¯ä¸Šæ¸¸ç³»ç»Ÿè¯·æ±‚æµé‡é£™å‡ï¼Œå¸¸è§äºå„ç±»ä¿ƒé”€/ç§’æ€æ´»åŠ¨ï¼Œå¯ä»¥ç»“åˆä¸šåŠ¡æµé‡æŒ‡æ ‡æ’æŸ¥æ˜¯å¦æœ‰å°–çŠ¶å³°å€¼ã€‚</li><li>è¿‡åº¦ä½¿ç”¨ç»ˆç»“å™¨ï¼ˆFinalizerï¼‰ï¼Œè¯¥å¯¹è±¡æ²¡æœ‰ç«‹å³è¢« GCã€‚</li><li>å†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰ï¼Œå¤§é‡å¯¹è±¡å¼•ç”¨æ²¡æœ‰é‡Šæ”¾ï¼ŒJVM æ— æ³•å¯¹å…¶è‡ªåŠ¨å›æ”¶ï¼Œå¸¸è§äºä½¿ç”¨äº† File ç­‰èµ„æºæ²¡æœ‰å›æ”¶ã€‚</li></ul><h5 id="è§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a> è§£å†³æ–¹æ¡ˆ</h5><p>é’ˆå¯¹å¤§éƒ¨åˆ†æƒ…å†µï¼Œé€šå¸¸åªéœ€è¦é€šè¿‡ <code>-Xmx</code> å‚æ•°è°ƒé«˜ JVM å †å†…å­˜ç©ºé—´å³å¯ã€‚å¦‚æœä»ç„¶æ²¡æœ‰è§£å†³ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹æƒ…å†µåšè¿›ä¸€æ­¥å¤„ç†ï¼š</p><ul><li>å¦‚æœæ˜¯è¶…å¤§å¯¹è±¡ï¼Œå¯ä»¥æ£€æŸ¥å…¶åˆç†æ€§ï¼Œæ¯”å¦‚æ˜¯å¦ä¸€æ¬¡æ€§æŸ¥è¯¢äº†æ•°æ®åº“å…¨éƒ¨ç»“æœï¼Œè€Œæ²¡æœ‰åšç»“æœæ•°é™åˆ¶ã€‚</li><li>å¦‚æœæ˜¯ä¸šåŠ¡å³°å€¼å‹åŠ›ï¼Œå¯ä»¥è€ƒè™‘æ·»åŠ æœºå™¨èµ„æºï¼Œæˆ–è€…åšé™æµé™çº§ã€‚</li><li>å¦‚æœæ˜¯å†…å­˜æ³„æ¼ï¼Œéœ€è¦æ‰¾åˆ°æŒæœ‰çš„å¯¹è±¡ï¼Œä¿®æ”¹ä»£ç è®¾è®¡ï¼Œæ¯”å¦‚å…³é—­æ²¡æœ‰é‡Šæ”¾çš„è¿æ¥ã€‚</li></ul><h4 id="gc-overhead-limit-exceeded" tabindex="-1"><a class="header-anchor" href="#gc-overhead-limit-exceeded" aria-hidden="true">#</a> GC overhead limit exceeded</h4><p>å½“ Java è¿›ç¨‹èŠ±è´¹ 98% ä»¥ä¸Šçš„æ—¶é—´æ‰§è¡Œ GCï¼Œä½†åªæ¢å¤äº†ä¸åˆ° 2% çš„å†…å­˜ï¼Œä¸”è¯¥åŠ¨ä½œè¿ç»­é‡å¤äº† 5 æ¬¡ï¼Œå°±ä¼šæŠ›å‡º <code>java.lang.OutOfMemoryError:GC overhead limit exceeded</code> é”™è¯¯ã€‚ç®€å•åœ°è¯´ï¼Œå°±æ˜¯åº”ç”¨ç¨‹åºå·²ç»åŸºæœ¬è€—å°½äº†æ‰€æœ‰å¯ç”¨å†…å­˜ï¼Œ GC ä¹Ÿæ— æ³•å›æ”¶ã€‚</p><p>æ­¤ç±»é—®é¢˜çš„åŸå› ä¸è§£å†³æ–¹æ¡ˆè·Ÿ <code>Java heap space</code> éå¸¸ç±»ä¼¼ï¼Œå¯ä»¥å‚è€ƒä¸Šæ–‡ã€‚</p><h4 id="permgen-space" tabindex="-1"><a class="header-anchor" href="#permgen-space" aria-hidden="true">#</a> Permgen space</h4><p>è¯¥é”™è¯¯è¡¨ç¤ºæ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼‰å·²ç”¨æ»¡ï¼Œé€šå¸¸æ˜¯å› ä¸ºåŠ è½½çš„ class æ•°ç›®å¤ªå¤šæˆ–ä½“ç§¯å¤ªå¤§ã€‚</p><h5 id="åŸå› åˆ†æ-1" tabindex="-1"><a class="header-anchor" href="#åŸå› åˆ†æ-1" aria-hidden="true">#</a> åŸå› åˆ†æ</h5><p>æ°¸ä¹…ä»£å­˜å‚¨å¯¹è±¡ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li>åŠ è½½/ç¼“å­˜åˆ°å†…å­˜ä¸­çš„ class å®šä¹‰ï¼ŒåŒ…æ‹¬ç±»çš„åç§°ï¼Œå­—æ®µï¼Œæ–¹æ³•å’Œå­—èŠ‚ç ï¼›</li><li>å¸¸é‡æ± ï¼›</li><li>å¯¹è±¡æ•°ç»„/ç±»å‹æ•°ç»„æ‰€å…³è”çš„ classï¼›</li><li>JIT ç¼–è¯‘å™¨ä¼˜åŒ–åçš„ class ä¿¡æ¯ã€‚</li></ul><p>PermGen çš„ä½¿ç”¨é‡ä¸åŠ è½½åˆ°å†…å­˜çš„ class çš„æ•°é‡/å¤§å°æ­£ç›¸å…³ã€‚</p><h5 id="è§£å†³æ–¹æ¡ˆ-1" tabindex="-1"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-1" aria-hidden="true">#</a> è§£å†³æ–¹æ¡ˆ</h5><p>æ ¹æ® Permgen space æŠ¥é”™çš„æ—¶æœºï¼Œå¯ä»¥é‡‡ç”¨ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>ç¨‹åºå¯åŠ¨æŠ¥é”™ï¼Œä¿®æ”¹ <code>-XX:MaxPermSize</code> å¯åŠ¨å‚æ•°ï¼Œè°ƒå¤§æ°¸ä¹…ä»£ç©ºé—´ã€‚</li><li>åº”ç”¨é‡æ–°éƒ¨ç½²æ—¶æŠ¥é”™ï¼Œå¾ˆå¯èƒ½æ˜¯æ²¡æœ‰åº”ç”¨æ²¡æœ‰é‡å¯ï¼Œå¯¼è‡´åŠ è½½äº†å¤šä»½ class ä¿¡æ¯ï¼Œåªéœ€é‡å¯ JVM å³å¯è§£å†³ã€‚</li><li>è¿è¡Œæ—¶æŠ¥é”™ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½ä¼šåŠ¨æ€åˆ›å»ºå¤§é‡ classï¼Œè€Œè¿™äº› class çš„ç”Ÿå‘½å‘¨æœŸå¾ˆçŸ­æš‚ï¼Œä½†æ˜¯ JVM é»˜è®¤ä¸ä¼šå¸è½½ classï¼Œå¯ä»¥è®¾ç½® <code>-XX:+CMSClassUnloadingEnabled</code> å’Œ <code>-XX:+UseConcMarkSweepGC</code> è¿™ä¸¤ä¸ªå‚æ•°å…è®¸ JVM å¸è½½ classã€‚</li></ul><p>å¦‚æœä¸Šè¿°æ–¹æ³•æ— æ³•è§£å†³ï¼Œå¯ä»¥é€šè¿‡ jmap å‘½ä»¤ dump å†…å­˜å¯¹è±¡ <code>jmap -dump:format=b,file=dump.hprof &lt;process-id&gt;</code> ï¼Œç„¶ååˆ©ç”¨ <a href="https://www.eclipse.org/mat/" target="_blank" rel="noopener noreferrer">Eclipse MAT<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> åŠŸèƒ½é€ä¸€åˆ†æå¼€é”€æœ€å¤§çš„ classloader å’Œé‡å¤ classã€‚</p><h4 id="metaspace" tabindex="-1"><a class="header-anchor" href="#metaspace" aria-hidden="true">#</a> Metaspace</h4><p>DK 1.8 ä½¿ç”¨ Metaspace æ›¿æ¢äº†æ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼‰ï¼Œè¯¥é”™è¯¯è¡¨ç¤º Metaspace å·²è¢«ç”¨æ»¡ï¼Œé€šå¸¸æ˜¯å› ä¸ºåŠ è½½çš„ class æ•°ç›®å¤ªå¤šæˆ–ä½“ç§¯å¤ªå¤§ã€‚</p><p>æ­¤ç±»é—®é¢˜çš„åŸå› ä¸è§£å†³æ–¹æ³•è·Ÿ <code>Permgen space</code> éå¸¸ç±»ä¼¼ï¼Œå¯ä»¥å‚è€ƒä¸Šæ–‡ã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯è°ƒæ•´ Metaspace ç©ºé—´å¤§å°çš„å¯åŠ¨å‚æ•°ä¸º <code>-XX:MaxMetaspaceSize</code>ã€‚</p><h4 id="unable-to-create-new-native-thread" tabindex="-1"><a class="header-anchor" href="#unable-to-create-new-native-thread" aria-hidden="true">#</a> Unable to create new native thread</h4><p>æ¯ä¸ª Java çº¿ç¨‹éƒ½éœ€è¦å ç”¨ä¸€å®šçš„å†…å­˜ç©ºé—´ï¼Œå½“ JVM å‘åº•å±‚æ“ä½œç³»ç»Ÿè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„ native çº¿ç¨‹æ—¶ï¼Œå¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„èµ„æºåˆ†é…å°±ä¼šæŠ¥æ­¤ç±»é”™è¯¯ã€‚</p><h5 id="åŸå› åˆ†æ-2" tabindex="-1"><a class="header-anchor" href="#åŸå› åˆ†æ-2" aria-hidden="true">#</a> åŸå› åˆ†æ</h5><p>JVM å‘ OS è¯·æ±‚åˆ›å»º native çº¿ç¨‹å¤±è´¥ï¼Œå°±ä¼šæŠ›å‡º <code>Unable to create new native thread</code>ï¼Œå¸¸è§çš„åŸå› åŒ…æ‹¬ä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li>çº¿ç¨‹æ•°è¶…è¿‡æ“ä½œç³»ç»Ÿæœ€å¤§çº¿ç¨‹æ•° ulimit é™åˆ¶ã€‚</li><li>çº¿ç¨‹æ•°è¶…è¿‡ kernel.pid_maxï¼ˆåªèƒ½é‡å¯ï¼‰ã€‚</li><li>native å†…å­˜ä¸è¶³ã€‚</li></ul><p>è¯¥é—®é¢˜å‘ç”Ÿçš„å¸¸è§è¿‡ç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ æ­¥ï¼š</p><ol><li>JVM å†…éƒ¨çš„åº”ç”¨ç¨‹åºè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„ Java çº¿ç¨‹ï¼›</li><li>JVM native æ–¹æ³•ä»£ç†äº†è¯¥æ¬¡è¯·æ±‚ï¼Œå¹¶å‘æ“ä½œç³»ç»Ÿè¯·æ±‚åˆ›å»ºä¸€ä¸ª native çº¿ç¨‹ï¼›</li><li>æ“ä½œç³»ç»Ÿå°è¯•åˆ›å»ºä¸€ä¸ªæ–°çš„ native çº¿ç¨‹ï¼Œå¹¶ä¸ºå…¶åˆ†é…å†…å­˜ï¼›</li><li>å¦‚æœæ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜å·²è€—å°½ï¼Œæˆ–æ˜¯å—åˆ° 32 ä½è¿›ç¨‹çš„åœ°å€ç©ºé—´é™åˆ¶ï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šæ‹’ç»æœ¬æ¬¡ native å†…å­˜åˆ†é…ï¼›</li><li>JVM å°†æŠ›å‡º <code>java.lang.OutOfMemoryError: Unable to create new native thread</code> é”™è¯¯ã€‚</li></ol><h5 id="è§£å†³æ–¹æ¡ˆ-2" tabindex="-1"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-2" aria-hidden="true">#</a> è§£å†³æ–¹æ¡ˆ</h5><ul><li>å‡çº§é…ç½®ï¼Œä¸ºæœºå™¨æä¾›æ›´å¤šçš„å†…å­˜ï¼›</li><li>é™ä½ Java Heap Space å¤§å°ï¼›</li><li>ä¿®å¤åº”ç”¨ç¨‹åºçš„çº¿ç¨‹æ³„æ¼é—®é¢˜ï¼›</li><li>é™åˆ¶çº¿ç¨‹æ± å¤§å°ï¼›</li><li>ä½¿ç”¨ -Xss å‚æ•°å‡å°‘çº¿ç¨‹æ ˆçš„å¤§å°ï¼›</li><li>è°ƒé«˜ OS å±‚é¢çš„çº¿ç¨‹æœ€å¤§æ•°ï¼šæ‰§è¡Œ <code>ulimia -a</code> æŸ¥çœ‹æœ€å¤§çº¿ç¨‹æ•°é™åˆ¶ï¼Œä½¿ç”¨ <code>ulimit -u xxx</code> è°ƒæ•´æœ€å¤§çº¿ç¨‹æ•°é™åˆ¶ã€‚</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ulimit -a
.... çœç•¥éƒ¨åˆ†å†…å®¹ .....
max user processes              (-u) 16384
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="out-of-swap-space" tabindex="-1"><a class="header-anchor" href="#out-of-swap-space" aria-hidden="true">#</a> Out of swap spaceï¼Ÿ</h4><p>è¯¥é”™è¯¯è¡¨ç¤ºæ‰€æœ‰å¯ç”¨çš„è™šæ‹Ÿå†…å­˜å·²è¢«è€—å°½ã€‚è™šæ‹Ÿå†…å­˜ï¼ˆVirtual Memoryï¼‰ç”±ç‰©ç†å†…å­˜ï¼ˆPhysical Memoryï¼‰å’Œäº¤æ¢ç©ºé—´ï¼ˆSwap Spaceï¼‰ä¸¤éƒ¨åˆ†ç»„æˆã€‚å½“è¿è¡Œæ—¶ç¨‹åºè¯·æ±‚çš„è™šæ‹Ÿå†…å­˜æº¢å‡ºæ—¶å°±ä¼šæŠ¥ <code>Out of swap space?</code> é”™è¯¯ã€‚</p><h5 id="åŸå› åˆ†æ-3" tabindex="-1"><a class="header-anchor" href="#åŸå› åˆ†æ-3" aria-hidden="true">#</a> åŸå› åˆ†æ</h5><p>è¯¥é”™è¯¯å‡ºç°çš„å¸¸è§åŸå› åŒ…æ‹¬ä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li>åœ°å€ç©ºé—´ä¸è¶³ï¼›</li><li>ç‰©ç†å†…å­˜å·²è€—å…‰ï¼›</li><li>åº”ç”¨ç¨‹åºçš„æœ¬åœ°å†…å­˜æ³„æ¼ï¼ˆnative leakï¼‰ï¼Œä¾‹å¦‚ä¸æ–­ç”³è¯·æœ¬åœ°å†…å­˜ï¼Œå´ä¸é‡Šæ”¾ã€‚</li><li>æ‰§è¡Œ <code>jmap -histo:live &lt;pid&gt;</code> å‘½ä»¤ï¼Œå¼ºåˆ¶æ‰§è¡Œ Full GCï¼›å¦‚æœå‡ æ¬¡æ‰§è¡Œåå†…å­˜æ˜æ˜¾ä¸‹é™ï¼Œåˆ™åŸºæœ¬ç¡®è®¤ä¸º Direct ByteBuffer é—®é¢˜ã€‚</li></ul><h5 id="è§£å†³æ–¹æ¡ˆ-3" tabindex="-1"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-3" aria-hidden="true">#</a> è§£å†³æ–¹æ¡ˆ</h5><p>æ ¹æ®é”™è¯¯åŸå› å¯ä»¥é‡‡å–å¦‚ä¸‹è§£å†³æ–¹æ¡ˆï¼š</p><ul><li>å‡çº§åœ°å€ç©ºé—´ä¸º 64 bitï¼›</li><li>ä½¿ç”¨ <a href="https://github.com/alibaba/arthas" target="_blank" rel="noopener noreferrer">Arthas<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ£€æŸ¥æ˜¯å¦ä¸º Inflater/Deflater è§£å‹ç¼©é—®é¢˜ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ˜¾å¼è°ƒç”¨ end æ–¹æ³•ã€‚</li><li>Direct ByteBuffer é—®é¢˜å¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•° <code>-XX:MaxDirectMemorySize</code> è°ƒä½é˜ˆå€¼ã€‚</li><li>å‡çº§æœåŠ¡å™¨é…ç½®/éš”ç¦»éƒ¨ç½²ï¼Œé¿å…äº‰ç”¨ã€‚</li></ul><h4 id="kill-process-or-sacrifice-child" tabindex="-1"><a class="header-anchor" href="#kill-process-or-sacrifice-child" aria-hidden="true">#</a> Kill process or sacrifice child</h4><p>æœ‰ä¸€ç§å†…æ ¸ä½œä¸šï¼ˆKernel Jobï¼‰åä¸º Out of Memory Killerï¼Œå®ƒä¼šåœ¨å¯ç”¨å†…å­˜æä½çš„æƒ…å†µä¸‹â€œæ€æ­»â€ï¼ˆkillï¼‰æŸäº›è¿›ç¨‹ã€‚OOM Killer ä¼šå¯¹æ‰€æœ‰è¿›ç¨‹è¿›è¡Œæ‰“åˆ†ï¼Œç„¶åå°†è¯„åˆ†è¾ƒé«˜çš„è¿›ç¨‹â€œæ€æ­»â€ï¼Œå…·ä½“çš„è¯„åˆ†è§„åˆ™å¯ä»¥å‚è€ƒ <a href="https://dev.to/rrampage/surviving-the-linux-oom-killer-2ki9" target="_blank" rel="noopener noreferrer">Surviving the Linux OOM Killer<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><p>ä¸åŒäºå…¶ä»–çš„ OOM é”™è¯¯ï¼Œ<code>Kill process or sacrifice child</code> é”™è¯¯ä¸æ˜¯ç”± JVM å±‚é¢è§¦å‘çš„ï¼Œè€Œæ˜¯ç”±æ“ä½œç³»ç»Ÿå±‚é¢è§¦å‘çš„ã€‚å½“ç³»ç»Ÿç©ºé—²å†…å­˜çªç„¶å¤§å¹…è¢«é‡Šæ”¾ï¼Œæœ‰è¾ƒå¤§æ¦‚ç‡è§¦å‘äº† OOM Killer æ€æ‰äº†æŸäº›è¿›ç¨‹ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220726151232866-cf56ae17.png" alt="image-20220726151232866" tabindex="0" loading="lazy"><figcaption>image-20220726151232866</figcaption></figure><h5 id="åŸå› åˆ†æ-4" tabindex="-1"><a class="header-anchor" href="#åŸå› åˆ†æ-4" aria-hidden="true">#</a> åŸå› åˆ†æ</h5><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒLinux å†…æ ¸å…è®¸è¿›ç¨‹ç”³è¯·çš„å†…å­˜æ€»é‡å¤§äºç³»ç»Ÿå¯ç”¨å†…å­˜ï¼Œé€šè¿‡è¿™ç§â€œé”™å³°å¤ç”¨â€çš„æ–¹å¼å¯ä»¥æ›´æœ‰æ•ˆçš„åˆ©ç”¨ç³»ç»Ÿèµ„æºã€‚</p><p>ç„¶è€Œï¼Œè¿™ç§æ–¹å¼ä¹Ÿä¼šæ— å¯é¿å…åœ°å¸¦æ¥ä¸€å®šçš„â€œè¶…å–â€é£é™©ã€‚ä¾‹å¦‚æŸäº›è¿›ç¨‹æŒç»­å ç”¨ç³»ç»Ÿå†…å­˜ï¼Œç„¶åå¯¼è‡´å…¶ä»–è¿›ç¨‹æ²¡æœ‰å¯ç”¨å†…å­˜ã€‚æ­¤æ—¶ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æ¿€æ´» OOM Killerï¼Œå¯»æ‰¾è¯„åˆ†é«˜çš„è¿›ç¨‹ï¼Œå¹¶å°†å…¶â€œæ€æ­»â€ï¼Œé‡Šæ”¾å†…å­˜èµ„æºã€‚</p><h5 id="è§£å†³æ–¹æ¡ˆ-4" tabindex="-1"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-4" aria-hidden="true">#</a> è§£å†³æ–¹æ¡ˆ</h5><ul><li>å‡çº§æœåŠ¡å™¨é…ç½®/éš”ç¦»éƒ¨ç½²ï¼Œé¿å…äº‰ç”¨ã€‚</li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/performance_tuning_guide/s-memory-captun" target="_blank" rel="noopener noreferrer">OOM Killer è°ƒä¼˜<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</li></ul><h4 id="requested-array-size-exceeds-vm-limit" tabindex="-1"><a class="header-anchor" href="#requested-array-size-exceeds-vm-limit" aria-hidden="true">#</a> Requested array size exceeds VM limit</h4><p>JVM é™åˆ¶äº†æ•°ç»„çš„æœ€å¤§é•¿åº¦ï¼Œè¯¥é”™è¯¯è¡¨ç¤ºç¨‹åºè¯·æ±‚åˆ›å»ºçš„æ•°ç»„è¶…è¿‡æœ€å¤§é•¿åº¦é™åˆ¶ã€‚</p><p>JVM åœ¨ä¸ºæ•°ç»„åˆ†é…å†…å­˜å‰ï¼Œä¼šæ£€æŸ¥è¦åˆ†é…çš„æ•°æ®ç»“æ„åœ¨ç³»ç»Ÿä¸­æ˜¯å¦å¯å¯»å€ï¼Œé€šå¸¸ä¸º <code>Integer.MAX_VALUE - 2</code>ã€‚</p><p>æ­¤ç±»é—®é¢˜æ¯”è¾ƒç½•è§ï¼Œé€šå¸¸éœ€è¦æ£€æŸ¥ä»£ç ï¼Œç¡®è®¤ä¸šåŠ¡æ˜¯å¦éœ€è¦åˆ›å»ºå¦‚æ­¤å¤§çš„æ•°ç»„ï¼Œæ˜¯å¦å¯ä»¥æ‹†åˆ†ä¸ºå¤šä¸ªå—ï¼Œåˆ†æ‰¹æ‰§è¡Œã€‚</p><h4 id="direct-buffer-memory" tabindex="-1"><a class="header-anchor" href="#direct-buffer-memory" aria-hidden="true">#</a> Direct buffer memory</h4><p>Java å…è®¸åº”ç”¨ç¨‹åºé€šè¿‡ Direct ByteBuffer ç›´æ¥è®¿é—®å †å¤–å†…å­˜ï¼Œè®¸å¤šé«˜æ€§èƒ½ç¨‹åºé€šè¿‡ Direct ByteBuffer ç»“åˆå†…å­˜æ˜ å°„æ–‡ä»¶ï¼ˆMemory Mapped Fileï¼‰å®ç°é«˜é€Ÿ IOã€‚</p><h5 id="åŸå› åˆ†æ-5" tabindex="-1"><a class="header-anchor" href="#åŸå› åˆ†æ-5" aria-hidden="true">#</a> åŸå› åˆ†æ</h5><p>Direct ByteBuffer çš„é»˜è®¤å¤§å°ä¸º 64 MBï¼Œä¸€æ—¦ä½¿ç”¨è¶…å‡ºé™åˆ¶ï¼Œå°±ä¼šæŠ›å‡º <code>Direct buffer memory</code> é”™è¯¯ã€‚</p><h5 id="è§£å†³æ–¹æ¡ˆ-5" tabindex="-1"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-5" aria-hidden="true">#</a> è§£å†³æ–¹æ¡ˆ</h5><ul><li>Java åªèƒ½é€šè¿‡ ByteBuffer.allocateDirect æ–¹æ³•ä½¿ç”¨ Direct ByteBufferï¼Œå› æ­¤ï¼Œå¯ä»¥é€šè¿‡ <a href="https://github.com/alibaba/arthas" target="_blank" rel="noopener noreferrer">Arthas<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ç­‰åœ¨çº¿è¯Šæ–­å·¥å…·æ‹¦æˆªè¯¥æ–¹æ³•è¿›è¡Œæ’æŸ¥ã€‚</li><li>æ£€æŸ¥æ˜¯å¦ç›´æ¥æˆ–é—´æ¥ä½¿ç”¨äº† NIOï¼Œå¦‚ nettyï¼Œjetty ç­‰ã€‚</li><li>é€šè¿‡å¯åŠ¨å‚æ•° <code>-XX:MaxDirectMemorySize</code> è°ƒæ•´ Direct ByteBuffer çš„ä¸Šé™å€¼ã€‚</li><li>æ£€æŸ¥ JVM å‚æ•°æ˜¯å¦æœ‰ <code>-XX:+DisableExplicitGC</code> é€‰é¡¹ï¼Œå¦‚æœæœ‰å°±å»æ‰ï¼Œå› ä¸ºè¯¥å‚æ•°ä¼šä½¿ <code>System.gc()</code> å¤±æ•ˆã€‚</li><li>æ£€æŸ¥å †å¤–å†…å­˜ä½¿ç”¨ä»£ç ï¼Œç¡®è®¤æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼ï¼›æˆ–è€…é€šè¿‡åå°„è°ƒç”¨ <code>sun.misc.Cleaner</code> çš„ <code>clean()</code> æ–¹æ³•æ¥ä¸»åŠ¨é‡Šæ”¾è¢« Direct ByteBuffer æŒæœ‰çš„å†…å­˜ç©ºé—´ã€‚</li><li>å†…å­˜å®¹é‡ç¡®å®ä¸è¶³ï¼Œå‡çº§é…ç½®ã€‚</li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes/edit/main/demo/theme-docs/src/Java/eightpart/virtualMachine.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 542716863@qq.com">RrOrange</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/Computer-Science-Learn-Notes/Java/eightpart/concurrency.html" class="nav-link prev" aria-label="Javaå¹¶å‘"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Javaå¹¶å‘</div></a><a href="/Computer-Science-Learn-Notes/Java/eightpart/spring.html" class="nav-link next" aria-label="Springç³»åˆ—"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Springç³»åˆ—<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">é»˜è®¤é¡µè„š</div><div class="copyright">Copyright Â© 2023 zhiyu1998</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/Computer-Science-Learn-Notes/assets/app-704f16ef.js" defer></script>
  </body>
</html>
