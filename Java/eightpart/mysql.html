<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/Java/eightpart/mysql.html"><meta property="og:title" content="MySQL"><meta property="og:description" content="ğŸ¬ MYSQL MySql åŸºç¡€æ¶æ„ | ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ image-20220613104147805 è¿æ¥å™¨ï¼š èº«ä»½è®¤è¯å’Œæƒé™ç›¸å…³(ç™»å½• MySQL çš„æ—¶å€™)ã€‚; æŸ¥è¯¢ç¼“å­˜ï¼š æ‰§è¡ŒæŸ¥è¯¢è¯­å¥çš„æ—¶å€™ï¼Œä¼šå…ˆæŸ¥è¯¢ç¼“å­˜ï¼ˆMySQL 8.0 ç‰ˆæœ¬åç§»é™¤ï¼Œå› ä¸ºè¿™ä¸ªåŠŸèƒ½ä¸å¤ªå®ç”¨ï¼‰ã€‚; åˆ†æå™¨ï¼š æ²¡æœ‰å‘½ä¸­ç¼“å­˜çš„è¯ï¼ŒSQL è¯­å¥å°±ä¼šç»è¿‡åˆ†æå™¨ï¼Œåˆ†..."><meta property="og:type" content="article"><meta property="og:image" content="https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-04-04T17:31:51.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="MySQL"><meta property="article:author" content="zhiyu1998"><meta property="article:modified_time" content="2023-04-04T17:31:51.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"MySQL","image":["https://zhiyu1998.github.io/Computer-Science-Learn-Notes/Computer-Science-Learn-Notes/"],"dateModified":"2023-04-04T17:31:51.000Z","author":[{"@type":"Person","name":"zhiyu1998"}]}</script><link rel="manifest" href="/Computer-Science-Learn-Notes/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>MySQL</title><meta name="description" content="ğŸ¬ MYSQL MySql åŸºç¡€æ¶æ„ | ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ image-20220613104147805 è¿æ¥å™¨ï¼š èº«ä»½è®¤è¯å’Œæƒé™ç›¸å…³(ç™»å½• MySQL çš„æ—¶å€™)ã€‚; æŸ¥è¯¢ç¼“å­˜ï¼š æ‰§è¡ŒæŸ¥è¯¢è¯­å¥çš„æ—¶å€™ï¼Œä¼šå…ˆæŸ¥è¯¢ç¼“å­˜ï¼ˆMySQL 8.0 ç‰ˆæœ¬åç§»é™¤ï¼Œå› ä¸ºè¿™ä¸ªåŠŸèƒ½ä¸å¤ªå®ç”¨ï¼‰ã€‚; åˆ†æå™¨ï¼š æ²¡æœ‰å‘½ä¸­ç¼“å­˜çš„è¯ï¼ŒSQL è¯­å¥å°±ä¼šç»è¿‡åˆ†æå™¨ï¼Œåˆ†...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/Computer-Science-Learn-Notes/assets/style-1866b779.css" as="style"><link rel="stylesheet" href="/Computer-Science-Learn-Notes/assets/style-1866b779.css">
    <link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/app-66c72b60.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/framework-afce0fe7.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/mysql.html-4788adf8.js"><link rel="modulepreload" href="/Computer-Science-Learn-Notes/assets/mysql.html-f5b0f716.js"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-27ae749c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/slides.html-0f261d40.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/datastruct.html-814f91bc.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/learnInProblem.html-e2624bd5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-0c8d2f60.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/disable.html-ff8b473a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/encrypt.html-9fbca9c6.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/markdown.html-55bc9907.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/page.html-0e7ead7d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/personal_tech.html-3bc8c638.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/rent_house.html-23504880.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/basic.html-2311c034.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/concurrent.html-ada5aaea.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/concurrency.html-e7bc6f0b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/datastruct.html-881ce9de.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/distribution.html-d27d659c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/foundation.html-bf4e15fb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/giant.html-42c6a59e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/intelligenceQuestion.html-bd2292b3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/intro.html-fffd0865.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/messageQueue.html-278edcbd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/netty.html-c94bbb94.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/network.html-05853173.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/redis.html-34355bf8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/spring.html-5502b472.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/system.html-7b8bb171.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/think.html-7aaeaa58.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/virtualMachine.html-3e875324.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/Mybatis.html-49e400d9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/Spring.html-e43fb86b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringBoot.html-6059d383.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringCloud.html-76a4f205.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringDataJpa.html-7952c7e4.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringMVC.html-9cedf7ca.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringSecurity.html-477b5769.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/kotlin.html-434e1c2b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/leetcode.html-6e6af564.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/react.html-e22168ca.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/typescript.html-73dbe6d5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/vue.html-b29ea4f2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/1.ç®€ä»‹.html-1e536036.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10.å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½.html-733d51ee.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/11.ç›´æ¥å†…å­˜.html-cd6f6114.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/12.æ‰§è¡Œå¼•æ“.html-24baab50.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/13.StringTable.html-1bd92712.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/14.åƒåœ¾å›æ”¶æ¦‚è¿°.html-effe5d94.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/15.åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•.html-b029208d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/16.åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ.html-9a13bda3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/17-åƒåœ¾å›æ”¶å™¨.html-a8ddf178.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/2.ç±»åŠ è½½å­ç³»ç»Ÿ.html-345d10bb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/3.è¿è¡Œæ—¶æ•°æ®åŒº.html-157299af.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/4.ç¨‹åºè®¡æ•°å™¨ï¼ˆPCå¯„å­˜å™¨ï¼‰.html-5efab972.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/5.è™šæ‹Ÿæœºæ ˆ.html-83dc9801.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/6.æœ¬åœ°æ–¹æ³•æ¥å£.html-effcee7e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/7.æœ¬åœ°æ–¹æ³•æ ˆ.html-aa08dac1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/8.å †.html-2be9fba4.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/9.æ–¹æ³•åŒº.html-9a92dbe7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/03-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—.html-4aecb229.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾.html-33c8a326.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/05-æ›¿æ¢ç©ºæ ¼.html-731ec847.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.html-64aa068b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10-I.æ–æ³¢é‚£å¥‘æ•°åˆ—.html-21f0bbc7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10-IIé’è›™è·³å°é˜¶é—®é¢˜.html-5936af63.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/11-æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—.html-8ecdda63.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/12-çŸ©é˜µä¸­çš„è·¯å¾„.html-9b2fd662.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´.html-32d9b38a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/14-å‰ªç»³å­.html-e21a6ec0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/15-äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°.html-97ba661d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/16-æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹.html-e2b3eebc.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/17-æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•°.html-0f115655.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/18-åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹.html-a1ceedab.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹.html-459571cf.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/24-åè½¬é“¾è¡¨.html-92de2c0d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/25-åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨.html-56752d60.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/26-æ ‘çš„å­ç»“æ„.html-1319ff49.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/27-äºŒå‰æ ‘çš„é•œåƒ.html-d20c02c1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/28-å¯¹ç§°çš„äºŒå‰æ ‘.html-187d456e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/58-II å·¦æ—‹è½¬å­—ç¬¦ä¸².html-713e6be0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/å¸¸ç”¨æ–¹æ³•å°è£…åˆé›†.html-af0be8af.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/404.html-75fcb8ce.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-039ed2dc.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-c13a7958.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-986cbfb0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-58c0e762.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-dc2c74b8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-a146e343.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-297716ff.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-f08ea5cf.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-cf1c7cba.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-4187abed.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-6de5662b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-90d0a7cf.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-c6c0348e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-50cf6287.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-9bd6aad5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-d4518628.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-2016f3b0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-ba00b820.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/slides.html-a991af2c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/datastruct.html-7308e003.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/learnInProblem.html-7f04200b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-c34e5275.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/disable.html-d972dbc6.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/encrypt.html-4170437a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/markdown.html-61862a67.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/page.html-67d96e22.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/personal_tech.html-5568dee3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/rent_house.html-1e0dd4dc.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/basic.html-18911cb1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/concurrent.html-2c57d1b2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/concurrency.html-afad628e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/datastruct.html-6bc5abf5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/distribution.html-37fe1b25.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/foundation.html-85a0e08b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/giant.html-3eed9986.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/intelligenceQuestion.html-482d99cd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/intro.html-34111fe3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/messageQueue.html-f1cfd3be.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/netty.html-58c97bb7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/network.html-264ac01e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/redis.html-3db37bdc.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/spring.html-a9a42659.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/system.html-fdd3c39f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/think.html-cb5d858e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/virtualMachine.html-c1769886.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/Mybatis.html-3af6d6d4.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/Spring.html-e163eccb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringBoot.html-56483b76.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringCloud.html-03730661.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringDataJpa.html-41f35d61.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringMVC.html-83890e3a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SpringSecurity.html-62b13e45.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/kotlin.html-b2e2dd46.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/leetcode.html-f644d859.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/react.html-594c07f5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/typescript.html-7057d002.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/vue.html-bc78c79b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/1.ç®€ä»‹.html-50b9c060.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10.å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½.html-8c7802a5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/11.ç›´æ¥å†…å­˜.html-d0d37dbd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/12.æ‰§è¡Œå¼•æ“.html-e00ef777.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/13.StringTable.html-8bba02d8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/14.åƒåœ¾å›æ”¶æ¦‚è¿°.html-93107bc9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/15.åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•.html-8b7d348d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/16.åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ.html-3633af62.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/17-åƒåœ¾å›æ”¶å™¨.html-d2c56119.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/2.ç±»åŠ è½½å­ç³»ç»Ÿ.html-7d72d57f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/3.è¿è¡Œæ—¶æ•°æ®åŒº.html-3d6a37b7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/4.ç¨‹åºè®¡æ•°å™¨ï¼ˆPCå¯„å­˜å™¨ï¼‰.html-95dde1b1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/5.è™šæ‹Ÿæœºæ ˆ.html-dc56806b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/6.æœ¬åœ°æ–¹æ³•æ¥å£.html-7fc16965.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/7.æœ¬åœ°æ–¹æ³•æ ˆ.html-6cad103e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/8.å †.html-f69bf86e.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/9.æ–¹æ³•åŒº.html-ef3b6e04.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/03-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—.html-567f5361.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾.html-6e6af06d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/05-æ›¿æ¢ç©ºæ ¼.html-202212eb.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.html-19d03253.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10-I.æ–æ³¢é‚£å¥‘æ•°åˆ—.html-b6e27af0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/10-IIé’è›™è·³å°é˜¶é—®é¢˜.html-10ebe3d1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/11-æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—.html-f82a7837.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/12-çŸ©é˜µä¸­çš„è·¯å¾„.html-324f8453.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´.html-dad3810f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/14-å‰ªç»³å­.html-c23774d2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/15-äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°.html-14fb859b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/16-æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹.html-64f6fe8a.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/17-æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•°.html-8531c65c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/18-åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹.html-3aeace11.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹.html-2517eeed.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/24-åè½¬é“¾è¡¨.html-6a3f1b99.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/25-åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨.html-702f2779.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/26-æ ‘çš„å­ç»“æ„.html-4d99c9a3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/27-äºŒå‰æ ‘çš„é•œåƒ.html-85287fc8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/28-å¯¹ç§°çš„äºŒå‰æ ‘.html-3aeebb13.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/58-II å·¦æ—‹è½¬å­—ç¬¦ä¸².html-a6dd23e1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/å¸¸ç”¨æ–¹æ³•å°è£…åˆé›†.html-f4b05f8b.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/404.html-982c42ec.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-7186d5f7.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-eaa10b62.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-1fbfb2e6.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-1271cf68.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-96bcade0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-90e31230.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-a1738b34.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-81d7f46f.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-95691e99.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-a6d8def1.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-040d812d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-44563782.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-e775c7d3.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-fca388e5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-8663824d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-c6c6d33d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index.html-b144c1dd.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/waline-meta-a31b78ed.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/component-0be4b3d2.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index-b03bef79.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/mermaid.core-73a383b6.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/highlight.esm-a794bb63.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/markdown.esm-d92a2fc9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/notes.esm-224f94d9.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/reveal.esm-e5069ce0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/search.esm-2c3fba7d.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/VuePlayground-f22e6317.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/photoswipe.esm-36cd6c3c.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/index-70769223.js" as="script"><link rel="prefetch" href="/Computer-Science-Learn-Notes/assets/SearchResult-7cf681a0.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/Computer-Science-Learn-Notes/" class="brand"><img class="logo" src="/Computer-Science-Learn-Notes/logo.svg" alt><!----><!----></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/Computer-Science-Learn-Notes/" class="nav-link" aria-label="ä¸»é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/Computer-Science-Learn-Notes/intro/" class="nav-link" aria-label="å¯¼è¯»"><span class="font-icon icon iconfont icon-discover" style=""></span>å¯¼è¯»<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes/issues" rel="noopener noreferrer" target="_blank" aria-label="é—®é¢˜åé¦ˆ" class="nav-link"><span class="font-icon icon iconfont icon-note" style=""></span>é—®é¢˜åé¦ˆ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">æœç´¢</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-vscode" style=""></span><span class="title">å‰ç«¯</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-timer" style=""></span><span class="title">Golang</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-build" style=""></span><span class="title">è®¡ç®—æœºåŸºç¡€</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">JavaåŸºç¡€</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-branch" style=""></span><span class="title">Javaå¹¶å‘</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-profile" style=""></span><span class="title">Javaé¢è¯•</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/foundation.html" class="nav-link sidebar-link sidebar-page" aria-label="JavaåŸºç¡€"><!---->JavaåŸºç¡€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/intro.html" class="nav-link sidebar-link sidebar-page" aria-label="å‰è¨€"><!---->å‰è¨€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/concurrency.html" class="nav-link sidebar-link sidebar-page" aria-label="Javaå¹¶å‘"><!---->Javaå¹¶å‘<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/virtualMachine.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM"><!---->JVM<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/spring.html" class="nav-link sidebar-link sidebar-page" aria-label="Springç³»åˆ—"><!---->Springç³»åˆ—<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="MySQL"><!---->MySQL<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#ğŸ¬-mysql" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ¬ MYSQL"><!---->ğŸ¬ MYSQL<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#mysql-åŸºç¡€æ¶æ„-ä¸€æ¡-sql-æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="MySql åŸºç¡€æ¶æ„ | ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„"><!---->MySql åŸºç¡€æ¶æ„ | ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#â­myisam-å’Œ-innodb-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­MyISAM å’Œ InnoDB çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><!---->â­MyISAM å’Œ InnoDB çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“çš„ç´¢å¼•åˆ†ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®åº“çš„ç´¢å¼•åˆ†ç±»"><!---->æ•°æ®åº“çš„ç´¢å¼•åˆ†ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#â­ï¸èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­ï¸èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•"><!---->â­ï¸èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“äº‹åŠ¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®åº“äº‹åŠ¡ï¼Ÿ"><!---->æ•°æ®åº“äº‹åŠ¡ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#å¹¶å‘äº‹åŠ¡å¸¦æ¥äº†å“ªäº›é—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¹¶å‘äº‹åŠ¡å¸¦æ¥äº†å“ªäº›é—®é¢˜"><!---->å¹¶å‘äº‹åŠ¡å¸¦æ¥äº†å“ªäº›é—®é¢˜<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#â­æœ‰å“ªäº›äº‹åŠ¡éš”ç¦»çº§åˆ«-mysql-çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­æœ‰å“ªäº›äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼ŒMySQL çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ?"><!---->â­æœ‰å“ªäº›äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼ŒMySQL çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ?<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#è¡¨çº§é”å’Œè¡Œçº§é”äº†è§£å—-æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¡¨çº§é”å’Œè¡Œçº§é”äº†è§£å—ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><!---->è¡¨çº§é”å’Œè¡Œçº§é”äº†è§£å—ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#å…±äº«é”å’Œæ’ä»–é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…±äº«é”å’Œæ’ä»–é”"><!---->å…±äº«é”å’Œæ’ä»–é”<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“ç´¢å¼•å¤±æ•ˆæœ‰å“ªäº›" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®åº“ç´¢å¼•å¤±æ•ˆæœ‰å“ªäº›"><!---->æ•°æ®åº“ç´¢å¼•å¤±æ•ˆæœ‰å“ªäº›<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“sqlä¼˜åŒ–æœ‰å“ªäº›æ–¹æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®åº“sqlä¼˜åŒ–æœ‰å“ªäº›æ–¹æ³•"><!---->æ•°æ®åº“sqlä¼˜åŒ–æœ‰å“ªäº›æ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#innodb-æœ‰å“ªå‡ ç±»è¡Œé”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="InnoDB æœ‰å“ªå‡ ç±»è¡Œé”"><!---->InnoDB æœ‰å“ªå‡ ç±»è¡Œé”<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#ä¸ºä»€ä¹ˆmysql-æ²¡æœ‰ä½¿ç”¨hashè¡¨ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„å‘¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸ºä»€ä¹ˆMySQL æ²¡æœ‰ä½¿ç”¨Hashè¡¨ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„å‘¢ï¼Ÿ"><!---->ä¸ºä»€ä¹ˆMySQL æ²¡æœ‰ä½¿ç”¨Hashè¡¨ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„å‘¢ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#â­ï¸ä¸ºä»€ä¹ˆmysqlåº•å±‚è¦ç”¨b-æ ‘-å’Œbæ ‘æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="â­ï¸ä¸ºä»€ä¹ˆMySQLåº•å±‚è¦ç”¨B+æ ‘ï¼Ÿå’ŒBæ ‘æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><!---->â­ï¸ä¸ºä»€ä¹ˆMySQLåº•å±‚è¦ç”¨B+æ ‘ï¼Ÿå’ŒBæ ‘æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#è¯¦è§£b-æ ‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¯¦è§£B+æ ‘"><!---->è¯¦è§£B+æ ‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#mysqlä¸‰å¤§æ—¥å¿—-binlogã€redo-logã€undo-log" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="MySQLä¸‰å¤§æ—¥å¿—ï¼ˆbinlogã€redo logã€undo logï¼‰"><!---->MySQLä¸‰å¤§æ—¥å¿—ï¼ˆbinlogã€redo logã€undo logï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#å›¾è§£mvcc" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å›¾è§£MVCC"><!---->å›¾è§£MVCC<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#innodbå­˜å‚¨å¼•æ“å¯¹mvccçš„å®ç°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="InnoDBå­˜å‚¨å¼•æ“å¯¹MVCCçš„å®ç°"><!---->InnoDBå­˜å‚¨å¼•æ“å¯¹MVCCçš„å®ç°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#mysqlæœ‰å‡ ç§é«˜å¯ç”¨æ–¹æ¡ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="MySQLæœ‰å‡ ç§é«˜å¯ç”¨æ–¹æ¡ˆ"><!---->MySQLæœ‰å‡ ç§é«˜å¯ç”¨æ–¹æ¡ˆ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#è¯»å†™åˆ†ç¦»äº†è§£å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¯»å†™åˆ†ç¦»äº†è§£å—ï¼Ÿ"><!---->è¯»å†™åˆ†ç¦»äº†è§£å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#èŠèŠåˆ†åº“åˆ†è¡¨-åˆ†è¡¨ä¸ºä»€ä¹ˆè¦åœæœè¿™ç§æ“ä½œ-å¦‚æœä¸åœæœå¯ä»¥æ€ä¹ˆåš" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="èŠèŠåˆ†åº“åˆ†è¡¨,åˆ†è¡¨ä¸ºä»€ä¹ˆè¦åœæœè¿™ç§æ“ä½œï¼Œå¦‚æœä¸åœæœå¯ä»¥æ€ä¹ˆåš"><!---->èŠèŠåˆ†åº“åˆ†è¡¨,åˆ†è¡¨ä¸ºä»€ä¹ˆè¦åœæœè¿™ç§æ“ä½œï¼Œå¦‚æœä¸åœæœå¯ä»¥æ€ä¹ˆåš<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#ä¸»ä»å¤åˆ¶åŸç†äº†è§£ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸»ä»å¤åˆ¶åŸç†äº†è§£ä¹ˆï¼Ÿ"><!---->ä¸»ä»å¤åˆ¶åŸç†äº†è§£ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®åº“å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”"><!---->æ•°æ®åº“å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/redis.html" class="nav-link sidebar-link sidebar-page" aria-label="redis"><!---->redis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/distribution.html" class="nav-link sidebar-link sidebar-page" aria-label="åˆ†å¸ƒå¼"><!---->åˆ†å¸ƒå¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/messageQueue.html" class="nav-link sidebar-link sidebar-page" aria-label="æ¶ˆæ¯é˜Ÿåˆ—"><!---->æ¶ˆæ¯é˜Ÿåˆ—<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/netty.html" class="nav-link sidebar-link sidebar-page" aria-label="Netty"><!---->Netty<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/network.html" class="nav-link sidebar-link sidebar-page" aria-label="è®¡ç®—æœºç½‘ç»œ"><!---->è®¡ç®—æœºç½‘ç»œ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/system.html" class="nav-link sidebar-link sidebar-page" aria-label="æ“ä½œç³»ç»Ÿ"><!---->æ“ä½œç³»ç»Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/datastruct.html" class="nav-link sidebar-link sidebar-page" aria-label="æ•°æ®ç»“æ„"><!---->æ•°æ®ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/intelligenceQuestion.html" class="nav-link sidebar-link sidebar-page" aria-label="æ™ºåŠ›é¢˜"><!---->æ™ºåŠ›é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/giant.html" class="nav-link sidebar-link sidebar-page" aria-label="2022å¤§å‚å…«è‚¡æ–‡"><!---->2022å¤§å‚å…«è‚¡æ–‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Computer-Science-Learn-Notes/Java/eightpart/think.html" class="nav-link sidebar-link sidebar-page" aria-label="åŸºäºé¢è¯•é¢˜çš„ä¸€äº›æ€è€ƒ"><!---->åŸºäºé¢è¯•é¢˜çš„ä¸€äº›æ€è€ƒ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-leaf" style=""></span><span class="title">Javaæ¡†æ¶</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-async" style=""></span><span class="title">Javaè™šæ‹Ÿæœº</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-launch" style=""></span><span class="title">Kotlinç»“åˆSpring</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-object" style=""></span><span class="title">LeetCodeåˆ·é¢˜é¡ºåº</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-repair" style=""></span><span class="title">ç»éªŒæ€»ç»“</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->MySQL</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">zhiyu1998</span></span><span property="author" content="zhiyu1998"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-04-04T15:12:04.000Z"></span><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" id="ArtalkPV" data-path="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 68 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT68M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#ğŸ¬-mysql" class="router-link-active router-link-exact-active toc-link level2">ğŸ¬ MYSQL</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#mysql-åŸºç¡€æ¶æ„-ä¸€æ¡-sql-æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„" class="router-link-active router-link-exact-active toc-link level3">MySql åŸºç¡€æ¶æ„ | ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#â­myisam-å’Œ-innodb-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level3">â­MyISAM å’Œ InnoDB çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“çš„ç´¢å¼•åˆ†ç±»" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®åº“çš„ç´¢å¼•åˆ†ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#â­ï¸èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level3">â­ï¸èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“äº‹åŠ¡" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®åº“äº‹åŠ¡ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#å¹¶å‘äº‹åŠ¡å¸¦æ¥äº†å“ªäº›é—®é¢˜" class="router-link-active router-link-exact-active toc-link level3">å¹¶å‘äº‹åŠ¡å¸¦æ¥äº†å“ªäº›é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#â­æœ‰å“ªäº›äº‹åŠ¡éš”ç¦»çº§åˆ«-mysql-çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level3">â­æœ‰å“ªäº›äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼ŒMySQL çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ?</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#è¡¨çº§é”å’Œè¡Œçº§é”äº†è§£å—-æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active toc-link level3">è¡¨çº§é”å’Œè¡Œçº§é”äº†è§£å—ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#å…±äº«é”å’Œæ’ä»–é”" class="router-link-active router-link-exact-active toc-link level3">å…±äº«é”å’Œæ’ä»–é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“ç´¢å¼•å¤±æ•ˆæœ‰å“ªäº›" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®åº“ç´¢å¼•å¤±æ•ˆæœ‰å“ªäº›</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“sqlä¼˜åŒ–æœ‰å“ªäº›æ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®åº“sqlä¼˜åŒ–æœ‰å“ªäº›æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#innodb-æœ‰å“ªå‡ ç±»è¡Œé”" class="router-link-active router-link-exact-active toc-link level3">InnoDB æœ‰å“ªå‡ ç±»è¡Œé”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#ä¸ºä»€ä¹ˆmysql-æ²¡æœ‰ä½¿ç”¨hashè¡¨ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„å‘¢" class="router-link-active router-link-exact-active toc-link level3">ä¸ºä»€ä¹ˆMySQL æ²¡æœ‰ä½¿ç”¨Hashè¡¨ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„å‘¢ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#â­ï¸ä¸ºä»€ä¹ˆmysqlåº•å±‚è¦ç”¨b-æ ‘-å’Œbæ ‘æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active toc-link level3">â­ï¸ä¸ºä»€ä¹ˆMySQLåº•å±‚è¦ç”¨B+æ ‘ï¼Ÿå’ŒBæ ‘æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#è¯¦è§£b-æ ‘" class="router-link-active router-link-exact-active toc-link level3">è¯¦è§£B+æ ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#mysqlä¸‰å¤§æ—¥å¿—-binlogã€redo-logã€undo-log" class="router-link-active router-link-exact-active toc-link level3">MySQLä¸‰å¤§æ—¥å¿—ï¼ˆbinlogã€redo logã€undo logï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#å›¾è§£mvcc" class="router-link-active router-link-exact-active toc-link level3">å›¾è§£MVCC</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#innodbå­˜å‚¨å¼•æ“å¯¹mvccçš„å®ç°" class="router-link-active router-link-exact-active toc-link level3">InnoDBå­˜å‚¨å¼•æ“å¯¹MVCCçš„å®ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#mysqlæœ‰å‡ ç§é«˜å¯ç”¨æ–¹æ¡ˆ" class="router-link-active router-link-exact-active toc-link level3">MySQLæœ‰å‡ ç§é«˜å¯ç”¨æ–¹æ¡ˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#è¯»å†™åˆ†ç¦»äº†è§£å—" class="router-link-active router-link-exact-active toc-link level3">è¯»å†™åˆ†ç¦»äº†è§£å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#èŠèŠåˆ†åº“åˆ†è¡¨-åˆ†è¡¨ä¸ºä»€ä¹ˆè¦åœæœè¿™ç§æ“ä½œ-å¦‚æœä¸åœæœå¯ä»¥æ€ä¹ˆåš" class="router-link-active router-link-exact-active toc-link level3">èŠèŠåˆ†åº“åˆ†è¡¨,åˆ†è¡¨ä¸ºä»€ä¹ˆè¦åœæœè¿™ç§æ“ä½œï¼Œå¦‚æœä¸åœæœå¯ä»¥æ€ä¹ˆåš</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#ä¸»ä»å¤åˆ¶åŸç†äº†è§£ä¹ˆ" class="router-link-active router-link-exact-active toc-link level3">ä¸»ä»å¤åˆ¶åŸç†äº†è§£ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Computer-Science-Learn-Notes/Java/eightpart/mysql.html#æ•°æ®åº“å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®åº“å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”</a></li><!----><!--]--></ul></li><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="ğŸ¬-mysql" tabindex="-1"><a class="header-anchor" href="#ğŸ¬-mysql" aria-hidden="true">#</a> ğŸ¬ MYSQL</h2><h3 id="mysql-åŸºç¡€æ¶æ„-ä¸€æ¡-sql-æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„" tabindex="-1"><a class="header-anchor" href="#mysql-åŸºç¡€æ¶æ„-ä¸€æ¡-sql-æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„" aria-hidden="true">#</a> MySql åŸºç¡€æ¶æ„ | ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„</h3><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220612134312190-6f587153.png" alt="image-20220613104147805" tabindex="0" loading="lazy"><figcaption>image-20220613104147805</figcaption></figure><ul><li><strong>è¿æ¥å™¨ï¼š</strong> èº«ä»½è®¤è¯å’Œæƒé™ç›¸å…³(ç™»å½• MySQL çš„æ—¶å€™)ã€‚</li><li><strong>æŸ¥è¯¢ç¼“å­˜ï¼š</strong> æ‰§è¡ŒæŸ¥è¯¢è¯­å¥çš„æ—¶å€™ï¼Œä¼šå…ˆæŸ¥è¯¢ç¼“å­˜ï¼ˆMySQL 8.0 ç‰ˆæœ¬åç§»é™¤ï¼Œå› ä¸ºè¿™ä¸ªåŠŸèƒ½ä¸å¤ªå®ç”¨ï¼‰ã€‚</li><li><strong>åˆ†æå™¨ï¼š</strong> æ²¡æœ‰å‘½ä¸­ç¼“å­˜çš„è¯ï¼ŒSQL è¯­å¥å°±ä¼šç»è¿‡åˆ†æå™¨ï¼Œåˆ†æå™¨è¯´ç™½äº†å°±æ˜¯è¦å…ˆçœ‹ä½ çš„ SQL è¯­å¥è¦å¹²å˜›ï¼Œå†æ£€æŸ¥ä½ çš„ SQL è¯­å¥è¯­æ³•æ˜¯å¦æ­£ç¡®ã€‚</li><li><strong>ä¼˜åŒ–å™¨ï¼š</strong> æŒ‰ç…§ MySQL è®¤ä¸ºæœ€ä¼˜çš„æ–¹æ¡ˆå»æ‰§è¡Œã€‚</li><li><strong>æ‰§è¡Œå™¨ï¼š</strong> æ‰§è¡Œè¯­å¥ï¼Œç„¶åä»å­˜å‚¨å¼•æ“è¿”å›æ•°æ®ã€‚ æ‰§è¡Œè¯­å¥ä¹‹å‰ä¼šå…ˆåˆ¤æ–­æ˜¯å¦æœ‰æƒé™ï¼Œå¦‚æœæ²¡æœ‰æƒé™çš„è¯ï¼Œå°±ä¼šæŠ¥é”™ã€‚</li><li><strong>æ’ä»¶å¼å­˜å‚¨å¼•æ“</strong> ï¼š ä¸»è¦è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œè¯»å–ï¼Œé‡‡ç”¨çš„æ˜¯æ’ä»¶å¼æ¶æ„ï¼Œæ”¯æŒ InnoDBã€MyISAMã€Memory ç­‰å¤šç§å­˜å‚¨å¼•æ“ã€‚</li></ul><h3 id="â­myisam-å’Œ-innodb-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#â­myisam-å’Œ-innodb-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> â­MyISAM å’Œ InnoDB çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>é™¤äº†6ï¼Œéƒ½æ˜¯InnoDBæ”¯æŒï¼Œå‰è€…ä¸æ”¯æŒ</p><p><strong>1.æ˜¯å¦æ”¯æŒè¡Œçº§é”</strong></p><p><strong>2.æ˜¯å¦æ”¯æŒäº‹åŠ¡</strong></p><p><strong>3.æ˜¯å¦æ”¯æŒå¤–é”®</strong></p><p><strong>4.æ˜¯å¦æ”¯æŒæ•°æ®åº“å¼‚å¸¸å´©æºƒåçš„å®‰å…¨æ¢å¤</strong></p><blockquote><p>MyISAM ä¸æ”¯æŒï¼Œè€Œ InnoDB æ”¯æŒã€‚</p><p>ä½¿ç”¨ InnoDB çš„æ•°æ®åº“åœ¨å¼‚å¸¸å´©æºƒåï¼Œæ•°æ®åº“é‡æ–°å¯åŠ¨çš„æ—¶å€™ä¼šä¿è¯æ•°æ®åº“æ¢å¤åˆ°å´©æºƒå‰çš„çŠ¶æ€ã€‚è¿™ä¸ªæ¢å¤çš„è¿‡ç¨‹ä¾èµ–äº <code>redo log</code> ã€‚</p></blockquote><p><strong>5.æ˜¯å¦æ”¯æŒ MVCC</strong></p><p><strong>6.ç´¢å¼•å®ç°ä¸ä¸€æ ·ã€‚</strong></p><blockquote><p>è™½ç„¶ MyISAM å¼•æ“å’Œ InnoDB å¼•æ“éƒ½æ˜¯ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œä½†æ˜¯ä¸¤è€…çš„å®ç°æ–¹å¼ä¸å¤ªä¸€æ ·ã€‚</p><p>InnoDB å¼•æ“ä¸­ï¼Œå…¶æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ç´¢å¼•æ–‡ä»¶ã€‚ç›¸æ¯” MyISAMï¼Œç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ï¼Œå…¶è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰ B+Tree ç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„ï¼Œæ ‘çš„å¶èŠ‚ç‚¹ data åŸŸä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚</p></blockquote><h3 id="æ•°æ®åº“çš„ç´¢å¼•åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“çš„ç´¢å¼•åˆ†ç±»" aria-hidden="true">#</a> æ•°æ®åº“çš„ç´¢å¼•åˆ†ç±»</h3><ul><li>æŒ‰ã€Œæ•°æ®ç»“æ„ã€åˆ†ç±»ï¼š<strong>B+treeç´¢å¼•ã€Hashç´¢å¼•ã€Full-textç´¢å¼•</strong>ã€‚</li><li>æŒ‰ã€Œç‰©ç†å­˜å‚¨ã€åˆ†ç±»ï¼š<strong>èšç°‡ç´¢å¼•ï¼ˆä¸»é”®ç´¢å¼•ï¼‰ã€äºŒçº§ç´¢å¼•ï¼ˆè¾…åŠ©ç´¢å¼•ï¼‰</strong>ã€‚</li><li>æŒ‰ã€Œå­—æ®µç‰¹æ€§ã€åˆ†ç±»ï¼š<strong>ä¸»é”®ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€æ™®é€šç´¢å¼•ã€å‰ç¼€ç´¢å¼•</strong>ã€‚</li><li>æŒ‰ã€Œå­—æ®µä¸ªæ•°ã€åˆ†ç±»ï¼š<strong>å•åˆ—ç´¢å¼•ã€è”åˆç´¢å¼•</strong>ã€‚</li></ul><blockquote><p>xia&#39;m</p></blockquote><h4 id="æŒ‰æ•°æ®ç»“æ„åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#æŒ‰æ•°æ®ç»“æ„åˆ†ç±»" aria-hidden="true">#</a> æŒ‰æ•°æ®ç»“æ„åˆ†ç±»</h4><p>ä»æ•°æ®ç»“æ„çš„è§’åº¦æ¥çœ‹ï¼ŒMySQL å¸¸è§ç´¢å¼•æœ‰ B+Tree ç´¢å¼•ã€HASH ç´¢å¼•ã€Full-Text ç´¢å¼•ã€‚</p><p>æ¯ä¸€ç§å­˜å‚¨å¼•æ“æ”¯æŒçš„ç´¢å¼•ç±»å‹ä¸ä¸€å®šç›¸åŒï¼Œæˆ‘åœ¨è¡¨ä¸­æ€»ç»“äº† MySQL å¸¸è§çš„å­˜å‚¨å¼•æ“ InnoDBã€MyISAM å’Œ Memory åˆ†åˆ«æ”¯æŒçš„ç´¢å¼•ç±»å‹ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220712154456833-fa0b5d2f.png" alt="image-20220712154456833" tabindex="0" loading="lazy"><figcaption>image-20220712154456833</figcaption></figure><p>InnoDB æ˜¯åœ¨ MySQL 5.5 ä¹‹åæˆä¸ºé»˜è®¤çš„ MySQL å­˜å‚¨å¼•æ“ï¼ŒB+Tree ç´¢å¼•ç±»å‹ä¹Ÿæ˜¯ MySQL å­˜å‚¨å¼•æ“é‡‡ç”¨æœ€å¤šçš„ç´¢å¼•ç±»å‹ã€‚</p><p>åœ¨åˆ›å»ºè¡¨æ—¶ï¼ŒInnoDB å­˜å‚¨å¼•æ“ä¼šæ ¹æ®ä¸åŒçš„åœºæ™¯é€‰æ‹©ä¸åŒçš„åˆ—ä½œä¸ºç´¢å¼•ï¼š</p><ul><li>å¦‚æœæœ‰ä¸»é”®ï¼Œé»˜è®¤ä¼šä½¿ç”¨ä¸»é”®ä½œä¸ºèšç°‡ç´¢å¼•çš„ç´¢å¼•é”®ï¼ˆkeyï¼‰ï¼›</li><li>å¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œå°±é€‰æ‹©ç¬¬ä¸€ä¸ªä¸åŒ…å« NULL å€¼çš„å”¯ä¸€åˆ—ä½œä¸ºèšç°‡ç´¢å¼•çš„ç´¢å¼•é”®ï¼ˆkeyï¼‰ï¼›</li><li>åœ¨ä¸Šé¢ä¸¤ä¸ªéƒ½æ²¡æœ‰çš„æƒ…å†µä¸‹ï¼ŒInnoDB å°†è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšå¼è‡ªå¢ id åˆ—ä½œä¸ºèšç°‡ç´¢å¼•çš„ç´¢å¼•é”®ï¼ˆkeyï¼‰ï¼›</li></ul><p>å…¶å®ƒç´¢å¼•éƒ½å±äºè¾…åŠ©ç´¢å¼•ï¼ˆSecondary Indexï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºäºŒçº§ç´¢å¼•æˆ–éèšç°‡ç´¢å¼•ã€‚<strong>åˆ›å»ºçš„ä¸»é”®ç´¢å¼•å’ŒäºŒçº§ç´¢å¼•é»˜è®¤ä½¿ç”¨çš„æ˜¯ B+Tree ç´¢å¼•</strong>ã€‚</p><p>ä¸¾ä¸ªğŸŒ°ï¼Œæœ‰è¿™æ ·ä¸€ä¸ªè¡¨</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220712154548420-aaba0166.png" alt="image-20220712154548420" tabindex="0" loading="lazy"><figcaption>image-20220712154548420</figcaption></figure><p>è¿™äº›è¡Œæ•°æ®ï¼Œå­˜å‚¨åœ¨ B+Tree ç´¢å¼•æ—¶æ˜¯é•¿ä»€ä¹ˆæ ·å­çš„ï¼Ÿ</p><p>B+Tree æ˜¯ä¸€ç§å¤šå‰æ ‘ï¼Œå¶å­èŠ‚ç‚¹æ‰å­˜æ”¾æ•°æ®ï¼Œéå¶å­èŠ‚ç‚¹åªå­˜æ”¾ç´¢å¼•ï¼Œè€Œä¸”æ¯ä¸ªèŠ‚ç‚¹é‡Œçš„æ•°æ®æ˜¯<strong>æŒ‰ä¸»é”®é¡ºåºå­˜æ”¾</strong>çš„ã€‚æ¯ä¸€å±‚çˆ¶èŠ‚ç‚¹çš„ç´¢å¼•å€¼éƒ½ä¼šå‡ºç°åœ¨ä¸‹å±‚å­èŠ‚ç‚¹çš„ç´¢å¼•å€¼ä¸­ï¼Œå› æ­¤åœ¨å¶å­èŠ‚ç‚¹ä¸­ï¼ŒåŒ…æ‹¬äº†æ‰€æœ‰çš„ç´¢å¼•å€¼ä¿¡æ¯ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹éƒ½æŒ‡å‘ä¸‹ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œå½¢æˆä¸€ä¸ªé“¾è¡¨ã€‚</p><p>ä¸»é”®ç´¢å¼•çš„ B+Tree å¦‚å›¾æ‰€ç¤ºï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220712154624540-4d848b3f.png" alt="image-20220712154624540" tabindex="0" loading="lazy"><figcaption>image-20220712154624540</figcaption></figure><h5 id="é€šè¿‡ä¸»é”®æŸ¥è¯¢å•†å“æ•°æ®çš„è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#é€šè¿‡ä¸»é”®æŸ¥è¯¢å•†å“æ•°æ®çš„è¿‡ç¨‹" aria-hidden="true">#</a> é€šè¿‡ä¸»é”®æŸ¥è¯¢å•†å“æ•°æ®çš„è¿‡ç¨‹</h5><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æ‰§è¡Œäº†ä¸‹é¢è¿™æ¡æŸ¥è¯¢è¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿ç”¨äº†ä¸»é”®ç´¢å¼•æŸ¥è¯¢ id å·ä¸º 5 çš„å•†å“ã€‚æŸ¥è¯¢è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼ŒB+Tree ä¼šè‡ªé¡¶å‘ä¸‹é€å±‚è¿›è¡ŒæŸ¥æ‰¾ï¼š</p><ul><li>å°† 5 ä¸æ ¹èŠ‚ç‚¹çš„ç´¢å¼•æ•°æ® (1ï¼Œ10ï¼Œ20) æ¯”è¾ƒï¼Œ5 åœ¨ 1 å’Œ 10 ä¹‹é—´ï¼Œæ‰€ä»¥æ ¹æ® B+Treeçš„æœç´¢é€»è¾‘ï¼Œæ‰¾åˆ°ç¬¬äºŒå±‚çš„ç´¢å¼•æ•°æ® (1ï¼Œ4ï¼Œ7)ï¼›</li><li>åœ¨ç¬¬äºŒå±‚çš„ç´¢å¼•æ•°æ® (1ï¼Œ4ï¼Œ7)ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œå› ä¸º 5 åœ¨ 4 å’Œ 7 ä¹‹é—´ï¼Œæ‰€ä»¥æ‰¾åˆ°ç¬¬ä¸‰å±‚çš„ç´¢å¼•æ•°æ®ï¼ˆ4ï¼Œ5ï¼Œ6ï¼‰ï¼›</li><li>åœ¨å¶å­èŠ‚ç‚¹çš„ç´¢å¼•æ•°æ®ï¼ˆ4ï¼Œ5ï¼Œ6ï¼‰ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œç„¶åæˆ‘ä»¬æ‰¾åˆ°äº†ç´¢å¼•å€¼ä¸º 5 çš„è¡Œæ•°æ®ã€‚</li></ul><p>æ•°æ®åº“çš„ç´¢å¼•å’Œæ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨ç¡¬ç›˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¯»å–ä¸€ä¸ªèŠ‚ç‚¹å½“ä½œä¸€æ¬¡ç£ç›˜ I/O æ“ä½œã€‚é‚£ä¹ˆä¸Šé¢çš„æ•´ä¸ªæŸ¥è¯¢è¿‡ç¨‹ä¸€å…±ç»å†äº† 3 ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œäº† 3 æ¬¡ I/O æ“ä½œã€‚</p><p>B+Tree å­˜å‚¨åƒä¸‡çº§çš„æ•°æ®åªéœ€è¦ 3-4 å±‚é«˜åº¦å°±å¯ä»¥æ»¡è¶³ï¼Œè¿™æ„å‘³ç€ä»åƒä¸‡çº§çš„è¡¨æŸ¥è¯¢ç›®æ ‡æ•°æ®æœ€å¤šéœ€è¦ 3-4 æ¬¡ç£ç›˜ I/Oï¼Œæ‰€ä»¥<strong>B+Tree ç›¸æ¯”äº B æ ‘å’ŒäºŒå‰æ ‘æ¥è¯´ï¼Œæœ€å¤§çš„ä¼˜åŠ¿åœ¨äºæŸ¥è¯¢æ•ˆç‡å¾ˆé«˜ï¼Œå› ä¸ºå³ä½¿åœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å†µï¼ŒæŸ¥è¯¢ä¸€ä¸ªæ•°æ®çš„ç£ç›˜ I/O ä¾ç„¶ç»´æŒåœ¨ 3-4æ¬¡ã€‚</strong></p><h5 id="é€šè¿‡äºŒçº§ç´¢å¼•æŸ¥è¯¢å•†å“æ•°æ®çš„è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#é€šè¿‡äºŒçº§ç´¢å¼•æŸ¥è¯¢å•†å“æ•°æ®çš„è¿‡ç¨‹" aria-hidden="true">#</a> é€šè¿‡äºŒçº§ç´¢å¼•æŸ¥è¯¢å•†å“æ•°æ®çš„è¿‡ç¨‹</h5><p>ä¸»é”®ç´¢å¼•çš„ B+Tree å’ŒäºŒçº§ç´¢å¼•çš„ B+Tree åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li>ä¸»é”®ç´¢å¼•çš„ B+Tree çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯å®é™…æ•°æ®ï¼Œæ‰€æœ‰å®Œæ•´çš„ç”¨æˆ·è®°å½•éƒ½å­˜æ”¾åœ¨ä¸»é”®ç´¢å¼•çš„ B+Tree çš„å¶å­èŠ‚ç‚¹é‡Œï¼›</li><li>äºŒçº§ç´¢å¼•çš„ B+Tree çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯ä¸»é”®å€¼ï¼Œè€Œä¸æ˜¯å®é™…æ•°æ®ã€‚</li></ul><p>æˆ‘è¿™é‡Œå°†å‰é¢çš„å•†å“è¡¨ä¸­çš„ product_no ï¼ˆå•†å“ç¼–ç ï¼‰å­—æ®µè®¾ç½®ä¸ºäºŒçº§ç´¢å¼•ï¼Œé‚£ä¹ˆäºŒçº§ç´¢å¼•çš„ B+Tree å¦‚ä¸‹å›¾ï¼Œå…¶ä¸­éå¶å­çš„ key å€¼æ˜¯ product_noï¼ˆå›¾ä¸­æ©™è‰²éƒ¨åˆ†ï¼‰ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ•°æ®æ˜¯ä¸»é”®å€¼ï¼ˆå›¾ä¸­ç»¿è‰²éƒ¨åˆ†ï¼‰ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220712154658288-0ab2097c.png" alt="image-20220712154658288" tabindex="0" loading="lazy"><figcaption>image-20220712154658288</figcaption></figure><p>å¦‚æœæˆ‘ç”¨ product_no äºŒçº§ç´¢å¼•æŸ¥è¯¢å•†å“ï¼Œå¦‚ä¸‹æŸ¥è¯¢è¯­å¥ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> product <span class="token keyword">where</span> product_no <span class="token operator">=</span> <span class="token string">&#39;0002&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¼šå…ˆæ£€äºŒçº§ç´¢å¼•ä¸­çš„ B+Tree çš„ç´¢å¼•å€¼ï¼ˆå•†å“ç¼–ç ï¼Œproduct_noï¼‰ï¼Œæ‰¾åˆ°å¯¹åº”çš„å¶å­èŠ‚ç‚¹ï¼Œç„¶åè·å–ä¸»é”®å€¼ï¼Œç„¶åå†é€šè¿‡ä¸»é”®ç´¢å¼•ä¸­çš„ B+Tree æ ‘æŸ¥è¯¢åˆ°å¯¹åº”çš„å¶å­èŠ‚ç‚¹ï¼Œç„¶åè·å–æ•´è¡Œæ•°æ®ã€‚<strong>è¿™ä¸ªè¿‡ç¨‹å«ã€Œå›è¡¨ã€ï¼Œä¹Ÿå°±æ˜¯è¯´è¦æŸ¥ä¸¤ä¸ª B+Tree æ‰èƒ½æŸ¥åˆ°æ•°æ®</strong>ã€‚å¦‚ä¸‹å›¾ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220712154711271-c528a911.png" alt="image-20220712154711271" tabindex="0" loading="lazy"><figcaption>image-20220712154711271</figcaption></figure><p>ä¸è¿‡ï¼Œå½“æŸ¥è¯¢çš„æ•°æ®æ˜¯èƒ½åœ¨äºŒçº§ç´¢å¼•çš„ B+Tree çš„å¶å­èŠ‚ç‚¹é‡ŒæŸ¥è¯¢åˆ°ï¼Œè¿™æ—¶å°±ä¸ç”¨å†æŸ¥ä¸»é”®ç´¢å¼•æŸ¥ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ¡æŸ¥è¯¢è¯­å¥ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> product <span class="token keyword">where</span> product_no <span class="token operator">=</span> <span class="token string">&#39;0002&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>è¿™ç§åœ¨äºŒçº§ç´¢å¼•çš„ B+Tree å°±èƒ½æŸ¥è¯¢åˆ°ç»“æœçš„è¿‡ç¨‹å°±å«ä½œã€Œè¦†ç›–ç´¢å¼•ã€ï¼Œä¹Ÿå°±æ˜¯åªéœ€è¦æŸ¥ä¸€ä¸ª B+Tree å°±èƒ½æ‰¾åˆ°æ•°æ®</strong>ã€‚</p><h4 id="æŒ‰ç‰©ç†å­˜å‚¨åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#æŒ‰ç‰©ç†å­˜å‚¨åˆ†ç±»" aria-hidden="true">#</a> æŒ‰ç‰©ç†å­˜å‚¨åˆ†ç±»</h4><p>ä»ç‰©ç†å­˜å‚¨çš„è§’åº¦æ¥çœ‹ï¼Œç´¢å¼•åˆ†ä¸ºèšç°‡ç´¢å¼•ï¼ˆä¸»é”®ç´¢å¼•ï¼‰ã€äºŒçº§ç´¢å¼•ï¼ˆè¾…åŠ©ç´¢å¼•ï¼‰ã€‚</p><p>è¿™ä¸¤ä¸ªåŒºåˆ«åœ¨å‰é¢ä¹Ÿæåˆ°äº†ï¼š</p><ul><li>ä¸»é”®ç´¢å¼•çš„ B+Tree çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯å®é™…æ•°æ®ï¼Œæ‰€æœ‰å®Œæ•´çš„ç”¨æˆ·è®°å½•éƒ½å­˜æ”¾åœ¨ä¸»é”®ç´¢å¼•çš„ B+Tree çš„å¶å­èŠ‚ç‚¹é‡Œï¼›</li><li>äºŒçº§ç´¢å¼•çš„ B+Tree çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯ä¸»é”®å€¼ï¼Œè€Œä¸æ˜¯å®é™…æ•°æ®ã€‚</li></ul><h4 id="æŒ‰å­—æ®µç‰¹æ€§åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#æŒ‰å­—æ®µç‰¹æ€§åˆ†ç±»" aria-hidden="true">#</a> æŒ‰å­—æ®µç‰¹æ€§åˆ†ç±»</h4><p>ä»å­—æ®µç‰¹æ€§çš„è§’åº¦æ¥çœ‹ï¼Œç´¢å¼•åˆ†ä¸ºä¸»é”®ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€æ™®é€šç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€‚</p><ul><li><strong>ä¸»é”®ç´¢å¼•</strong>å°±æ˜¯å»ºç«‹åœ¨ä¸»é”®å­—æ®µä¸Šçš„ç´¢å¼•ï¼Œé€šå¸¸åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ä¸€èµ·åˆ›å»ºï¼Œä¸€å¼ è¡¨æœ€å¤šåªæœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•ï¼Œç´¢å¼•åˆ—çš„å€¼ä¸å…è®¸æœ‰ç©ºå€¼ã€‚</li><li><strong>å”¯ä¸€ç´¢å¼•</strong>å»ºç«‹åœ¨ UNIQUE å­—æ®µä¸Šçš„ç´¢å¼•ï¼Œä¸€å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼Œç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†æ˜¯å…è®¸æœ‰ç©ºå€¼ã€‚</li><li><strong>æ™®é€šç´¢å¼•</strong>å°±æ˜¯å»ºç«‹åœ¨æ™®é€šå­—æ®µä¸Šçš„ç´¢å¼•ï¼Œæ—¢ä¸è¦æ±‚å­—æ®µä¸ºä¸»é”®ï¼Œä¹Ÿä¸è¦æ±‚å­—æ®µä¸º UNIQUEã€‚</li><li><strong>å‰ç¼€ç´¢å¼•</strong>æ˜¯æŒ‡å¯¹å­—ç¬¦ç±»å‹å­—æ®µçš„å‰å‡ ä¸ªå­—ç¬¦å»ºç«‹çš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯åœ¨æ•´ä¸ªå­—æ®µä¸Šå»ºç«‹çš„ç´¢å¼•ï¼Œå‰ç¼€ç´¢å¼•å¯ä»¥å»ºç«‹åœ¨å­—æ®µç±»å‹ä¸º charã€ varcharã€binaryã€varbinary çš„åˆ—ä¸Šã€‚ <ul><li>ä½¿ç”¨å‰ç¼€ç´¢å¼•çš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘ç´¢å¼•å ç”¨çš„å­˜å‚¨ç©ºé—´ï¼Œæå‡æŸ¥è¯¢æ•ˆç‡ã€‚</li></ul></li></ul><h4 id="æŒ‰å­—æ®µä¸ªæ•°åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#æŒ‰å­—æ®µä¸ªæ•°åˆ†ç±»" aria-hidden="true">#</a> æŒ‰å­—æ®µä¸ªæ•°åˆ†ç±»</h4><p>ä»å­—æ®µä¸ªæ•°çš„è§’åº¦æ¥çœ‹ï¼Œç´¢å¼•åˆ†ä¸ºå•åˆ—ç´¢å¼•ã€è”åˆç´¢å¼•ï¼ˆå¤åˆç´¢å¼•ï¼‰ã€‚</p><ul><li>å»ºç«‹åœ¨å•åˆ—ä¸Šçš„ç´¢å¼•ç§°ä¸ºå•åˆ—ç´¢å¼•ï¼Œæ¯”å¦‚ä¸»é”®ç´¢å¼•ï¼›</li><li>å»ºç«‹åœ¨å¤šåˆ—ä¸Šçš„ç´¢å¼•ç§°ä¸ºè”åˆç´¢å¼•ï¼›</li></ul><h5 id="è”åˆç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#è”åˆç´¢å¼•" aria-hidden="true">#</a> è”åˆç´¢å¼•</h5><p>é€šè¿‡å°†å¤šä¸ªå­—æ®µç»„åˆæˆä¸€ä¸ªç´¢å¼•ï¼Œè¯¥ç´¢å¼•å°±è¢«ç§°ä¸ºè”åˆç´¢å¼•ã€‚æ¯”å¦‚å°†å•†å“è¡¨ä¸­çš„ product_no å’Œ name å­—æ®µç»„åˆæˆè”åˆç´¢å¼• <code>(product_no, name)</code>ï¼Œåˆ›å»ºè”åˆç´¢å¼•çš„æ–¹å¼å¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_product_no_name <span class="token keyword">ON</span> product<span class="token punctuation">(</span>product_no<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è”åˆç´¢å¼• <code>(product_no, name)</code> çš„ B+Tree ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220712155601299-8a8277e8.png" alt="image-20220712155601299" tabindex="0" loading="lazy"><figcaption>image-20220712155601299</figcaption></figure><h3 id="â­ï¸èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#â­ï¸èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" aria-hidden="true">#</a> â­ï¸èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</h3><blockquote><p>ç®€æ´å›ç­”</p></blockquote><ul><li>ä¸€ä¸ªè¡¨ä¸­åªèƒ½æ‹¥æœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ï¼Œè€Œéèšé›†ç´¢å¼•ä¸€ä¸ªè¡¨å¯ä»¥å­˜åœ¨å¤šä¸ªã€‚</li><li>ç´¢å¼•æ˜¯é€šè¿‡äºŒå‰æ ‘çš„æ•°æ®ç»“æ„æ¥æè¿°çš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç†è§£èšç°‡ç´¢å¼•ï¼šç´¢å¼•çš„å¶èŠ‚ç‚¹å°±æ˜¯æ•°æ®èŠ‚ç‚¹ã€‚è€Œéèšç°‡ç´¢å¼•çš„å¶èŠ‚ç‚¹ä»ç„¶æ˜¯ç´¢å¼•èŠ‚ç‚¹ï¼Œåªä¸è¿‡æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å¯¹åº”çš„æ•°æ®å—ã€‚</li><li>èšé›†ç´¢å¼•ï¼šç‰©ç†å­˜å‚¨æŒ‰ç…§ç´¢å¼•æ’åºï¼›éèšé›†ç´¢å¼•ï¼šç‰©ç†å­˜å‚¨ä¸æŒ‰ç…§ç´¢å¼•æ’åº</li></ul><blockquote><p>è¯¦ç»†</p></blockquote><p>å¦å¤–ï¼Œç´¢å¼•åˆå¯ä»¥åˆ†æˆèšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•ï¼ˆäºŒçº§ç´¢å¼•ï¼‰ï¼Œå®ƒä»¬åŒºåˆ«å°±åœ¨äºå¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯ä»€ä¹ˆæ•°æ®ï¼š</p><ul><li>èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯å®é™…æ•°æ®ï¼Œæ‰€æœ‰å®Œæ•´çš„ç”¨æˆ·è®°å½•éƒ½å­˜æ”¾åœ¨èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ï¼›</li><li>äºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯ä¸»é”®å€¼ï¼Œè€Œä¸æ˜¯å®é™…æ•°æ®ã€‚</li></ul><p>å› ä¸ºè¡¨çš„æ•°æ®éƒ½æ˜¯å­˜æ”¾åœ¨èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹é‡Œï¼Œæ‰€ä»¥ InnoDB å­˜å‚¨å¼•æ“ä¸€å®šä¼šä¸ºè¡¨åˆ›å»ºä¸€ä¸ªèšç°‡ç´¢å¼•ï¼Œä¸”ç”±äºæ•°æ®åœ¨ç‰©ç†ä¸Šåªä¼šä¿å­˜ä¸€ä»½ï¼Œæ‰€ä»¥èšç°‡ç´¢å¼•åªèƒ½æœ‰ä¸€ä¸ªã€‚</p><p>InnoDB åœ¨åˆ›å»ºèšç°‡ç´¢å¼•æ—¶ï¼Œä¼šæ ¹æ®ä¸åŒçš„åœºæ™¯é€‰æ‹©ä¸åŒçš„åˆ—ä½œä¸ºç´¢å¼•ï¼š</p><ul><li>å¦‚æœæœ‰ä¸»é”®ï¼Œé»˜è®¤ä¼šä½¿ç”¨ä¸»é”®ä½œä¸ºèšç°‡ç´¢å¼•çš„ç´¢å¼•é”®ï¼›</li><li>å¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œå°±é€‰æ‹©ç¬¬ä¸€ä¸ªä¸åŒ…å« NULL å€¼çš„å”¯ä¸€åˆ—ä½œä¸ºèšç°‡ç´¢å¼•çš„ç´¢å¼•é”®ï¼›</li><li>åœ¨ä¸Šé¢ä¸¤ä¸ªéƒ½æ²¡æœ‰çš„æƒ…å†µä¸‹ï¼ŒInnoDB å°†è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšå¼è‡ªå¢ id åˆ—ä½œä¸ºèšç°‡ç´¢å¼•çš„ç´¢å¼•é”®ï¼›</li></ul><p>ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•ï¼Œé‚£ä¸ºäº†å®ç°éä¸»é”®å­—æ®µçš„å¿«é€Ÿæœç´¢ï¼Œå°±å¼•å‡ºäº†äºŒçº§ç´¢å¼•ï¼ˆéèšç°‡ç´¢å¼•/è¾…åŠ©ç´¢å¼•ï¼‰ï¼Œå®ƒä¹Ÿæ˜¯åˆ©ç”¨äº† B+ æ ‘çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯äºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯ä¸»é”®å€¼ï¼Œä¸æ˜¯å®é™…æ•°æ®ã€‚</p><p>äºŒçº§ç´¢å¼•çš„ B+ æ ‘å¦‚ä¸‹å›¾ï¼Œæ•°æ®éƒ¨åˆ†ä¸ºä¸»é”®å€¼ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220718134133927-b68e0629.png" alt="image-20220718134133927" tabindex="0" loading="lazy"><figcaption>image-20220718134133927</figcaption></figure><p>å› æ­¤ï¼Œ<strong>å¦‚æœæŸä¸ªæŸ¥è¯¢è¯­å¥ä½¿ç”¨äº†äºŒçº§ç´¢å¼•ï¼Œä½†æ˜¯æŸ¥è¯¢çš„æ•°æ®ä¸æ˜¯ä¸»é”®å€¼ï¼Œè¿™æ—¶åœ¨äºŒçº§ç´¢å¼•æ‰¾åˆ°ä¸»é”®å€¼åï¼Œéœ€è¦å»èšç°‡ç´¢å¼•ä¸­è·å¾—æ•°æ®è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«ä½œã€Œå›è¡¨ã€ï¼Œä¹Ÿå°±æ˜¯è¯´è¦æŸ¥ä¸¤ä¸ª B+ æ ‘æ‰èƒ½æŸ¥åˆ°æ•°æ®ã€‚ä¸è¿‡ï¼Œå½“æŸ¥è¯¢çš„æ•°æ®æ˜¯ä¸»é”®å€¼æ—¶ï¼Œå› ä¸ºåªåœ¨äºŒçº§ç´¢å¼•å°±èƒ½æŸ¥è¯¢åˆ°ï¼Œä¸ç”¨å†å»èšç°‡ç´¢å¼•æŸ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«ä½œã€Œç´¢å¼•è¦†ç›–ã€ï¼Œä¹Ÿå°±æ˜¯åªéœ€è¦æŸ¥ä¸€ä¸ª B+ æ ‘å°±èƒ½æ‰¾åˆ°æ•°æ®ã€‚</strong></p><h3 id="æ•°æ®åº“äº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“äº‹åŠ¡" aria-hidden="true">#</a> æ•°æ®åº“äº‹åŠ¡ï¼Ÿ</h3><p>ç®€å•æ¥è¯´ï¼Œæ•°æ®åº“äº‹åŠ¡å¯ä»¥ä¿è¯å¤šä¸ªå¯¹æ•°æ®åº“çš„æ“ä½œï¼ˆä¹Ÿå°±æ˜¯ SQL è¯­å¥ï¼‰æ„æˆä¸€ä¸ªé€»è¾‘ä¸Šçš„æ•´ä½“ã€‚æ„æˆè¿™ä¸ªé€»è¾‘ä¸Šçš„æ•´ä½“çš„è¿™äº›æ•°æ®åº“æ“ä½œéµå¾ªï¼š<strong>è¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸ,è¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ</strong> ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># å¼€å¯ä¸€ä¸ªäº‹åŠ¡</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
<span class="token comment"># å¤šæ¡ SQL è¯­å¥</span>
SQL1<span class="token punctuation">,</span>SQL2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">## æäº¤äº‹åŠ¡</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220613143832546-57c4395f.png" alt="image-20220613143832546" tabindex="0" loading="lazy"><figcaption>image-20220613143832546</figcaption></figure><p>å¦å¤–ï¼Œå…³ç³»å‹æ•°æ®åº“ï¼ˆä¾‹å¦‚ï¼š<code>MySQL</code>ã€<code>SQL Server</code>ã€<code>Oracle</code> ç­‰ï¼‰äº‹åŠ¡éƒ½æœ‰ <strong>ACID</strong> ç‰¹æ€§ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220613143851071-47396e94.png" alt="image-20220613143851071" tabindex="0" loading="lazy"><figcaption>image-20220613143851071</figcaption></figure><ol><li><strong>åŸå­æ€§</strong>ï¼ˆ<code>Atomicity</code>ï¼‰ ï¼š äº‹åŠ¡æ˜¯æœ€å°çš„æ‰§è¡Œå•ä½ï¼Œä¸å…è®¸åˆ†å‰²ã€‚äº‹åŠ¡çš„åŸå­æ€§ç¡®ä¿åŠ¨ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå®Œå…¨ä¸èµ·ä½œç”¨ï¼›</li><li><strong>ä¸€è‡´æ€§</strong>ï¼ˆ<code>Consistency</code>ï¼‰ï¼š æ‰§è¡Œäº‹åŠ¡å‰åï¼Œæ•°æ®ä¿æŒä¸€è‡´ï¼Œä¾‹å¦‚è½¬è´¦ä¸šåŠ¡ä¸­ï¼Œæ— è®ºäº‹åŠ¡æ˜¯å¦æˆåŠŸï¼Œè½¬è´¦è€…å’Œæ”¶æ¬¾äººçš„æ€»é¢åº”è¯¥æ˜¯ä¸å˜çš„ï¼›</li><li><strong>éš”ç¦»æ€§</strong>ï¼ˆ<code>Isolation</code>ï¼‰ï¼š å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸€ä¸ªç”¨æˆ·çš„äº‹åŠ¡ä¸è¢«å…¶ä»–äº‹åŠ¡æ‰€å¹²æ‰°ï¼Œå„å¹¶å‘äº‹åŠ¡ä¹‹é—´æ•°æ®åº“æ˜¯ç‹¬ç«‹çš„ï¼›</li><li><strong>æŒä¹…æ€§</strong>ï¼ˆ<code>Durabilily</code>ï¼‰ï¼š ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ä¹‹åã€‚å®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜æ˜¯æŒä¹…çš„ï¼Œå³ä½¿æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚</li></ol><p>ğŸŒˆ è¿™é‡Œè¦é¢å¤–è¡¥å……ä¸€ç‚¹ï¼š<strong>åªæœ‰ä¿è¯äº†äº‹åŠ¡çš„æŒä¹…æ€§ã€åŸå­æ€§ã€éš”ç¦»æ€§ä¹‹åï¼Œä¸€è‡´æ€§æ‰èƒ½å¾—åˆ°ä¿éšœã€‚ä¹Ÿå°±æ˜¯è¯´ Aã€Iã€D æ˜¯æ‰‹æ®µï¼ŒC æ˜¯ç›®çš„ï¼</strong> æƒ³å¿…å¤§å®¶ä¹Ÿå’Œæˆ‘ä¸€æ ·ï¼Œè¢« ACID è¿™ä¸ªæ¦‚å¿µè¢«è¯¯å¯¼äº†å¾ˆä¹…!</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220613144017540-a6073ed9.png" alt="image-20220613144017540" tabindex="0" loading="lazy"><figcaption>image-20220613144017540</figcaption></figure><p>å¦å¤–ï¼ŒDDIA ä¹Ÿå°±æ˜¯ <a href="https://book.douban.com/subject/30329536/" target="_blank" rel="noopener noreferrer">ã€ŠDesigning Data-Intensive Applicationï¼ˆæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ï¼‰ã€‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>çš„ä½œè€…åœ¨ä»–çš„è¿™æœ¬ä¹¦ä¸­å¦‚æ˜¯è¯´ï¼š</p><blockquote><p>Atomicity, isolation, and durability are properties of the database, whereas consisâ€ tency (in the ACID sense) is a property of the application. The application may rely on the databaseâ€™s atomicity and isolation properties in order to achieve consistency, but itâ€™s not up to the database alone.</p><p>ç¿»è¯‘è¿‡æ¥çš„æ„æ€æ˜¯ï¼šåŸå­æ€§ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§æ˜¯æ•°æ®åº“çš„å±æ€§ï¼Œè€Œä¸€è‡´æ€§ï¼ˆåœ¨ ACID æ„ä¹‰ä¸Šï¼‰æ˜¯åº”ç”¨ç¨‹åºçš„å±æ€§ã€‚åº”ç”¨å¯èƒ½ä¾èµ–æ•°æ®åº“çš„åŸå­æ€§å’Œéš”ç¦»å±æ€§æ¥å®ç°ä¸€è‡´æ€§ï¼Œä½†è¿™å¹¶ä¸ä»…å–å†³äºæ•°æ®åº“ã€‚å› æ­¤ï¼Œå­—æ¯ C ä¸å±äº ACID ã€‚</p></blockquote><h3 id="å¹¶å‘äº‹åŠ¡å¸¦æ¥äº†å“ªäº›é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å¹¶å‘äº‹åŠ¡å¸¦æ¥äº†å“ªäº›é—®é¢˜" aria-hidden="true">#</a> å¹¶å‘äº‹åŠ¡å¸¦æ¥äº†å“ªäº›é—®é¢˜</h3><blockquote><p>éƒ¨åˆ†å›¾é€‰è‡ªã€ŠMySQLæ˜¯æ€æ ·è¿è¡Œçš„ã€‹</p></blockquote><p>åœ¨å…¸å‹çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¤šä¸ªäº‹åŠ¡å¹¶å‘è¿è¡Œï¼Œç»å¸¸ä¼šæ“ä½œç›¸åŒçš„æ•°æ®æ¥å®Œæˆå„è‡ªçš„ä»»åŠ¡ï¼ˆå¤šä¸ªç”¨æˆ·å¯¹åŒä¸€æ•°æ®è¿›è¡Œæ“ä½œï¼‰ã€‚å¹¶å‘è™½ç„¶æ˜¯å¿…é¡»çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´ä»¥ä¸‹çš„é—®é¢˜ã€‚</p><ul><li><strong>è„è¯»ï¼ˆDirty readï¼‰:</strong> å½“ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨è®¿é—®æ•°æ®å¹¶ä¸”å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œè€Œè¿™ç§ä¿®æ”¹è¿˜æ²¡æœ‰æäº¤åˆ°æ•°æ®åº“ä¸­ï¼Œè¿™æ—¶å¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®äº†è¿™ä¸ªæ•°æ®ï¼Œç„¶åä½¿ç”¨äº†è¿™ä¸ªæ•°æ®ã€‚å› ä¸ºè¿™ä¸ªæ•°æ®æ˜¯è¿˜æ²¡æœ‰æäº¤çš„æ•°æ®ï¼Œé‚£ä¹ˆå¦å¤–ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°çš„è¿™ä¸ªæ•°æ®æ˜¯â€œè„æ•°æ®â€ï¼Œä¾æ®â€œè„æ•°æ®â€æ‰€åšçš„æ“ä½œå¯èƒ½æ˜¯ä¸æ­£ç¡®çš„ã€‚ã€ç®€è€Œè¨€ä¹‹ï¼š<strong>å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œé‚£å°±æ„å‘³ç€å‘ç”Ÿäº† è„è¯»</strong> ã€‘</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/v2-404a11c565a99a9382aa3ed1d8e05e9a_r-64009e8b.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706223058381-3d92fe5a.png" alt="image-20220706223058381" tabindex="0" loading="lazy"><figcaption>image-20220706223058381</figcaption></figure><ul><li><strong>ä¸¢å¤±ä¿®æ”¹ï¼ˆLost to modifyï¼‰/ è„å†™:</strong> æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡è¯»å–ä¸€ä¸ªæ•°æ®æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®äº†è¯¥æ•°æ®ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€ä¸ªäº‹åŠ¡ä¸­ä¿®æ”¹äº†è¿™ä¸ªæ•°æ®åï¼Œç¬¬äºŒä¸ªäº‹åŠ¡ä¹Ÿä¿®æ”¹äº†è¿™ä¸ªæ•°æ®ã€‚è¿™æ ·ç¬¬ä¸€ä¸ªäº‹åŠ¡å†…çš„ä¿®æ”¹ç»“æœå°±è¢«ä¸¢å¤±ï¼Œå› æ­¤ç§°ä¸ºä¸¢å¤±ä¿®æ”¹ã€‚ ä¾‹å¦‚ï¼šäº‹åŠ¡ 1 è¯»å–æŸè¡¨ä¸­çš„æ•°æ® A=20ï¼Œäº‹åŠ¡ 2 ä¹Ÿè¯»å– A=20ï¼Œäº‹åŠ¡ 1 ä¿®æ”¹ A=A-1ï¼Œäº‹åŠ¡ 2 ä¹Ÿä¿®æ”¹ A=A-1ï¼Œæœ€ç»ˆç»“æœ A=19ï¼Œäº‹åŠ¡ 1 çš„ä¿®æ”¹è¢«ä¸¢å¤±ã€‚ã€<strong>å¦‚æœä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œé‚£å°±æ„å‘³ç€å‘ç”Ÿäº† è„å†™</strong>ã€‘</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/v2-0b5257fd270ef7e6e619e2eec293ec37_r-c98bda3d.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706223114814-6a11557f.png" alt="image-20220706223114814" tabindex="0" loading="lazy"><figcaption>image-20220706223114814</figcaption></figure><ul><li><strong>ä¸å¯é‡å¤è¯»ï¼ˆUnrepeatable readï¼‰:</strong> æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡è¯»åŒä¸€æ•°æ®ã€‚åœ¨è¿™ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰ç»“æŸæ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®è¯¥æ•°æ®ã€‚é‚£ä¹ˆï¼Œåœ¨ç¬¬ä¸€ä¸ªäº‹åŠ¡ä¸­çš„ä¸¤æ¬¡è¯»æ•°æ®ä¹‹é—´ï¼Œç”±äºç¬¬äºŒä¸ªäº‹åŠ¡çš„ä¿®æ”¹å¯¼è‡´ç¬¬ä¸€ä¸ªäº‹åŠ¡ä¸¤æ¬¡è¯»å–çš„æ•°æ®å¯èƒ½ä¸å¤ªä¸€æ ·ã€‚è¿™å°±å‘ç”Ÿäº†åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„æƒ…å†µï¼Œå› æ­¤ç§°ä¸ºä¸å¯é‡å¤è¯»ã€‚</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/v2-f470fb471caacb70acf65bc2a597b0c5_r-65a83ff3.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706222414240-45d82de9.png" alt="image-20220706222414240" tabindex="0" loading="lazy"><figcaption>image-20220706222414240</figcaption></figure><ul><li><strong>å¹»è¯»ï¼ˆPhantom readï¼‰:</strong> å¹»è¯»ä¸ä¸å¯é‡å¤è¯»ç±»ä¼¼ã€‚å®ƒå‘ç”Ÿåœ¨ä¸€ä¸ªäº‹åŠ¡ï¼ˆT1ï¼‰è¯»å–äº†å‡ è¡Œæ•°æ®ï¼Œæ¥ç€å¦ä¸€ä¸ªå¹¶å‘äº‹åŠ¡ï¼ˆT2ï¼‰æ’å…¥äº†ä¸€äº›æ•°æ®æ—¶ã€‚åœ¨éšåçš„æŸ¥è¯¢ä¸­ï¼Œç¬¬ä¸€ä¸ªäº‹åŠ¡ï¼ˆT1ï¼‰å°±ä¼šå‘ç°å¤šäº†ä¸€äº›åŸæœ¬ä¸å­˜åœ¨çš„è®°å½•ï¼Œå°±å¥½åƒå‘ç”Ÿäº†å¹»è§‰ä¸€æ ·ï¼Œæ‰€ä»¥ç§°ä¸ºå¹»è¯»ã€‚</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/v2-c698e64414f7cb1428e3025e133d9592_r-cabcd233.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706222426455-41664bff.png" alt="image-20220706222426455" tabindex="0" loading="lazy"><figcaption>image-20220706222426455</figcaption></figure><p><strong>ä¸å¯é‡å¤è¯»å’Œå¹»è¯»åŒºåˆ«</strong> ï¼š<code>&lt;u&gt;</code>ä¸å¯é‡å¤è¯»çš„é‡ç‚¹æ˜¯ä¿®æ”¹<code>&lt;/u&gt;</code>æ¯”å¦‚å¤šæ¬¡è¯»å–ä¸€æ¡è®°å½•å‘ç°å…¶ä¸­æŸäº›åˆ—çš„å€¼è¢«ä¿®æ”¹ï¼Œ<code>&lt;u&gt;</code>å¹»è¯»çš„é‡ç‚¹åœ¨äºæ–°å¢æˆ–è€…åˆ é™¤<code>&lt;/u&gt;</code>æ¯”å¦‚å¤šæ¬¡æŸ¥è¯¢åŒä¸€æ¡æŸ¥è¯¢è¯­å¥ï¼ˆDQLï¼‰æ—¶ï¼Œè®°å½•å‘ç°è®°å½•å¢å¤šæˆ–å‡å°‘äº†ã€‚</p><h3 id="â­æœ‰å“ªäº›äº‹åŠ¡éš”ç¦»çº§åˆ«-mysql-çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#â­æœ‰å“ªäº›äº‹åŠ¡éš”ç¦»çº§åˆ«-mysql-çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> â­æœ‰å“ªäº›äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼ŒMySQL çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ?</h3><p>MySQL çš„éš”ç¦»çº§åˆ«åŸºäºé”å’Œ MVCC æœºåˆ¶å…±åŒå®ç°çš„ã€‚</p><ul><li><strong>READ-UNCOMMITTED(è¯»å–æœªæäº¤)</strong> ï¼š æœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œå…è®¸è¯»å–å°šæœªæäº¤çš„æ•°æ®å˜æ›´ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„è¯»ã€å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»ã€‚</li><li><strong>READ-COMMITTED(è¯»å–å·²æäº¤)</strong> ï¼š å…è®¸è¯»å–å¹¶å‘äº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®ï¼Œå¯ä»¥é˜»æ­¢è„è¯»ï¼Œä½†æ˜¯å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»ä»æœ‰å¯èƒ½å‘ç”Ÿã€‚</li><li><strong>REPEATABLE-READ(å¯é‡å¤è¯»)</strong> ï¼š å¯¹åŒä¸€å­—æ®µçš„å¤šæ¬¡è¯»å–ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œé™¤éæ•°æ®æ˜¯è¢«æœ¬èº«äº‹åŠ¡è‡ªå·±æ‰€ä¿®æ”¹ï¼Œå¯ä»¥é˜»æ­¢è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä½†å¹»è¯»ä»æœ‰å¯èƒ½å‘ç”Ÿã€‚</li><li><strong>SERIALIZABLE(å¯ä¸²è¡ŒåŒ–)</strong> ï¼š æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®Œå…¨æœä» ACID çš„éš”ç¦»çº§åˆ«ã€‚æ‰€æœ‰çš„äº‹åŠ¡ä¾æ¬¡é€ä¸ªæ‰§è¡Œï¼Œè¿™æ ·äº‹åŠ¡ä¹‹é—´å°±å®Œå…¨ä¸å¯èƒ½äº§ç”Ÿå¹²æ‰°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥çº§åˆ«å¯ä»¥é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ä»¥åŠå¹»è¯»ã€‚</li></ul><hr><table><thead><tr><th style="text-align:center;">éš”ç¦»çº§åˆ«</th><th style="text-align:center;">è„è¯»</th><th style="text-align:center;">ä¸å¯é‡å¤è¯»</th><th style="text-align:center;">å¹»è¯»</th></tr></thead><tbody><tr><td style="text-align:center;">READ-UNCOMMITTED</td><td style="text-align:center;">âˆš</td><td style="text-align:center;">âˆš</td><td style="text-align:center;">âˆš</td></tr><tr><td style="text-align:center;">READ-COMMITTED</td><td style="text-align:center;">Ã—</td><td style="text-align:center;">âˆš</td><td style="text-align:center;">âˆš</td></tr><tr><td style="text-align:center;">REPEATABLE-READ</td><td style="text-align:center;">Ã—</td><td style="text-align:center;">Ã—</td><td style="text-align:center;">âˆš</td></tr><tr><td style="text-align:center;">SERIALIZABLE</td><td style="text-align:center;">Ã—</td><td style="text-align:center;">Ã—</td><td style="text-align:center;">Ã—</td></tr></tbody></table><h3 id="è¡¨çº§é”å’Œè¡Œçº§é”äº†è§£å—-æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#è¡¨çº§é”å’Œè¡Œçº§é”äº†è§£å—-æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> è¡¨çº§é”å’Œè¡Œçº§é”äº†è§£å—ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>MyISAM ä»…ä»…æ”¯æŒè¡¨çº§é”(table-level locking)ï¼Œä¸€é”å°±é”æ•´å¼ è¡¨ï¼Œè¿™åœ¨å¹¶å‘å†™çš„æƒ…å†µä¸‹æ€§éå¸¸å·®ã€‚</p><p>InnoDB ä¸å…‰æ”¯æŒè¡¨çº§é”(table-level locking)ï¼Œè¿˜æ”¯æŒè¡Œçº§é”(row-level locking)ï¼Œé»˜è®¤ä¸ºè¡Œçº§é”ã€‚è¡Œçº§é”çš„ç²’åº¦æ›´å°ï¼Œä»…å¯¹ç›¸å…³çš„è®°å½•ä¸Šé”å³å¯ï¼ˆå¯¹ä¸€è¡Œæˆ–è€…å¤šè¡Œè®°å½•åŠ é”ï¼‰ï¼Œæ‰€ä»¥å¯¹äºå¹¶å‘å†™å…¥æ“ä½œæ¥è¯´ï¼Œ InnoDB çš„æ€§èƒ½æ›´é«˜ã€‚</p><p><strong>è¡¨çº§é”å’Œè¡Œçº§é”å¯¹æ¯”</strong> ï¼š</p><ul><li><strong>è¡¨çº§é”ï¼š</strong> MySQL ä¸­é”å®šç²’åº¦æœ€å¤§çš„ä¸€ç§é”ï¼Œæ˜¯é’ˆ<strong>å¯¹éç´¢å¼•å­—æ®µåŠ çš„é”</strong>ï¼Œå¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—ä¹Ÿæ¯”è¾ƒå°‘ï¼ŒåŠ é”å¿«ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚å…¶é”å®šç²’åº¦æœ€å¤§ï¼Œè§¦å‘é”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ï¼ŒMyISAM å’Œ InnoDB å¼•æ“éƒ½æ”¯æŒè¡¨çº§é”ã€‚</li><li><strong>è¡Œçº§é”ï¼š</strong> MySQL ä¸­é”å®šç²’åº¦æœ€å°çš„ä¸€ç§é”ï¼Œæ˜¯é’ˆ<strong>å¯¹ç´¢å¼•å­—æ®µåŠ çš„é”</strong>ï¼Œåªé’ˆå¯¹å½“å‰æ“ä½œçš„è®°å½•è¿›è¡ŒåŠ é”ã€‚ è¡Œçº§é”èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚å…¶åŠ é”ç²’åº¦æœ€å°ï¼Œå¹¶å‘åº¦é«˜ï¼Œä½†åŠ é”çš„å¼€é”€ä¹Ÿæœ€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”ã€‚</li></ul><h3 id="å…±äº«é”å’Œæ’ä»–é”" tabindex="-1"><a class="header-anchor" href="#å…±äº«é”å’Œæ’ä»–é”" aria-hidden="true">#</a> å…±äº«é”å’Œæ’ä»–é”</h3><p>ä¸è®ºæ˜¯è¡¨çº§é”è¿˜æ˜¯è¡Œçº§é”ï¼Œéƒ½å­˜åœ¨å…±äº«é”ï¼ˆShare Lockï¼ŒS é”ï¼‰å’Œæ’ä»–é”ï¼ˆExclusive Lockï¼ŒX é”ï¼‰è¿™ä¸¤ç±»ï¼š</p><ul><li><strong>å…±äº«é”ï¼ˆS é”ï¼‰</strong> ï¼šåˆç§°è¯»é”ï¼Œäº‹åŠ¡åœ¨è¯»å–è®°å½•çš„æ—¶å€™è·å–å…±äº«é”ï¼Œå…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è·å–ï¼ˆé”å…¼å®¹ï¼‰ã€‚</li><li><strong>æ’ä»–é”ï¼ˆX é”ï¼‰</strong> ï¼šåˆç§°å†™é”/ç‹¬å é”ï¼Œäº‹åŠ¡åœ¨ä¿®æ”¹è®°å½•çš„æ—¶å€™è·å–æ’ä»–é”ï¼Œä¸å…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è·å–ã€‚å¦‚æœä¸€ä¸ªè®°å½•å·²ç»è¢«åŠ äº†æ’ä»–é”ï¼Œé‚£å…¶ä»–äº‹åŠ¡ä¸èƒ½å†å¯¹è¿™æ¡äº‹åŠ¡åŠ ä»»ä½•ç±»å‹çš„é”ï¼ˆé”ä¸å…¼å®¹ï¼‰ã€‚</li></ul><p>æ’ä»–é”ä¸ä»»ä½•çš„é”éƒ½ä¸å…¼å®¹ï¼Œå…±äº«é”ä»…å’Œå…±äº«é”å…¼å®¹ã€‚</p><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;">S é”</th><th style="text-align:left;">X é”</th></tr></thead><tbody><tr><td style="text-align:left;">S é”</td><td style="text-align:left;">ä¸å†²çª</td><td style="text-align:left;">å†²çª</td></tr><tr><td style="text-align:left;">X é”</td><td style="text-align:left;">å†²çª</td><td style="text-align:left;">å†²çª</td></tr></tbody></table><p>ç”±äº MVCC çš„å­˜åœ¨ï¼Œå¯¹äºä¸€èˆ¬çš„ <code>SELECT</code> è¯­å¥ï¼ŒInnoDB ä¸ä¼šåŠ ä»»ä½•é”ã€‚ä¸è¿‡ï¼Œ ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹è¯­å¥æ˜¾å¼åŠ å…±äº«é”æˆ–æ’ä»–é”ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># å…±äº«é”</span>
<span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">LOCK</span> <span class="token operator">IN</span> <span class="token keyword">SHARE</span> <span class="token keyword">MODE</span><span class="token punctuation">;</span>
<span class="token comment"># æ’ä»–é”</span>
<span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FOR</span> <span class="token keyword">UPDATE</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ•°æ®åº“ç´¢å¼•å¤±æ•ˆæœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“ç´¢å¼•å¤±æ•ˆæœ‰å“ªäº›" aria-hidden="true">#</a> æ•°æ®åº“ç´¢å¼•å¤±æ•ˆæœ‰å“ªäº›</h3><p>è¯¦ç»†æŸ¥çœ‹æ–‡ç« ï¼š<a href="https://xiaolincoding.com/mysql/index/index_lose.html" target="_blank" rel="noopener noreferrer">https://xiaolincoding.com/mysql/index/index_lose.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li>å½“æˆ‘ä»¬ä½¿ç”¨å·¦æˆ–è€…å·¦å³æ¨¡ç³ŠåŒ¹é…çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ <code>like %xx</code> æˆ–è€… <code>like %xx%</code>è¿™ä¸¤ç§æ–¹å¼éƒ½ä¼šé€ æˆç´¢å¼•å¤±æ•ˆï¼›</li><li>å½“æˆ‘ä»¬åœ¨æŸ¥è¯¢æ¡ä»¶ä¸­å¯¹ç´¢å¼•åˆ—ä½¿ç”¨å‡½æ•°ï¼Œå°±ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆã€‚</li><li>å½“æˆ‘ä»¬åœ¨æŸ¥è¯¢æ¡ä»¶ä¸­å¯¹ç´¢å¼•åˆ—è¿›è¡Œè¡¨è¾¾å¼è®¡ç®—ï¼Œä¹Ÿæ˜¯æ— æ³•èµ°ç´¢å¼•çš„ã€‚</li><li>MySQL åœ¨é‡åˆ°å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æŠŠå­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—ï¼Œç„¶åå†è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå­—ç¬¦ä¸²æ˜¯ç´¢å¼•åˆ—ï¼Œè€Œæ¡ä»¶è¯­å¥ä¸­çš„è¾“å…¥å‚æ•°æ˜¯æ•°å­—çš„è¯ï¼Œé‚£ä¹ˆç´¢å¼•åˆ—ä¼šå‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ï¼Œç”±äºéšå¼ç±»å‹è½¬æ¢æ˜¯é€šè¿‡ CAST å‡½æ•°å®ç°çš„ï¼Œç­‰åŒäºå¯¹ç´¢å¼•åˆ—ä½¿ç”¨äº†å‡½æ•°ï¼Œæ‰€ä»¥å°±ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆã€‚</li><li>è”åˆç´¢å¼•è¦èƒ½æ­£ç¡®ä½¿ç”¨éœ€è¦éµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§æœ€å·¦ä¼˜å…ˆçš„æ–¹å¼è¿›è¡Œç´¢å¼•çš„åŒ¹é…ï¼Œå¦åˆ™å°±ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆã€‚</li><li>åœ¨ WHERE å­å¥ä¸­ï¼Œå¦‚æœåœ¨ OR å‰çš„æ¡ä»¶åˆ—æ˜¯ç´¢å¼•åˆ—ï¼Œè€Œåœ¨ OR åçš„æ¡ä»¶åˆ—ä¸æ˜¯ç´¢å¼•åˆ—ï¼Œé‚£ä¹ˆç´¢å¼•ä¼šå¤±æ•ˆã€‚</li></ul><h3 id="æ•°æ®åº“sqlä¼˜åŒ–æœ‰å“ªäº›æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“sqlä¼˜åŒ–æœ‰å“ªäº›æ–¹æ³•" aria-hidden="true">#</a> æ•°æ®åº“sqlä¼˜åŒ–æœ‰å“ªäº›æ–¹æ³•</h3><blockquote><p>è§„èŒƒ</p></blockquote><p><a href="https://javaguide.cn/database/mysql/mysql-high-performance-optimization-specification-recommendations.html#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E8%A7%84%E8%8C%83" target="_blank" rel="noopener noreferrer">MySQLé«˜æ€§èƒ½ä¼˜åŒ–è§„èŒƒå»ºè®®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ol><li>å°½é‡é¿å…ä½¿ç”¨å­æŸ¥è¯¢</li><li>ç”¨INæ¥æ›¿æ¢OR</li><li>è¯»å–é€‚å½“çš„è®°å½•LIMIT M,Nï¼Œè€Œä¸è¦è¯»å¤šä½™çš„è®°å½•</li><li>ç¦æ­¢ä¸å¿…è¦çš„Order Byæ’åº</li><li>æ€»å’ŒæŸ¥è¯¢å¯ä»¥ç¦æ­¢æ’é‡ç”¨union all</li><li>é¿å…éšæœºå–è®°å½•</li><li>å°†å¤šæ¬¡æ’å…¥æ¢æˆæ‰¹é‡Insertæ’å…¥</li><li>åªè¿”å›å¿…è¦çš„åˆ—ï¼Œç”¨å…·ä½“çš„å­—æ®µåˆ—è¡¨ä»£æ›¿ select * è¯­å¥</li><li>åŒºåˆ†inå’Œexists</li><li>ä¼˜åŒ–Group Byè¯­å¥</li><li>å°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µ</li><li>ä¼˜åŒ–Joinè¯­å¥</li></ol><blockquote><p>æ­¥éª¤</p></blockquote><p><a href="https://www.pdai.tech/md/db/sql-lan/sql-lan-optimize.html#sql%E8%AF%AD%E8%A8%80---sql%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96" target="_blank" rel="noopener noreferrer">SQLè¯­å¥ä¼˜åŒ–<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="innodb-æœ‰å“ªå‡ ç±»è¡Œé”" tabindex="-1"><a class="header-anchor" href="#innodb-æœ‰å“ªå‡ ç±»è¡Œé”" aria-hidden="true">#</a> InnoDB æœ‰å“ªå‡ ç±»è¡Œé”</h3><p>MySQL InnoDB æ”¯æŒä¸‰ç§è¡Œé”å®šæ–¹å¼ï¼š</p><ul><li><strong>è®°å½•é”ï¼ˆRecord Lockï¼‰</strong> ï¼šä¹Ÿè¢«ç§°ä¸ºè®°å½•é”ï¼Œå±äºå•ä¸ªè¡Œè®°å½•ä¸Šçš„é”ã€‚</li><li><strong>é—´éš™é”ï¼ˆGap Lockï¼‰</strong> ï¼šé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä¸åŒ…æ‹¬è®°å½•æœ¬èº«ã€‚</li><li><strong>ä¸´é”®é”ï¼ˆNext-key Lockï¼‰</strong> ï¼šRecord Lock+Gap Lockï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼ŒåŒ…å«è®°å½•æœ¬èº«ã€‚è®°å½•é”åªèƒ½é”ä½å·²ç»å­˜åœ¨çš„è®°å½•ï¼Œä¸ºäº†é¿å…æ’å…¥æ–°è®°å½•ï¼Œéœ€è¦ä¾èµ–é—´éš™é”ã€‚</li></ul><p>InnoDB çš„é»˜è®¤éš”ç¦»çº§åˆ« REPEATABLE-READï¼ˆå¯é‡è¯»ï¼‰æ˜¯å¯ä»¥è§£å†³å¹»è¯»é—®é¢˜å‘ç”Ÿçš„ï¼Œä¸»è¦æœ‰ä¸‹é¢ä¸¤ç§æƒ…å†µï¼š</p><ul><li><strong>å¿«ç…§è¯»</strong> ï¼šç”± MVCC æœºåˆ¶æ¥ä¿è¯ä¸å‡ºç°å¹»è¯»ã€‚</li><li><strong>å½“å‰è¯»</strong> ï¼š ä½¿ç”¨ Next-Key Lock è¿›è¡ŒåŠ é”æ¥ä¿è¯ä¸å‡ºç°å¹»è¯»ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆmysql-æ²¡æœ‰ä½¿ç”¨hashè¡¨ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„å‘¢" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆmysql-æ²¡æœ‰ä½¿ç”¨hashè¡¨ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„å‘¢" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆMySQL æ²¡æœ‰ä½¿ç”¨Hashè¡¨ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„å‘¢ï¼Ÿ</h3><p><strong>1.Hash å†²çªé—®é¢˜</strong> ï¼šJDK1.8 ä¹‹å‰ <code>HashMap</code> å°±æ˜¯é€šè¿‡é“¾åœ°å€æ³•æ¥è§£å†³å“ˆå¸Œå†²çªçš„ã€‚ä¸è¿‡ï¼ŒJDK1.8 ä»¥å <code>HashMap</code>ä¸ºäº†å‡å°‘é“¾è¡¨è¿‡é•¿çš„æ—¶å€™æœç´¢æ—¶é—´è¿‡é•¿å¼•å…¥äº†çº¢é»‘æ ‘ï¼Œä¸è¿‡å¯¹äºæ•°æ®åº“æ¥è¯´è¿™è¿˜ä¸ç®—æœ€å¤§çš„ç¼ºç‚¹ã€‚</p><p><strong>2.Hash ç´¢å¼•ä¸æ”¯æŒé¡ºåºå’ŒèŒƒå›´æŸ¥è¯¢(Hash ç´¢å¼•ä¸æ”¯æŒé¡ºåºå’ŒèŒƒå›´æŸ¥è¯¢æ˜¯å®ƒæœ€å¤§çš„ç¼ºç‚¹ï¼š</strong> å‡å¦‚æˆ‘ä»¬è¦å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œæ’åºæˆ–è€…è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼Œé‚£ Hash ç´¢å¼•å¯å°±ä¸è¡Œäº†ã€‚</p><p>è¯•æƒ³ä¸€ç§æƒ…å†µ:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> tb1 <span class="token constant">WHERE</span> id <span class="token operator">&lt;</span> <span class="token number">500</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨è¿™ç§èŒƒå›´æŸ¥è¯¢ä¸­ï¼Œä¼˜åŠ¿éå¸¸å¤§ï¼Œç›´æ¥éå†æ¯” 500 å°çš„å¶å­èŠ‚ç‚¹å°±å¤Ÿäº†ã€‚è€Œ Hash ç´¢å¼•æ˜¯æ ¹æ® hash ç®—æ³•æ¥å®šä½çš„ï¼Œéš¾ä¸æˆè¿˜è¦æŠŠ 1 - 499 çš„æ•°æ®ï¼Œæ¯ä¸ªéƒ½è¿›è¡Œä¸€æ¬¡ hash è®¡ç®—æ¥å®šä½å—?è¿™å°±æ˜¯ Hash æœ€å¤§çš„ç¼ºç‚¹äº†ã€‚</p><h3 id="â­ï¸ä¸ºä»€ä¹ˆmysqlåº•å±‚è¦ç”¨b-æ ‘-å’Œbæ ‘æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#â­ï¸ä¸ºä»€ä¹ˆmysqlåº•å±‚è¦ç”¨b-æ ‘-å’Œbæ ‘æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> â­ï¸ä¸ºä»€ä¹ˆMySQLåº•å±‚è¦ç”¨B+æ ‘ï¼Ÿå’ŒBæ ‘æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>å›¾è§£B+æ ‘ï¼š<a href="https://zhuanlan.zhihu.com/p/54102723" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/54102723<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>B æ ‘ä¹Ÿç§° B-æ ‘,å…¨ç§°ä¸º <strong>å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘</strong> ï¼ŒB+ æ ‘æ˜¯ B æ ‘çš„ä¸€ç§å˜ä½“ã€‚B æ ‘å’Œ B+æ ‘ä¸­çš„ B æ˜¯ <code>Balanced</code> ï¼ˆå¹³è¡¡ï¼‰çš„æ„æ€ã€‚</p><p>ç›®å‰å¤§éƒ¨åˆ†æ•°æ®åº“ç³»ç»ŸåŠæ–‡ä»¶ç³»ç»Ÿéƒ½é‡‡ç”¨ B-Tree æˆ–å…¶å˜ç§ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ã€‚</p><p><strong>B æ ‘&amp; B+æ ‘ä¸¤è€…æœ‰ä½•å¼‚åŒå‘¢ï¼Ÿ</strong></p><ul><li>B æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹æ—¢å­˜æ”¾é”®(key) ä¹Ÿå­˜æ”¾ æ•°æ®(data)ï¼Œè€Œ B+æ ‘åªæœ‰å¶å­èŠ‚ç‚¹å­˜æ”¾ key å’Œ dataï¼Œå…¶ä»–å†…èŠ‚ç‚¹åªå­˜æ”¾ keyã€‚</li><li>B æ ‘çš„å¶å­èŠ‚ç‚¹éƒ½æ˜¯ç‹¬ç«‹çš„;B+æ ‘çš„å¶å­èŠ‚ç‚¹æœ‰ä¸€æ¡å¼•ç”¨é“¾æŒ‡å‘ä¸å®ƒç›¸é‚»çš„å¶å­èŠ‚ç‚¹ã€‚</li><li>B æ ‘çš„æ£€ç´¢çš„è¿‡ç¨‹ç›¸å½“äºå¯¹èŒƒå›´å†…çš„æ¯ä¸ªèŠ‚ç‚¹çš„å…³é”®å­—åšäºŒåˆ†æŸ¥æ‰¾ï¼Œå¯èƒ½è¿˜æ²¡æœ‰åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œæ£€ç´¢å°±ç»“æŸäº†ã€‚è€Œ B+æ ‘çš„æ£€ç´¢æ•ˆç‡å°±å¾ˆç¨³å®šäº†ï¼Œä»»ä½•æŸ¥æ‰¾éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œå¶å­èŠ‚ç‚¹çš„é¡ºåºæ£€ç´¢å¾ˆæ˜æ˜¾ã€‚</li></ul><p>åœ¨ MySQL ä¸­ï¼ŒMyISAM å¼•æ“å’Œ InnoDB å¼•æ“éƒ½æ˜¯ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œä½†æ˜¯ï¼Œä¸¤è€…çš„å®ç°æ–¹å¼ä¸å¤ªä¸€æ ·ã€‚</p><p>MyISAM å¼•æ“ä¸­ï¼ŒB+Tree å¶èŠ‚ç‚¹çš„ data åŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€ã€‚åœ¨ç´¢å¼•æ£€ç´¢çš„æ—¶å€™ï¼Œé¦–å…ˆæŒ‰ç…§ B+Tree æœç´¢ç®—æ³•æœç´¢ç´¢å¼•ï¼Œå¦‚æœæŒ‡å®šçš„ Key å­˜åœ¨ï¼Œåˆ™å–å‡ºå…¶ data åŸŸçš„å€¼ï¼Œç„¶å<strong>ä»¥ data åŸŸçš„å€¼ä¸ºåœ°å€è¯»å–ç›¸åº”çš„æ•°æ®è®°å½•</strong>ã€‚è¿™è¢«ç§°ä¸ºâ€œ<strong>éèšç°‡ç´¢å¼•</strong>â€ã€‚</p><p>InnoDB å¼•æ“ä¸­ï¼Œå…¶æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ç´¢å¼•æ–‡ä»¶ã€‚ç›¸æ¯” MyISAMï¼Œç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ï¼Œå…¶è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰ B+Tree ç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„ï¼Œ<strong>æ ‘çš„å¶èŠ‚ç‚¹ data åŸŸä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•</strong>ã€‚è¿™ä¸ªç´¢å¼•çš„ key æ˜¯æ•°æ®è¡¨çš„ä¸»é”®ï¼Œå› æ­¤ InnoDB è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ä¸»ç´¢å¼•ã€‚è¿™è¢«ç§°ä¸º**â€œèšç°‡ç´¢å¼•ï¼ˆæˆ–èšé›†ç´¢å¼•ï¼‰**â€ï¼Œè€Œå…¶ä½™çš„ç´¢å¼•éƒ½ä½œä¸ºè¾…åŠ©ç´¢å¼•ï¼Œè¾…åŠ©ç´¢å¼•çš„ data åŸŸå­˜å‚¨ç›¸åº”è®°å½•ä¸»é”®çš„å€¼è€Œä¸æ˜¯åœ°å€ï¼Œè¿™ä¹Ÿæ˜¯å’Œ MyISAM ä¸åŒçš„åœ°æ–¹ã€‚åœ¨æ ¹æ®ä¸»ç´¢å¼•æœç´¢æ—¶ï¼Œç›´æ¥æ‰¾åˆ° key æ‰€åœ¨çš„èŠ‚ç‚¹å³å¯å–å‡ºæ•°æ®ï¼›åœ¨æ ¹æ®è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾æ—¶ï¼Œåˆ™éœ€è¦å…ˆå–å‡ºä¸»é”®çš„å€¼ï¼Œå†èµ°ä¸€éä¸»ç´¢å¼•ã€‚ å› æ­¤ï¼Œåœ¨è®¾è®¡è¡¨çš„æ—¶å€™ï¼Œä¸å»ºè®®ä½¿ç”¨è¿‡é•¿çš„å­—æ®µä½œä¸ºä¸»é”®ï¼Œä¹Ÿä¸å»ºè®®ä½¿ç”¨éå•è°ƒçš„å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™æ ·ä¼šé€ æˆä¸»ç´¢å¼•é¢‘ç¹åˆ†è£‚ã€‚</p><h3 id="è¯¦è§£b-æ ‘" tabindex="-1"><a class="header-anchor" href="#è¯¦è§£b-æ ‘" aria-hidden="true">#</a> è¯¦è§£B+æ ‘</h3><h4 id="ä»€ä¹ˆæ˜¯-b-æ ‘" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-b-æ ‘" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯ B+ æ ‘ï¼Ÿ</h4><p>B+ æ ‘å°±æ˜¯å¯¹ B æ ‘åšäº†ä¸€ä¸ªå‡çº§ï¼ŒMySQL ä¸­ç´¢å¼•çš„æ•°æ®ç»“æ„å°±æ˜¯é‡‡ç”¨äº† B+ æ ‘ï¼ŒB+ æ ‘ç»“æ„å¦‚ä¸‹å›¾ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220718133551150-47255c85.png" alt="image-20220718133551150" tabindex="0" loading="lazy"><figcaption>image-20220718133551150</figcaption></figure><p>B+ æ ‘ä¸ B æ ‘å·®å¼‚çš„ç‚¹ï¼Œä¸»è¦æ˜¯ä»¥ä¸‹è¿™å‡ ç‚¹ï¼š</p><ul><li>å¶å­èŠ‚ç‚¹ï¼ˆæœ€åº•éƒ¨çš„èŠ‚ç‚¹ï¼‰æ‰ä¼šå­˜æ”¾å®é™…æ•°æ®ï¼ˆç´¢å¼•+è®°å½•ï¼‰ï¼Œéå¶å­èŠ‚ç‚¹åªä¼šå­˜æ”¾ç´¢å¼•ï¼›</li><li>æ‰€æœ‰ç´¢å¼•éƒ½ä¼šåœ¨å¶å­èŠ‚ç‚¹å‡ºç°ï¼Œå¶å­èŠ‚ç‚¹ä¹‹é—´æ„æˆä¸€ä¸ªæœ‰åºé“¾è¡¨ï¼›</li><li>éå¶å­èŠ‚ç‚¹çš„ç´¢å¼•ä¹Ÿä¼šåŒæ—¶å­˜åœ¨åœ¨å­èŠ‚ç‚¹ä¸­ï¼Œå¹¶ä¸”æ˜¯åœ¨å­èŠ‚ç‚¹ä¸­æ‰€æœ‰ç´¢å¼•çš„æœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰ã€‚</li><li>éå¶å­èŠ‚ç‚¹ä¸­æœ‰å¤šå°‘ä¸ªå­èŠ‚ç‚¹ï¼Œå°±æœ‰å¤šå°‘ä¸ªç´¢å¼•ï¼›</li></ul><p>ä¸‹é¢é€šè¿‡ä¸‰ä¸ªæ–¹é¢ï¼Œæ¯”è¾ƒä¸‹ B+ å’Œ B æ ‘çš„æ€§èƒ½åŒºåˆ«ã€‚</p><h4 id="b-æ ‘æ˜¯å¦‚ä½•è¿›è¡ŒæŸ¥è¯¢çš„" tabindex="-1"><a class="header-anchor" href="#b-æ ‘æ˜¯å¦‚ä½•è¿›è¡ŒæŸ¥è¯¢çš„" aria-hidden="true">#</a> B+ æ ‘æ˜¯å¦‚ä½•è¿›è¡ŒæŸ¥è¯¢çš„ï¼Ÿ</h4><p>ä¸€ä¸ªæ•°æ®é¡µä¸­çš„è®°å½•æ£€ç´¢ï¼Œå› ä¸ºä¸€ä¸ªæ•°æ®é¡µä¸­çš„è®°å½•æ˜¯æœ‰é™çš„ï¼Œä¸”ä¸»é”®å€¼æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥é€šè¿‡å¯¹æ‰€æœ‰è®°å½•è¿›è¡Œåˆ†ç»„ï¼Œç„¶åå°†ç»„å·ï¼ˆæ§½å·ï¼‰å­˜å‚¨åˆ°é¡µç›®å½•ï¼Œä½¿å…¶èµ·åˆ°ç´¢å¼•ä½œç”¨ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾çš„æ–¹æ³•å¿«é€Ÿæ£€ç´¢åˆ°è®°å½•åœ¨å“ªä¸ªåˆ†ç»„ï¼Œæ¥é™ä½æ£€ç´¢çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦å­˜å‚¨å¤§é‡çš„è®°å½•æ—¶ï¼Œå°±éœ€è¦å¤šä¸ªæ•°æ®é¡µï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦è€ƒè™‘å¦‚ä½•å»ºç«‹åˆé€‚çš„ç´¢å¼•ï¼Œæ‰èƒ½æ–¹ä¾¿å®šä½è®°å½•æ‰€åœ¨çš„é¡µã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<strong>InnoDB é‡‡ç”¨äº† B+ æ ‘ä½œä¸ºç´¢å¼•</strong>ã€‚ç£ç›˜çš„ I/O æ“ä½œæ¬¡æ•°å¯¹ç´¢å¼•çš„ä½¿ç”¨æ•ˆç‡è‡³å…³é‡è¦ï¼Œå› æ­¤åœ¨æ„é€ ç´¢å¼•çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºé‡‡ç”¨â€œçŸ®èƒ–â€çš„ B+ æ ‘æ•°æ®ç»“æ„ï¼Œè¿™æ ·æ‰€éœ€è¦è¿›è¡Œçš„ç£ç›˜ I/O æ¬¡æ•°æ›´å°‘ï¼Œè€Œä¸” B+ æ ‘ æ›´é€‚åˆè¿›è¡Œå…³é”®å­—çš„èŒƒå›´æŸ¥è¯¢ã€‚</p><p>InnoDB é‡Œçš„ B+ æ ‘ä¸­çš„<strong>æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªæ•°æ®é¡µ</strong>ï¼Œç»“æ„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220718133843334-4bcfe1b7.png" alt="image-20220718134312198" tabindex="0" loading="lazy"><figcaption>image-20220718134312198</figcaption></figure><p>é€šè¿‡ä¸Šå›¾ï¼Œæˆ‘ä»¬çœ‹å‡º B+ æ ‘çš„ç‰¹ç‚¹ï¼š</p><ul><li>åªæœ‰å¶å­èŠ‚ç‚¹ï¼ˆæœ€åº•å±‚çš„èŠ‚ç‚¹ï¼‰æ‰å­˜æ”¾äº†æ•°æ®ï¼Œéå¶å­èŠ‚ç‚¹ï¼ˆå…¶ä»–ä¸Šå±‚èŠ‚ï¼‰ä»…ç”¨æ¥å­˜æ”¾ç›®å½•é¡¹ä½œä¸ºç´¢å¼•ã€‚</li><li>éå¶å­èŠ‚ç‚¹åˆ†ä¸ºä¸åŒå±‚æ¬¡ï¼Œé€šè¿‡åˆ†å±‚æ¥é™ä½æ¯ä¸€å±‚çš„æœç´¢é‡ï¼›</li><li>æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§ç´¢å¼•é”®å¤§å°æ’åºï¼Œæ„æˆä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œä¾¿äºèŒƒå›´æŸ¥è¯¢ï¼›</li></ul><p>æˆ‘ä»¬å†çœ‹çœ‹ B+ æ ‘å¦‚ä½•å®ç°å¿«é€ŸæŸ¥æ‰¾ä¸»é”®ä¸º 6 çš„è®°å½•ï¼Œä»¥ä¸Šå›¾ä¸ºä¾‹å­ï¼š</p><ul><li>ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€šè¿‡äºŒåˆ†æ³•å¿«é€Ÿå®šä½åˆ°ç¬¦åˆé¡µå†…èŒƒå›´åŒ…å«æŸ¥è¯¢å€¼çš„é¡µï¼Œå› ä¸ºæŸ¥è¯¢çš„ä¸»é”®å€¼ä¸º 6ï¼Œåœ¨[1, 7)èŒƒå›´ä¹‹é—´ï¼Œæ‰€ä»¥åˆ°é¡µ 30 ä¸­æŸ¥æ‰¾æ›´è¯¦ç»†çš„ç›®å½•é¡¹ï¼›</li><li>åœ¨éå¶å­èŠ‚ç‚¹ï¼ˆé¡µ30ï¼‰ä¸­ï¼Œç»§ç»­é€šè¿‡äºŒåˆ†æ³•å¿«é€Ÿå®šä½åˆ°ç¬¦åˆé¡µå†…èŒƒå›´åŒ…å«æŸ¥è¯¢å€¼çš„é¡µï¼Œä¸»é”®å€¼å¤§äº 5ï¼Œæ‰€ä»¥å°±åˆ°å¶å­èŠ‚ç‚¹ï¼ˆé¡µ16ï¼‰æŸ¥æ‰¾è®°å½•ï¼›</li><li>æ¥ç€ï¼Œåœ¨å¶å­èŠ‚ç‚¹ï¼ˆé¡µ16ï¼‰ä¸­ï¼Œé€šè¿‡æ§½æŸ¥æ‰¾è®°å½•æ—¶ï¼Œä½¿ç”¨äºŒåˆ†æ³•å¿«é€Ÿå®šä½è¦æŸ¥è¯¢çš„è®°å½•åœ¨å“ªä¸ªæ§½ï¼ˆå“ªä¸ªè®°å½•åˆ†ç»„ï¼‰ï¼Œå®šä½åˆ°æ§½åï¼Œå†éå†æ§½å†…çš„æ‰€æœ‰è®°å½•ï¼Œæ‰¾åˆ°ä¸»é”®ä¸º 6 çš„è®°å½•ã€‚</li></ul><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å®šä½è®°å½•æ‰€åœ¨å“ªä¸€ä¸ªé¡µæ—¶ï¼Œä¹Ÿæ˜¯é€šè¿‡äºŒåˆ†æ³•å¿«é€Ÿå®šä½åˆ°åŒ…å«è¯¥è®°å½•çš„é¡µã€‚å®šä½åˆ°è¯¥é¡µåï¼Œåˆä¼šåœ¨è¯¥é¡µå†…è¿›è¡ŒäºŒåˆ†æ³•å¿«é€Ÿå®šä½è®°å½•æ‰€åœ¨çš„åˆ†ç»„ï¼ˆæ§½å·ï¼‰ï¼Œæœ€ååœ¨åˆ†ç»„å†…è¿›è¡Œéå†æŸ¥æ‰¾ã€‚</p><h4 id="å•ç‚¹æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#å•ç‚¹æŸ¥è¯¢" aria-hidden="true">#</a> å•ç‚¹æŸ¥è¯¢</h4><p>B æ ‘è¿›è¡Œå•ä¸ªç´¢å¼•æŸ¥è¯¢æ—¶ï¼Œæœ€å¿«å¯ä»¥åœ¨ O(1) çš„æ—¶é—´ä»£ä»·å†…å°±æŸ¥åˆ°ï¼Œè€Œä»å¹³å‡æ—¶é—´ä»£ä»·æ¥çœ‹ï¼Œä¼šæ¯” B+ æ ‘ç¨å¿«ä¸€äº›ã€‚</p><p>ä½†æ˜¯ B æ ‘çš„æŸ¥è¯¢æ³¢åŠ¨ä¼šæ¯”è¾ƒå¤§ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹å³å­˜ç´¢å¼•åˆå­˜è®°å½•ï¼Œæ‰€ä»¥æœ‰æ—¶å€™è®¿é—®åˆ°äº†éå¶å­èŠ‚ç‚¹å°±å¯ä»¥æ‰¾åˆ°ç´¢å¼•ï¼Œè€Œæœ‰æ—¶éœ€è¦è®¿é—®åˆ°å¶å­èŠ‚ç‚¹æ‰èƒ½æ‰¾åˆ°ç´¢å¼•ã€‚</p><p><strong>B+ æ ‘çš„éå¶å­èŠ‚ç‚¹ä¸å­˜æ”¾å®é™…çš„è®°å½•æ•°æ®ï¼Œä»…å­˜æ”¾ç´¢å¼•ï¼Œå› æ­¤æ•°æ®é‡ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œç›¸æ¯”å­˜å‚¨å³å­˜ç´¢å¼•åˆå­˜è®°å½•çš„ B æ ‘ï¼ŒB+æ ‘çš„éå¶å­èŠ‚ç‚¹å¯ä»¥å­˜æ”¾æ›´å¤šçš„ç´¢å¼•ï¼Œå› æ­¤ B+ æ ‘å¯ä»¥æ¯” B æ ‘æ›´ã€ŒçŸ®èƒ–ã€ï¼ŒæŸ¥è¯¢åº•å±‚èŠ‚ç‚¹çš„ç£ç›˜ I/Oæ¬¡æ•°ä¼šæ›´å°‘</strong>ã€‚</p><h4 id="æ’å…¥å’Œåˆ é™¤æ•ˆç‡" tabindex="-1"><a class="header-anchor" href="#æ’å…¥å’Œåˆ é™¤æ•ˆç‡" aria-hidden="true">#</a> æ’å…¥å’Œåˆ é™¤æ•ˆç‡</h4><p>B+ æ ‘æœ‰å¤§é‡çš„å†—ä½™èŠ‚ç‚¹ï¼Œè¿™æ ·ä½¿å¾—åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥ä»å¶å­èŠ‚ç‚¹ä¸­åˆ é™¤ï¼Œç”šè‡³å¯ä»¥ä¸åŠ¨éå¶å­èŠ‚ç‚¹ï¼Œè¿™æ ·åˆ é™¤éå¸¸å¿«ï¼Œ</p><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªåŠ¨å›¾æ˜¯åˆ é™¤ B+ æ ‘ 0004 èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œå› ä¸ºéå¶å­èŠ‚ç‚¹æœ‰ 0004 çš„å†—ä½™èŠ‚ç‚¹ï¼Œæ‰€ä»¥åœ¨åˆ é™¤çš„æ—¶å€™ï¼Œæ ‘å½¢ç»“æ„å˜åŒ–å¾ˆå°ï¼š</p><figure><img src="https://img-blog.csdnimg.cn/25508b0cd9c44ef6937fdd737020a7f1.gif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>æ³¨æ„ï¼Œï¼šB+ æ ‘å¯¹äºéå¶å­èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å’Œç´¢å¼•çš„ä¸ªæ•°ï¼Œå®šä¹‰æ–¹å¼å¯èƒ½ä¼šæœ‰ä¸åŒï¼Œæœ‰çš„æ˜¯è¯´éå¶å­èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„ä¸ªæ•°ä¸º M é˜¶ï¼Œè€Œç´¢å¼•çš„ä¸ªæ•°ä¸º M-1ï¼ˆè¿™ä¸ªæ˜¯ç»´åŸºç™¾ç§‘é‡Œçš„å®šä¹‰ï¼‰ï¼Œå› æ­¤æˆ‘æœ¬æ–‡å…³äº B+ æ ‘çš„åŠ¨å›¾éƒ½æ˜¯åŸºäºè¿™ä¸ªã€‚ä½†æ˜¯æˆ‘åœ¨å‰é¢ä»‹ç» B+ æ ‘ä¸ B+ æ ‘çš„å·®å¼‚æ—¶ï¼Œè¯´çš„æ˜¯ã€Œéå¶å­èŠ‚ç‚¹ä¸­æœ‰å¤šå°‘ä¸ªå­èŠ‚ç‚¹ï¼Œå°±æœ‰å¤šå°‘ä¸ªç´¢å¼•ã€ï¼Œä¸»è¦æ˜¯ MySQL ç”¨åˆ°çš„ B+ æ ‘å°±æ˜¯è¿™ä¸ªç‰¹æ€§ã€‚</p></blockquote><p>ä¸‹é¢è¿™ä¸ªåŠ¨å›¾æ˜¯åˆ é™¤ B æ ‘ 0008 èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ ‘çš„å¤æ‚å˜åŒ–ï¼š</p><figure><img src="https://img-blog.csdnimg.cn/2be62679487640bbaac663fa96c7f35f.gif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ç”šè‡³ï¼ŒB+ æ ‘åœ¨åˆ é™¤æ ¹èŠ‚ç‚¹çš„æ—¶å€™ï¼Œç”±äºå­˜åœ¨å†—ä½™çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¸ä¼šå‘ç”Ÿå¤æ‚çš„æ ‘çš„å˜å½¢ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªåŠ¨å›¾æ˜¯åˆ é™¤ B+ æ ‘æ ¹èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼š</p><figure><img src="https://img-blog.csdnimg.cn/23730b5af987480fabff0f1d142a2b6c.gif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>B æ ‘åˆ™ä¸åŒï¼ŒB æ ‘æ²¡æœ‰å†—ä½™èŠ‚ç‚¹ï¼Œåˆ é™¤èŠ‚ç‚¹çš„æ—¶å€™éå¸¸å¤æ‚ï¼Œæ¯”å¦‚åˆ é™¤æ ¹èŠ‚ç‚¹ä¸­çš„æ•°æ®ï¼Œå¯èƒ½æ¶‰åŠå¤æ‚çš„æ ‘çš„å˜å½¢ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªåŠ¨å›¾æ˜¯åˆ é™¤ B æ ‘æ ¹èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼š</p><figure><img src="https://img-blog.csdnimg.cn/img_convert/7552002f9b8195ab650d431bfe66cce2.gif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>B+ æ ‘çš„æ’å…¥ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæœ‰å†—ä½™èŠ‚ç‚¹ï¼Œæ’å…¥å¯èƒ½å­˜åœ¨èŠ‚ç‚¹çš„åˆ†è£‚ï¼ˆå¦‚æœèŠ‚ç‚¹é¥±å’Œï¼‰ï¼Œä½†æ˜¯æœ€å¤šåªæ¶‰åŠæ ‘çš„ä¸€æ¡è·¯å¾„ã€‚è€Œä¸” B+ æ ‘ä¼šè‡ªåŠ¨å¹³è¡¡ï¼Œä¸éœ€è¦åƒæ›´å¤šå¤æ‚çš„ç®—æ³•ï¼Œç±»ä¼¼çº¢é»‘æ ‘çš„æ—‹è½¬æ“ä½œç­‰ã€‚</p><p>å› æ­¤ï¼Œ<strong>B+ æ ‘çš„æ’å…¥å’Œåˆ é™¤æ•ˆç‡æ›´é«˜</strong>ã€‚</p><h4 id="èŒƒå›´æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#èŒƒå›´æŸ¥è¯¢" aria-hidden="true">#</a> èŒƒå›´æŸ¥è¯¢</h4><p>B æ ‘å’Œ B+ æ ‘ç­‰å€¼æŸ¥è¯¢åŸç†åŸºæœ¬ä¸€è‡´ï¼Œå…ˆä»æ ¹èŠ‚ç‚¹æŸ¥æ‰¾ï¼Œç„¶åå¯¹æ¯”ç›®æ ‡æ•°æ®çš„èŒƒå›´ï¼Œæœ€åé€’å½’çš„è¿›å…¥å­èŠ‚ç‚¹æŸ¥æ‰¾ã€‚</p><p>å› ä¸º <strong>B+ æ ‘æ‰€æœ‰å¶å­èŠ‚ç‚¹é—´è¿˜æœ‰ä¸€ä¸ªé“¾è¡¨è¿›è¡Œè¿æ¥ï¼Œè¿™ç§è®¾è®¡å¯¹èŒƒå›´æŸ¥æ‰¾éå¸¸æœ‰å¸®åŠ©</strong>ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æƒ³çŸ¥é“ 12 æœˆ 1 æ—¥å’Œ 12 æœˆ 12 æ—¥ä¹‹é—´çš„è®¢å•ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥å…ˆæŸ¥æ‰¾åˆ° 12 æœˆ 1 æ—¥æ‰€åœ¨çš„å¶å­èŠ‚ç‚¹ï¼Œç„¶ååˆ©ç”¨é“¾è¡¨å‘å³éå†ï¼Œç›´åˆ°æ‰¾åˆ° 12 æœˆ12 æ—¥çš„èŠ‚ç‚¹ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä»æ ¹èŠ‚ç‚¹æŸ¥è¯¢äº†ï¼Œè¿›ä¸€æ­¥èŠ‚çœæŸ¥è¯¢éœ€è¦çš„æ—¶é—´ã€‚</p><p>è€Œ B æ ‘æ²¡æœ‰å°†æ‰€æœ‰å¶å­èŠ‚ç‚¹ç”¨é“¾è¡¨ä¸²è”èµ·æ¥çš„ç»“æ„ï¼Œå› æ­¤åªèƒ½é€šè¿‡æ ‘çš„éå†æ¥å®ŒæˆèŒƒå›´æŸ¥è¯¢ï¼Œè¿™ä¼šæ¶‰åŠå¤šä¸ªèŠ‚ç‚¹çš„ç£ç›˜ I/O æ“ä½œï¼ŒèŒƒå›´æŸ¥è¯¢æ•ˆç‡ä¸å¦‚ B+ æ ‘ã€‚</p><p>å› æ­¤ï¼Œå­˜åœ¨å¤§é‡èŒƒå›´æ£€ç´¢çš„åœºæ™¯ï¼Œé€‚åˆä½¿ç”¨ B+æ ‘ï¼Œæ¯”å¦‚æ•°æ®åº“ã€‚è€Œå¯¹äºå¤§é‡çš„å•ä¸ªç´¢å¼•æŸ¥è¯¢çš„åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘ B æ ‘ï¼Œæ¯”å¦‚ nosql çš„MongoDB</p><h4 id="mysql-ä¸­çš„-b-æ ‘" tabindex="-1"><a class="header-anchor" href="#mysql-ä¸­çš„-b-æ ‘" aria-hidden="true">#</a> MySQL ä¸­çš„ B+ æ ‘</h4><p>MySQL çš„å­˜å‚¨æ–¹å¼æ ¹æ®å­˜å‚¨å¼•æ“çš„ä¸åŒè€Œä¸åŒï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯ Innodb å­˜å‚¨å¼•æ“ï¼Œå®ƒå°±æ˜¯é‡‡ç”¨äº† B+ æ ‘ä½œä¸ºäº†ç´¢å¼•çš„æ•°æ®ç»“æ„ã€‚</p><p>ä¸‹å›¾å°±æ˜¯ Innodb é‡Œçš„ B+ æ ‘ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220718133843334-4bcfe1b7.png" alt="image-20220718133843334" tabindex="0" loading="lazy"><figcaption>image-20220718133843334</figcaption></figure><p>ä½†æ˜¯ Innodb ä½¿ç”¨çš„ B+ æ ‘æœ‰ä¸€äº›ç‰¹åˆ«çš„ç‚¹ï¼Œæ¯”å¦‚ï¼š</p><ul><li>B+ æ ‘çš„å¶å­èŠ‚ç‚¹ä¹‹é—´æ˜¯ç”¨ã€ŒåŒå‘é“¾è¡¨ã€è¿›è¡Œè¿æ¥ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯æ—¢èƒ½å‘å³éå†ï¼Œä¹Ÿèƒ½å‘å·¦éå†ã€‚</li><li>B+ æ ‘ç‚¹èŠ‚ç‚¹å†…å®¹æ˜¯æ•°æ®é¡µï¼Œæ•°æ®é¡µé‡Œå­˜æ”¾äº†ç”¨æˆ·çš„è®°å½•ä»¥åŠå„ç§ä¿¡æ¯ï¼Œæ¯ä¸ªæ•°æ®é¡µé»˜è®¤å¤§å°æ˜¯ 16 KBã€‚</li></ul><p>Innodb æ ¹æ®ç´¢å¼•ç±»å‹ä¸åŒï¼Œåˆ†ä¸ºèšé›†å’ŒäºŒçº§ç´¢å¼•ã€‚ä»–ä»¬åŒºåˆ«åœ¨äºï¼Œèšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯å®é™…æ•°æ®ï¼Œæ‰€æœ‰å®Œæ•´çš„ç”¨æˆ·è®°å½•éƒ½å­˜æ”¾åœ¨èšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ï¼Œè€ŒäºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯ä¸»é”®å€¼ï¼Œè€Œä¸æ˜¯å®é™…æ•°æ®ã€‚</p><p>å› ä¸ºè¡¨çš„æ•°æ®éƒ½æ˜¯å­˜æ”¾åœ¨èšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹é‡Œï¼Œæ‰€ä»¥ InnoDB å­˜å‚¨å¼•æ“ä¸€å®šä¼šä¸ºè¡¨åˆ›å»ºä¸€ä¸ªèšé›†ç´¢å¼•ï¼Œä¸”ç”±äºæ•°æ®åœ¨ç‰©ç†ä¸Šåªä¼šä¿å­˜ä¸€ä»½ï¼Œæ‰€ä»¥èšç°‡ç´¢å¼•åªèƒ½æœ‰ä¸€ä¸ªï¼Œè€ŒäºŒçº§ç´¢å¼•å¯ä»¥åˆ›å»ºå¤šä¸ªã€‚</p><h3 id="mysqlä¸‰å¤§æ—¥å¿—-binlogã€redo-logã€undo-log" tabindex="-1"><a class="header-anchor" href="#mysqlä¸‰å¤§æ—¥å¿—-binlogã€redo-logã€undo-log" aria-hidden="true">#</a> MySQLä¸‰å¤§æ—¥å¿—ï¼ˆbinlogã€redo logã€undo logï¼‰</h3><p><code>MySQL</code> æ—¥å¿— ä¸»è¦åŒ…æ‹¬é”™è¯¯æ—¥å¿—ã€æŸ¥è¯¢æ—¥å¿—ã€æ…¢æŸ¥è¯¢æ—¥å¿—ã€äº‹åŠ¡æ—¥å¿—ã€äºŒè¿›åˆ¶æ—¥å¿—å‡ å¤§ç±»ã€‚å…¶ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„è¿˜è¦å±äºŒè¿›åˆ¶æ—¥å¿— <code>binlog</code>ï¼ˆå½’æ¡£æ—¥å¿—ï¼‰å’Œäº‹åŠ¡æ—¥å¿— <code>redo log</code>ï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ <code>undo log</code>ï¼ˆå›æ»šæ—¥å¿—ï¼‰</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220613210057735-66d9f839.png" alt="image-20220613210057735" tabindex="0" loading="lazy"><figcaption>image-20220613210057735</figcaption></figure><h4 id="redo-log" tabindex="-1"><a class="header-anchor" href="#redo-log" aria-hidden="true">#</a> redo log</h4><p><code>redo log</code>ï¼ˆé‡åšæ—¥å¿—ï¼‰æ˜¯ <code>InnoDB</code>å­˜å‚¨å¼•æ“ç‹¬æœ‰çš„ï¼Œå®ƒè®© <code>MySQL</code>æ‹¥æœ‰äº†å´©æºƒæ¢å¤èƒ½åŠ›ã€‚</p><p>æ¯”å¦‚ <code>MySQL</code> å®ä¾‹æŒ‚äº†æˆ–å®•æœºäº†ï¼Œé‡å¯æ—¶ï¼Œ<code>InnoDB</code>å­˜å‚¨å¼•æ“ä¼šä½¿ç”¨ <code>redo log</code>æ¢å¤æ•°æ®ï¼Œä¿è¯æ•°æ®çš„æŒä¹…æ€§ä¸å®Œæ•´æ€§ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706212928940-906f7192.png" alt="image-20220706212928940" tabindex="0" loading="lazy"><figcaption>image-20220706212928940</figcaption></figure><p><code>MySQL</code> ä¸­æ•°æ®æ˜¯ä»¥é¡µä¸ºå•ä½ï¼Œä½ æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œä¼šä»ç¡¬ç›˜æŠŠä¸€é¡µçš„æ•°æ®åŠ è½½å‡ºæ¥ï¼ŒåŠ è½½å‡ºæ¥çš„æ•°æ®å«æ•°æ®é¡µï¼Œä¼šæ”¾å…¥åˆ° <code>Buffer Pool</code> ä¸­ã€‚</p><p>åç»­çš„æŸ¥è¯¢éƒ½æ˜¯å…ˆä» <code>Buffer Pool</code> ä¸­æ‰¾ï¼Œæ²¡æœ‰å‘½ä¸­å†å»ç¡¬ç›˜åŠ è½½ï¼Œå‡å°‘ç¡¬ç›˜ <code>IO</code> å¼€é”€ï¼Œæå‡æ€§èƒ½ã€‚</p><p>æ›´æ–°è¡¨æ•°æ®çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå‘ç° <code>Buffer Pool</code> é‡Œå­˜åœ¨è¦æ›´æ–°çš„æ•°æ®ï¼Œå°±ç›´æ¥åœ¨ <code>Buffer Pool</code> é‡Œæ›´æ–°ã€‚</p><p>ç„¶åä¼šæŠŠâ€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€è®°å½•åˆ°é‡åšæ—¥å¿—ç¼“å­˜ï¼ˆ<code>redo log buffer</code>ï¼‰é‡Œï¼Œæ¥ç€åˆ·ç›˜åˆ° <code>redo log</code> æ–‡ä»¶é‡Œã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706212937926-530494b7.png" alt="image-20220706212937926" tabindex="0" loading="lazy"><figcaption>image-20220706212937926</figcaption></figure><blockquote><p>å›¾ç‰‡ç¬”è¯¯æç¤ºï¼šç¬¬ 4 æ­¥ â€œæ¸…ç©º redo log buffe åˆ·ç›˜åˆ° redo æ—¥å¿—ä¸­â€è¿™å¥è¯ä¸­çš„ buffe åº”è¯¥æ˜¯ bufferã€‚</p></blockquote><p>ç†æƒ³æƒ…å†µï¼Œäº‹åŠ¡ä¸€æäº¤å°±ä¼šè¿›è¡Œåˆ·ç›˜æ“ä½œï¼Œä½†å®é™…ä¸Šï¼Œåˆ·ç›˜çš„æ—¶æœºæ˜¯æ ¹æ®ç­–ç•¥æ¥è¿›è¡Œçš„ã€‚</p><blockquote><p>å°è´´å£«ï¼šæ¯æ¡ redo è®°å½•ç”±â€œè¡¨ç©ºé—´å·+æ•°æ®é¡µå·+åç§»é‡+ä¿®æ”¹æ•°æ®é•¿åº¦+å…·ä½“ä¿®æ”¹çš„æ•°æ®â€ç»„æˆ</p></blockquote><h5 id="pagecache" tabindex="-1"><a class="header-anchor" href="#pagecache" aria-hidden="true">#</a> PageCache</h5><p>æˆ‘ä»¬çŸ¥é“æ–‡ä»¶ä¸€èˆ¬å­˜æ”¾åœ¨ç¡¬ç›˜ï¼ˆæœºæ¢°ç¡¬ç›˜æˆ–å›ºæ€ç¡¬ç›˜ï¼‰ä¸­ï¼ŒCPU å¹¶ä¸èƒ½ç›´æ¥è®¿é—®ç¡¬ç›˜ä¸­çš„æ•°æ®ï¼Œè€Œæ˜¯éœ€è¦å…ˆå°†ç¡¬ç›˜ä¸­çš„æ•°æ®è¯»å…¥åˆ°å†…å­˜ä¸­ï¼Œç„¶åæ‰èƒ½è¢« CPU è®¿é—®ã€‚</p><p>ç”±äºè¯»å†™ç¡¬ç›˜çš„é€Ÿåº¦æ¯”è¯»å†™å†…å­˜è¦æ…¢å¾ˆå¤šï¼ˆDDR4 å†…å­˜è¯»å†™é€Ÿåº¦æ˜¯æœºæ¢°ç¡¬ç›˜500å€ï¼Œæ˜¯å›ºæ€ç¡¬ç›˜çš„200å€ï¼‰ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…æ¯æ¬¡è¯»å†™æ–‡ä»¶æ—¶ï¼Œéƒ½éœ€è¦å¯¹ç¡¬ç›˜è¿›è¡Œè¯»å†™æ“ä½œï¼ŒLinux å†…æ ¸ä½¿ç”¨ <code>é¡µç¼“å­˜ï¼ˆPage Cacheï¼‰</code> æœºåˆ¶æ¥å¯¹æ–‡ä»¶ä¸­çš„æ•°æ®è¿›è¡Œç¼“å­˜ã€‚</p><blockquote><p>æœ¬æ–‡ä½¿ç”¨çš„ Linux å†…æ ¸ç‰ˆæœ¬ä¸ºï¼šLinux-2.6.23</p></blockquote><h6 id="ä»€ä¹ˆæ˜¯é¡µç¼“å­˜" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯é¡µç¼“å­˜" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯é¡µç¼“å­˜</h6><p>ä¸ºäº†æå‡å¯¹æ–‡ä»¶çš„è¯»å†™æ•ˆç‡ï¼ŒLinux å†…æ ¸ä¼šä»¥é¡µå¤§å°ï¼ˆ4KBï¼‰ä¸ºå•ä½ï¼Œå°†æ–‡ä»¶åˆ’åˆ†ä¸ºå¤šæ•°æ®å—ã€‚å½“ç”¨æˆ·å¯¹æ–‡ä»¶ä¸­çš„æŸä¸ªæ•°æ®å—è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œå†…æ ¸é¦–å…ˆä¼šç”³è¯·ä¸€ä¸ªå†…å­˜é¡µï¼ˆç§°ä¸º <code>é¡µç¼“å­˜</code>ï¼‰ä¸æ–‡ä»¶ä¸­çš„æ•°æ®å—è¿›è¡Œç»‘å®šã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725150519009-13831ebc.png" alt="image-20220725150519009" tabindex="0" loading="lazy"><figcaption>image-20220725150519009</figcaption></figure><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“ç”¨æˆ·å¯¹æ–‡ä»¶è¿›è¡Œè¯»å†™æ—¶ï¼Œå®é™…ä¸Šæ˜¯å¯¹æ–‡ä»¶çš„ <code>é¡µç¼“å­˜</code> è¿›è¡Œè¯»å†™ã€‚æ‰€ä»¥å¯¹æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œä¼šåˆ†ä»¥ä¸‹ä¸¤ç§æƒ…å†µè¿›è¡Œå¤„ç†ï¼š</p><ul><li>å½“ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®æ—¶ï¼Œå¦‚æœè¦è¯»å–çš„æ•°æ®æ‰€åœ¨çš„é¡µç¼“å­˜å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆå°±ç›´æ¥æŠŠé¡µç¼“å­˜çš„æ•°æ®æ‹·è´ç»™ç”¨æˆ·å³å¯ã€‚å¦åˆ™ï¼Œå†…æ ¸é¦–å…ˆä¼šç”³è¯·ä¸€ä¸ªç©ºé—²çš„å†…å­˜é¡µï¼ˆé¡µç¼“å­˜ï¼‰ï¼Œç„¶åä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®åˆ°é¡µç¼“å­˜ï¼Œå¹¶ä¸”æŠŠé¡µç¼“å­˜çš„æ•°æ®æ‹·è´ç»™ç”¨æˆ·ã€‚</li><li>å½“å‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®æ—¶ï¼Œå¦‚æœè¦å†™å…¥çš„æ•°æ®æ‰€åœ¨çš„é¡µç¼“å­˜å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆç›´æ¥æŠŠæ–°æ•°æ®å†™å…¥åˆ°é¡µç¼“å­˜å³å¯ã€‚å¦åˆ™ï¼Œå†…æ ¸é¦–å…ˆä¼šç”³è¯·ä¸€ä¸ªç©ºé—²çš„å†…å­˜é¡µï¼ˆé¡µç¼“å­˜ï¼‰ï¼Œç„¶åä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®åˆ°é¡µç¼“å­˜ï¼Œå¹¶ä¸”æŠŠæ–°æ•°æ®å†™å…¥åˆ°é¡µç¼“å­˜ä¸­ã€‚å¯¹äºè¢«ä¿®æ”¹çš„é¡µç¼“å­˜ï¼Œå†…æ ¸ä¼šå®šæ—¶æŠŠè¿™äº›é¡µç¼“å­˜åˆ·æ–°åˆ°æ–‡ä»¶ä¸­ã€‚</li></ul><h6 id="é¡µç¼“å­˜çš„å®ç°" tabindex="-1"><a class="header-anchor" href="#é¡µç¼“å­˜çš„å®ç°" aria-hidden="true">#</a> é¡µç¼“å­˜çš„å®ç°</h6><p>å‰é¢ä¸»è¦ä»‹ç»äº†é¡µç¼“å­˜çš„ä½œç”¨å’ŒåŸç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¼šåˆ†æ Linux å†…æ ¸æ˜¯æ€ä¹ˆå®ç°é¡µç¼“å­˜æœºåˆ¶çš„ã€‚</p><ol><li>address_space</li></ol><p>åœ¨ Linux å†…æ ¸ä¸­ï¼Œä½¿ç”¨ <code>file</code> å¯¹è±¡æ¥æè¿°ä¸€ä¸ªè¢«æ‰“å¼€çš„æ–‡ä»¶ï¼Œå…¶ä¸­æœ‰ä¸ªåä¸º <code>f_mapping</code> çš„å­—æ®µï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">file</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">struct</span> <span class="token class-name">address_space</span> <span class="token operator">*</span>f_mapping<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œ<code>f_mapping</code> å­—æ®µçš„ç±»å‹ä¸º <code>address_space</code> ç»“æ„ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">address_space</span> <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> <span class="token class-name">inode</span>           <span class="token operator">*</span>host<span class="token punctuation">;</span>      <span class="token comment">/* owner: inode, block_device */</span>
    <span class="token keyword">struct</span> <span class="token class-name">radix_tree_root</span> page_tree<span class="token punctuation">;</span>  <span class="token comment">/* radix tree of all pages */</span>
    <span class="token class-name">rwlock_t</span>               tree_lock<span class="token punctuation">;</span>  <span class="token comment">/* and rwlock protecting it */</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>address_space</code> ç»“æ„å…¶ä¸­çš„ä¸€ä¸ªä½œç”¨å°±æ˜¯ç”¨äºå­˜å‚¨æ–‡ä»¶çš„ <code>é¡µç¼“å­˜</code>ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹å„ä¸ªå­—æ®µçš„ä½œç”¨ï¼š</p><ul><li><code>host</code>ï¼šæŒ‡å‘å½“å‰ <code>address_space</code> å¯¹è±¡æ‰€å±çš„æ–‡ä»¶ <code>inode</code> å¯¹è±¡ï¼ˆæ¯ä¸ªæ–‡ä»¶éƒ½ä½¿ç”¨ä¸€ä¸ª <code>inode</code> å¯¹è±¡è¡¨ç¤ºï¼‰ã€‚</li><li><code>page_tree</code>ï¼šç”¨äºå­˜å‚¨å½“å‰æ–‡ä»¶çš„ <code>é¡µç¼“å­˜</code>ã€‚</li><li><code>tree_lock</code>ï¼šç”¨äºé˜²æ­¢å¹¶å‘è®¿é—® <code>page_tree</code> å¯¼è‡´çš„èµ„æºç«äº‰é—®é¢˜ã€‚</li></ul><p>ä» <code>address_space</code> å¯¹è±¡çš„å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œæ–‡ä»¶çš„ <code>é¡µç¼“å­˜</code> ä½¿ç”¨äº† <code>radixæ ‘</code> æ¥å­˜å‚¨ã€‚</p><blockquote><p><code>radixæ ‘</code>ï¼šåˆååŸºæ•°æ ‘ï¼Œå®ƒä½¿ç”¨é”®å€¼ï¼ˆkey-valueï¼‰å¯¹çš„å½¢å¼æ¥ä¿å­˜æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡é”®å¿«é€ŸæŸ¥æ‰¾åˆ°å…¶å¯¹åº”çš„å€¼ã€‚å†…æ ¸ä»¥æ–‡ä»¶è¯»å†™æ“ä½œä¸­çš„æ•°æ® <code>åç§»é‡</code> ä½œä¸ºé”®ï¼Œä»¥æ•°æ®åç§»é‡æ‰€åœ¨çš„ <code>é¡µç¼“å­˜</code> ä½œä¸ºå€¼ï¼Œå­˜å‚¨åœ¨ <code>address_space</code> ç»“æ„çš„ <code>page_tree</code> å­—æ®µä¸­ã€‚</p></blockquote><p>ä¸‹å›¾å±•ç¤ºäº†ä¸Šè¿°å„ä¸ªç»“æ„ä¹‹é—´çš„å…³ç³»ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220725150553230-925f6ff9.png" alt="image-20220725150553230" tabindex="0" loading="lazy"><figcaption>image-20220725150553230</figcaption></figure><p>å¦‚æœå¯¹ <code>radixæ ‘</code> ä¸å¤ªäº†è§£ï¼Œå¯ä»¥ç®€å•å°†å…¶çœ‹æˆå¯ä»¥é€šè¿‡æ–‡ä»¶åç§»é‡å¿«é€Ÿæ‰¾åˆ°å…¶æ‰€åœ¨ <code>é¡µç¼“å­˜</code> çš„ç»“æ„ï¼Œæœ‰æœºä¼šæˆ‘ä¼šå¦å¤–å†™ä¸€ç¯‡å…³äº <code>radixæ ‘</code> çš„æ–‡ç« ã€‚</p><ol start="2"><li>è¯»æ–‡ä»¶æ“ä½œ</li></ol><p>ç°åœ¨æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¯»å–æ–‡ä»¶æ•°æ®çš„è¿‡ç¨‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è°ƒç”¨ <code>read</code> ç³»ç»Ÿè°ƒç”¨æ¥è¯»å–æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œå…¶è°ƒç”¨é“¾å¦‚ä¸‹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>read()
â””â†’ sys_read()
   â””â†’ vfs_read()
      â””â†’ do_sync_read()
         â””â†’ generic_file_aio_read()
            â””â†’ do_generic_file_read()
               â””â†’ do_generic_mapping_read()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šé¢çš„è°ƒç”¨é“¾å¯ä»¥çœ‹å‡ºï¼Œ<code>read</code> ç³»ç»Ÿè°ƒç”¨æœ€ç»ˆä¼šè°ƒç”¨ <code>do_generic_mapping_read</code> å‡½æ•°æ¥è¯»å–æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œå…¶å®ç°å¦‚ä¸‹ï¼š</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">do_generic_mapping_read</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">address_space</span> <span class="token operator">*</span>mapping<span class="token punctuation">,</span>
                        <span class="token keyword">struct</span> <span class="token class-name">file_ra_state</span> <span class="token operator">*</span>_ra<span class="token punctuation">,</span>
                        <span class="token keyword">struct</span> <span class="token class-name">file</span> <span class="token operator">*</span>filp<span class="token punctuation">,</span>
                        <span class="token class-name">loff_t</span> <span class="token operator">*</span>ppos<span class="token punctuation">,</span>
                        <span class="token class-name">read_descriptor_t</span> <span class="token operator">*</span>desc<span class="token punctuation">,</span>
                        <span class="token class-name">read_actor_t</span> actor<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">struct</span> <span class="token class-name">inode</span> <span class="token operator">*</span>inode <span class="token operator">=</span> mapping<span class="token operator">-&gt;</span>host<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> index<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">page</span> <span class="token operator">*</span>cached_page<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    cached_page <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    index <span class="token operator">=</span> <span class="token operator">*</span>ppos <span class="token operator">&gt;&gt;</span> PAGE_CACHE_SHIFT<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">struct</span> <span class="token class-name">page</span> <span class="token operator">*</span>page<span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

find_page<span class="token operator">:</span>
        <span class="token comment">// 1. æŸ¥æ‰¾æ–‡ä»¶åç§»é‡æ‰€åœ¨çš„é¡µç¼“å­˜æ˜¯å¦å­˜åœ¨</span>
        page <span class="token operator">=</span> <span class="token function">find_get_page</span><span class="token punctuation">(</span>mapping<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token comment">// 2. å¦‚æœé¡µç¼“å­˜ä¸å­˜åœ¨, é‚£ä¹ˆè·³åˆ° no_cached_page è¿›è¡Œå¤„ç†</span>
            <span class="token keyword">goto</span> no_cached_page<span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

page_ok<span class="token operator">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">// 3. å¦‚æœé¡µç¼“å­˜å­˜åœ¨, é‚£ä¹ˆæŠŠé¡µç¼“å­˜çš„æ•°æ®æ‹·è´åˆ°ç”¨æˆ·åº”ç”¨ç¨‹åºçš„å†…å­˜ä¸­</span>
        ret <span class="token operator">=</span> <span class="token function">actor</span><span class="token punctuation">(</span>desc<span class="token punctuation">,</span> page<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> nr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> nr <span class="token operator">&amp;&amp;</span> desc<span class="token operator">-&gt;</span>count<span class="token punctuation">)</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token keyword">goto</span> out<span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

readpage<span class="token operator">:</span>
        <span class="token comment">// 4. ä»æ–‡ä»¶è¯»å–æ•°æ®åˆ°é¡µç¼“å­˜ä¸­</span>
        error <span class="token operator">=</span> mapping<span class="token operator">-&gt;</span>a_ops<span class="token operator">-&gt;</span><span class="token function">readpage</span><span class="token punctuation">(</span>filp<span class="token punctuation">,</span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">goto</span> page_ok<span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

no_cached_page<span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cached_page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 5. ç”³è¯·ä¸€ä¸ªå†…å­˜é¡µä½œä¸ºé¡µç¼“å­˜</span>
            cached_page <span class="token operator">=</span> <span class="token function">page_cache_alloc_cold</span><span class="token punctuation">(</span>mapping<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 6. æŠŠæ–°ç”³è¯·çš„é¡µç¼“å­˜æ·»åŠ åˆ°æ–‡ä»¶é¡µç¼“å­˜ä¸­</span>
        error <span class="token operator">=</span> <span class="token function">add_to_page_cache_lru</span><span class="token punctuation">(</span>cached_page<span class="token punctuation">,</span> mapping<span class="token punctuation">,</span> index<span class="token punctuation">,</span> GFP_KERNEL<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        page <span class="token operator">=</span> cached_page<span class="token punctuation">;</span>
        cached_page <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">goto</span> readpage<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

out<span class="token operator">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>do_generic_mapping_read</code> å‡½æ•°çš„å®ç°æ¯”è¾ƒå¤æ‚ï¼Œç»è¿‡ç²¾ç®€åï¼Œä¸Šé¢ä»£ç åªç•™ä¸‹æœ€é‡è¦çš„é€»è¾‘ï¼Œå¯ä»¥å½’çº³ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li>é€šè¿‡è°ƒç”¨ <code>find_get_page</code> å‡½æ•°æŸ¥æ‰¾è¦è¯»å–çš„æ–‡ä»¶åç§»é‡æ‰€å¯¹åº”çš„é¡µç¼“å­˜æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±æŠŠé¡µç¼“å­˜ä¸­çš„æ•°æ®æ‹·è´åˆ°åº”ç”¨ç¨‹åºçš„å†…å­˜ä¸­ã€‚</li><li>å¦åˆ™è°ƒç”¨ <code>page_cache_alloc_cold</code> å‡½æ•°ç”³è¯·ä¸€ä¸ªç©ºé—²çš„å†…å­˜é¡µä½œä¸ºæ–°çš„é¡µç¼“å­˜ï¼Œå¹¶ä¸”é€šè¿‡è°ƒç”¨ <code>add_to_page_cache_lru</code> å‡½æ•°æŠŠæ–°ç”³è¯·çš„é¡µç¼“å­˜æ·»åŠ åˆ°æ–‡ä»¶é¡µç¼“å­˜å’Œ LRU é˜Ÿåˆ—ä¸­ï¼ˆåé¢ä¼šä»‹ç»ï¼‰ã€‚</li><li>é€šè¿‡è°ƒç”¨ <code>readpage</code> æ¥å£ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®åˆ°é¡µç¼“å­˜ä¸­ï¼Œå¹¶ä¸”æŠŠé¡µç¼“å­˜çš„æ•°æ®æ‹·è´åˆ°åº”ç”¨ç¨‹åºçš„å†…å­˜ä¸­ã€‚</li></ul><p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œå½“é¡µç¼“å­˜ä¸å­˜åœ¨æ—¶ä¼šç”³è¯·ä¸€å—ç©ºé—²çš„å†…å­˜é¡µä½œä¸ºé¡µç¼“å­˜ï¼Œå¹¶ä¸”é€šè¿‡è°ƒç”¨ <code>add_to_page_cache_lru</code> å‡½æ•°æŠŠå…¶æ·»åŠ åˆ°æ–‡ä»¶çš„é¡µç¼“å­˜å’Œ LRU é˜Ÿåˆ—ä¸­ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ <code>add_to_page_cache_lru</code> å‡½æ•°çš„å®ç°ï¼š</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code> <span class="token keyword">int</span> <span class="token function">add_to_page_cache_lru</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">page</span> <span class="token operator">*</span>page<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">address_space</span> <span class="token operator">*</span>mapping<span class="token punctuation">,</span>
                           <span class="token class-name">pgoff_t</span> offset<span class="token punctuation">,</span> <span class="token class-name">gfp_t</span> gfp_mask<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// 1. æŠŠé¡µç¼“å­˜æ·»åŠ åˆ°æ–‡ä»¶é¡µç¼“å­˜ä¸­</span>
    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">add_to_page_cache</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> mapping<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> gfp_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">lru_cache_add</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2. æŠŠé¡µç¼“å­˜æ·»åŠ åˆ° LRU é˜Ÿåˆ—ä¸­</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>add_to_page_cache_lru</code> å‡½æ•°ä¸»è¦å®Œæˆä¸¤ä¸ªå·¥ä½œï¼š</p><ul><li>é€šè¿‡è°ƒç”¨ <code>add_to_page_cache</code> å‡½æ•°æŠŠé¡µç¼“å­˜æ·»åŠ åˆ°æ–‡ä»¶é¡µç¼“å­˜ä¸­ï¼Œä¹Ÿå°±æ˜¯æ·»åŠ åˆ° <code>address_space</code> ç»“æ„çš„ <code>page_tree</code> å­—æ®µä¸­ã€‚</li><li>é€šè¿‡è°ƒç”¨ <code>lru_cache_add</code> å‡½æ•°æŠŠé¡µç¼“å­˜æ·»åŠ åˆ° LRU é˜Ÿåˆ—ä¸­ã€‚LRU é˜Ÿåˆ—ç”¨äºå½“ç³»ç»Ÿå†…å­˜ä¸è¶³æ—¶ï¼Œå¯¹é¡µç¼“å­˜è¿›è¡Œæ¸…ç†æ—¶ä½¿ç”¨ã€‚</li></ul><h6 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h6><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº† <code>é¡µç¼“å­˜</code> çš„ä½œç”¨å’ŒåŸç†ï¼Œå¹¶ä¸”ä»‹ç»äº†åœ¨è¯»å–æ–‡ä»¶æ•°æ®æ—¶å¯¹é¡µç¼“å­˜çš„å¤„ç†è¿‡ç¨‹ã€‚æœ¬æ–‡å¹¶æ²¡æœ‰ä»‹ç»å†™æ–‡ä»¶æ“ä½œå¯¹åº”çš„é¡µç¼“å­˜å¤„ç†å’Œå½“ç³»ç»Ÿå†…å­˜ä¸è¶³æ—¶æ€ä¹ˆé‡Šæ”¾é¡µç¼“å­˜ï¼Œæœ‰å…´è¶£çš„è¯å¯ä»¥è‡ªè¡Œé˜…è¯»ç›¸å…³çš„ä»£ç å®ç°ã€‚</p><h5 id="åˆ·ç›˜æ—¶æœº" tabindex="-1"><a class="header-anchor" href="#åˆ·ç›˜æ—¶æœº" aria-hidden="true">#</a> åˆ·ç›˜æ—¶æœº</h5><p><code>InnoDB</code> å­˜å‚¨å¼•æ“ä¸º <code>redo log</code> çš„åˆ·ç›˜ç­–ç•¥æä¾›äº† <code>innodb_flush_log_at_trx_commit</code> å‚æ•°ï¼Œå®ƒæ”¯æŒä¸‰ç§ç­–ç•¥ï¼š</p><ul><li><strong>0</strong> ï¼šè®¾ç½®ä¸º 0 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶ä¸è¿›è¡Œåˆ·ç›˜æ“ä½œ</li><li><strong>1</strong> ï¼šè®¾ç½®ä¸º 1 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½å°†è¿›è¡Œåˆ·ç›˜æ“ä½œï¼ˆé»˜è®¤å€¼ï¼‰</li><li><strong>2</strong> ï¼šè®¾ç½®ä¸º 2 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½åªæŠŠ redo log buffer å†…å®¹å†™å…¥ page cache</li></ul><p><code>innodb_flush_log_at_trx_commit</code> å‚æ•°é»˜è®¤ä¸º 1 ï¼Œä¹Ÿå°±æ˜¯è¯´å½“äº‹åŠ¡æäº¤æ—¶ä¼šè°ƒç”¨ <code>fsync</code> å¯¹ redo log è¿›è¡Œåˆ·ç›˜</p><p>å¦å¤–ï¼Œ<code>InnoDB</code> å­˜å‚¨å¼•æ“æœ‰ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œæ¯éš” <code>1</code> ç§’ï¼Œå°±ä¼šæŠŠ <code>redo log buffer</code> ä¸­çš„å†…å®¹å†™åˆ°æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼ˆ<code>page cache</code>ï¼‰ï¼Œç„¶åè°ƒç”¨ <code>fsync</code> åˆ·ç›˜ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213001613-6196cfff.png" alt="image-20220706213001613" tabindex="0" loading="lazy"><figcaption>image-20220706213001613</figcaption></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªæ²¡æœ‰æäº¤äº‹åŠ¡çš„ <code>redo log</code> è®°å½•ï¼Œä¹Ÿå¯èƒ½ä¼šåˆ·ç›˜ã€‚</p><p><strong>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</strong></p><p>å› ä¸ºåœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ <code>redo log</code> è®°å½•æ˜¯ä¼šå†™å…¥ <code>redo log buffer</code> ä¸­ï¼Œè¿™äº› <code>redo log</code> è®°å½•ä¼šè¢«åå°çº¿ç¨‹åˆ·ç›˜ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213009977-579f4218.png" alt="image-20220706213009977" tabindex="0" loading="lazy"><figcaption>image-20220706213009977</figcaption></figure><p>é™¤äº†åå°çº¿ç¨‹æ¯ç§’ <code>1</code>æ¬¡çš„è½®è¯¢æ“ä½œï¼Œè¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå½“ <code>redo log buffer</code> å ç”¨çš„ç©ºé—´å³å°†è¾¾åˆ° <code>innodb_log_buffer_size</code> ä¸€åŠçš„æ—¶å€™ï¼Œåå°çº¿ç¨‹ä¼šä¸»åŠ¨åˆ·ç›˜ã€‚</p><p>ä¸‹é¢æ˜¯ä¸åŒåˆ·ç›˜ç­–ç•¥çš„æµç¨‹å›¾</p><p>innodb_flush_log_at_trx_commit=0</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213032809-ab0bdbaf.png" alt="image-20220706213032809" tabindex="0" loading="lazy"><figcaption>image-20220706213032809</figcaption></figure><p>ä¸º <code>0</code>æ—¶ï¼Œå¦‚æœ <code>MySQL</code>æŒ‚äº†æˆ–å®•æœºå¯èƒ½ä¼šæœ‰ <code>1</code>ç§’æ•°æ®çš„ä¸¢å¤±ã€‚</p><p>innodb_flush_log_at_trx_commit=1</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213045311-52a2bc70.png" alt="image-20220706213045311" tabindex="0" loading="lazy"><figcaption>image-20220706213045311</figcaption></figure><p>ä¸º <code>1</code>æ—¶ï¼Œ åªè¦äº‹åŠ¡æäº¤æˆåŠŸï¼Œ<code>redo log</code>è®°å½•å°±ä¸€å®šåœ¨ç¡¬ç›˜é‡Œï¼Œä¸ä¼šæœ‰ä»»ä½•æ•°æ®ä¸¢å¤±ã€‚</p><p>å¦‚æœäº‹åŠ¡æ‰§è¡ŒæœŸé—´ <code>MySQL</code>æŒ‚äº†æˆ–å®•æœºï¼Œè¿™éƒ¨åˆ†æ—¥å¿—ä¸¢äº†ï¼Œä½†æ˜¯äº‹åŠ¡å¹¶æ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥æ—¥å¿—ä¸¢äº†ä¹Ÿä¸ä¼šæœ‰æŸå¤±ã€‚</p><p>innodb_flush_log_at_trx_commit=2</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213100010-d21d518a.png" alt="image-20220706213100010" tabindex="0" loading="lazy"><figcaption>image-20220706213100010</figcaption></figure><p>ä¸º <code>2</code>æ—¶ï¼Œ åªè¦äº‹åŠ¡æäº¤æˆåŠŸï¼Œ<code>redo log buffer</code>ä¸­çš„å†…å®¹åªå†™å…¥æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼ˆ<code>page cache</code>ï¼‰ã€‚</p><p>å¦‚æœä»…ä»…åªæ˜¯ <code>MySQL</code>æŒ‚äº†ä¸ä¼šæœ‰ä»»ä½•æ•°æ®ä¸¢å¤±ï¼Œä½†æ˜¯å®•æœºå¯èƒ½ä¼šæœ‰ <code>1</code>ç§’æ•°æ®çš„ä¸¢å¤±ã€‚</p><h5 id="æ—¥å¿—æ–‡ä»¶ç»„" tabindex="-1"><a class="header-anchor" href="#æ—¥å¿—æ–‡ä»¶ç»„" aria-hidden="true">#</a> æ—¥å¿—æ–‡ä»¶ç»„</h5><p>ç¡¬ç›˜ä¸Šå­˜å‚¨çš„ <code>redo log</code> æ—¥å¿—æ–‡ä»¶ä¸åªä¸€ä¸ªï¼Œè€Œæ˜¯ä»¥ä¸€ä¸ª<strong>æ—¥å¿—æ–‡ä»¶ç»„</strong>çš„å½¢å¼å‡ºç°çš„ï¼Œæ¯ä¸ªçš„ <code>redo</code>æ—¥å¿—æ–‡ä»¶å¤§å°éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>æ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„ <code>4</code>ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯ <code>1GB</code>ï¼Œæ•´ä¸ª <code>redo log</code> æ—¥å¿—æ–‡ä»¶ç»„å¯ä»¥è®°å½• <code>4G</code>çš„å†…å®¹ã€‚</p><p>å®ƒé‡‡ç”¨çš„æ˜¯ç¯å½¢æ•°ç»„å½¢å¼ï¼Œä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾åˆå›åˆ°å¤´å¾ªç¯å†™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213128010-c91ecb04.png" alt="image-20220706213128010" tabindex="0" loading="lazy"><figcaption>image-20220706213128010</figcaption></figure><p>åœ¨ä¸ª<strong>æ—¥å¿—æ–‡ä»¶ç»„</strong>ä¸­è¿˜æœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§ï¼Œåˆ†åˆ«æ˜¯ <code>write posã€checkpoint</code></p><ul><li><strong>write pos</strong> æ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»</li><li><strong>checkpoint</strong> æ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯å¾€åæ¨ç§»</li></ul><p>æ¯æ¬¡åˆ·ç›˜ <code>redo log</code> è®°å½•åˆ°<strong>æ—¥å¿—æ–‡ä»¶ç»„</strong>ä¸­ï¼Œ<code>write pos</code> ä½ç½®å°±ä¼šåç§»æ›´æ–°ã€‚</p><p>æ¯æ¬¡ <code>MySQL</code> åŠ è½½<strong>æ—¥å¿—æ–‡ä»¶ç»„</strong>æ¢å¤æ•°æ®æ—¶ï¼Œä¼šæ¸…ç©ºåŠ è½½è¿‡çš„ <code>redo log</code> è®°å½•ï¼Œå¹¶æŠŠ <code>checkpoint</code> åç§»æ›´æ–°ã€‚</p><p><code>write pos</code> å’Œ <code>checkpoint</code> ä¹‹é—´çš„è¿˜ç©ºç€çš„éƒ¨åˆ†å¯ä»¥ç”¨æ¥å†™å…¥æ–°çš„ <code>redo log</code> è®°å½•ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213147439-858d6d55.png" alt="image-20220706213147439" tabindex="0" loading="lazy"><figcaption>image-20220706213147439</figcaption></figure><p>å¦‚æœ <code>write pos</code> è¿½ä¸Š <code>checkpoint</code> ï¼Œè¡¨ç¤º<strong>æ—¥å¿—æ–‡ä»¶ç»„</strong>æ»¡äº†ï¼Œè¿™æ—¶å€™ä¸èƒ½å†å†™å…¥æ–°çš„ <code>redo log</code> è®°å½•ï¼Œ<code>MySQL</code> å¾—åœä¸‹æ¥ï¼Œæ¸…ç©ºä¸€äº›è®°å½•ï¼ŒæŠŠ <code>checkpoint</code> æ¨è¿›ä¸€ä¸‹ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213155597-dabe2913.png" alt="image-20220706213155597" tabindex="0" loading="lazy"><figcaption>image-20220706213155597</figcaption></figure><h5 id="redo-log-å°ç»“" tabindex="-1"><a class="header-anchor" href="#redo-log-å°ç»“" aria-hidden="true">#</a> redo log å°ç»“</h5><p>ç›¸ä¿¡å¤§å®¶éƒ½çŸ¥é“ <code>redo log</code> çš„ä½œç”¨å’Œå®ƒçš„åˆ·ç›˜æ—¶æœºã€å­˜å‚¨å½¢å¼ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š <strong>åªè¦æ¯æ¬¡æŠŠä¿®æ”¹åçš„æ•°æ®é¡µç›´æ¥åˆ·ç›˜ä¸å°±å¥½äº†ï¼Œè¿˜æœ‰ <code>redo log</code> ä»€ä¹ˆäº‹ï¼Ÿ</strong></p><p>å®ƒä»¬ä¸éƒ½æ˜¯åˆ·ç›˜ä¹ˆï¼Ÿå·®åˆ«åœ¨å“ªé‡Œï¼Ÿ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">1</span> <span class="token class-name">Byte</span> <span class="token operator">=</span> <span class="token number">8</span>bit
<span class="token number">1</span> <span class="token constant">KB</span> <span class="token operator">=</span> <span class="token number">1024</span> <span class="token class-name">Byte</span>
<span class="token number">1</span> <span class="token constant">MB</span> <span class="token operator">=</span> <span class="token number">1024</span> <span class="token constant">KB</span>
<span class="token number">1</span> <span class="token constant">GB</span> <span class="token operator">=</span> <span class="token number">1024</span> <span class="token constant">MB</span>
<span class="token number">1</span> <span class="token constant">TB</span> <span class="token operator">=</span> <span class="token number">1024</span> <span class="token constant">GB</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®é™…ä¸Šï¼Œæ•°æ®é¡µå¤§å°æ˜¯ <code>16KB</code>ï¼Œåˆ·ç›˜æ¯”è¾ƒè€—æ—¶ï¼Œå¯èƒ½å°±ä¿®æ”¹äº†æ•°æ®é¡µé‡Œçš„å‡  <code>Byte</code> æ•°æ®ï¼Œæœ‰å¿…è¦æŠŠå®Œæ•´çš„æ•°æ®é¡µåˆ·ç›˜å—ï¼Ÿ</p><p>è€Œä¸”æ•°æ®é¡µåˆ·ç›˜æ˜¯éšæœºå†™ï¼Œå› ä¸ºä¸€ä¸ªæ•°æ®é¡µå¯¹åº”çš„ä½ç½®å¯èƒ½åœ¨ç¡¬ç›˜æ–‡ä»¶çš„éšæœºä½ç½®ï¼Œæ‰€ä»¥æ€§èƒ½æ˜¯å¾ˆå·®ã€‚</p><p>å¦‚æœæ˜¯å†™ <code>redo log</code>ï¼Œä¸€è¡Œè®°å½•å¯èƒ½å°±å å‡ å <code>Byte</code>ï¼ŒåªåŒ…å«è¡¨ç©ºé—´å·ã€æ•°æ®é¡µå·ã€ç£ç›˜æ–‡ä»¶åç§» é‡ã€æ›´æ–°å€¼ï¼Œå†åŠ ä¸Šæ˜¯é¡ºåºå†™ï¼Œæ‰€ä»¥åˆ·ç›˜é€Ÿåº¦å¾ˆå¿«ã€‚</p><p>æ‰€ä»¥ç”¨ <code>redo log</code> å½¢å¼è®°å½•ä¿®æ”¹å†…å®¹ï¼Œæ€§èƒ½ä¼šè¿œè¿œè¶…è¿‡åˆ·æ•°æ®é¡µçš„æ–¹å¼ï¼Œè¿™ä¹Ÿè®©æ•°æ®åº“çš„å¹¶å‘èƒ½åŠ›æ›´å¼ºã€‚</p><blockquote><p>å…¶å®å†…å­˜çš„æ•°æ®é¡µåœ¨ä¸€å®šæ—¶æœºä¹Ÿä¼šåˆ·ç›˜ï¼Œæˆ‘ä»¬æŠŠè¿™ç§°ä¸ºé¡µåˆå¹¶ï¼Œè®² <code>Buffer Pool</code>çš„æ—¶å€™ä¼šå¯¹è¿™å—ç»†è¯´</p></blockquote><h4 id="binlog" tabindex="-1"><a class="header-anchor" href="#binlog" aria-hidden="true">#</a> binlog</h4><p><code>redo log</code> å®ƒæ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•å†…å®¹æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ï¼Œå±äº <code>InnoDB</code> å­˜å‚¨å¼•æ“ã€‚</p><p>è€Œ <code>binlog</code> æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•å†…å®¹æ˜¯è¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œç±»ä¼¼äºâ€œç»™ ID=2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1â€ï¼Œå±äº <code>MySQL Server</code> å±‚ã€‚</p><p>ä¸ç®¡ç”¨ä»€ä¹ˆå­˜å‚¨å¼•æ“ï¼Œåªè¦å‘ç”Ÿäº†è¡¨æ•°æ®æ›´æ–°ï¼Œéƒ½ä¼šäº§ç”Ÿ <code>binlog</code> æ—¥å¿—ã€‚</p><p>é‚£ <code>binlog</code> åˆ°åº•æ˜¯ç”¨æ¥å¹²å˜›çš„ï¼Ÿ</p><p>å¯ä»¥è¯´ <code>MySQL</code>æ•°æ®åº“çš„<strong>æ•°æ®å¤‡ä»½ã€ä¸»å¤‡ã€ä¸»ä¸»ã€ä¸»ä»</strong>éƒ½ç¦»ä¸å¼€ <code>binlog</code>ï¼Œéœ€è¦ä¾é  <code>binlog</code>æ¥åŒæ­¥æ•°æ®ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚</p><h5 id="è®°å½•æ ¼å¼" tabindex="-1"><a class="header-anchor" href="#è®°å½•æ ¼å¼" aria-hidden="true">#</a> è®°å½•æ ¼å¼</h5><p><code>binlog</code> æ—¥å¿—æœ‰ä¸‰ç§æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡ <code>binlog_format</code>å‚æ•°æŒ‡å®šã€‚</p><ul><li><strong>statement</strong></li><li><strong>row</strong></li><li><strong>mixed</strong></li></ul><p>æŒ‡å®š <code>statement</code>ï¼Œè®°å½•çš„å†…å®¹æ˜¯ <code>SQL</code>è¯­å¥åŸæ–‡ï¼Œæ¯”å¦‚æ‰§è¡Œä¸€æ¡ <code>update T set update_time=now() where id=1</code>ï¼Œè®°å½•çš„å†…å®¹å¦‚ä¸‹</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220404124818143-b306f70a.png" alt="image-20220706213326407" tabindex="0" loading="lazy"><figcaption>image-20220706213326407</figcaption></figure><p>åŒæ­¥æ•°æ®æ—¶ï¼Œä¼šæ‰§è¡Œè®°å½•çš„ <code>SQL</code>è¯­å¥ï¼Œä½†æ˜¯</p><p>æœ‰ä¸ªé—®é¢˜ï¼Œ<code>update_time=now()</code>è¿™é‡Œä¼šè·å–å½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œç›´æ¥æ‰§è¡Œä¼šå¯¼è‡´ä¸åŸåº“çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šä¸º <code>row</code>ï¼Œè®°å½•çš„å†…å®¹ä¸å†æ˜¯ç®€å•çš„ <code>SQL</code>è¯­å¥äº†ï¼Œè¿˜åŒ…å«æ“ä½œçš„å…·ä½“æ•°æ®ï¼Œè®°å½•å†…å®¹å¦‚ä¸‹</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220404124827143-edfddacd.png" alt="image-20220706213333425" tabindex="0" loading="lazy"><figcaption>image-20220706213333425</figcaption></figure><p><code>row</code>æ ¼å¼è®°å½•çš„å†…å®¹çœ‹ä¸åˆ°è¯¦ç»†ä¿¡æ¯ï¼Œè¦é€šè¿‡ <code>mysqlbinlog</code>å·¥å…·è§£æå‡ºæ¥ã€‚</p><p><code>update_time=now()</code>å˜æˆäº†å…·ä½“çš„æ—¶é—´ <code>update_time=1627112756247</code>ï¼Œæ¡ä»¶åé¢çš„@1ã€@2ã€@3 éƒ½æ˜¯è¯¥è¡Œæ•°æ®ç¬¬ 1 ä¸ª~3 ä¸ªå­—æ®µçš„åŸå§‹å€¼ï¼ˆ<strong>å‡è®¾è¿™å¼ è¡¨åªæœ‰ 3 ä¸ªå­—æ®µ</strong>ï¼‰ã€‚</p><p>è¿™æ ·å°±èƒ½ä¿è¯åŒæ­¥æ•°æ®çš„ä¸€è‡´æ€§ï¼Œé€šå¸¸æƒ…å†µä¸‹éƒ½æ˜¯æŒ‡å®šä¸º <code>row</code>ï¼Œè¿™æ ·å¯ä»¥ä¸ºæ•°æ®åº“çš„æ¢å¤ä¸åŒæ­¥å¸¦æ¥æ›´å¥½çš„å¯é æ€§ã€‚</p><p>ä½†æ˜¯è¿™ç§æ ¼å¼ï¼Œéœ€è¦æ›´å¤§çš„å®¹é‡æ¥è®°å½•ï¼Œæ¯”è¾ƒå ç”¨ç©ºé—´ï¼Œæ¢å¤ä¸åŒæ­¥æ—¶ä¼šæ›´æ¶ˆè€— <code>IO</code>èµ„æºï¼Œå½±å“æ‰§è¡Œé€Ÿåº¦ã€‚</p><p>æ‰€ä»¥å°±æœ‰äº†ä¸€ç§æŠ˜ä¸­çš„æ–¹æ¡ˆï¼ŒæŒ‡å®šä¸º <code>mixed</code>ï¼Œè®°å½•çš„å†…å®¹æ˜¯å‰ä¸¤è€…çš„æ··åˆã€‚</p><p><code>MySQL</code>ä¼šåˆ¤æ–­è¿™æ¡ <code>SQL</code>è¯­å¥æ˜¯å¦å¯èƒ½å¼•èµ·æ•°æ®ä¸ä¸€è‡´ï¼Œå¦‚æœæ˜¯ï¼Œå°±ç”¨ <code>row</code>æ ¼å¼ï¼Œå¦åˆ™å°±ç”¨ <code>statement</code>æ ¼å¼</p><h5 id="å†™å…¥æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#å†™å…¥æœºåˆ¶" aria-hidden="true">#</a> å†™å…¥æœºåˆ¶</h5><p><code>binlog</code>çš„å†™å…¥æ—¶æœºä¹Ÿéå¸¸ç®€å•ï¼Œäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…ˆæŠŠæ—¥å¿—å†™åˆ° <code>binlog cache</code>ï¼Œäº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œå†æŠŠ <code>binlog cache</code>å†™åˆ° <code>binlog</code>æ–‡ä»¶ä¸­ã€‚</p><p>å› ä¸ºä¸€ä¸ªäº‹åŠ¡çš„ <code>binlog</code>ä¸èƒ½è¢«æ‹†å¼€ï¼Œæ— è®ºè¿™ä¸ªäº‹åŠ¡å¤šå¤§ï¼Œä¹Ÿè¦ç¡®ä¿ä¸€æ¬¡æ€§å†™å…¥ï¼Œæ‰€ä»¥ç³»ç»Ÿä¼šç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªå—å†…å­˜ä½œä¸º <code>binlog cache</code>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>binlog_cache_size</code>å‚æ•°æ§åˆ¶å•ä¸ªçº¿ç¨‹ binlog cache å¤§å°ï¼Œå¦‚æœå­˜å‚¨å†…å®¹è¶…è¿‡äº†è¿™ä¸ªå‚æ•°ï¼Œå°±è¦æš‚å­˜åˆ°ç£ç›˜ï¼ˆ<code>Swap</code>ï¼‰ã€‚</p><p><code>binlog</code>æ—¥å¿—åˆ·ç›˜æµç¨‹å¦‚ä¸‹</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220404124853946-0dfdc7be.png" alt="image-20220706213409674" tabindex="0" loading="lazy"><figcaption>image-20220706213409674</figcaption></figure><ul><li><strong>ä¸Šå›¾çš„ writeï¼Œæ˜¯æŒ‡æŠŠæ—¥å¿—å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ page cacheï¼Œå¹¶æ²¡æœ‰æŠŠæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥é€Ÿåº¦æ¯”è¾ƒå¿«</strong></li><li><strong>ä¸Šå›¾çš„ fsyncï¼Œæ‰æ˜¯å°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜çš„æ“ä½œ</strong></li></ul><p><code>write</code>å’Œ <code>fsync</code>çš„æ—¶æœºï¼Œå¯ä»¥ç”±å‚æ•° <code>sync_binlog</code>æ§åˆ¶ï¼Œé»˜è®¤æ˜¯ <code>0</code>ã€‚</p><p>ä¸º <code>0</code>çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½åª <code>write</code>ï¼Œç”±ç³»ç»Ÿè‡ªè¡Œåˆ¤æ–­ä»€ä¹ˆæ—¶å€™æ‰§è¡Œ <code>fsync</code>ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220404124910100-7e64c232.png" alt="image-20220706213418556" tabindex="0" loading="lazy"><figcaption>image-20220706213418556</figcaption></figure><p>è™½ç„¶æ€§èƒ½å¾—åˆ°æå‡ï¼Œä½†æ˜¯æœºå™¨å®•æœºï¼Œ<code>page cache</code>é‡Œé¢çš„ binlog ä¼šä¸¢å¤±ã€‚</p><p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå¯ä»¥è®¾ç½®ä¸º <code>1</code>ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ä¼šæ‰§è¡Œ <code>fsync</code>ï¼Œå°±å¦‚åŒ <strong>redo log æ—¥å¿—åˆ·ç›˜æµç¨‹</strong> ä¸€æ ·ã€‚</p><p>æœ€åè¿˜æœ‰ä¸€ç§æŠ˜ä¸­æ–¹å¼ï¼Œå¯ä»¥è®¾ç½®ä¸º <code>N(N&gt;1)</code>ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ <code>write</code>ï¼Œä½†ç´¯ç§¯ <code>N</code>ä¸ªäº‹åŠ¡åæ‰ <code>fsync</code></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220404124922094-ae4904ec.png" alt="image-20220706213426711" tabindex="0" loading="lazy"><figcaption>image-20220706213426711</figcaption></figure><p>åœ¨å‡ºç° <code>IO</code>ç“¶é¢ˆçš„åœºæ™¯é‡Œï¼Œå°† <code>sync_binlog</code>è®¾ç½®æˆä¸€ä¸ªæ¯”è¾ƒå¤§çš„å€¼ï¼Œå¯ä»¥æå‡æ€§èƒ½ã€‚</p><p>åŒæ ·çš„ï¼Œå¦‚æœæœºå™¨å®•æœºï¼Œä¼šä¸¢å¤±æœ€è¿‘ <code>N</code>ä¸ªäº‹åŠ¡çš„ <code>binlog</code>æ—¥å¿—</p><h4 id="ä¸¤é˜¶æ®µæäº¤" tabindex="-1"><a class="header-anchor" href="#ä¸¤é˜¶æ®µæäº¤" aria-hidden="true">#</a> ä¸¤é˜¶æ®µæäº¤</h4><p><code>redo log</code>ï¼ˆé‡åšæ—¥å¿—ï¼‰è®© <code>InnoDB</code>å­˜å‚¨å¼•æ“æ‹¥æœ‰äº†å´©æºƒæ¢å¤èƒ½åŠ›ã€‚</p><p><code>binlog</code>ï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ä¿è¯äº† <code>MySQL</code>é›†ç¾¤æ¶æ„çš„æ•°æ®ä¸€è‡´æ€§ã€‚</p><p>è™½ç„¶å®ƒä»¬éƒ½å±äºæŒä¹…åŒ–çš„ä¿è¯ï¼Œä½†æ˜¯ä¾§é‡ç‚¹ä¸åŒã€‚</p><p>åœ¨æ‰§è¡Œæ›´æ–°è¯­å¥è¿‡ç¨‹ï¼Œä¼šè®°å½• <code>redo log</code>ä¸ <code>binlog</code>ä¸¤å—æ—¥å¿—ï¼Œä»¥åŸºæœ¬çš„äº‹åŠ¡ä¸ºå•ä½ï¼Œ<code>redo log</code>åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥ä¸æ–­å†™å…¥ï¼Œè€Œ <code>binlog</code>åªæœ‰åœ¨æäº¤äº‹åŠ¡æ—¶æ‰å†™å…¥ï¼Œæ‰€ä»¥ <code>redo log</code>ä¸ <code>binlog</code>çš„å†™å…¥æ—¶æœºä¸ä¸€æ ·ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213448142-0be195c9.png" alt="image-20220706213448142" tabindex="0" loading="lazy"><figcaption>image-20220706213448142</figcaption></figure><p>å›åˆ°æ­£é¢˜ï¼Œ<code>redo log</code>ä¸ <code>binlog</code>ä¸¤ä»½æ—¥å¿—ä¹‹é—´çš„é€»è¾‘ä¸ä¸€è‡´ï¼Œä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><p>æˆ‘ä»¬ä»¥ <code>update</code>è¯­å¥ä¸ºä¾‹ï¼Œå‡è®¾ <code>id=2</code>çš„è®°å½•ï¼Œå­—æ®µ <code>c</code>å€¼æ˜¯ <code>0</code>ï¼ŒæŠŠå­—æ®µ <code>c</code>å€¼æ›´æ–°æˆ <code>1</code>ï¼Œ<code>SQL</code>è¯­å¥ä¸º <code>update T set c=1 where id=2</code>ã€‚</p><p>å‡è®¾æ‰§è¡Œè¿‡ç¨‹ä¸­å†™å®Œ <code>redo log</code>æ—¥å¿—åï¼Œ<code>binlog</code>æ—¥å¿—å†™æœŸé—´å‘ç”Ÿäº†å¼‚å¸¸ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213523943-9a9b450f.png" alt="image-20220706213523943" tabindex="0" loading="lazy"><figcaption>image-20220706213523943</figcaption></figure><p>ç”±äº <code>binlog</code>æ²¡å†™å®Œå°±å¼‚å¸¸ï¼Œè¿™æ—¶å€™ <code>binlog</code>é‡Œé¢æ²¡æœ‰å¯¹åº”çš„ä¿®æ”¹è®°å½•ã€‚å› æ­¤ï¼Œä¹‹åç”¨ <code>binlog</code>æ—¥å¿—æ¢å¤æ•°æ®æ—¶ï¼Œå°±ä¼šå°‘è¿™ä¸€æ¬¡æ›´æ–°ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ <code>c</code>å€¼æ˜¯ <code>0</code>ï¼Œè€ŒåŸåº“å› ä¸º <code>redo log</code>æ—¥å¿—æ¢å¤ï¼Œè¿™ä¸€è¡Œ <code>c</code>å€¼æ˜¯ <code>1</code>ï¼Œæœ€ç»ˆæ•°æ®ä¸ä¸€è‡´ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213531140-21e5b288.png" alt="image-20220706213531140" tabindex="0" loading="lazy"><figcaption>image-20220706213531140</figcaption></figure><p>ä¸ºäº†è§£å†³ä¸¤ä»½æ—¥å¿—ä¹‹é—´çš„é€»è¾‘ä¸€è‡´é—®é¢˜ï¼Œ<code>InnoDB</code>å­˜å‚¨å¼•æ“ä½¿ç”¨<strong>ä¸¤é˜¶æ®µæäº¤</strong>æ–¹æ¡ˆã€‚</p><p>åŸç†å¾ˆç®€å•ï¼Œå°† <code>redo log</code>çš„å†™å…¥æ‹†æˆäº†ä¸¤ä¸ªæ­¥éª¤ <code>prepare</code>å’Œ <code>commit</code>ï¼Œè¿™å°±æ˜¯<strong>ä¸¤é˜¶æ®µæäº¤</strong>ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213538608-bee51f45.png" alt="image-20220706213538608" tabindex="0" loading="lazy"><figcaption>image-20220706213538608</figcaption></figure><p>ä½¿ç”¨<strong>ä¸¤é˜¶æ®µæäº¤</strong>åï¼Œå†™å…¥ <code>binlog</code>æ—¶å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¸ä¼šæœ‰å½±å“ï¼Œå› ä¸º <code>MySQL</code>æ ¹æ® <code>redo log</code>æ—¥å¿—æ¢å¤æ•°æ®æ—¶ï¼Œå‘ç° <code>redo log</code>è¿˜å¤„äº <code>prepare</code>é˜¶æ®µï¼Œå¹¶ä¸”æ²¡æœ‰å¯¹åº” <code>binlog</code>æ—¥å¿—ï¼Œå°±ä¼šå›æ»šè¯¥äº‹åŠ¡ã€‚<img src="/Computer-Science-Learn-Notes/assets/image-20220706213548852-4014b5ff.png" alt="image-20220706213548852" loading="lazy"></p><p>å†çœ‹ä¸€ä¸ªåœºæ™¯ï¼Œ<code>redo log</code>è®¾ç½® <code>commit</code>é˜¶æ®µå‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¼šä¸ä¼šå›æ»šäº‹åŠ¡å‘¢ï¼Ÿ</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213556183-80f2bd79.png" alt="image-20220706213556183" tabindex="0" loading="lazy"><figcaption>image-20220706213556183</figcaption></figure><p>å¹¶ä¸ä¼šå›æ»šäº‹åŠ¡ï¼Œå®ƒä¼šæ‰§è¡Œä¸Šå›¾æ¡†ä½çš„é€»è¾‘ï¼Œè™½ç„¶ <code>redo log</code>æ˜¯å¤„äº <code>prepare</code>é˜¶æ®µï¼Œä½†æ˜¯èƒ½é€šè¿‡äº‹åŠ¡ <code>id</code>æ‰¾åˆ°å¯¹åº”çš„ <code>binlog</code>æ—¥å¿—ï¼Œæ‰€ä»¥ <code>MySQL</code>è®¤ä¸ºæ˜¯å®Œæ•´çš„ï¼Œå°±ä¼šæäº¤äº‹åŠ¡æ¢å¤æ•°æ®</p><h4 id="undo-log" tabindex="-1"><a class="header-anchor" href="#undo-log" aria-hidden="true">#</a> undo log</h4><p>æˆ‘ä»¬åœ¨æ‰§è¡Œæ‰§è¡Œä¸€æ¡â€œå¢åˆ æ”¹â€è¯­å¥çš„æ—¶å€™ï¼Œè™½ç„¶æ²¡æœ‰è¾“å…¥ begin å¼€å¯äº‹åŠ¡å’Œ commit æäº¤äº‹åŠ¡ï¼Œä½†æ˜¯ MySQL ä¼š<strong>éšå¼å¼€å¯äº‹åŠ¡</strong>æ¥æ‰§è¡Œâ€œå¢åˆ æ”¹â€è¯­å¥çš„ï¼Œæ‰§è¡Œå®Œå°±è‡ªåŠ¨æäº¤äº‹åŠ¡çš„ï¼Œè¿™æ ·å°±ä¿è¯äº†æ‰§è¡Œå®Œâ€œå¢åˆ æ”¹â€è¯­å¥åï¼Œæˆ‘ä»¬å¯ä»¥åŠæ—¶åœ¨æ•°æ®åº“è¡¨çœ‹åˆ°â€œå¢åˆ æ”¹â€çš„ç»“æœäº†ã€‚</p><p>æ‰§è¡Œä¸€æ¡è¯­å¥æ˜¯å¦è‡ªåŠ¨æäº¤äº‹åŠ¡ï¼Œæ˜¯ç”± <code>autocommit</code> å‚æ•°å†³å®šçš„ï¼Œé»˜è®¤æ˜¯å¼€å¯ã€‚æ‰€ä»¥ï¼Œæ‰§è¡Œä¸€æ¡ update è¯­å¥ä¹Ÿæ˜¯ä¼šä½¿ç”¨äº‹åŠ¡çš„ã€‚</p><p>é‚£ä¹ˆï¼Œè€ƒè™‘ä¸€ä¸ªé—®é¢˜ã€‚ä¸€ä¸ªäº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œåœ¨è¿˜æ²¡æœ‰æäº¤äº‹åŠ¡ä¹‹å‰ï¼Œå¦‚æœMySQL å‘ç”Ÿäº†å´©æºƒï¼Œè¦æ€ä¹ˆå›æ»šåˆ°äº‹åŠ¡ä¹‹å‰çš„æ•°æ®å‘¢ï¼Ÿ</p><p>å¦‚æœæˆ‘ä»¬æ¯æ¬¡åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéƒ½è®°å½•ä¸‹å›æ»šæ—¶éœ€è¦çš„ä¿¡æ¯åˆ°ä¸€ä¸ªæ—¥å¿—é‡Œï¼Œé‚£ä¹ˆåœ¨äº‹åŠ¡æ‰§è¡Œä¸­é€”å‘ç”Ÿäº† MySQL å´©æºƒåï¼Œå°±ä¸ç”¨æ‹…å¿ƒæ— æ³•å›æ»šåˆ°äº‹åŠ¡ä¹‹å‰çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ—¥å¿—å›æ»šåˆ°äº‹åŠ¡ä¹‹å‰çš„æ•°æ®ã€‚</p><p>å®ç°è¿™ä¸€æœºåˆ¶å°±æ˜¯ <strong>undo logï¼ˆå›æ»šæ—¥å¿—ï¼‰ï¼Œå®ƒä¿è¯äº†äº‹åŠ¡çš„ ACID ç‰¹æ€§ (opens new window)ä¸­çš„åŸå­æ€§ï¼ˆAtomicityï¼‰ã€‚</strong></p><p>undo log æ˜¯ä¸€ç§ç”¨äºæ’¤é”€å›é€€çš„æ—¥å¿—ã€‚åœ¨äº‹åŠ¡æ²¡æäº¤ä¹‹å‰ï¼ŒMySQL ä¼šå…ˆè®°å½•æ›´æ–°å‰çš„æ•°æ®åˆ° undo log æ—¥å¿—æ–‡ä»¶é‡Œé¢ï¼Œå½“äº‹åŠ¡å›æ»šæ—¶ï¼Œå¯ä»¥åˆ©ç”¨ undo log æ¥è¿›è¡Œå›æ»šã€‚å¦‚ä¸‹å›¾ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213728255-a75bea9a.png" alt="image-20220706213728255" tabindex="0" loading="lazy"><figcaption>image-20220706213728255</figcaption></figure><p>æ¯å½“ InnoDB å¼•æ“å¯¹ä¸€æ¡è®°å½•è¿›è¡Œæ“ä½œï¼ˆä¿®æ”¹ã€åˆ é™¤ã€æ–°å¢ï¼‰æ—¶ï¼Œè¦æŠŠå›æ»šæ—¶éœ€è¦çš„ä¿¡æ¯éƒ½è®°å½•åˆ° undo log é‡Œï¼Œæ¯”å¦‚ï¼š</p><ul><li>åœ¨<strong>æ’å…¥</strong>ä¸€æ¡è®°å½•æ—¶ï¼Œè¦æŠŠè¿™æ¡è®°å½•çš„ä¸»é”®å€¼è®°ä¸‹æ¥ï¼Œè¿™æ ·ä¹‹åå›æ»šæ—¶åªéœ€è¦æŠŠè¿™ä¸ªä¸»é”®å€¼å¯¹åº”çš„è®°å½•<strong>åˆ æ‰</strong>å°±å¥½äº†ï¼›</li><li>åœ¨<strong>åˆ é™¤</strong>ä¸€æ¡è®°å½•æ—¶ï¼Œè¦æŠŠè¿™æ¡è®°å½•ä¸­çš„å†…å®¹éƒ½è®°ä¸‹æ¥ï¼Œè¿™æ ·ä¹‹åå›æ»šæ—¶å†æŠŠç”±è¿™äº›å†…å®¹ç»„æˆçš„è®°å½•<strong>æ’å…¥</strong>åˆ°è¡¨ä¸­å°±å¥½äº†ï¼›</li><li>åœ¨<strong>æ›´æ–°</strong>ä¸€æ¡è®°å½•æ—¶ï¼Œè¦æŠŠè¢«æ›´æ–°çš„åˆ—çš„æ—§å€¼è®°ä¸‹æ¥ï¼Œè¿™æ ·ä¹‹åå›æ»šæ—¶å†æŠŠè¿™äº›åˆ—<strong>æ›´æ–°ä¸ºæ—§å€¼</strong>å°±å¥½äº†ã€‚</li></ul><p>åœ¨å‘ç”Ÿå›æ»šæ—¶ï¼Œå°±è¯»å– undo log é‡Œçš„æ•°æ®ï¼Œç„¶ååšåŸå…ˆç›¸åæ“ä½œã€‚æ¯”å¦‚å½“ delete ä¸€æ¡è®°å½•æ—¶ï¼Œundo log ä¸­ä¼šæŠŠè®°å½•ä¸­çš„å†…å®¹éƒ½è®°ä¸‹æ¥ï¼Œç„¶åæ‰§è¡Œå›æ»šæ“ä½œçš„æ—¶å€™ï¼Œå°±è¯»å– undo log é‡Œçš„æ•°æ®ï¼Œç„¶åè¿›è¡Œ insert æ“ä½œã€‚</p><p>ä¸åŒçš„æ“ä½œï¼Œéœ€è¦è®°å½•çš„å†…å®¹ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥ä¸åŒç±»å‹çš„æ“ä½œï¼ˆä¿®æ”¹ã€åˆ é™¤ã€æ–°å¢ï¼‰äº§ç”Ÿçš„ undo log çš„æ ¼å¼ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œå…·ä½“çš„æ¯ä¸€ä¸ªæ“ä½œçš„ undo log çš„æ ¼å¼æˆ‘å°±ä¸è¯¦ç»†ä»‹ç»äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»æŸ¥æŸ¥ã€‚</p><p>ä¸€æ¡è®°å½•çš„æ¯ä¸€æ¬¡æ›´æ–°æ“ä½œäº§ç”Ÿçš„ undo log æ ¼å¼éƒ½æœ‰ä¸€ä¸ª roll_pointer æŒ‡é’ˆå’Œä¸€ä¸ª trx_id äº‹åŠ¡idï¼š</p><ul><li>é€šè¿‡ trx_id å¯ä»¥çŸ¥é“è¯¥è®°å½•æ˜¯è¢«å“ªä¸ªäº‹åŠ¡ä¿®æ”¹çš„ï¼›</li><li>é€šè¿‡ roll_pointer æŒ‡é’ˆå¯ä»¥å°†è¿™äº› undo log ä¸²æˆä¸€ä¸ªé“¾è¡¨ï¼Œè¿™ä¸ªé“¾è¡¨å°±è¢«ç§°ä¸ºç‰ˆæœ¬é“¾ï¼›</li></ul><p>ç‰ˆæœ¬é“¾å¦‚ä¸‹å›¾ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706213736248-663bea2f.png" alt="image-20220706213736248" tabindex="0" loading="lazy"><figcaption>image-20220706213736248</figcaption></figure><p>å¦å¤–ï¼Œ<strong>undo log è¿˜æœ‰ä¸€ä¸ªä½œç”¨ï¼Œé€šè¿‡ ReadView + undo log å®ç° MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰</strong>ã€‚</p><p>å¯¹äºã€Œè¯»æäº¤ã€å’Œã€Œå¯é‡å¤è¯»ã€éš”ç¦»çº§åˆ«çš„äº‹åŠ¡æ¥è¯´ï¼Œå®ƒä»¬çš„å¿«ç…§è¯»ï¼ˆæ™®é€š select è¯­å¥ï¼‰æ˜¯é€šè¿‡ Read View + undo log æ¥å®ç°çš„ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºåˆ›å»º Read View çš„æ—¶æœºä¸åŒï¼š</p><ul><li>ã€Œè¯»æäº¤ã€éš”ç¦»çº§åˆ«æ˜¯åœ¨æ¯ä¸ª select éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ Read Viewï¼Œä¹Ÿæ„å‘³ç€ï¼Œäº‹åŠ¡æœŸé—´çš„å¤šæ¬¡è¯»å–åŒä¸€æ¡æ•°æ®ï¼Œå‰åä¸¤æ¬¡è¯»çš„æ•°æ®å¯èƒ½ä¼šå‡ºç°ä¸ä¸€è‡´ï¼Œå› ä¸ºå¯èƒ½è¿™æœŸé—´å¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹äº†è¯¥è®°å½•ï¼Œå¹¶æäº¤äº†äº‹åŠ¡ã€‚</li><li>ã€Œå¯é‡å¤è¯»ã€éš”ç¦»çº§åˆ«æ˜¯å¯åŠ¨äº‹åŠ¡æ—¶ç”Ÿæˆä¸€ä¸ª Read Viewï¼Œç„¶åæ•´ä¸ªäº‹åŠ¡æœŸé—´éƒ½åœ¨ç”¨è¿™ä¸ª Read Viewï¼Œè¿™æ ·å°±ä¿è¯äº†åœ¨äº‹åŠ¡æœŸé—´è¯»åˆ°çš„æ•°æ®éƒ½æ˜¯äº‹åŠ¡å¯åŠ¨å‰çš„è®°å½•ã€‚</li></ul><p>è¿™ä¸¤ä¸ªéš”ç¦»çº§åˆ«å®ç°æ˜¯é€šè¿‡ã€Œäº‹åŠ¡çš„ Read View é‡Œçš„å­—æ®µã€å’Œã€Œè®°å½•ä¸­çš„ä¸¤ä¸ªéšè—åˆ—ï¼ˆtrx_id å’Œ roll_pointerï¼‰ã€çš„æ¯”å¯¹ï¼Œå¦‚æœä¸æ»¡è¶³å¯è§è¡Œï¼Œå°±ä¼šé¡ºç€ undo log ç‰ˆæœ¬é“¾é‡Œæ‰¾åˆ°æ»¡è¶³å…¶å¯è§æ€§çš„è®°å½•ï¼Œä»è€Œæ§åˆ¶å¹¶å‘äº‹åŠ¡è®¿é—®åŒä¸€ä¸ªè®°å½•æ—¶çš„è¡Œä¸ºï¼Œè¿™å°±å« MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰ã€‚å…·ä½“çš„å®ç°å¯ä»¥çœ‹ï¼š<a href="https://xiaolincoding.com/mysql/transaction/mvcc.html#%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%9C%89%E5%93%AA%E4%BA%9B" target="_blank" rel="noopener noreferrer">äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯æ€ä¹ˆå®ç°çš„<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Ÿ å› æ­¤ï¼Œundo log ä¸¤å¤§ä½œç”¨ï¼š</p><ul><li><strong>å®ç°äº‹åŠ¡å›æ»šï¼Œä¿éšœäº‹åŠ¡çš„åŸå­æ€§</strong>ã€‚äº‹åŠ¡å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‡ºç°äº†é”™è¯¯æˆ–è€…ç”¨æˆ·æ‰§ è¡Œäº† ROLLBACK è¯­å¥ï¼ŒMySQL å¯ä»¥åˆ©ç”¨ undo log ä¸­çš„å†å²æ•°æ®å°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€ã€‚</li><li><strong>å®ç° MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰å…³é”®å› ç´ ä¹‹ä¸€</strong>ã€‚MVCC æ˜¯é€šè¿‡ ReadView + undo log å®ç°çš„ã€‚undo log ä¸ºæ¯æ¡è®°å½•ä¿å­˜å¤šä»½å†å²æ•°æ®ï¼ŒMySQL åœ¨æ‰§è¡Œå¿«ç…§è¯»ï¼ˆæ™®é€š select è¯­å¥ï¼‰çš„æ—¶å€™ï¼Œä¼šæ ¹æ®äº‹åŠ¡çš„ Read View é‡Œçš„ä¿¡æ¯ï¼Œé¡ºç€ undo log çš„ç‰ˆæœ¬é“¾æ‰¾åˆ°æ»¡è¶³å…¶å¯è§æ€§çš„è®°å½•ã€‚</li></ul><h3 id="å›¾è§£mvcc" tabindex="-1"><a class="header-anchor" href="#å›¾è§£mvcc" aria-hidden="true">#</a> å›¾è§£MVCC</h3><p>çº²è¦ï¼š</p><ul><li>å½“å‰è¯»å’Œå¿«ç…§è¯»çš„æ¦‚å¿µ</li><li>äº‹åŠ¡éš”ç¦»çº§åˆ«</li><li>MVCC çš„ä¸¤ä¸ªæ¦‚å¿µ <ul><li>ç‰ˆæœ¬é“¾</li><li>è¯»è§†å›¾ï¼ˆè¯»å·²æäº¤å’Œå¯é‡å¤è¯»ï¼‰</li></ul></li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706231641283-61b4f4ba.png" alt="image-20220706231641283" tabindex="0" loading="lazy"><figcaption>image-20220706231641283</figcaption></figure><ul><li>å½“ç†è§£äº†ä¸Šè¿°æ¦‚å¿µå¯ä»¥å¯¹æ­¤ä¾‹å­è¿›è¡ŒåŠ æ·±ç†è§£</li></ul><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220706220605710-e83a663d.png" alt="image-20220706220605710" tabindex="0" loading="lazy"><figcaption>image-20220706220605710</figcaption></figure><h3 id="innodbå­˜å‚¨å¼•æ“å¯¹mvccçš„å®ç°" tabindex="-1"><a class="header-anchor" href="#innodbå­˜å‚¨å¼•æ“å¯¹mvccçš„å®ç°" aria-hidden="true">#</a> InnoDBå­˜å‚¨å¼•æ“å¯¹MVCCçš„å®ç°</h3><p>MVCC çš„å®ç°ä¾èµ–äºï¼šéšè—å­—æ®µã€Read Viewã€undo logã€‚åœ¨å†…éƒ¨å®ç°ä¸­ï¼ŒInnoDB é€šè¿‡æ•°æ®è¡Œçš„ DB_TRX_ID å’Œ Read View æ¥åˆ¤æ–­æ•°æ®çš„å¯è§æ€§ï¼Œå¦‚ä¸å¯è§ï¼Œåˆ™é€šè¿‡æ•°æ®è¡Œçš„ DB_ROLL_PTR æ‰¾åˆ° undo log ä¸­çš„å†å²ç‰ˆæœ¬ã€‚æ¯ä¸ªäº‹åŠ¡è¯»åˆ°çš„æ•°æ®ç‰ˆæœ¬å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œç”¨æˆ·åªèƒ½çœ‹åˆ°è¯¥äº‹åŠ¡åˆ›å»º Read View ä¹‹å‰å·²ç»æäº¤çš„ä¿®æ”¹å’Œè¯¥äº‹åŠ¡æœ¬èº«åšçš„ä¿®æ”¹</p><h4 id="éšè—å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#éšè—å­—æ®µ" aria-hidden="true">#</a> éšè—å­—æ®µ</h4><p>åœ¨å†…éƒ¨ï¼Œ<code>InnoDB</code> å­˜å‚¨å¼•æ“ä¸ºæ¯è¡Œæ•°æ®æ·»åŠ äº†ä¸‰ä¸ª <a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-multi-versioning.html" target="_blank" rel="noopener noreferrer">éšè—å­—æ®µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ï¼š</p><ul><li><code>DB_TRX_IDï¼ˆ6å­—èŠ‚ï¼‰</code>ï¼šè¡¨ç¤ºæœ€åä¸€æ¬¡æ’å…¥æˆ–æ›´æ–°è¯¥è¡Œçš„äº‹åŠ¡ idã€‚æ­¤å¤–ï¼Œ<code>delete</code> æ“ä½œåœ¨å†…éƒ¨è¢«è§†ä¸ºæ›´æ–°ï¼Œåªä¸è¿‡ä¼šåœ¨è®°å½•å¤´ <code>Record header</code> ä¸­çš„ <code>deleted_flag</code> å­—æ®µå°†å…¶æ ‡è®°ä¸ºå·²åˆ é™¤</li><li><code>DB_ROLL_PTRï¼ˆ7å­—èŠ‚ï¼‰</code> å›æ»šæŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥è¡Œçš„ <code>undo log</code> ã€‚å¦‚æœè¯¥è¡Œæœªè¢«æ›´æ–°ï¼Œåˆ™ä¸ºç©º</li><li><code>DB_ROW_IDï¼ˆ6å­—èŠ‚ï¼‰</code>ï¼šå¦‚æœæ²¡æœ‰è®¾ç½®ä¸»é”®ä¸”è¯¥è¡¨æ²¡æœ‰å”¯ä¸€éç©ºç´¢å¼•æ—¶ï¼Œ<code>InnoDB</code> ä¼šä½¿ç”¨è¯¥ id æ¥ç”Ÿæˆèšç°‡ç´¢å¼•</li></ul><h4 id="readview" tabindex="-1"><a class="header-anchor" href="#readview" aria-hidden="true">#</a> ReadView</h4><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code>class ReadView <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
private<span class="token operator">:</span>
  <span class="token class-name">trx_id_t</span> m_low_limit_id<span class="token punctuation">;</span>      <span class="token comment">/* å¤§äºç­‰äºè¿™ä¸ª ID çš„äº‹åŠ¡å‡ä¸å¯è§ */</span>

  <span class="token class-name">trx_id_t</span> m_up_limit_id<span class="token punctuation">;</span>       <span class="token comment">/* å°äºè¿™ä¸ª ID çš„äº‹åŠ¡å‡å¯è§ */</span>

  <span class="token class-name">trx_id_t</span> m_creator_trx_id<span class="token punctuation">;</span>    <span class="token comment">/* åˆ›å»ºè¯¥ Read View çš„äº‹åŠ¡ID */</span>

  <span class="token class-name">trx_id_t</span> m_low_limit_no<span class="token punctuation">;</span>      <span class="token comment">/* äº‹åŠ¡ Number, å°äºè¯¥ Number çš„ Undo Logs å‡å¯ä»¥è¢« Purge */</span>

  <span class="token class-name">ids_t</span> m_ids<span class="token punctuation">;</span>                  <span class="token comment">/* åˆ›å»º Read View æ—¶çš„æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ */</span>

  m_closed<span class="token punctuation">;</span>                     <span class="token comment">/* æ ‡è®° Read View æ˜¯å¦ close */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Read Viewä¸»è¦æ˜¯ç”¨æ¥åšå¯è§æ€§åˆ¤æ–­ï¼Œé‡Œé¢ä¿å­˜äº† â€œå½“å‰å¯¹æœ¬äº‹åŠ¡ä¸å¯è§çš„å…¶ä»–æ´»è·ƒäº‹åŠ¡â€</p><p>ä¸»è¦æœ‰ä»¥ä¸‹å­—æ®µï¼š</p><ul><li><code>m_low_limit_id</code>ï¼šç›®å‰å‡ºç°è¿‡çš„æœ€å¤§çš„äº‹åŠ¡ ID+1ï¼Œå³ä¸‹ä¸€ä¸ªå°†è¢«åˆ†é…çš„äº‹åŠ¡ IDã€‚å¤§äºç­‰äºè¿™ä¸ª ID çš„æ•°æ®ç‰ˆæœ¬å‡ä¸å¯è§</li><li><code>m_up_limit_id</code>ï¼šæ´»è·ƒäº‹åŠ¡åˆ—è¡¨ <code>m_ids</code> ä¸­æœ€å°çš„äº‹åŠ¡ IDï¼Œå¦‚æœ <code>m_ids</code> ä¸ºç©ºï¼Œåˆ™ <code>m_up_limit_id</code> ä¸º <code>m_low_limit_id</code>ã€‚å°äºè¿™ä¸ª ID çš„æ•°æ®ç‰ˆæœ¬å‡å¯è§</li><li><code>m_ids</code>ï¼š<code>Read View</code> åˆ›å»ºæ—¶å…¶ä»–æœªæäº¤çš„æ´»è·ƒäº‹åŠ¡ ID åˆ—è¡¨ã€‚åˆ›å»º <code>Read View</code>æ—¶ï¼Œå°†å½“å‰æœªæäº¤äº‹åŠ¡ ID è®°å½•ä¸‹æ¥ï¼Œåç»­å³ä½¿å®ƒä»¬ä¿®æ”¹äº†è®°å½•è¡Œçš„å€¼ï¼Œå¯¹äºå½“å‰äº‹åŠ¡ä¹Ÿæ˜¯ä¸å¯è§çš„ã€‚<code>m_ids</code> ä¸åŒ…æ‹¬å½“å‰äº‹åŠ¡è‡ªå·±å’Œå·²æäº¤çš„äº‹åŠ¡ï¼ˆæ­£åœ¨å†…å­˜ä¸­ï¼‰</li><li><code>m_creator_trx_id</code>ï¼šåˆ›å»ºè¯¥ <code>Read View</code> çš„äº‹åŠ¡ ID</li></ul><p><strong>äº‹åŠ¡å¯è§æ€§ç¤ºæ„å›¾</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220711215228405-23805717.png" alt="image-20220711215228405" tabindex="0" loading="lazy"><figcaption>image-20220711215228405</figcaption></figure><h4 id="undo-log-1" tabindex="-1"><a class="header-anchor" href="#undo-log-1" aria-hidden="true">#</a> undo-log</h4><p><code>undo log</code> ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</p><ul><li>å½“äº‹åŠ¡å›æ»šæ—¶ç”¨äºå°†æ•°æ®æ¢å¤åˆ°ä¿®æ”¹å‰çš„æ ·å­</li><li>å¦ä¸€ä¸ªä½œç”¨æ˜¯ <code>MVCC</code> ï¼Œå½“è¯»å–è®°å½•æ—¶ï¼Œè‹¥è¯¥è®°å½•è¢«å…¶ä»–äº‹åŠ¡å ç”¨æˆ–å½“å‰ç‰ˆæœ¬å¯¹è¯¥äº‹åŠ¡ä¸å¯è§ï¼Œåˆ™å¯ä»¥é€šè¿‡ <code>undo log</code> è¯»å–ä¹‹å‰çš„ç‰ˆæœ¬æ•°æ®ï¼Œä»¥æ­¤å®ç°éé”å®šè¯»</li></ul><p><strong>åœ¨ <code>InnoDB</code> å­˜å‚¨å¼•æ“ä¸­ <code>undo log</code> åˆ†ä¸ºä¸¤ç§ï¼š <code>insert undo log</code> å’Œ <code>update undo log</code>ï¼š</strong></p><ol><li><strong><code>insert undo log</code></strong> ï¼šæŒ‡åœ¨ <code>insert</code> æ“ä½œä¸­äº§ç”Ÿçš„ <code>undo log</code>ã€‚å› ä¸º <code>insert</code> æ“ä½œçš„è®°å½•åªå¯¹äº‹åŠ¡æœ¬èº«å¯è§ï¼Œå¯¹å…¶ä»–äº‹åŠ¡ä¸å¯è§ï¼Œæ•…è¯¥ <code>undo log</code> å¯ä»¥åœ¨äº‹åŠ¡æäº¤åç›´æ¥åˆ é™¤ã€‚ä¸éœ€è¦è¿›è¡Œ <code>purge</code> æ“ä½œ</li></ol><p><strong><code>insert</code> æ—¶çš„æ•°æ®åˆå§‹çŠ¶æ€ï¼š</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220711215325716-79d58152.png" alt="image-20220711215325716" tabindex="0" loading="lazy"><figcaption>image-20220711215325716</figcaption></figure><ol start="2"><li><strong><code>update undo log</code></strong> ï¼š<code>update</code> æˆ– <code>delete</code> æ“ä½œä¸­äº§ç”Ÿçš„ <code>undo log</code>ã€‚è¯¥ <code>undo log</code>å¯èƒ½éœ€è¦æä¾› <code>MVCC</code> æœºåˆ¶ï¼Œå› æ­¤ä¸èƒ½åœ¨äº‹åŠ¡æäº¤æ—¶å°±è¿›è¡Œåˆ é™¤ã€‚æäº¤æ—¶æ”¾å…¥ <code>undo log</code> é“¾è¡¨ï¼Œç­‰å¾… <code>purgeçº¿ç¨‹</code> è¿›è¡Œæœ€åçš„åˆ é™¤</li></ol><p><strong>æ•°æ®ç¬¬ä¸€æ¬¡è¢«ä¿®æ”¹æ—¶ï¼š</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220711215339796-4d3b82fc.png" alt="image-20220711215339796" tabindex="0" loading="lazy"><figcaption>image-20220711215339796</figcaption></figure><p><strong>æ•°æ®ç¬¬äºŒæ¬¡è¢«ä¿®æ”¹æ—¶ï¼š</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220711215345905-8c79b116.png" alt="image-20220711215345905" tabindex="0" loading="lazy"><figcaption>image-20220711215345905</figcaption></figure><p>ä¸åŒäº‹åŠ¡æˆ–è€…ç›¸åŒäº‹åŠ¡çš„å¯¹åŒä¸€è®°å½•è¡Œçš„ä¿®æ”¹ï¼Œä¼šä½¿è¯¥è®°å½•è¡Œçš„ <code>undo log</code> æˆä¸ºä¸€æ¡é“¾è¡¨ï¼Œé“¾é¦–å°±æ˜¯æœ€æ–°çš„è®°å½•ï¼Œé“¾å°¾å°±æ˜¯æœ€æ—©çš„æ—§è®°å½•</p><h4 id="æ•°æ®å¯è§æ€§ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#æ•°æ®å¯è§æ€§ç®—æ³•" aria-hidden="true">#</a> æ•°æ®å¯è§æ€§ç®—æ³•</h4><p>åœ¨ <code>InnoDB</code> å­˜å‚¨å¼•æ“ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡åï¼Œæ‰§è¡Œæ¯ä¸ª <code>select</code> è¯­å¥å‰ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼ˆRead Viewï¼‰ï¼Œ<strong>å¿«ç…§ä¸­ä¿å­˜äº†å½“å‰æ•°æ®åº“ç³»ç»Ÿä¸­æ­£å¤„äºæ´»è·ƒï¼ˆæ²¡æœ‰ commitï¼‰çš„äº‹åŠ¡çš„ ID å·</strong>ã€‚å…¶å®ç®€å•çš„è¯´ä¿å­˜çš„æ˜¯ç³»ç»Ÿä¸­å½“å‰ä¸åº”è¯¥è¢«æœ¬äº‹åŠ¡çœ‹åˆ°çš„å…¶ä»–äº‹åŠ¡ ID åˆ—è¡¨ï¼ˆå³ m_idsï¼‰ã€‚å½“ç”¨æˆ·åœ¨è¿™ä¸ªäº‹åŠ¡ä¸­è¦è¯»å–æŸä¸ªè®°å½•è¡Œçš„æ—¶å€™ï¼Œ<code>InnoDB</code> ä¼šå°†è¯¥è®°å½•è¡Œçš„ <code>DB_TRX_ID</code> ä¸ <code>Read View</code> ä¸­çš„ä¸€äº›å˜é‡åŠå½“å‰äº‹åŠ¡ ID è¿›è¡Œæ¯”è¾ƒï¼Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³å¯è§æ€§æ¡ä»¶</p><p>å…·ä½“çš„æ¯”è¾ƒç®—æ³•å¦‚ä¸‹</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220711215410118-3fb3b6f8.png" alt="image-20220711215410118" tabindex="0" loading="lazy"><figcaption>image-20220711215410118</figcaption></figure><ol><li>å¦‚æœè®°å½• DB_TRX_ID &lt; m_up_limit_idï¼Œé‚£ä¹ˆè¡¨æ˜æœ€æ–°ä¿®æ”¹è¯¥è¡Œçš„äº‹åŠ¡ï¼ˆDB_TRX_IDï¼‰åœ¨å½“å‰äº‹åŠ¡åˆ›å»ºå¿«ç…§ä¹‹å‰å°±æäº¤äº†ï¼Œæ‰€ä»¥è¯¥è®°å½•è¡Œçš„å€¼å¯¹å½“å‰äº‹åŠ¡æ˜¯å¯è§çš„</li><li>å¦‚æœ DB_TRX_ID &gt;= m_low_limit_idï¼Œé‚£ä¹ˆè¡¨æ˜æœ€æ–°ä¿®æ”¹è¯¥è¡Œçš„äº‹åŠ¡ï¼ˆDB_TRX_IDï¼‰åœ¨å½“å‰äº‹åŠ¡åˆ›å»ºå¿«ç…§ä¹‹åæ‰ä¿®æ”¹è¯¥è¡Œï¼Œæ‰€ä»¥è¯¥è®°å½•è¡Œçš„å€¼å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚è·³åˆ°æ­¥éª¤ 5</li><li>m_ids ä¸ºç©ºï¼Œåˆ™è¡¨æ˜åœ¨å½“å‰äº‹åŠ¡åˆ›å»ºå¿«ç…§ä¹‹å‰ï¼Œä¿®æ”¹è¯¥è¡Œçš„äº‹åŠ¡å°±å·²ç»æäº¤äº†ï¼Œæ‰€ä»¥è¯¥è®°å½•è¡Œçš„å€¼å¯¹å½“å‰äº‹åŠ¡æ˜¯å¯è§çš„</li><li>å¦‚æœ m_up_limit_id &lt;= DB_TRX_ID &lt; m_low_limit_idï¼Œè¡¨æ˜æœ€æ–°ä¿®æ”¹è¯¥è¡Œçš„äº‹åŠ¡ï¼ˆDB_TRX_IDï¼‰åœ¨å½“å‰äº‹åŠ¡åˆ›å»ºå¿«ç…§çš„æ—¶å€™å¯èƒ½å¤„äºâ€œæ´»åŠ¨çŠ¶æ€â€æˆ–è€…â€œå·²æäº¤çŠ¶æ€â€ï¼›æ‰€ä»¥å°±è¦å¯¹æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ m_ids è¿›è¡ŒæŸ¥æ‰¾ï¼ˆæºç ä¸­æ˜¯ç”¨çš„äºŒåˆ†æŸ¥æ‰¾ï¼Œå› ä¸ºæ˜¯æœ‰åºçš„ï¼‰ <ul><li>å¦‚æœåœ¨æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ m_ids ä¸­èƒ½æ‰¾åˆ° DB_TRX_IDï¼Œè¡¨æ˜ï¼šâ‘  åœ¨å½“å‰äº‹åŠ¡åˆ›å»ºå¿«ç…§å‰ï¼Œè¯¥è®°å½•è¡Œçš„å€¼è¢«äº‹åŠ¡ ID ä¸º DB_TRX_ID çš„äº‹åŠ¡ä¿®æ”¹äº†ï¼Œä½†æ²¡æœ‰æäº¤ï¼›æˆ–è€… â‘¡ åœ¨å½“å‰äº‹åŠ¡åˆ›å»ºå¿«ç…§åï¼Œè¯¥è®°å½•è¡Œçš„å€¼è¢«äº‹åŠ¡ ID ä¸º DB_TRX_ID çš„äº‹åŠ¡ä¿®æ”¹äº†ã€‚è¿™äº›æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè®°å½•è¡Œçš„å€¼å¯¹å½“å‰äº‹åŠ¡éƒ½æ˜¯ä¸å¯è§çš„ã€‚è·³åˆ°æ­¥éª¤ 5</li><li>åœ¨æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ä¸­æ‰¾ä¸åˆ°ï¼Œåˆ™è¡¨æ˜â€œid ä¸º trx_id çš„äº‹åŠ¡â€åœ¨ä¿®æ”¹â€œè¯¥è®°å½•è¡Œçš„å€¼â€åï¼Œåœ¨â€œå½“å‰äº‹åŠ¡â€åˆ›å»ºå¿«ç…§å‰å°±å·²ç»æäº¤äº†ï¼Œæ‰€ä»¥è®°å½•è¡Œå¯¹å½“å‰äº‹åŠ¡å¯è§</li></ul></li><li>åœ¨è¯¥è®°å½•è¡Œçš„ DB_ROLL_PTR æŒ‡é’ˆæ‰€æŒ‡å‘çš„ <code>undo log</code> å–å‡ºå¿«ç…§è®°å½•ï¼Œç”¨å¿«ç…§è®°å½•çš„ DB_TRX_ID è·³åˆ°æ­¥éª¤ 1 é‡æ–°å¼€å§‹åˆ¤æ–­ï¼Œç›´åˆ°æ‰¾åˆ°æ»¡è¶³çš„å¿«ç…§ç‰ˆæœ¬æˆ–è¿”å›ç©º</li></ol><h3 id="mysqlæœ‰å‡ ç§é«˜å¯ç”¨æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#mysqlæœ‰å‡ ç§é«˜å¯ç”¨æ–¹æ¡ˆ" aria-hidden="true">#</a> MySQLæœ‰å‡ ç§é«˜å¯ç”¨æ–¹æ¡ˆ</h3><ul><li>ä¸»ä»æˆ–ä¸»ä¸»åŠåŒæ­¥å¤åˆ¶</li><li>åŠåŒæ­¥å¤åˆ¶ä¼˜åŒ–</li><li>é«˜å¯ç”¨æ¶æ„ä¼˜åŒ–</li><li>å…±äº«å­˜å‚¨</li><li>åˆ†å¸ƒå¼åè®®</li></ul><h4 id="ä¸»ä»æˆ–ä¸»ä¸»åŠåŒæ­¥å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#ä¸»ä»æˆ–ä¸»ä¸»åŠåŒæ­¥å¤åˆ¶" aria-hidden="true">#</a> ä¸»ä»æˆ–ä¸»ä¸»åŠåŒæ­¥å¤åˆ¶</h4><p>ç”¨åŒèŠ‚ç‚¹æ•°æ®åº“ï¼Œæ­å»ºå•å‘æˆ–è€…åŒå‘çš„åŠåŒæ­¥å¤åˆ¶ã€‚æ¶æ„å¦‚ä¸‹ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220801004733873-fea7de7f.png" alt="image-20220801004733873" tabindex="0" loading="lazy"><figcaption>image-20220801004733873</figcaption></figure><p>é€šå¸¸ä¼šå’Œproxyã€keepalivedç­‰ç¬¬ä¸‰æ–¹è½¯ä»¶åŒæ—¶ä½¿ç”¨ï¼Œå³å¯ä»¥ç”¨æ¥ç›‘æ§æ•°æ®åº“çš„å¥åº·ï¼Œåˆå¯ä»¥æ‰§è¡Œä¸€ç³»åˆ—ç®¡ç†å‘½ä»¤ã€‚å¦‚æœä¸»åº“å‘ç”Ÿæ•…éšœï¼Œåˆ‡æ¢åˆ°å¤‡åº“åä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨æ•°æ®åº“ã€‚</p><p><strong>è¿™ç§æ–¹æ¡ˆä¼˜ç‚¹</strong>æ˜¯æ¶æ„ã€éƒ¨ç½²æ¯”è¾ƒç®€å•ï¼Œä¸»æœºå®•æœºç›´æ¥åˆ‡æ¢å³å¯ã€‚<strong>ç¼ºç‚¹</strong>æ˜¯å®Œå…¨ä¾èµ–äºåŠåŒæ­¥å¤åˆ¶ï¼ŒåŠåŒæ­¥å¤åˆ¶é€€åŒ–ä¸ºå¼‚æ­¥å¤åˆ¶ï¼Œæ— æ³•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼›å¦å¤–ï¼Œè¿˜éœ€è¦é¢å¤–è€ƒè™‘<strong>haproxyã€keepalived</strong>çš„é«˜å¯ç”¨æœºåˆ¶ã€‚</p><h4 id="åŠåŒæ­¥å¤åˆ¶ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#åŠåŒæ­¥å¤åˆ¶ä¼˜åŒ–" aria-hidden="true">#</a> åŠåŒæ­¥å¤åˆ¶ä¼˜åŒ–</h4><p>åŠåŒæ­¥å¤åˆ¶æœºåˆ¶æ˜¯å¯é çš„ï¼Œå¯ä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„ã€‚ä½†æ˜¯å¦‚æœç½‘ç»œå‘ç”Ÿæ³¢åŠ¨ï¼ŒåŠåŒæ­¥å¤åˆ¶å‘ç”Ÿè¶…æ—¶ä¼šåˆ‡æ¢ä¸ºå¼‚æ­¥å¤åˆ¶ï¼Œå¼‚å¤åˆ¶æ˜¯æ— æ³•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§çš„ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨åŠåŒå¤åˆ¶çš„åŸºç¡€ä¸Šä¼˜åŒ–ä¸€ä¸‹ï¼Œå°½å¯èƒ½ä¿è¯åŠåŒå¤åˆ¶ã€‚å¦‚<strong>åŒé€šé“å¤åˆ¶</strong>æ–¹æ¡ˆ</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220801004755753-fe27b4bb.png" alt="image-20220801004755753" tabindex="0" loading="lazy"><figcaption>image-20220801004755753</figcaption></figure><ul><li>ä¼˜ç‚¹ï¼šè¿™ç§æ–¹æ¡ˆæ¶æ„ã€éƒ¨ç½²ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä¸»æœºå®•æœºä¹Ÿæ˜¯ç›´æ¥åˆ‡æ¢å³å¯ã€‚æ¯”æ–¹æ¡ˆ1çš„åŠåŒæ­¥å¤åˆ¶ï¼Œæ›´èƒ½ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li><li>ç¼ºç‚¹ï¼šéœ€è¦ä¿®æ”¹å†…æ ¸æºç æˆ–è€…ä½¿ç”¨mysqlé€šä¿¡åè®®ï¼Œæ²¡æœ‰ä»æ ¹æœ¬ä¸Šè§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜</li></ul><h4 id="é«˜å¯ç”¨æ¶æ„ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#é«˜å¯ç”¨æ¶æ„ä¼˜åŒ–" aria-hidden="true">#</a> é«˜å¯ç”¨æ¶æ„ä¼˜åŒ–</h4><p>ä¿è¯é«˜å¯ç”¨ï¼Œå¯ä»¥æŠŠä¸»ä»åŒèŠ‚ç‚¹æ•°æ®åº“æ‰©å±•ä¸ºæ•°æ®åº“é›†ç¾¤ã€‚Zookeeperå¯ä»¥ä½œä¸ºé›†ç¾¤ç®¡ç†ï¼Œå®ƒä½¿ç”¨åˆ†å¸ƒå¼ç®—æ³•ä¿è¯é›†ç¾¤æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¯ä»¥è¾ƒå¥½çš„é¿å…ç½‘ç»œåˆ†åŒºç°è±¡çš„äº§ç”Ÿã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220801004842095-87b38a13.png" alt="image-20220801004842095" tabindex="0" loading="lazy"><figcaption>image-20220801004842095</figcaption></figure><ul><li>ä¼˜ç‚¹ï¼šä¿è¯äº†æ•´ä¸ªç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ï¼Œæ‰©å±•æ€§ä¹Ÿè¾ƒå¥½ï¼Œå¯ä»¥æ‰©å±•ä¸ºå¤§è§„æ¨¡é›†ç¾¤ã€‚</li><li>ç¼ºç‚¹ï¼šæ•°æ®ä¸€è‡´æ€§<strong>ä»ç„¶ä¾èµ–äºåŸç”Ÿçš„mysqlåŠåŒæ­¥å¤åˆ¶</strong>ï¼›å¼•å…¥Zookeeperä½¿ç³»ç»Ÿé€»è¾‘æ›´å¤æ‚ã€‚</li></ul><h4 id="å…±äº«å­˜å‚¨" tabindex="-1"><a class="header-anchor" href="#å…±äº«å­˜å‚¨" aria-hidden="true">#</a> å…±äº«å­˜å‚¨</h4><blockquote><p>å…±äº«å­˜å‚¨å®ç°äº†æ•°æ®åº“æœåŠ¡å™¨å’Œå­˜å‚¨è®¾å¤‡çš„è§£è€¦ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´çš„æ•°æ®åŒæ­¥ä¸å†ä¾èµ–äºMySQLçš„åŸç”Ÿå¤åˆ¶åŠŸèƒ½ï¼Œè€Œæ˜¯é€šè¿‡ç£ç›˜æ•°æ®åŒæ­¥çš„æ‰‹æ®µï¼Œæ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p></blockquote><h5 id="drbdç£ç›˜å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#drbdç£ç›˜å¤åˆ¶" aria-hidden="true">#</a> DRBDç£ç›˜å¤åˆ¶</h5><p>DRBDæ˜¯ä¸€ä¸ªç”¨è½¯ä»¶å®ç°çš„ã€æ— å…±äº«çš„ã€æœåŠ¡å™¨ä¹‹é—´é•œåƒå—è®¾å¤‡å†…å®¹çš„å­˜å‚¨å¤åˆ¶è§£å†³æ–¹æ¡ˆã€‚ä¸»è¦ç”¨äºå¯¹æœåŠ¡å™¨ä¹‹é—´çš„ç£ç›˜ã€åˆ†åŒºã€é€»è¾‘å·ç­‰è¿›è¡Œæ•°æ®é•œåƒï¼Œå½“ç”¨æˆ·å°†æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜æ—¶ï¼Œè¿˜ä¼šå°†æ•°æ®å‘é€åˆ°ç½‘ç»œä¸­å¦ä¸€å°ä¸»æœºçš„ç£ç›˜ä¸Šï¼Œè¿™æ ·çš„æœ¬åœ°ä¸»æœº(ä¸»èŠ‚ç‚¹)ä¸è¿œç¨‹ä¸»æœº(å¤‡èŠ‚ç‚¹)çš„æ•°æ®å°±å¯ä»¥ä¿è¯å®æ—¶åŒæ­¥ã€‚å¸¸ç”¨æ¶æ„å¦‚ä¸‹ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220801004923275-5719e313.png" alt="image-20220801004923275" tabindex="0" loading="lazy"><figcaption>image-20220801004923275</figcaption></figure><p>å½“æœ¬åœ°ä¸»æœºå‡ºç°é—®é¢˜ï¼Œè¿œç¨‹ä¸»æœºä¸Šè¿˜ä¿ç•™ç€ä¸€ä»½ç›¸åŒçš„æ•°æ®ï¼Œå³å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œä¿è¯äº†æ•°æ®çš„å®‰å…¨ã€‚</p><ul><li>ä¼˜ç‚¹ï¼šéƒ¨ç½²ç®€å•ï¼Œä»·æ ¼åˆé€‚ï¼Œä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§</li><li>ç¼ºç‚¹ï¼šå¯¹IOæ€§èƒ½å½±å“è¾ƒå¤§ï¼Œä»åº“ä¸æä¾›è¯»æ“ä½œ</li></ul><h4 id="åˆ†å¸ƒå¼åè®®" tabindex="-1"><a class="header-anchor" href="#åˆ†å¸ƒå¼åè®®" aria-hidden="true">#</a> åˆ†å¸ƒå¼åè®®</h4><p>åˆ†å¸ƒå¼åè®®å¯ä»¥å¾ˆå¥½è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚å¸¸è§çš„éƒ¨ç½²æ–¹æ¡ˆå°±æ˜¯<strong>MySQL cluster</strong>ï¼Œå®ƒæ˜¯å®˜æ–¹é›†ç¾¤çš„éƒ¨ç½²æ–¹æ¡ˆï¼Œé€šè¿‡ä½¿ç”¨NDBå­˜å‚¨å¼•æ“å®æ—¶å¤‡ä»½å†—ä½™æ•°æ®ï¼Œå®ç°æ•°æ®åº“çš„é«˜å¯ç”¨æ€§å’Œæ•°æ®ä¸€è‡´æ€§ã€‚å¦‚ä¸‹ï¼š</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220801004942686-5128d469.png" alt="image-20220801004942686" tabindex="0" loading="lazy"><figcaption>image-20220801004942686</figcaption></figure><ul><li>ä¼˜ç‚¹ï¼šä¸ä¾èµ–äºç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Œå¯ä»¥å®ç°æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼›</li><li>ç¼ºç‚¹ï¼šé…ç½®è¾ƒå¤æ‚ï¼›éœ€è¦ä½¿ç”¨NDBå‚¨å­˜å¼•æ“ï¼›è‡³å°‘ä¸‰èŠ‚ç‚¹ï¼›</li></ul><h3 id="è¯»å†™åˆ†ç¦»äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#è¯»å†™åˆ†ç¦»äº†è§£å—" aria-hidden="true">#</a> è¯»å†™åˆ†ç¦»äº†è§£å—ï¼Ÿ</h3><p>è§åæ€æ„ï¼Œæ ¹æ®è¯»å†™åˆ†ç¦»çš„åå­—ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ï¼š<strong>è¯»å†™åˆ†ç¦»ä¸»è¦æ˜¯ä¸ºäº†å°†å¯¹æ•°æ®åº“çš„è¯»å†™æ“ä½œåˆ†æ•£åˆ°ä¸åŒçš„æ•°æ®åº“èŠ‚ç‚¹ä¸Šã€‚</strong> è¿™æ ·çš„è¯ï¼Œå°±èƒ½å¤Ÿå°å¹…æå‡å†™æ€§èƒ½ï¼Œå¤§å¹…æå‡è¯»æ€§èƒ½ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220617163230641-34fa9af9.png" alt="image-20220617163230641" tabindex="0" loading="lazy"><figcaption>image-20220617163230641</figcaption></figure><p>ä¸è®ºæ˜¯ä½¿ç”¨å“ªä¸€ç§è¯»å†™åˆ†ç¦»å…·ä½“çš„å®ç°æ–¹æ¡ˆï¼Œæƒ³è¦å®ç°è¯»å†™åˆ†ç¦»ä¸€èˆ¬åŒ…å«å¦‚ä¸‹å‡ æ­¥ï¼š</p><ol><li>éƒ¨ç½²å¤šå°æ•°æ®åº“ï¼Œé€‰æ‹©å…¶ä¸­çš„ä¸€å°ä½œä¸ºä¸»æ•°æ®åº“ï¼Œå…¶ä»–çš„ä¸€å°æˆ–è€…å¤šå°ä½œä¸ºä»æ•°æ®åº“ã€‚</li><li>ä¿è¯ä¸»æ•°æ®åº“å’Œä»æ•°æ®åº“ä¹‹é—´çš„æ•°æ®æ˜¯å®æ—¶åŒæ­¥çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„<strong>ä¸»ä»å¤åˆ¶</strong>ã€‚</li><li>ç³»ç»Ÿå°†å†™è¯·æ±‚äº¤ç»™ä¸»æ•°æ®åº“å¤„ç†ï¼Œè¯»è¯·æ±‚äº¤ç»™ä»æ•°æ®åº“å¤„ç†ã€‚</li></ol><p>è½å®åˆ°é¡¹ç›®æœ¬èº«çš„è¯ï¼Œå¸¸ç”¨çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><p><strong>1.ä»£ç†æ–¹å¼</strong></p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220617163247933-8849715b.png" alt="image-20220617163247933" tabindex="0" loading="lazy"><figcaption>image-20220617163247933</figcaption></figure><p>æˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨å’Œæ•°æ®ä¸­é—´åŠ äº†ä¸€ä¸ªä»£ç†å±‚ã€‚åº”ç”¨ç¨‹åºæ‰€æœ‰çš„æ•°æ®è¯·æ±‚éƒ½äº¤ç»™ä»£ç†å±‚å¤„ç†ï¼Œä»£ç†å±‚è´Ÿè´£åˆ†ç¦»è¯»å†™è¯·æ±‚ï¼Œå°†å®ƒä»¬è·¯ç”±åˆ°å¯¹åº”çš„æ•°æ®åº“ä¸­ã€‚</p><p>æä¾›ç±»ä¼¼åŠŸèƒ½çš„ä¸­é—´ä»¶æœ‰ <strong>MySQL Router</strong>ï¼ˆå®˜æ–¹ï¼‰ã€<strong>Atlas</strong>ï¼ˆåŸºäº MySQL Proxyï¼‰ã€<strong>Maxscale</strong>ã€<strong>MyCat</strong>ã€‚</p><p><strong>2.ç»„ä»¶æ–¹å¼</strong></p><p>åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥ç¬¬ä¸‰æ–¹ç»„ä»¶æ¥å¸®åŠ©æˆ‘ä»¬è¯»å†™è¯·æ±‚ã€‚</p><p>è¿™ä¹Ÿæ˜¯æˆ‘æ¯”è¾ƒæ¨èçš„ä¸€ç§æ–¹å¼ã€‚è¿™ç§æ–¹å¼ç›®å‰åœ¨å„ç§äº’è”ç½‘å…¬å¸ä¸­ç”¨çš„æœ€å¤šçš„ï¼Œç›¸å…³çš„å®é™…çš„æ¡ˆä¾‹ä¹Ÿéå¸¸å¤šã€‚å¦‚æœä½ è¦é‡‡ç”¨è¿™ç§æ–¹å¼çš„è¯ï¼Œæ¨èä½¿ç”¨ <code>sharding-jdbc</code> ï¼Œç›´æ¥å¼•å…¥ jar åŒ…å³å¯ä½¿ç”¨ï¼Œéå¸¸æ–¹ä¾¿ã€‚åŒæ—¶ï¼Œä¹ŸèŠ‚çœäº†å¾ˆå¤šè¿ç»´çš„æˆæœ¬ã€‚</p><h3 id="èŠèŠåˆ†åº“åˆ†è¡¨-åˆ†è¡¨ä¸ºä»€ä¹ˆè¦åœæœè¿™ç§æ“ä½œ-å¦‚æœä¸åœæœå¯ä»¥æ€ä¹ˆåš" tabindex="-1"><a class="header-anchor" href="#èŠèŠåˆ†åº“åˆ†è¡¨-åˆ†è¡¨ä¸ºä»€ä¹ˆè¦åœæœè¿™ç§æ“ä½œ-å¦‚æœä¸åœæœå¯ä»¥æ€ä¹ˆåš" aria-hidden="true">#</a> èŠèŠåˆ†åº“åˆ†è¡¨,åˆ†è¡¨ä¸ºä»€ä¹ˆè¦åœæœè¿™ç§æ“ä½œï¼Œå¦‚æœä¸åœæœå¯ä»¥æ€ä¹ˆåš</h3><h4 id="åˆ†åº“åˆ†è¡¨æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#åˆ†åº“åˆ†è¡¨æ–¹æ¡ˆ" aria-hidden="true">#</a> åˆ†åº“åˆ†è¡¨æ–¹æ¡ˆ</h4><ul><li>æ°´å¹³åˆ†åº“ï¼šä»¥å­—æ®µä¸ºä¾æ®ï¼ŒæŒ‰ç…§ä¸€å®šç­–ç•¥ï¼ˆhashã€rangeç­‰ï¼‰ï¼Œå°†ä¸€ä¸ªåº“ä¸­çš„æ•°æ®æ‹†åˆ†åˆ°å¤šä¸ªåº“ä¸­ã€‚</li><li>æ°´å¹³åˆ†è¡¨ï¼šä»¥å­—æ®µä¸ºä¾æ®ï¼ŒæŒ‰ç…§ä¸€å®šç­–ç•¥ï¼ˆhashã€rangeç­‰ï¼‰ï¼Œå°†ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®æ‹†åˆ†åˆ°å¤šä¸ªè¡¨ä¸­ã€‚</li><li>å‚ç›´åˆ†åº“ï¼šä»¥è¡¨ä¸ºä¾æ®ï¼ŒæŒ‰ç…§ä¸šåŠ¡å½’å±ä¸åŒï¼Œå°†ä¸åŒçš„è¡¨æ‹†åˆ†åˆ°ä¸åŒçš„åº“ä¸­ã€‚</li><li>å‚ç›´åˆ†è¡¨ï¼šä»¥å­—æ®µä¸ºä¾æ®ï¼ŒæŒ‰ç…§å­—æ®µçš„æ´»è·ƒæ€§ï¼Œå°†è¡¨ä¸­å­—æ®µæ‹†åˆ°ä¸åŒçš„è¡¨ï¼ˆä¸»è¡¨å’Œæ‰©å±•è¡¨ï¼‰ä¸­ã€‚</li></ul><h4 id="å¸¸ç”¨çš„åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨çš„åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶" aria-hidden="true">#</a> å¸¸ç”¨çš„åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶</h4><ul><li>sharding-jdbcï¼ˆå½“å½“ï¼‰</li><li>Mycat</li><li>TDDLï¼ˆæ·˜å®ï¼‰</li><li>Oceanus(58åŒåŸæ•°æ®åº“ä¸­é—´ä»¶)</li><li>vitessï¼ˆè°·æ­Œå¼€å‘çš„æ•°æ®åº“ä¸­é—´ä»¶ï¼‰</li><li>Atlas(Qihoo 360)</li></ul><h4 id="åˆ†åº“åˆ†è¡¨å¯èƒ½é‡åˆ°çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#åˆ†åº“åˆ†è¡¨å¯èƒ½é‡åˆ°çš„é—®é¢˜" aria-hidden="true">#</a> åˆ†åº“åˆ†è¡¨å¯èƒ½é‡åˆ°çš„é—®é¢˜</h4><ul><li>äº‹åŠ¡é—®é¢˜ï¼šéœ€è¦ç”¨åˆ†å¸ƒå¼äº‹åŠ¡å•¦</li><li>è·¨èŠ‚ç‚¹Joinçš„é—®é¢˜ï¼šè§£å†³è¿™ä¸€é—®é¢˜å¯ä»¥åˆ†ä¸¤æ¬¡æŸ¥è¯¢å®ç°</li><li>è·¨èŠ‚ç‚¹çš„count,order by,group byä»¥åŠèšåˆå‡½æ•°é—®é¢˜ï¼šåˆ†åˆ«åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šå¾—åˆ°ç»“æœååœ¨åº”ç”¨ç¨‹åºç«¯è¿›è¡Œåˆå¹¶ã€‚</li><li>æ•°æ®è¿ç§»ï¼Œå®¹é‡è§„åˆ’ï¼Œæ‰©å®¹ç­‰é—®é¢˜</li><li>IDé—®é¢˜ï¼šæ•°æ®åº“è¢«åˆ‡åˆ†åï¼Œä¸èƒ½å†ä¾èµ–æ•°æ®åº“è‡ªèº«çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶å•¦ï¼Œæœ€ç®€å•å¯ä»¥è€ƒè™‘UUID</li><li>è·¨åˆ†ç‰‡çš„æ’åºåˆ†é¡µé—®é¢˜ï¼ˆåå°åŠ å¤§pagesizeå¤„ç†ï¼Ÿï¼‰</li></ul><h4 id="åˆ†è¡¨è¦åœæœå˜›-ä¸åœæœæ€ä¹ˆåš" tabindex="-1"><a class="header-anchor" href="#åˆ†è¡¨è¦åœæœå˜›-ä¸åœæœæ€ä¹ˆåš" aria-hidden="true">#</a> åˆ†è¡¨è¦åœæœå˜›ï¼Ÿä¸åœæœæ€ä¹ˆåšï¼Ÿ</h4><p>ä¸ç”¨ã€‚ä¸åœæœçš„æ—¶å€™ï¼Œåº”è¯¥æ€ä¹ˆåšå‘¢ï¼Œåˆ†äº”ä¸ªæ­¥éª¤ï¼š</p><ol><li>ç¼–å†™ä»£ç†å±‚ï¼ŒåŠ ä¸ªå¼€å…³ï¼ˆæ§åˆ¶è®¿é—®æ–°çš„DAOè¿˜æ˜¯è€çš„DAOï¼Œæˆ–è€…æ˜¯éƒ½è®¿é—®ï¼‰ï¼Œç°åº¦æœŸé—´ï¼Œè¿˜æ˜¯è®¿é—®è€çš„DAOã€‚</li><li>å‘ç‰ˆå…¨é‡åï¼Œå¼€å¯åŒå†™ï¼Œæ—¢åœ¨æ—§è¡¨æ–°å¢å’Œä¿®æ”¹ï¼Œä¹Ÿåœ¨æ–°è¡¨æ–°å¢å’Œä¿®æ”¹ã€‚æ—¥å¿—æˆ–è€…ä¸´æ—¶è¡¨è®°ä¸‹æ–°è¡¨IDèµ·å§‹å€¼ï¼Œæ—§è¡¨ä¸­å°äºè¿™ä¸ªå€¼çš„æ•°æ®å°±æ˜¯å­˜é‡æ•°æ®ï¼Œè¿™æ‰¹æ•°æ®å°±æ˜¯è¦è¿ç§»çš„ã€‚</li><li>é€šè¿‡è„šæœ¬æŠŠæ—§è¡¨çš„å­˜é‡æ•°æ®å†™å…¥æ–°è¡¨ã€‚</li><li>åœè¯»æ—§è¡¨æ”¹è¯»æ–°è¡¨ï¼Œæ­¤æ—¶æ–°è¡¨å·²ç»æ‰¿è½½äº†æ‰€æœ‰è¯»å†™ä¸šåŠ¡ï¼Œä½†æ˜¯è¿™æ—¶å€™ä¸è¦ç«‹åˆ»åœå†™æ—§è¡¨ï¼Œéœ€è¦ä¿æŒåŒå†™ä¸€æ®µæ—¶é—´ã€‚</li><li>å½“è¯»å†™æ–°è¡¨ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå¦‚æœæ²¡æœ‰ä¸šåŠ¡é—®é¢˜ï¼Œå°±å¯ä»¥åœå†™æ—§è¡¨å•¦</li></ol><h3 id="ä¸»ä»å¤åˆ¶åŸç†äº†è§£ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#ä¸»ä»å¤åˆ¶åŸç†äº†è§£ä¹ˆ" aria-hidden="true">#</a> ä¸»ä»å¤åˆ¶åŸç†äº†è§£ä¹ˆï¼Ÿ</h3><p>MySQL binlog(binary log å³äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶) ä¸»è¦è®°å½•äº† MySQL æ•°æ®åº“ä¸­æ•°æ®çš„æ‰€æœ‰å˜åŒ–(æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰ DDL å’Œ DML è¯­å¥)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ ¹æ®ä¸»åº“çš„ MySQL binlog æ—¥å¿—å°±èƒ½å¤Ÿå°†ä¸»åº“çš„æ•°æ®åŒæ­¥åˆ°ä»åº“ä¸­ã€‚</p><figure><img src="/Computer-Science-Learn-Notes/assets/image-20220617163123694-95b51dc4.png" alt="image-20220617163123694" tabindex="0" loading="lazy"><figcaption>image-20220617163123694</figcaption></figure><ol><li>ä¸»åº“å°†æ•°æ®åº“ä¸­æ•°æ®çš„å˜åŒ–å†™å…¥åˆ° binlog</li><li>ä»åº“è¿æ¥ä¸»åº“</li><li>ä»åº“ä¼šåˆ›å»ºä¸€ä¸ª I/O çº¿ç¨‹å‘ä¸»åº“è¯·æ±‚æ›´æ–°çš„ binlog</li><li>ä¸»åº“ä¼šåˆ›å»ºä¸€ä¸ª binlog dump çº¿ç¨‹æ¥å‘é€ binlog ï¼Œä»åº“ä¸­çš„ I/O çº¿ç¨‹è´Ÿè´£æ¥æ”¶</li><li>ä»åº“çš„ I/O çº¿ç¨‹å°†æ¥æ”¶çš„ binlog å†™å…¥åˆ° relay log ä¸­ã€‚</li><li>ä»åº“çš„ SQL çº¿ç¨‹è¯»å– relay log åŒæ­¥æ•°æ®æœ¬åœ°ï¼ˆä¹Ÿå°±æ˜¯å†æ‰§è¡Œä¸€é SQL ï¼‰ã€‚</li></ol><p>æ€ä¹ˆæ ·ï¼Ÿçœ‹äº†æˆ‘å¯¹ä¸»ä»å¤åˆ¶è¿™ä¸ªè¿‡ç¨‹çš„è®²è§£ï¼Œä½ åº”è¯¥ææ˜ç™½äº†å§!</p><p>ä½ ä¸€èˆ¬çœ‹åˆ° binlog å°±è¦æƒ³åˆ°ä¸»ä»å¤åˆ¶ã€‚å½“ç„¶ï¼Œé™¤äº†ä¸»ä»å¤åˆ¶ä¹‹å¤–ï¼Œbinlog è¿˜èƒ½å¸®åŠ©æˆ‘ä»¬å®ç°æ•°æ®æ¢å¤ã€‚</p><p>ğŸŒˆ æ‹“å±•ä¸€ä¸‹ï¼š</p><p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰ä½¿ç”¨è¿‡é˜¿é‡Œå¼€æºçš„ä¸€ä¸ªå«åš canal çš„å·¥å…·ã€‚è¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç° MySQL å’Œå…¶ä»–æ•°æ®æºæ¯”å¦‚ Elasticsearch æˆ–è€…å¦å¤–ä¸€å° MySQL æ•°æ®åº“ä¹‹é—´çš„æ•°æ®åŒæ­¥ã€‚å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªå·¥å…·çš„åº•å±‚åŸç†è‚¯å®šä¹Ÿæ˜¯ä¾èµ– binlogã€‚canal çš„åŸç†å°±æ˜¯æ¨¡æ‹Ÿ MySQL ä¸»ä»å¤åˆ¶çš„è¿‡ç¨‹ï¼Œè§£æ binlog å°†æ•°æ®åŒæ­¥åˆ°å…¶ä»–çš„æ•°æ®æºã€‚</p><p>å¦å¤–ï¼Œåƒå’±ä»¬å¸¸ç”¨çš„åˆ†å¸ƒå¼ç¼“å­˜ç»„ä»¶ Redis ä¹Ÿæ˜¯é€šè¿‡ä¸»ä»å¤åˆ¶å®ç°çš„è¯»å†™åˆ†ç¦»ã€‚</p><p>ğŸŒ• ç®€å•æ€»ç»“ä¸€ä¸‹ï¼š</p><p><strong>MySQL ä¸»ä»å¤åˆ¶æ˜¯ä¾èµ–äº binlog ã€‚å¦å¤–ï¼Œå¸¸è§çš„ä¸€äº›åŒæ­¥ MySQL æ•°æ®åˆ°å…¶ä»–æ•°æ®æºçš„å·¥å…·ï¼ˆæ¯”å¦‚ canalï¼‰çš„åº•å±‚ä¸€èˆ¬ä¹Ÿæ˜¯ä¾èµ– binlog ã€‚</strong></p><h3 id="æ•°æ®åº“å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”" aria-hidden="true">#</a> æ•°æ®åº“å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”</h3><h4 id="åŸºäºæ•°æ®åº“è¡¨-é”è¡¨-å¾ˆå°‘ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#åŸºäºæ•°æ®åº“è¡¨-é”è¡¨-å¾ˆå°‘ä½¿ç”¨" aria-hidden="true">#</a> åŸºäºæ•°æ®åº“è¡¨ï¼ˆé”è¡¨ï¼Œå¾ˆå°‘ä½¿ç”¨ï¼‰</h4><p>æœ€ç®€å•çš„æ–¹å¼å¯èƒ½å°±æ˜¯ç›´æ¥åˆ›å»ºä¸€å¼ é”è¡¨ï¼Œç„¶åé€šè¿‡æ“ä½œè¯¥è¡¨ä¸­çš„æ•°æ®æ¥å®ç°äº†ã€‚å½“æˆ‘ä»¬æƒ³è¦è·å¾—é”çš„æ—¶å€™ï¼Œå°±å¯ä»¥åœ¨è¯¥è¡¨ä¸­å¢åŠ ä¸€æ¡è®°å½•ï¼Œæƒ³è¦é‡Šæ”¾é”çš„æ—¶å€™å°±åˆ é™¤è¿™æ¡è®°å½•ã€‚</p><p>ä¸ºäº†æ›´å¥½çš„æ¼”ç¤ºï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€å¼ æ•°æ®åº“è¡¨ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> database_lock <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	<span class="token identifier"><span class="token punctuation">`</span>resource<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;é”å®šçš„èµ„æº&#39;</span><span class="token punctuation">,</span>
	<span class="token identifier"><span class="token punctuation">`</span>description<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;æè¿°&#39;</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> uiq_idx_resource <span class="token punctuation">(</span>resource<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">&#39;æ•°æ®åº“åˆ†å¸ƒå¼é”è¡¨&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æˆ‘ä»¬æƒ³è¦è·å¾—é”æ—¶ï¼Œå¯ä»¥æ’å…¥ä¸€æ¡æ•°æ®ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> database_lock<span class="token punctuation">(</span>resource<span class="token punctuation">,</span> description<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;lock&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å½“éœ€è¦é‡Šæ”¾é”çš„æ—¶ï¼Œå¯ä»¥åˆ é™¤è¿™æ¡æ•°æ®ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> database_lock <span class="token keyword">WHERE</span> resource<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="åŸºäºæ‚²è§‚é”" tabindex="-1"><a class="header-anchor" href="#åŸºäºæ‚²è§‚é”" aria-hidden="true">#</a> åŸºäºæ‚²è§‚é”</h4><p><strong>æ‚²è§‚é”å®ç°æ€è·¯</strong>ï¼Ÿ</p><ol><li>åœ¨å¯¹ä»»æ„è®°å½•è¿›è¡Œä¿®æ”¹å‰ï¼Œå…ˆå°è¯•ä¸ºè¯¥è®°å½•åŠ ä¸Šæ’ä»–é”ï¼ˆexclusive lockingï¼‰ã€‚</li><li>å¦‚æœåŠ é”å¤±è´¥ï¼Œè¯´æ˜è¯¥è®°å½•æ­£åœ¨è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆå½“å‰æŸ¥è¯¢å¯èƒ½è¦ç­‰å¾…æˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚ å…·ä½“å“åº”æ–¹å¼ç”±å¼€å‘è€…æ ¹æ®å®é™…éœ€è¦å†³å®šã€‚</li><li>å¦‚æœæˆåŠŸåŠ é”ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¯¹è®°å½•åšä¿®æ”¹ï¼Œäº‹åŠ¡å®Œæˆåå°±ä¼šè§£é”äº†ã€‚</li><li>å…¶é—´å¦‚æœæœ‰å…¶ä»–å¯¹è¯¥è®°å½•åšä¿®æ”¹æˆ–åŠ æ’ä»–é”çš„æ“ä½œï¼Œéƒ½ä¼šç­‰å¾…æˆ‘ä»¬è§£é”æˆ–ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</li></ol><p><strong>ä»¥MySQL InnoDBä¸­ä½¿ç”¨æ‚²è§‚é”ä¸ºä¾‹</strong>ï¼Ÿ</p><p>è¦ä½¿ç”¨æ‚²è§‚é”ï¼Œæˆ‘ä»¬å¿…é¡»å…³é—­mysqlæ•°æ®åº“çš„è‡ªåŠ¨æäº¤å±æ€§ï¼Œå› ä¸ºMySQLé»˜è®¤ä½¿ç”¨autocommitæ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½ æ‰§è¡Œä¸€ä¸ªæ›´æ–°æ“ä½œåï¼ŒMySQLä¼šç«‹åˆ»å°†ç»“æœè¿›è¡Œæäº¤ã€‚set autocommit=0;</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">//0.å¼€å§‹äº‹åŠ¡</span>
<span class="token keyword">begin</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token keyword">begin</span> <span class="token keyword">work</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span> <span class="token punctuation">(</span>ä¸‰è€…é€‰ä¸€å°±å¯ä»¥<span class="token punctuation">)</span>
<span class="token comment">//1.æŸ¥è¯¢å‡ºå•†å“ä¿¡æ¯</span>
<span class="token keyword">select</span> <span class="token keyword">status</span> <span class="token keyword">from</span> t_goods <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">for</span> <span class="token keyword">update</span><span class="token punctuation">;</span>
<span class="token comment">//2.æ ¹æ®å•†å“ä¿¡æ¯ç”Ÿæˆè®¢å•</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_orders <span class="token punctuation">(</span>id<span class="token punctuation">,</span>goods_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//3.ä¿®æ”¹å•†å“statusä¸º2</span>
<span class="token keyword">update</span> t_goods <span class="token keyword">set</span> <span class="token keyword">status</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">//4.æäº¤äº‹åŠ¡</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token keyword">commit</span> <span class="token keyword">work</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„æŸ¥è¯¢è¯­å¥ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>selectâ€¦for update</code>çš„æ–¹å¼ï¼Œè¿™æ ·å°±é€šè¿‡å¼€å¯æ’ä»–é”çš„æ–¹å¼å®ç°äº†æ‚²è§‚é”ã€‚æ­¤æ—¶åœ¨t_goodsè¡¨ä¸­ï¼Œidä¸º1çš„ é‚£æ¡æ•°æ®å°±è¢«æˆ‘ä»¬é”å®šäº†ï¼Œå…¶å®ƒçš„äº‹åŠ¡å¿…é¡»ç­‰æœ¬æ¬¡äº‹åŠ¡æäº¤ä¹‹åæ‰èƒ½æ‰§è¡Œã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥ä¿è¯å½“å‰çš„æ•°æ®ä¸ä¼šè¢«å…¶å®ƒäº‹åŠ¡ä¿®æ”¹ã€‚</p><p>ä¸Šé¢æˆ‘ä»¬æåˆ°ï¼Œä½¿ç”¨ <code>selectâ€¦for update</code>ä¼šæŠŠæ•°æ®ç»™é”ä½ï¼Œä¸è¿‡æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€äº›é”çš„çº§åˆ«ï¼ŒMySQL InnoDBé»˜è®¤è¡Œçº§é”ã€‚è¡Œçº§é”éƒ½æ˜¯åŸºäºç´¢å¼•çš„ï¼Œå¦‚æœä¸€æ¡SQLè¯­å¥ç”¨ä¸åˆ°ç´¢å¼•æ˜¯ä¸ä¼šä½¿ç”¨è¡Œçº§é”çš„ï¼Œä¼šä½¿ç”¨è¡¨çº§é”æŠŠæ•´å¼ è¡¨é”ä½ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ã€‚</p><h4 id="åŸºäºä¹è§‚é”" tabindex="-1"><a class="header-anchor" href="#åŸºäºä¹è§‚é”" aria-hidden="true">#</a> åŸºäºä¹è§‚é”</h4><p>ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆåˆåâ€œä¹è§‚é”â€ï¼ŒOptimistic Concurrency Controlï¼Œç¼©å†™â€œOCCâ€ï¼‰æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ã€‚å®ƒå‡è®¾å¤šç”¨æˆ·å¹¶å‘çš„äº‹åŠ¡åœ¨å¤„ç†æ—¶ä¸ä¼šå½¼æ­¤äº’ç›¸å½±å“ï¼Œå„äº‹åŠ¡èƒ½å¤Ÿåœ¨ä¸äº§ç”Ÿé”çš„æƒ…å†µä¸‹å¤„ç†å„è‡ªå½±å“çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚åœ¨æäº¤æ•°æ®æ›´æ–°ä¹‹å‰ï¼Œæ¯ä¸ªäº‹åŠ¡ä¼šå…ˆæ£€æŸ¥åœ¨è¯¥äº‹åŠ¡è¯»å–æ•°æ®åï¼Œæœ‰æ²¡æœ‰å…¶ä»–äº‹åŠ¡åˆä¿®æ”¹äº†è¯¥æ•°æ®ã€‚å¦‚æœå…¶ä»–äº‹åŠ¡æœ‰æ›´æ–°çš„è¯ï¼Œæ­£åœ¨æäº¤çš„äº‹åŠ¡ä¼šè¿›è¡Œå›æ»šã€‚</p><p><strong>ä»¥ä½¿ç”¨ç‰ˆæœ¬å·å®ç°ä¹è§‚é”ä¸ºä¾‹ï¼Ÿ</strong></p><p>ä½¿ç”¨ç‰ˆæœ¬å·æ—¶ï¼Œå¯ä»¥åœ¨æ•°æ®åˆå§‹åŒ–æ—¶æŒ‡å®šä¸€ä¸ªç‰ˆæœ¬å·ï¼Œæ¯æ¬¡å¯¹æ•°æ®çš„æ›´æ–°æ“ä½œéƒ½å¯¹ç‰ˆæœ¬å·æ‰§è¡Œ+1æ“ä½œã€‚å¹¶åˆ¤æ–­å½“å‰ç‰ˆæœ¬å·æ˜¯ä¸æ˜¯è¯¥æ•°æ®çš„æœ€æ–°çš„ç‰ˆæœ¬å·ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token number">1.</span>æŸ¥è¯¢å‡ºå•†å“ä¿¡æ¯
<span class="token keyword">select</span> <span class="token punctuation">(</span><span class="token keyword">status</span><span class="token punctuation">,</span><span class="token keyword">status</span><span class="token punctuation">,</span>version<span class="token punctuation">)</span> <span class="token keyword">from</span> t_goods <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token comment">#{id}</span>
<span class="token number">2.</span>æ ¹æ®å•†å“ä¿¡æ¯ç”Ÿæˆè®¢å•
<span class="token number">3.</span>ä¿®æ”¹å•†å“<span class="token keyword">status</span>ä¸º<span class="token number">2</span>
<span class="token keyword">update</span> t_goods 
<span class="token keyword">set</span> <span class="token keyword">status</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>version<span class="token operator">=</span>version<span class="token operator">+</span><span class="token number">1</span>
<span class="token keyword">where</span> id<span class="token operator">=</span><span class="token comment">#{id} and version=#{version};</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¹è§‚é”æœºåˆ¶å¾€å¾€åŸºäºç³»ç»Ÿä¸­æ•°æ®å­˜å‚¨é€»è¾‘ï¼Œå› æ­¤ä¹Ÿå…·å¤‡ä¸€å®šçš„å±€é™æ€§ã€‚ç”±äºä¹è§‚é”æœºåˆ¶æ˜¯åœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸­å®ç°çš„ï¼Œå¯¹äºæ¥è‡ªå¤–éƒ¨ç³»ç»Ÿçš„ç”¨æˆ·æ•°æ®æ›´æ–°æ“ä½œä¸å—æˆ‘ä»¬ç³»ç»Ÿçš„æ§åˆ¶ï¼Œå› æ­¤å¯èƒ½ä¼šé€ æˆè„æ•°æ®è¢«æ›´æ–°åˆ°æ•°æ®åº“ä¸­ã€‚åœ¨ç³»ç»Ÿè®¾è®¡é˜¶æ®µï¼Œæˆ‘ä»¬åº”è¯¥å……åˆ†è€ƒè™‘åˆ°è¿™äº›æƒ…å†µï¼Œå¹¶è¿›è¡Œç›¸åº”çš„è°ƒæ•´ï¼ˆå¦‚å°†ä¹è§‚é”ç­–ç•¥åœ¨æ•°æ®åº“å­˜å‚¨è¿‡ç¨‹ä¸­å®ç°ï¼Œå¯¹å¤–åªå¼€æ”¾åŸºäºæ­¤å­˜å‚¨è¿‡ç¨‹çš„æ•°æ®æ›´æ–°é€”å¾„ï¼Œè€Œä¸æ˜¯å°†æ•°æ®åº“è¡¨ç›´æ¥å¯¹å¤–å…¬å¼€ï¼‰ã€‚</p><ul><li><strong>ç¼ºé™·</strong></li></ul><p>å¯¹æ•°æ®åº“ä¾èµ–ï¼Œå¼€é”€é—®é¢˜ï¼Œè¡Œé”å˜è¡¨é”é—®é¢˜ï¼Œæ— æ³•è§£å†³æ•°æ®åº“å•ç‚¹å’Œå¯é‡å…¥çš„é—®é¢˜ã€‚</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/zhiyu1998/Computer-Science-Learn-Notes/edit/main/demo/theme-docs/src/Java/eightpart/mysql.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 542716863@qq.com">RrOrange</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/Computer-Science-Learn-Notes/Java/eightpart/spring.html" class="nav-link prev" aria-label="Springç³»åˆ—"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Springç³»åˆ—</div></a><a href="/Computer-Science-Learn-Notes/Java/eightpart/redis.html" class="nav-link next" aria-label="redis"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">redis<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">é»˜è®¤é¡µè„š</div><div class="copyright">Copyright Â© 2023 zhiyu1998</div></footer></div><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/Computer-Science-Learn-Notes/assets/app-66c72b60.js" defer></script>
  </body>
</html>
